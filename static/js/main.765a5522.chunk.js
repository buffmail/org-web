(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{141:function(e,t,n){e.exports=n.p+"static/media/org-web.b087bbb4.svg"},149:function(e,t,n){e.exports=n.p+"static/media/dropbox.44db08f0.svg"},150:function(e,t,n){e.exports=n.p+"static/media/google_drive.f5fd3e02.png"},151:function(e,t,n){e.exports=n(360)},156:function(e,t,n){},268:function(e,t,n){},269:function(e,t,n){},270:function(e,t,n){},271:function(e,t,n){},273:function(e,t,n){},274:function(e,t,n){},284:function(e,t,n){},289:function(e,t,n){},290:function(e,t,n){},294:function(e,t,n){},295:function(e,t,n){},296:function(e,t,n){},297:function(e,t,n){},298:function(e,t,n){},299:function(e,t,n){},300:function(e,t,n){},301:function(e,t,n){},302:function(e,t,n){},303:function(e,t,n){},304:function(e,t,n){},305:function(e,t,n){},306:function(e,t,n){},307:function(e,t,n){},308:function(e,t,n){},309:function(e,t,n){},310:function(e,t,n){},311:function(e,t,n){},312:function(e,t,n){},313:function(e,t,n){},348:function(e,t,n){},349:function(e,t,n){},350:function(e,t,n){},351:function(e,t,n){},352:function(e,t,n){},353:function(e,t,n){},354:function(e,t,n){},355:function(e,t,n){},356:function(e,t,n){},357:function(e,t,n){},358:function(e,t,n){},359:function(e,t,n){},360:function(e,t,n){"use strict";n.r(t);var a={};n.r(a),n.d(a,"setLoadingMessage",function(){return D}),n.d(a,"hideLoadingMessage",function(){return C}),n.d(a,"setIsLoading",function(){return O}),n.d(a,"setDisappearingLoadingMessage",function(){return A}),n.d(a,"setLastViewedFile",function(){return N}),n.d(a,"loadStaticFile",function(){return L}),n.d(a,"unloadStaticFile",function(){return M}),n.d(a,"setFontSize",function(){return P}),n.d(a,"setBulletStyle",function(){return R}),n.d(a,"setShouldTapTodoToAdvance",function(){return H}),n.d(a,"setAgendaDefaultDeadlineDelayUnit",function(){return j}),n.d(a,"setAgendaDefaultDeadlineDelayValue",function(){return x}),n.d(a,"setShouldLiveSync",function(){return F}),n.d(a,"setShouldSyncOnBecomingVisibile",function(){return U}),n.d(a,"setShouldStoreSettingsInSyncBackend",function(){return V}),n.d(a,"setHasUnseenChangelog",function(){return B}),n.d(a,"setLastSeenChangelogHeader",function(){return W}),n.d(a,"setCustomKeybinding",function(){return G}),n.d(a,"restoreBaseSettings",function(){return Y}),n.d(a,"pushModalPage",function(){return K}),n.d(a,"popModalPage",function(){return z}),n.d(a,"clearModalStack",function(){return J}),n.d(a,"activatePopup",function(){return X}),n.d(a,"closePopup",function(){return q});var r={};n.r(r),n.d(r,"displayFile",function(){return je}),n.d(r,"setLastSyncAt",function(){return xe}),n.d(r,"stopDisplayingFile",function(){return Fe}),n.d(r,"sync",function(){return Ue}),n.d(r,"openHeader",function(){return Ve}),n.d(r,"toggleHeaderOpened",function(){return Be}),n.d(r,"selectHeader",function(){return We}),n.d(r,"selectHeaderAndOpenParents",function(){return Ge}),n.d(r,"advanceTodoState",function(){return Ye}),n.d(r,"enterEditMode",function(){return Ke}),n.d(r,"exitEditMode",function(){return ze}),n.d(r,"updateHeaderTitle",function(){return Je}),n.d(r,"updateHeaderDescription",function(){return Xe}),n.d(r,"addHeader",function(){return qe}),n.d(r,"selectNextSiblingHeader",function(){return Qe}),n.d(r,"addHeaderAndEdit",function(){return Ze}),n.d(r,"selectNextVisibleHeader",function(){return $e}),n.d(r,"selectPreviousVisibleHeader",function(){return et}),n.d(r,"removeHeader",function(){return tt}),n.d(r,"moveHeaderUp",function(){return nt}),n.d(r,"moveHeaderDown",function(){return at}),n.d(r,"moveHeaderLeft",function(){return rt}),n.d(r,"moveHeaderRight",function(){return it}),n.d(r,"moveSubtreeLeft",function(){return ot}),n.d(r,"moveSubtreeRight",function(){return st}),n.d(r,"focusHeader",function(){return lt}),n.d(r,"unfocusHeader",function(){return ct}),n.d(r,"noOp",function(){return ut}),n.d(r,"applyOpennessState",function(){return dt}),n.d(r,"setDirty",function(){return pt}),n.d(r,"setSelectedTableCellId",function(){return ht}),n.d(r,"addNewTableRow",function(){return mt}),n.d(r,"removeTableRow",function(){return ft}),n.d(r,"addNewTableColumn",function(){return gt}),n.d(r,"removeTableColumn",function(){return bt}),n.d(r,"moveTableRowDown",function(){return vt}),n.d(r,"moveTableRowUp",function(){return yt}),n.d(r,"moveTableColumnLeft",function(){return Et}),n.d(r,"moveTableColumnRight",function(){return _t}),n.d(r,"updateTableCellValue",function(){return Tt}),n.d(r,"insertCapture",function(){return It}),n.d(r,"clearPendingCapture",function(){return wt}),n.d(r,"insertPendingCapture",function(){return kt}),n.d(r,"advanceCheckboxState",function(){return St}),n.d(r,"setSelectedListItemId",function(){return Dt}),n.d(r,"updateListTitleValue",function(){return Ct}),n.d(r,"updateListContentsValue",function(){return Ot}),n.d(r,"addNewListItem",function(){return At}),n.d(r,"selectNextSiblingListItem",function(){return Nt}),n.d(r,"addNewListItemAndEdit",function(){return Lt}),n.d(r,"removeListItem",function(){return Mt}),n.d(r,"moveListItemUp",function(){return Pt}),n.d(r,"moveListItemDown",function(){return Rt}),n.d(r,"moveListItemLeft",function(){return Ht}),n.d(r,"moveListItemRight",function(){return jt}),n.d(r,"moveListSubtreeLeft",function(){return xt}),n.d(r,"moveListSubtreeRight",function(){return Ft}),n.d(r,"setHeaderTags",function(){return Ut}),n.d(r,"reorderTags",function(){return Vt}),n.d(r,"reorderPropertyList",function(){return Bt}),n.d(r,"updateTimestampWithId",function(){return Wt}),n.d(r,"updatePlanningItemTimestamp",function(){return Gt}),n.d(r,"addNewPlanningItem",function(){return Yt}),n.d(r,"updatePropertyListItems",function(){return Kt}),n.d(r,"setOrgFileErrorMessage",function(){return zt});var i={};n.r(i),n.d(i,"addNewEmptyCaptureTemplate",function(){return Qt}),n.d(i,"updateTemplateFieldPathValue",function(){return Zt}),n.d(i,"addNewTemplateOrgFileAvailability",function(){return $t}),n.d(i,"removeTemplateOrgFileAvailability",function(){return en}),n.d(i,"addNewTemplateHeaderPath",function(){return tn}),n.d(i,"removeTemplateHeaderPath",function(){return nn}),n.d(i,"deleteTemplate",function(){return an}),n.d(i,"restoreCaptureSettings",function(){return rn}),n.d(i,"reorderCaptureTemplate",function(){return on});var o={};n.r(o),n.d(o,"signOut",function(){return aa}),n.d(o,"setCurrentFileBrowserDirectoryListing",function(){return ra}),n.d(o,"setIsLoadingMoreDirectoryListing",function(){return ia}),n.d(o,"getDirectoryListing",function(){return oa}),n.d(o,"loadMoreDirectoryListing",function(){return sa}),n.d(o,"pushBackup",function(){return la}),n.d(o,"downloadFile",function(){return ca});var s=n(0),l=n.n(s),c=n(36),u=n.n(c),d=(n(156),n(5)),p=n(9),h=n(10),m=n(12),f=n(11),g=n(14),b=n(13),v=n(18),y=n(7),E=n(139),_=n(27),T=n(23),I=n(60),w=function(e){return function(e){return function(t){var n=t.type,a=Object(I.a)(t,["type"]),r={SET_CURRENT_FILE_BROWSER_DIRECTORY_LISTING:["directoryListing"],AUTHENTICATE:["dropboxAccessToken"],DISPLAY_FILE:["contents"]};return r[n]&&r[n].forEach(function(e){a=Object(T.a)({},a,Object(_.a)({},e,"--REDACTED--"))}),ga("send","event","action",n,JSON.stringify(a)),e(t)}}},k=n(25),S=n.n(k),D=function(e){return{type:"SET_LOADING_MESSAGE",loadingMessage:e}},C=function(){return{type:"HIDE_LOADING_MESSAGE"}},O=function(e){return{type:"SET_IS_LOADING",isLoading:e}},A=function(e,t){return function(n){n(D(e)),setTimeout(function(){return n(C())},t)}},N=function(e,t){return{type:"SET_LAST_VIEWED_FILE",lastViewedPath:e,lastViewedContents:t}},L=function(e){return function(t,n){t(N(n().org.present.get("path"),n().org.present.get("contents"))),t(je(null,{changelog:'* January 20th, 2022\r\n** Fix a bug in which an extra newline is inserted for a new header\r\n* October 6th, 2021\r\n** First-class support for plain lists thanks to @kjmatsuda on GitHub\r\n* November 1st, 2018 (afternoon)\r\n** Add support for the [[https://orgmode.org/manual/Deadlines-and-scheduling.html#Deadlines-and-scheduling][-- delay type]] with SCHEDULED items\r\n* November 1st, 2018\r\n** Added support for [[https://orgmode.org/manual/Repeated-tasks.html][timestamp repeaters]]\r\nWhen you advance a header to a DONE state, if there is a DEADLINE or SCHEDULED planning item on that header, those timestamps will be advanced according to the specified repeater.\r\n* October 31st, 2018\r\n** Added a "Live sync" setting to automatically push changes as you make them, instead of requiring you to manually sync.\r\n** Happy Halloween!\r\n* October 22nd, 2018 (afternoon)\r\n** Added a [[http://eepurl.com/dK5F9w][mailing list]]! You can also find a link to sign up on the settings screen\r\nI plan on sending less than 1 email per week, and you can easily unsubscribe at any time!\r\n* October 22nd, 2018\r\n** Added first class support for property lists. Tap on any of the properties to bring up an editor (that won\'t work in this file, but you can try it out in the sample file!).\r\n:PROPERTIES:\r\n:prop1: value 1\r\n:prop2: value 2\r\n:END:\r\n* October 17th, 2018\r\n** Added a basic agenda view - try tapping the new calendar button at the bottom of the screen!\r\n* October 4th, 2018\r\n** Implemented new (kinda slicker?) modal component\r\n* October 2nd, 2018\r\n** Added buttons to add/edit deadline and scheduled timestamps\r\n* September 23rd, 2018\r\n** Added native support for displaying and editing timestamps\r\n* September 18th, 2018 (afternoon)\r\n** Parse and display inline markup like ~this~ and +this+ and *this* and /this/\r\n* September 18th, 2018\r\n** Added URL params for capture, specifically for Siri Shortcuts support!\r\n*** Check out [[https://www.icloud.com/shortcuts/4e51e8b748d14a50aa70ac6fb963f775][this sample Siri Shortcut]] or [[https://github.com/DanielDe/org-web/#capture-params-and-siri-support][the README file]] for more information\r\n* September 13th, 2018\r\n** Added support for Google Drive!\r\n*** You can now use Google Drive as a sync backend. Just choose it as an option when you click "Sign in".\r\n*** Please let me know if you run into any issues with Google Drive by [[https://github.com/DanielDe/org-web/issues/new][creating an issue]]!\r\n* September 5th, 2018\r\n** Native tag support and editor\r\n*** A new button in the header action drawer brings up the tag editor\r\n*** From here you can modify, add, and reorder tags\r\n* September 3rd, 2018\r\n** Huge UI overhaul!\r\n*** Removed the action drawer, replaced with just three buttons: Sync, Movement, and Capture Templates\r\n*** All other actions now available via header action drawer, table action drawer, or swipe actions\r\n*** See the Help/Sample file in Settings for more details!\r\n* September 2nd, 2018\r\n** Replaced "push" and "pull" buttons with a single "sync" button\r\n* August 31st, 2018\r\n** Added mini action drawer to selected headers for easier access to edit and focus buttons\r\n* August 30th, 2018\r\n** Moved undo button into the header\r\n*** This is one step in a major UI overhaul\r\n** Moved links to Github and Changelog into the settings page\r\n* August 29th, 2018\r\n** You can now swipe on headers to trigger common actions:\r\n*** Swipe right to advance the todo state\r\n*** Swipe left to remove the header\r\n*** This only works on touchscreen devices\r\n* August 28th, 2018\r\n** Capture templates are now reorderable (just drag and drop!)\r\n* August 23rd, 2018\r\n** Added native support for cookies like [1/2] and [50%]\r\n*** TODO Sample todo\r\n*** DONE Another sample todo\r\n*** They\'re also supported in plain checkbox lists [3/3] [100%]\r\n- [X] item 1\r\n- [X] item 2\r\n- [X] item 3\r\n* August 21st, 2018\r\n** Added native support for plain lists and checkboxes\r\nPlain lists:\r\n\r\n- Example 1\r\n- Example 2\r\n\r\nOrdered lists:\r\n\r\n1. Example 1\r\n2. Example 2\r\n20. [@20] Example 20\r\n\r\nAnd checkboxes:\r\n\r\n- [ ] checkbox 1\r\n  - [ ] checkbox 2\r\n    - [ ] checkbox 3\r\n  - [X] checkbox 4\r\n* August 18th, 2018\r\n** Added capture templates\r\n*** Now under Settings > Capture Templates you can specify capture templates which show up as custom buttons in the action drawer for easily capturing items in your org file\r\n* August 12th, 2018\r\n** Native support for tables!\r\n| ta | da |\r\n|----+----|\r\n| \ud83c\udf89 | \ud83c\udf8a |\r\n*** Tables will now be rendered as HTML tables\r\n*** When a table cell is selected, the action drawer will populate with additional actions to manipulate tables (more details on this in the sample file)\r\n*** Format specifiers (like <r> and <10>) aren\'t yet natively supported\r\n* August 9th, 2018\r\n** Improved navigation with back buttons a la an iOS UINavigationController\r\n* August 6th, 2018\r\n** Implemented new setting to store settings in a .org-web-config.json file in your Dropbox. This will keep settings in sync across multiple devices.\r\n* August 2nd, 2018\r\n** Added keyboard shortcuts, as well as a way to set custom bindings\r\n*** Find it in Settings > Keyboard shortcuts\r\n* August 1st, 2018\r\n** Added routing (and therefore back/forward button support)\r\n* July 31st, 2018 (afternoon)\r\n** Implemented a "Focus" button - see the sample file for details.\r\n** Other minor niceties and bug fixes.\r\n* July 31st, 2018\r\n** Finished a complete rewrite to use more modern tooling and best practices\r\n*** Achieved almost complete parity with the original version, minus a couple features that weren\'t used often. Please let me know if those features were important to you (or if you notice any bugs) by [[https://github.com/DanielDe/org-web/issues/new][creating an issue]].\r\n** More features coming soon!\r\n* July 4th, 2017\r\n** Fixed bug with preserving header openness state across reloads\r\n* June 3rd, 2017\r\n** Added setting to preserve open headers across reloads\r\n* May 29th, 2017\r\n** Added setting to enable tapping the TODO label to advance the TODO state\r\n** Fixed export bug that caused blank descriptions to be exported as a newline\r\n* May 21st, 2017\r\n** Added some schnazzy (sp?) icons to the file chooser\r\n* May 20th, 2017\r\n** Added force touch/3d touch on devices that support it\r\n*** Force push the add header button (+) to reveal a new button that adds a new TODO header\r\n*** More uses of force push to come!\r\n* May 13th, 2017\r\n** Display tags more natively\r\n** Added link to the Github repo - bug reports, feature requests, and pull requests welcome!\r\n* May 7th, 2017\r\n** Confirmation is no longer required to remove a header, since its easy to undo now\r\n** Fixed bug where first action couldn\'t be undone\r\n* May 6th, 2017\r\n** Added undo button\r\n* April 29th, 2017\r\n** Backups are now made on first load of a file, rather than with every push. Should speed things up a bit!\r\n** Added some nice animations\r\n* April 27th, 2017\r\n** org-web is now open source! [[https://github.com/DanielDe/org-web]]\r\n** Added setting for larger font size\r\n** Added setting for fancy bullets\r\n** Added setting for cozier header spacing\r\n** Added a button to view new features (what you\'re reading now!)\r\n',sample:"#+TODO: TODO | DONE\r\n#+TODO: START INPROGRESS STALLED | FINISHED\r\n\r\n* This is an actual org file - feel free to play around with it! (Don't worry about messing it up - your changes won't be saved, so just refresh the page to reset it)\r\n* For starters, tap on the next header to open it\r\nThis header has some description text and a couple subheaders. Look through the next few top level headers to learn more about org-web.\r\n** This is a subheader\r\n** This is a subheader too!\r\n* Actions\r\n** Todos [1/4] [25%]\r\nThis header has a few TODO items as subheaders.\r\n*** TODO Learn how to use TODOs in org-web\r\nTo advance the todo state of a header, swipe right on it until the background turns green.\r\n\r\nTry advancing the todo state of this header a few times!\r\n**** There's also a setting once you're signed in to enable tapping on the TODO label itself to advance the todo state. Its off by default because I thought the behavior would be confusing unless explained, but I recommend turning it on!\r\n*** DONE Check out org-web\r\n*** START Investigate custom TODO states\r\norg-web also supports [[http://orgmode.org/manual/Workflow-states.html#Workflow-states][custom todo states]] (if declared at the top of the file). Swipe right on this header a few times.\r\n\r\nNote that when the cycle restarts, it defaults to the first set of todo states. Manually edit the header to get back to a different todo state cycle (more on editing headers below!)\r\n** Editing headers\r\nWhen you select a header the \"header action drawer\" appears. The first two buttons in this drawer edit the header and description respectively. Try editing this header.\r\n** Tags\r\nThe next button in the header action drawer will bring up the tag editor.\r\n\r\nThis editor lets you add, modify, and reorder tags, as well as giving you easy access to all tags in the file.\r\n\r\nTry it out on these headers:\r\n*** Dogs:\r\n**** Eloise                                         :cute:middleaged:tiny:\r\n**** Clooney                                             :cute:young:tiny:\r\n**** Murphy                                             :cute:young:small:\r\n**** Starla                                              :cute:old:medium:\r\n**** Rex                                                 :cute:old:medium:\r\n**** Maz                                           :cute:middleaged:large:\r\n** Focusing\r\nThe next button in the header action drawer \"focuses\" on a header, hiding all others and promoting it to the top level. Press the button again to \"unfocus\".\r\n\r\nThis is purely visual - your org file isn't affected under the hood.\r\n\r\nI find this useful for focusing on my \"Groceries\" list when I go to the grocery store. Give it a shot on this grocery list:\r\n*** Groceries\r\n- [ ] Mangoes\r\n- [ ] Dark chocolate\r\n- [ ] Carrots\r\n** Adding and removing headers\r\nTo add a new header, press the + button in the header action drawer\r\n\r\nTo remove a header, swipe left on the header until the background turns red.\r\n** Moving headers\r\nTo move a header, click on the four-way arrows button at the bottom of the screen with a header selected. 6 buttons will appear for moving headers.\r\n\r\nThe center 4 move the header up, down, left, and right. The 2 outermost buttons move the header and its entire nested subtree.\r\n\r\nGive them a try on these nested headers to get a feel for how they operate:\r\n*** A few of my favorite things:\r\n**** Food\r\n***** Chocolate\r\n****** Dark chocolate\r\n****** Milk chocolate\r\n****** Crispy chocolate\r\n***** Mangoes\r\n**** Text editors\r\n***** Emacs\r\n**** Mountain bikes\r\n***** Santa Cruz\r\n***** Trek\r\n***** Giant\r\n***** Specialized\r\n**** Dogs\r\n***** Eloise\r\n***** Maz\r\n***** Starla\r\n***** Rex\r\n***** Clooney\r\n** Syncing\r\nThe \"cloud\" button in the lower left hand corner syncs changes to your chosen sync service (Dropbox or Google Drive).\r\n\r\nIf there's a newer version on the server and no local changes, it'll pull.\r\n\r\nIf there's no newer version on the server and there are local changes, it'll push.\r\n\r\nOtherwise, it'll ask what you want to do.\r\n\r\nThis button isn't enabled in this demo :)\r\n\r\nIf you'd like to automatically push changes as you make them, you can enable \"Live sync\" in settings.\r\n** Undoing\r\nThe undo button will appear up in the header bar when you're signed in\r\n\r\nThis works just like Emacs-style undo: your history is completely linear and you can \"undo undos\".\r\n* Tables\r\norg-web has native support for viewing and editing tables.\r\n\r\nTry playing around with this one by first clicking on a cell:\r\n\r\n| Dog name | Age | Weight (in lbs) | Parent   | Score (1-10) |\r\n|----------+-----+-----------------+----------+--------------|\r\n| Eloise   |   3 |             5.1 | Erin     |           15 |\r\n|----------+-----+-----------------+----------+--------------|\r\n| Starla   |  15 |              40 | Sarah S  |           15 |\r\n|----------+-----+-----------------+----------+--------------|\r\n| Rex      |  15 |              45 | Sarah S  |           15 |\r\n|----------+-----+-----------------+----------+--------------|\r\n| Maz      |   1 |              55 | Brittany |           15 |\r\n|----------+-----+-----------------+----------+--------------|\r\n| Clooney  | 0.1 |             4.8 | Sarah R  |           15 |\r\n|----------+-----+-----------------+----------+--------------|\r\n| Murphy   | 0.5 |              25 | Jordan   |           15 |\r\n\r\n** New action drawer items\r\nWhen a table cell is selected, a table-specific action drawer appears.\r\n\r\nThe leftmost icon allows you to edit a cell.\r\n\r\nOn the right side, the top two icons let you add and remove rows. The bottom two icons let you add and remove columns.\r\n\r\n** Moving rows and columns\r\nWhen a table cell is selected, the four-way arrow button at the bottom of the screen changes to manipulate tables.\r\n\r\nPress up and down to move rows, and left and right to move columns.\r\n** Format specifiers (like <r> and <10>) aren't yet supported, but they're on my list!\r\nIf this is an important feature to you, please let me know by upvoting [[https://github.com/DanielDe/org-web/issues/25][the issue]] on GitHub\r\n* Lists and checkboxes\r\norg-web has native support for displaying plain lists and checkboxes\r\n\r\nPlain:\r\n\r\n- plain list item 1\r\n- plain list item 2\r\n  - sub item 1\r\n- plain list item 3\r\n\r\nOrdered:\r\n\r\n1. Item 1\r\n2. Item 2\r\n20. [@20] Item 20\r\n21. Item 21\r\n\r\nCheckboxes:\r\n\r\n- [-] 1 [1/2]\r\n  - [ ] 1.1 [0%]\r\n    - [ ] 1.1.1\r\n  - [X] 1. 2\r\n- [X] 2\r\n\r\nCurrently, plain lists are mostly display only (except that you can check/uncheck checkboxes). If native support for manipulating plain lists is important to you, please let me know by upvoting [[https://github.com/DanielDe/org-web/issues/26][the issue]] on Github\r\n* Timestamps\r\norg-web has native support for displaying and editing timestamps.\r\n\r\nTry tapping on the timestamps below to get a feel for the editor:\r\n\r\n<2018-09-17 Sun>\r\n\r\n[2018-09-17 Sun]\r\n\r\n[2018-09-17 Sun +1d]\r\n\r\n[2018-09-17 Sun 10:00-11:30]\r\n\r\n<2018-09-17 Sun>--<2018-09-25 Tue>\r\n* Property lists\r\norg-web has native support for viewing and editing property lists. To bring up an editor, expand the ~PROPERTIES~ drawer below and tap on any of the properties.\r\n** Example\r\n:PROPERTIES:\r\n:callsign: Maverick\r\n:eyewear: Aviators\r\n:launch-date: [1986-05-16 Fri]\r\n:END:\r\n* Planning\r\norg-web has native support for adding and editing DEADLINE and SCHEDULED items. It also supports [[https://orgmode.org/manual/Repeated-tasks.html][repeaters]] and [[https://orgmode.org/manual/Deadlines-and-scheduling.html#Deadlines-and-scheduling][delays]]. Check out these examples:\r\n** An item with a deadline\r\nDEADLINE: <2018-10-03 Wed>\r\n** An item that is scheduled\r\nSCHEDULED: <2018-10-18 Thu>\r\n** An item with both\r\nDEADLINE: <2018-10-02 Tue>\r\nSCHEDULED: <2018-10-02 Tue>\r\n** TODO An item with a repeater - try swiping right to advance to the DONE state\r\nDEADLINE: <2018-11-01 Thu ++1w>\r\n* Capture\r\norg-web supports something like org-capture in the form of customizable, quickly accessible buttons for creating new headers.\r\n\r\nClick the button in the bottom right corner of the screen to see some examples. The first button, the lemon, will create a new entry in the \"Groceries\" list below this. The second button adds an entry to a more deeply nested header.\r\n\r\nOnce signed in, you can set up capture templates that specify header paths (and various other configurations). These capture templates can also sync between your devices (if you enable settings sync).\r\n** Groceries\r\n** Deeply\r\n*** Nested\r\n**** Headers\r\n***** Work\r\n****** Too!\r\n* Capture URL params and Siri support\r\norg-web supports a flexible mechanism for capturing using URL parameters. This mechanism integrates very nicely with the new [[https://support.apple.com/guide/shortcuts/welcome/ios][Siri Shortcuts]] feature in iOS 12, allowing you to use Siri to execute capture templates.\r\n\r\nYou can use [[https://www.icloud.com/shortcuts/4e51e8b748d14a50aa70ac6fb963f775][this sample Shortcut]] to get started with this right away in iOS 12. Open the link on your iOS device and click \"Get Shortcut\". Then open up the Shortcuts app and edit the template by following the directions in the comments. Then record a Siri trigger and you're good to go!\r\n\r\nAlternatively, you can take advantage of the URL parameters yourself to build your own custom capture mechanism. You can find more details about this in [[https://github.com/DanielDe/org-web/#capture-params-and-siri-support][the README file]].\r\n* Agenda\r\norg-web has a basic agenda view that you can access by tapping the calendar button at the bottom of the page.\r\n\r\nTap a header in this view to jump to it, and tap on the date to switch to a more readable relative date format.\r\n\r\nThese overdue items with deadlines should show up on today's entry:\r\n** TODO check out the org-web agenda view\r\nDEADLINE: <2018-09-10 Mon>\r\n** TODO sign up for Triplebyte\r\nSCHEDULED: <2018-09-17 Mon>\r\n* Syncing\r\norg-web pulls down your org files from Dropbox or Google Drive. Click the \"Sign in\" button in the upper right hand corner to sign in with either Dropbox or Google Drive and authenticate org-web.\r\n** Symlink your org files\r\nIf you don't already keep your org files in Dropbox or Google Drive, I recommend symlinking them in:\r\n\r\nln -s ~/Documents/todo.org ~/Dropbox/todo.org\r\n** Backups\r\nThe first time you push changes from org-web back up to your chosen sync service, org-web will make a backup of the original file first. It'll be named {your-file-name}.org-web-bak. Dropbox and Google Drive also both keep a full version history of your files for you, but this is an additional precaution in case something goes wrong pushing the file back up :)\r\n* org-web operates completely client side\r\nYou don't log in to org-web directly because org-web doesn't have a back end - it operates completely client side using Dropbox's wonderful Javascript SDK. This also means I'm not storing your Dropbox auth tokens in a database somewhere :)\r\n* Future plans\r\norg-web is currently pretty usable for simple tasks, but there's a lot more to do.\r\n\r\nIf you have an idea or feature request, or if you want to contribute to org-web, check out the [[https://github.com/DanielDe/org-web][GitHub page]]. We also have a [[https://gitter.im/org-web/Lobby?source=orgpage][Gitter chatroom]] if you want to chat!\r\n\r\nHere are a few of the things already on the todo list:\r\n** Support for other sync backends in addition to Dropbox and Google Drive\r\n*** SyncThing\r\n*** GitHub\r\n*** WebDAV\r\n*** Mega\r\n*** Others? If there's one you'd like, [[https://github.com/DanielDe/org-web/issues/new][create an issue]]!\r\n** Support for symmetric encryption\r\n** Search\r\n** Ability to create new files\r\n** Archiving\r\n** A backend API for use in your own apps/scripts/IFTTT/Alexa Skills/etc.\r\n** Offline support (Safari on iOS finally supports service workers!)\r\n** Ability to Tweet a header directly from org-web                    :joke:\r\n"}[e]))}},M=function(){return function(e,t){e(Fe()),t().base.get("lastViewedPath")&&e(je(t().base.get("lastViewedPath"),t().base.get("lastViewedContents")))}},P=function(e){return{type:"SET_FONT_SIZE",newFontSize:e}},R=function(e){return{type:"SET_BULLET_STYLE",newBulletStyle:e}},H=function(e){return{type:"SET_SHOULD_TAP_TODO_TO_ADVANCE",newShouldTapTodoToAdvance:e}},j=function(e){return{type:"SET_AGENDA_DEFAULT_DEADLINE_DELAY_UNIT",newAgendaDefaultDeadlineDelayUnit:e}},x=function(e){return{type:"SET_AGENDA_DEFAULT_DEADLINE_DELAY_VALUE",newAgendaDefaultDeadlineDelayValue:e}},F=function(e){return{type:"SET_SHOULD_LIVE_SYNC",shouldLiveSync:e}},U=function(e){return{type:"SET_SHOULD_SYNC_ON_BECOMING_VISIBLE",shouldSyncOnBecomingVisibile:e}},V=function(e){return function(t,n){if(t({type:"SET_SHOULD_STORE_SETTINGS_IN_SYNC_BACKEND",newShouldStoreSettingsInSyncBackend:e}),!e){var a=n().syncBackend.get("client");switch(a.type){case"Dropbox":a.deleteFile("/.org-web-config.json").catch(function(e,t){return e?null:alert("There was an error trying to delete the .org-web-config.json file: ".concat(t))});break;case"Google Drive":a.deleteFileByNameAndParent(".org-web-config.json","root")}window.previousSettingsFileContents=null}}},B=function(e){return{type:"SET_HAS_UNSEEN_CHANGELOG",newHasUnseenChangelog:e}},W=function(e){return{type:"SET_LAST_SEEN_CHANGELOG_HEADER",newLastSeenChangelogHeader:e}},G=function(e,t){return{type:"SET_CUSTOM_KEYBINDING",keybindingName:e,keybinding:t}},Y=function(e){return{type:"RESTORE_BASE_SETTINGS",newSettings:e}},K=function(e){return{type:"PUSH_MODAL_PAGE",modalPage:e}},z=function(){return{type:"POP_MODAL_PAGE"}},J=function(){return{type:"CLEAR_MODAL_STACK"}},X=function(e,t){return{type:"ACTIVATE_POPUP",popupType:e,data:t}},q=function(){return{type:"CLOSE_POPUP"}},Q=n(40),Z=n(4),$=n.n(Z),ee=n(1),te=n(15),ne=n.n(te),ae=n(140),re=n.n(ae),ie=n(2),oe=n.n(ie),se=n(6),le=function(e){var t=e.toJS(),n=t.isActive,a=t.year,r=t.month,i=t.day,o=t.dayName,s=t.startHour,l=t.startMinute,c=t.endHour,u=t.endMinute,d=t.repeaterType,p=t.repeaterValue,h=t.repeaterUnit,m=t.delayType,f=t.delayValue,g=t.delayUnit,b="";return b+=n?"<":"[",b+="".concat(a,"-").concat(r,"-").concat(i),b+=o?" ".concat(o):"",b+=s?" ".concat(s,":").concat(l):"",b+=c?"-".concat(c,":").concat(u):"",b+=d?" ".concat(d).concat(p).concat(h):"",b+=m?" ".concat(m).concat(f).concat(g):"",b+=n?">":"]"},ce=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.isActive,n=void 0===t||t,a=e.withStartTime,r=void 0!==a&&a,i=new Date,o={isActive:n,year:ne()(i,"YYYY"),month:ne()(i,"MM"),day:ne()(i,"DD"),dayName:ne()(i,"ddd"),startHour:null,startMinute:null,endHour:null,endMinute:null,repeaterType:null,repeaterValue:null,repeaterUnit:null,delayType:null,delayValue:null,delayUnit:null};return r&&(o.startHour=ne()(i,"HH"),o.startMinute=ne()(i,"mm")),o},ue=function(){return"[".concat(ne()(new Date,"YYYY-MM-DD ddd",{locale:navigator.language.startsWith("ko")?re.a:void 0}),"]")},de=function(e){var t=e.toJS(),n=t.year,a=t.month,r=t.day,i=t.startHour,o=t.startMinute,s="".concat(n,"-").concat(a,"-").concat(r);return i&&o&&(s+=" ".concat(i.padStart(2,"0"),":").concat(o)),oe()(s)},pe=function(e,t,n){return{h:Object(se.addHours)(e,t),d:Object(se.addDays)(e,t),w:Object(se.addWeeks)(e,t),m:Object(se.addMonths)(e,t),y:Object(se.addYears)(e,t)}[n]},he=function(e){return e.map(function(e){switch(e.get("type")){case"text":return e.get("contents");case"link":return e.getIn(["contents","title"])?e.getIn(["contents","title"]):e.getIn(["contents","uri"]);case"table":default:return""}}).join("")},me=function(e){if(!e)return"";var t=e.unshift(null);return e.zip(t).map(function(e){var t,n=Object(d.a)(e,2),a=n[0],r=n[1],i="";switch(a.get("type")){case"text":i=a.get("contents");break;case"link":i=(t=a).getIn(["contents","title"])?"[[".concat(t.getIn(["contents","uri"]),"][").concat(t.getIn(["contents","title"]),"]]"):"[[".concat(t.getIn(["contents","uri"]),"]]");break;case"fraction-cookie":i="[".concat(a.getIn(["fraction",0])||"","/").concat(a.getIn(["fraction",1])||"","]");break;case"percentage-cookie":i="[".concat(a.get("percentage")||"","%]");break;case"table":i=function(e){var t=e.get("contents").map(function(e){return Math.max.apply(Math,Object(Q.a)(e.get("contents").map(function(e){return($.a.countBy(e.get("rawContents"))["\n"]||0)+1})))}).toJS(),n=e.getIn(["contents",0,"contents"]).size,a=$.a.times(n).map(function(t){return Math.max.apply(Math,Object(Q.a)(e.get("contents").map(function(e){var n=e.getIn(["contents",t,"contents"]),a=he(n).split("\n").map(function(e){return e.trim().length});return Math.max.apply(Math,Object(Q.a)(a))})))});return $.a.dropRight($.a.flatten(e.get("contents").map(function(e,n){var r=t[n],i=$.a.times(r).map(function(t){return e.get("contents").map(function(e,n){var r=e.get("contents"),i=he(r).split("\n").map(function(e){return e.trim().length}),o=(e.get("rawContents").split("\n")[t]||"").trim(),s=a[n]-i[t];return o+" ".repeat(s)}).toJS().join(" | ")}).map(function(e){return"| ".concat(e," |")}),o="|"+a.map(function(e){return"-".repeat(e+2)}).join("+")+"|";return i.concat(o)}).toJS())).join("\n")}(a);break;case"list":i=function(e){var t=e.get("bulletCharacter"),n=0;return e.get("items").map(function(a){var r=e.get("isOrdered")||"*"!==t?"":" ",i=me(a.get("titleLine")),o=me(a.get("contents")),s=o.split("\n").map(function(e){return e.trim()?"".concat(r,"  ").concat(e):""}).join("\n"),l=null;if(e.get("isOrdered")){var c=++n,u=a.get("forceNumber");if(u&&(n=c=u),l="".concat(c).concat(e.get("numberTerminatorCharacter")),u&&(l+=" [@".concat(u,"]")),a.get("isCheckbox")){var d={checked:"X",unchecked:" ",partial:"-"}[a.get("checkboxState")];l+=" [".concat(d,"]")}l+=" ".concat(i)}else{if(l="".concat(r).concat(t),a.get("isCheckbox")){var p={checked:"X",unchecked:" ",partial:"-"}[a.get("checkboxState")];l+=" [".concat(p,"]")}l+=" ".concat(i)}return o&&(l+="\n".concat(s)),l}).join("\n")}(a);break;case"timestamp":i=function(e){var t=le(e.get("firstTimestamp"));return e.get("secondTimestamp")&&(t+="--".concat(le(e.get("secondTimestamp")))),t}(a);break;default:console.error("Unknown attributed string part type in attributedStringToRawText: ".concat(a.get("type")))}var o="";return r&&(["list","table"].includes(r.get("type"))?o="\n":"list"!==a.get("type")||"text"!==r.get("type")||r.get("contents").endsWith("\n")||(o="\n")),o+i}).join("")},fe=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object(ee.Map)();if(!e)return["",null];var n={"%t":"<".concat(ne()(new Date,"YYYY-MM-DD ddd"),">"),"%T":"<".concat(ne()(new Date,"YYYY-MM-DD ddd HH:mm"),">"),"%u":"[".concat(ne()(new Date,"YYYY-MM-DD ddd"),"]"),"%U":"[".concat(ne()(new Date,"YYYY-MM-DD ddd HH:mm"),"]")};t.entrySeq().forEach(function(e){var t=Object(d.a)(e,2),a=t[0],r=t[1];n["%".concat(a)]=r});var a=e;$.a.entries(n).forEach(function(e){var t=Object(d.a)(e,2),n=t[0],r=t[1];return a=a.replace(RegExp(n,"g"),r)});var r=a.includes("%?")?a.indexOf("%?"):null;return[a=a.replace(/%\?/,""),r]},ge=function(){var e=1;return function(){return e++}}(),be=function(e,t){return e.findIndex(function(e){return e.get("id")===t})},ve=function(e,t){return e.get(be(e,t))},ye=function(e,t){var n=ve(e,t),a=be(e,t),r=e.slice(a+1),i=r.findIndex(function(e){return e.get("nestingLevel")<=n.get("nestingLevel")});return-1===i?r:r.slice(0,i)},Ee=function(e,t){return ye(e,t).size},_e=function(e,t){var n=ve(e,t),a=be(e,t),r=e.slice(0,a).reverse().find(function(e){return e.get("nestingLevel")<n.get("nestingLevel")});return r?r.get("id"):null},Te=function e(t,n){var a=_e(t,n);if(!a)return!0;var r=ve(t,a);return r.get("opened")&&e(t,r.get("id"))},Ie=function(e,t){var n=function(e,t){for(var n=ve(e,t),a=be(e,t)-1;a>=0;--a){var r=e.get(a);if(r.get("nestingLevel")===n.get("nestingLevel")-1)return r.get("id");if(r.get("nestingLevel")<n.get("nestingLevel"))return null}return null}(e.get("headers"),t);if(null!==n){var a=be(e.get("headers"),n);e=e.setIn(["headers",a,"opened"],!0)}return e},we=function e(t,n){if(0===n.size)return null;var a=t.find(function(e){return null===_e(t,e.get("id"))&&e.getIn(["titleLine","rawTitle"]).trim()===n.first().trim()});return a?1===n.size?a:e(ye(t,a.get("id")),n.skip(1)):null},ke=function(e,t){return e.get("contents").some(function(e){return e.get("contents").some(function(e){return e.get("id")===t})})},Se=function(e,t){return e.find(function(e){return function e(t,n){return t.filter(function(e){return["table","list"].includes(e.get("type"))}).some(function(t){return"table"===t.get("type")?ke(t,n):t.get("items").some(function(t){return e(t.get("contents"),n)})})}(e.get("description"),t)})},De=function e(t,n){return t.map(function(t,a){return"timestamp"===t.get("type")&&t.get("id")===n?{path:[a],timestampPart:t}:"list"===t.get("type")?t.get("items").map(function(t,r){var i=e(t.get("contents"),n);if(i){var o=i.path,s=i.timestampPart;return{path:[a,"items",r,"contents"].concat(o),timestampPart:s}}var l=e(t.get("titleLine"),n);if(l){var c=l.path,u=l.timestampPart;return{path:[a,"items",r,"titleLine"].concat(c),timestampPart:u}}return null}).filter(function(e){return!!e}).first():"table"===t.get("type")?t.get("contents").map(function(t,r){return t.get("contents").map(function(t,i){var o=e(t.get("contents"),n);if(o){var s=o.path,l=o.timestampPart;return{path:[a,"contents",r,"contents",i,"contents"].concat(s),timestampPart:l}}return null}).filter(function(e){return!!e}).first()}).filter(function(e){return!!e}).first():null}).filter(function(e){return!!e}).first()},Ce=function e(t,n){return t.map(function(t,a){return"list"===t.get("type")?function(e,t){return e.get("items").some(function(e){return e.get("id")===t})}(t,n)?{path:[a],listPart:t}:t.get("items").map(function(t,r){var i=e(t.get("contents"),n);if(i){var o=i.path,s=i.listPart;return{path:[a,"items",r,"contents"].concat(o),listPart:s}}return null}).filter(function(e){return!!e}).first():null}).filter(function(e){return!!e}).first()},Oe=function(e,t){return e.map(function(e,n){var a=function e(t,n){return t.map(function(t,a){return"list"===t.get("type")?t.get("items").map(function(t,r){if(t.get("id")===n)return{path:[a,"items",r],listItemPart:t};var i=e(t.get("contents"),n);if(i){var o=i.path,s=i.listItemPart;return{path:[a,"items",r,"contents"].concat(o),listItemPart:s}}return null}).filter(function(e){return!!e}).first():null}).filter(function(e){return!!e}).first()}(e.get("description"),t);if(!a)return null;var r=a.path,i=a.listItemPart;return{path:[n,"description"].concat(r),listItemPart:i}}).filter(function(e){return!!e}).first()},Ae=function(e,t){return e.map(function(e,n){var a=function e(t,n){return t.map(function(t,a){return"table"===t.get("type")?ke(t,n)?{path:[a],tablePart:t}:null:"list"===t.get("type")?t.get("items").map(function(t,r){var i=e(t.get("contents"),n);if(i){var o=i.path,s=i.tablePart;return{path:[a,"items",r,"contents"].concat(o),tablePart:s}}return null}).filter(function(e){return!!e}).first():null}).filter(function(e){return!!e}).first()}(e.get("description"),t);if(!a)return null;var r=a.path,i=a.tablePart;return{path:[n,"description"].concat(r),tablePart:i}}).filter(function(e){return!!e}).first()},Ne=function(e,t,n){var a=Ae(e,t),r=a.path,i=a.tablePart,o=i.get("contents").findIndex(function(e){return e.get("contents").some(function(e){return e.get("id")===t})}),s=i.getIn(["contents",o,"contents"]).findIndex(function(e){return e.get("id")===t});return e.updateIn(r.concat(["contents"]),n(o,s))},Le=function(e,t,n){var a=function(e,t){return e.map(function(e,n){var a=Ce(e.get("description"),t);if(!a)return null;var r=a.path,i=a.listPart;return{path:[n,"description"].concat(r),listPart:i}}).filter(function(e){return!!e}).first()}(e,t),r=a.path,i=a.listPart.get("items").findIndex(function(e){return e.get("id")===t});return e.updateIn(r.concat(["items"]),n(i))},Me=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(0===e.size||"list"!==e.last().get("type")){var a=e.size;e=n?e.insert(a,n.set("id",ge()).set("items",new ee.List)):e.insert(a,Object(ee.fromJS)({type:"list",id:ge(),items:[],bulletCharacter:"-",numberTerminatorCharacter:null,isOrdered:!1}))}return e.map(function(e){switch(e.get("type")){case"list":return e.update("items",function(e){return e.push(t)});default:return e}})},Pe=function(e,t){if(!e)return null;var n=De(e,t);return n?n.timestampPart:null},Re=function(e,t){return e.find(function(e){return e.get("keywords").contains(t)})||e.first()},He=Object(ee.fromJS)([{description:"Groceries",headerPaths:["Capture","Groceries"],iconName:"lemon",id:ge(),isAvailableInAllOrgFiles:!1,letter:"",orgFilesWhereAvailable:[],shouldPrepend:!1,template:"* TODO %?",isSample:!0},{description:"Deeply nested header",headerPaths:["Capture","Deeply","Nested","Headers","Work","Too!"],iconName:"fighter-jet",id:ge(),isAvailableInAllOrgFiles:!1,letter:"",orgFilesWhereAvailable:[],shouldPrepend:!0,template:"* You can insert timestamps too! %T %?",isSample:!0}]),je=function(e,t){return{type:"DISPLAY_FILE",path:e,contents:t}},xe=function(e){return{type:"SET_LAST_SYNC_AT",lastSyncAt:e}},Fe=function(){return function(e,t){e({type:"STOP_DISPLAYING_FILE"}),e({type:k.ActionTypes.CLEAR_HISTORY}),e(ct()),e(q()),e(xe(null))}},Ue=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.forceAction,n=void 0===t?null:t,a=e.successMessage,r=void 0===a?"Changes pushed":a,i=e.shouldSuppressMessages,o=void 0!==i&&i;return function(e,t){var a=t().syncBackend.get("client"),i=t().org.present.get("path");null!==i&&(o||e(D("Syncing...")),e(O(!0)),e(zt(null)),a.getFileContentsAndMetadata(i).then(function(s){var l=s.contents,c=s.lastModifiedAt,u=t().org.present.get("isDirty"),d=oe()(c),p=t().org.present.get("lastSyncAt");Object(se.isAfter)(p,d)||"push"===n?u?a.updateFile(i,function(e,t,n,a){var r="";return n.size>0&&(r=n.join("\n")+"\n"),t.get(0).get("default")||(r=r+t.map(function(e){return e.get("configLine")}).join("\n")+"\n"),a.size>0&&(r+=a.join("\n")),r.length>0&&(r+="\n"),r+e.toJS().map(function(e){var t="";if(t+="*".repeat(e.nestingLevel),e.titleLine.todoKeyword&&(t+=" ".concat(e.titleLine.todoKeyword)),t+=" ".concat(e.titleLine.rawTitle),e.titleLine.tags.length>0&&(t+=" :".concat(e.titleLine.tags.filter(function(e){return!!e}).join(":"),":")),e.planningItems.length>0){var n=e.planningItems.map(function(e){return"".concat(e.type,": ").concat(le(Object(ee.fromJS)(e.timestamp)))}).join(" ").trimRight();t+="\n  ".concat(n)}return e.propertyListItems.length>0&&(t+="\n:PROPERTIES:",e.propertyListItems.forEach(function(e){t+="\n:".concat(e.property,": ").concat(me(Object(ee.fromJS)(e.value)))}),t+="\n:END:\n"),e.description&&(e.rawDescription.startsWith("\n")||0===e.rawDescription.length||(t+="\n"),t+=e.rawDescription),t}).join("\n")}(t().org.present.get("headers"),t().org.present.get("todoKeywordSets"),t().org.present.get("fileConfigLines"),t().org.present.get("linesBeforeHeadings"))).then(function(){o||e(A(r,2e3)),e(O(!1)),e(pt(!1)),e(xe(Object(se.addSeconds)(new Date,5)))}).catch(function(t){alert("There was an error pushing the file: ".concat(t.toString())),e(C()),e(O(!1))}):(o||e(A("Nothing to sync",2e3)),e(O(!1))):u&&"pull"!==n?(e(C()),e(O(!1)),e(X("sync-confirmation",{lastServerModifiedAt:d}))):(e(je(i,l)),e(dt()),e(pt(!1)),e(xe(Object(se.addSeconds)(new Date,5))),o||e(A("Latest version pulled",2e3)),e(O(!1)))}).catch(function(){e(C()),e(O(!1)),e(zt("File not found"))}))}},Ve=function(e){return{type:"OPEN_HEADER",headerId:e}},Be=function(e){return{type:"TOGGLE_HEADER_OPENED",headerId:e}},We=function(e){return function(t){t({type:"SELECT_HEADER",headerId:e}),e&&(t(ht(null)),t(Dt(null)))}},Ge=function(e){return function(t){t(We(e)),t({type:"OPEN_PARENTS_OF_HEADER",headerId:e})}},Ye=function(){return{type:"ADVANCE_TODO_STATE",headerId:arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,dirtying:!0}},Ke=function(e){return{type:"ENTER_EDIT_MODE",editModeType:e}},ze=function(){return{type:"EXIT_EDIT_MODE"}},Je=function(e,t){return{type:"UPDATE_HEADER_TITLE",headerId:e,newRawTitle:t,dirtying:!0}},Xe=function(e,t){return{type:"UPDATE_HEADER_DESCRIPTION",headerId:e,newRawDescription:t,dirtying:!0}},qe=function(e){return{type:"ADD_HEADER",headerId:e,dirtying:!0}},Qe=function(e){return{type:"SELECT_NEXT_SIBLING_HEADER",headerId:e}},Ze=function(e){return function(t){t(qe(e)),t(Qe(e)),t(Ke("title"))}},$e=function(e){return{type:"SELECT_NEXT_VISIBLE_HEADER",headerId:e}},et=function(e){return{type:"SELECT_PREVIOUS_VISIBLE_HEADER",headerId:e}},tt=function(e){return{type:"REMOVE_HEADER",headerId:e,dirtying:!0}},nt=function(e){return{type:"MOVE_HEADER_UP",headerId:e,dirtying:!0}},at=function(e){return{type:"MOVE_HEADER_DOWN",headerId:e,dirtying:!0}},rt=function(e){return{type:"MOVE_HEADER_LEFT",headerId:e,dirtying:!0}},it=function(e){return{type:"MOVE_HEADER_RIGHT",headerId:e,dirtying:!0}},ot=function(e){return{type:"MOVE_SUBTREE_LEFT",headerId:e,dirtying:!0}},st=function(e){return{type:"MOVE_SUBTREE_RIGHT",headerId:e,dirtying:!0}},lt=function(e){return{type:"FOCUS_HEADER",headerId:e}},ct=function(){return{type:"UNFOCUS_HEADER"}},ut=function(){return{type:"NO_OP"}},dt=function(){return{type:"APPLY_OPENNESS_STATE"}},pt=function(e){return{type:"SET_DIRTY",isDirty:e}},ht=function(e){return function(t){t({type:"SET_SELECTED_TABLE_CELL_ID",cellId:e}),e&&(t(We(null)),t(Dt(null)))}},mt=function(){return{type:"ADD_NEW_TABLE_ROW",dirtying:!0}},ft=function(){return{type:"REMOVE_TABLE_ROW",dirtying:!0}},gt=function(){return{type:"ADD_NEW_TABLE_COLUMN",dirtying:!0}},bt=function(){return{type:"REMOVE_TABLE_COLUMN",dirtying:!0}},vt=function(){return{type:"MOVE_TABLE_ROW_DOWN",dirtying:!0}},yt=function(){return{type:"MOVE_TABLE_ROW_UP",dirtying:!0}},Et=function(){return{type:"MOVE_TABLE_COLUMN_LEFT",dirtying:!0}},_t=function(){return{type:"MOVE_TABLE_COLUMN_RIGHT",dirtying:!0}},Tt=function(e,t){return{type:"UPDATE_TABLE_CELL_VALUE",cellId:e,newValue:t,dirtying:!0}},It=function(e,t,n){return function(a,r){a(q()),a({type:"INSERT_CAPTURE",template:r().capture.get("captureTemplates").concat(He).find(function(t){return t.get("id")===e}),content:t,shouldPrepend:n,dirtying:!0})}},wt=function(){return{type:"CLEAR_PENDING_CAPTURE"}},kt=function(){return function(e,t){var n=t().org.present.get("pendingCapture"),a=n.get("captureTemplateName"),r=n.get("captureContent"),i=n.get("customCaptureVariables");e(wt()),window.history.pushState({},"",window.location.pathname);var o=t().capture.get("captureTemplates").filter(function(e){return e.get("isAvailableInAllOrgFiles")||e.get("orgFilesWhereAvailable").includes(t().org.present.get("path"))}).find(function(e){return e.get("description").trim()===a.trim()});if(o)if(we(t().org.present.get("headers"),o.get("headerPaths"))){var s=fe(o.get("template"),i),l=Object(d.a)(s,2),c=l[0],u=l[1],p=u?"".concat(c.substring(0,u)).concat(r).concat(c.substring(u)):"".concat(c).concat(r);e(It(o.get("id"),p,o.get("shouldPrepend"))),e(Ue({successMessage:"Item captured"}))}else e(A('Capture failed: "'.concat(o.get("description"),'" header path invalid in this file'),8e3));else e(A('Capture failed: "'.concat(a,'" template not found or not available in this file'),8e3))}},St=function(e){return{type:"ADVANCE_CHECKBOX_STATE",listItemId:e,dirtying:!0}},Dt=function(e){return function(t){t({type:"SET_SELECTED_LIST_ITEM_ID",listItemId:e}),e&&(t(We(null)),t(ht(null)))}},Ct=function(e,t){return{type:"UPDATE_LIST_TITLE_VALUE",listItemId:e,newValue:t,dirtying:!0}},Ot=function(e,t){return{type:"UPDATE_LIST_CONTENTS_VALUE",listItemId:e,newValue:t,dirtying:!0}},At=function(){return{type:"ADD_NEW_LIST_ITEM",dirtying:!0}},Nt=function(){return{type:"SELECT_NEXT_SIBLING_LIST_ITEM"}},Lt=function(){return function(e){e(At()),e(Nt()),e(Ke("list-title"))}},Mt=function(){return{type:"REMOVE_LIST_ITEM",dirtying:!0}},Pt=function(){return{type:"MOVE_LIST_ITEM_UP",dirtying:!0}},Rt=function(){return{type:"MOVE_LIST_ITEM_DOWN",dirtying:!0}},Ht=function(){return{type:"MOVE_LIST_ITEM_LEFT",dirtying:!0}},jt=function(){return{type:"MOVE_LIST_ITEM_RIGHT",dirtying:!0}},xt=function(){return{type:"MOVE_LIST_SUBTREE_LEFT",dirtying:!0}},Ft=function(){return{type:"MOVE_LIST_SUBTREE_RIGHT",dirtying:!0}},Ut=function(e,t){return{type:"SET_HEADER_TAGS",headerId:e,tags:t,dirtying:!0}},Vt=function(e,t){return{type:"REORDER_TAGS",fromIndex:e,toIndex:t,dirtying:!0}},Bt=function(e,t){return function(n,a){return n({type:"REORDER_PROPERTY_LIST",fromIndex:e,toIndex:t,headerId:a().base.getIn(["activePopup","data","headerId"]),dirtying:!0})}},Wt=function(e,t){return{type:"UPDATE_TIMESTAMP_WITH_ID",timestampId:e,newTimestamp:t,dirtying:!0}},Gt=function(e,t,n){return{type:"UPDATE_PLANNING_ITEM_TIMESTAMP",headerId:e,planningItemIndex:t,newTimestamp:n,dirtying:!0}},Yt=function(e,t){return{type:"ADD_NEW_PLANNING_ITEM",headerId:e,planningType:t,dirtying:!0}},Kt=function(e,t){return{type:"UPDATE_PROPERTY_LIST_ITEMS",headerId:e,newPropertyListItems:t,dirtying:!0}},zt=function(e){return{type:"SET_ORG_FILE_ERROR_MESSAGE",message:e}},Jt=function(e){return function(t){return function(n){return n.dirtying&&e.getState().base.get("shouldLiveSync")&&e.dispatch(Ue({shouldSuppressMessages:!0})),t(n)}}},Xt=Object(Z.debounce)(function(e){return e.dispatch(Ue({shouldSuppressMessages:!0}))},1e3),qt=function(e){return function(t){return function(n){return window.addEventListener("visibilitychange",function(){e.getState().base.get("shouldSyncOnBecomingVisibile")&&Xt(e)}),t(n)}}},Qt=function(){return{type:"ADD_NEW_EMPTY_CAPTURE_TEMPLATE"}},Zt=function(e,t,n){return{type:"UPDATE_TEMPLATE_FIELD_PATH_VALUE",templateId:e,fieldPath:t,newValue:n}},$t=function(e){return{type:"ADD_NEW_TEMPLATE_ORG_FILE_AVAILABILITY",templateId:e}},en=function(e,t){return{type:"REMOVE_TEMPLATE_ORG_FILE_AVAILABILITY",templateId:e,orgFileAvailabilityIndex:t}},tn=function(e){return{type:"ADD_NEW_TEMPLATE_HEADER_PATH",templateId:e}},nn=function(e,t){return{type:"REMOVE_TEMPLATE_HEADER_PATH",templateId:e,headerPathIndex:t}},an=function(e){return{type:"DELETE_TEMPLATE",templateId:e}},rn=function(e){return{type:"RESTORE_CAPTURE_SETTINGS",newSettings:e}},on=function(e,t){return{type:"REORDER_CAPTURE_TEMPLATE",fromIndex:e,toIndex:t}},sn=function(){try{return localStorage.setItem("test","test"),"test"===localStorage.getItem("test")}catch(e){return!1}},ln=$.a.debounce(function(e,t){switch(e.type){case"Dropbox":e.createFile("/.org-web-config.json",t).catch(function(e){return alert("There was an error trying to push settings to your sync backend: ".concat(e))});break;case"Google Drive":e.createFile(".org-web-config.json","root",t).catch(function(e){return alert("There was an error trying to push settings to your sync backend: ".concat(e))})}},1e3,{maxWait:3e3}),cn=[{category:"base",name:"fontSize",type:"nullable",shouldStoreInConfig:!0},{category:"base",name:"bulletStyle",type:"nullable",shouldStoreInConfig:!0},{category:"base",name:"shouldTapTodoToAdvance",type:"boolean",shouldStoreInConfig:!0},{category:"base",name:"agendaDefaultDeadlineDelayUnit",type:"nullable",shouldStoreInConfig:!0},{category:"base",name:"agendaDefaultDeadlineDelayValue",type:"nullable",shouldStoreInConfig:!0},{category:"base",name:"shouldStoreSettingsInSyncBackend",type:"boolean",shouldStoreInConfig:!0},{category:"base",name:"lastSeenChangelogHeader",type:"nullable",shouldStoreInConfig:!0},{category:"base",name:"customKeybindings",type:"json",shouldStoreInConfig:!0},{category:"base",name:"shouldLiveSync",type:"boolean",shouldStoreInConfig:!1},{category:"base",name:"shouldSyncOnBecomingVisibile",type:"boolean",shouldStoreInConfig:!0},{category:"capture",name:"captureTemplates",type:"json",shouldStoreInConfig:!0,default:new ee.List}],un=function(e,t){return t.filter(function(e){return!e.depreacted}).filter(function(e){return"org"===e.category}).map(function(e){return e.name}).map(function(t){return[t,e.org.present.get(t)]}).concat(cn.filter(function(e){return"org"!==e.category}).map(function(t){return"json"===t.type?[t.name,JSON.stringify(e[t.category].get(t.name)||t.default||{})]:[t.name,e[t.category].get(t.name)]}))},dn=function(e){return JSON.stringify($.a.fromPairs(e.filter(function(e){var t=Object(d.a)(e,2),n=t[0];t[1];return!["lastSeenChangelogHeader"].includes(n)})),null,2)},pn=function(){if(sn()){var e={syncBackend:Object(ee.Map)(),org:{past:[],present:Object(ee.Map)(),future:[]},base:Object(ee.Map)(),capture:Object(ee.Map)()};cn.forEach(function(t){var n=localStorage.getItem(t.name);"nullable"===t.type?"null"===n&&(n=null):"boolean"===t.type?n="true"===n:"json"===t.type&&(n=n?Object(ee.fromJS)(JSON.parse(n)):t.default||new ee.Map),"org"===t.category?e[t.category].present=e[t.category].present.set(t.name,n):e[t.category]=e[t.category].set(t.name,n)}),e.capture.get("captureTemplates")&&(e.capture=e.capture.update("captureTemplates",function(e){return e.map(function(e){return e.set("id",ge())})}));var t=function(){var e=localStorage.getItem("headerOpenness");return e?JSON.parse(e):null}();return t&&(e.org.present=e.org.present.set("opennessState",Object(ee.fromJS)(t))),window.previousSettingsFileContents=dn(un(e,cn)),e}},hn=function(e,t){var n=t().syncBackend.get("client");if(n){var a=null;switch(n.type){case"Dropbox":a=n.getFileContents("/.org-web-config.json");break;case"Google Drive":a=n.getFileContentsByNameAndParent(".org-web-config.json","root")}a.then(function(t){try{var n=JSON.parse(t);e(Y(n)),e(rn(n))}catch(a){}}).catch(function(){})}},mn=function(e){return sn()?function(){var t=e.getState(),n=un(t,cn);if(n.forEach(function(e){var t=Object(d.a)(e,2),n=t[0],a=t[1];return localStorage.setItem(n,a)}),t.base.get("shouldStoreSettingsInSyncBackend")){var a=dn(n);window.previousSettingsFileContents!==a&&ln(t.syncBackend.get("client"),a),window.previousSettingsFileContents=a}var r=t.org.present.get("path");if(r&&t.org.present.get("headers")){var i=function e(t){for(var n=[],a=function(a){var i=t.get(a);if(!i.get("opened"))return r=a,"continue";var o=i.getIn(["titleLine","rawTitle"]),s=ye(t,i.get("id")),l=e(s);l.length>0?l.forEach(function(e){n.push([o].concat(e))}):n.push([o]),a+=s.size,r=a},r=0;r<t.size;++r)a(r);return n}(t.org.present.get("headers")),o={},s=localStorage.getItem("headerOpenness");s&&(o=JSON.parse(s)),o[r]=i,localStorage.setItem("headerOpenness",JSON.stringify(o))}}:function(){}},fn=function(e,t){sn()&&localStorage.setItem(e,t)},gn=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(sn()){var n=localStorage.getItem(e);return t&&"null"===n?null:n}return null},bn=function(e,t){return t.newSettings?function(e,t,n){return cn.filter(function(e){return e.category===n}).filter(function(e){return e.shouldStoreInConfig}).filter(function(e){return"lastSeenChangelogHeader"!==e.name}).forEach(function(n){e="json"===n.type?e.set(n.name,Object(ee.fromJS)(JSON.parse(t[n.name]))):e.set(n.name,t[n.name])}),e}(e,t.newSettings,"base"):e},vn=/(\[\[([^\]]*)\]\]|\[\[([^\]]*)\]\[([^\]]*)\]\])|(\[((\d*%)|(\d*\/\d*))\])|(([\s({'"]?)([*/~=_+])([^\s,'](.*)[^\s,'])\11([\s\-.,:!?'")}]?))|(([<[])(\d{4})-(\d{2})-(\d{2})(?: ([^0-9]{1,9}))?(?: ([012]?\d:[0-5]\d))?(?:-([012]?\d:[0-5]\d))?(?: ((?:\+)|(?:\+\+)|(?:\.\+)|(?:-)|(?:--))(\d+)(h|d|w|m|y))?(?: ((?:\+)|(?:\+\+)|(?:\.\+)|(?:-)|(?:--))(\d+)(h|d|w|m|y))?[>\]](?:--([<[])(\d{4})-(\d{2})-(\d{2})(?: ([^0-9]{1,9}))?(?: ([012]?\d:[0-5]\d))?(?:-([012]?\d:[0-5]\d))?(?: ((?:\+)|(?:\+\+)|(?:\.\+)|(?:-)|(?:--))(\d+)(h|d|w|m|y))?(?: ((?:\+)|(?:\+\+)|(?:\.\+)|(?:-)|(?:--))(\d+)(h|d|w|m|y))?[>\]])?)/g,yn=/([<[])(\d{4})-(\d{2})-(\d{2})(?: ([^0-9]{1,9}))?(?: ([012]?\d:[0-5]\d))?(?:-([012]?\d:[0-5]\d))?(?: ((?:\+)|(?:\+\+)|(?:\.\+)|(?:-)|(?:--))(\d+)(h|d|w|m|y))?(?: ((?:\+)|(?:\+\+)|(?:\.\+)|(?:-)|(?:--))(\d+)(h|d|w|m|y))?[>\]]/,En=function(e,t){var n=t.map(function(t){return e[t]}),a=Object(d.a)(n,13),r=a[0],i=a[1],o=a[2],s=a[3],l=a[4],c=a[5],u=a[6],p=a[7],h=a[8],m=a[9],f=a[10],g=a[11],b=a[12];if(!i)return null;var v,y,E,_,T,I,w=c?c.split(":"):[],k=Object(d.a)(w,2),S=k[0],D=k[1],C=u?u.split(":"):[],O=Object(d.a)(C,2),A=O[0],N=O[1];return["+","++",".+"].includes(p)?(v=p,y=h,E=m):["-","--"].includes(p)&&(_=p,T=h,I=m),["+","++",".+"].includes(f)?(v=f,y=g,E=b):["-","--"].includes(f)&&(_=f,T=g,I=b),{isActive:"<"===r,year:i,month:o,day:s,dayName:l,startHour:S,startMinute:D,endHour:A,endMinute:N,repeaterType:v,repeaterValue:y,repeaterUnit:E,delayType:_,delayValue:T,delayUnit:I}},_n=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.shouldAppendNewline,a=void 0!==n&&n,r=(t.excludeCookies,[]),i=vn.exec(e);i;){if(i[2])r.push({type:"link",rawText:i[0],uri:i[2],index:i.index});else if(i[3]&&i[4])r.push({type:"link",rawText:i[0],uri:i[3],title:i[4],index:i.index});else if(i[7]){var o=i[7].match(/(\d*)%/);r.push({type:"percentage-cookie",rawText:i[0],percentage:o[1],index:i.index})}else if(i[8]){var s=i[8].match(/(\d*)\/(\d*)/);r.push({type:"fraction-cookie",rawText:i[0],fraction:[s[1],s[2]],index:i.index})}else if(i[11]){var l={"~":"inline-code","*":"bold","/":"italic","+":"strikethrough",_:"underline","=":"verbatim"}[i[11]],c=i[10].length;r.push({type:"inline-markup",rawText:i[0].substring(c,i[12].length+2+c),index:i.index+c,content:i[12],markupType:l})}else if(i[15]){var u=En(i,$.a.range(16,29)),d=En(i,$.a.range(29,42));r.push({type:"timestamp",rawText:i[0],index:i.index,firstTimestamp:u,secondTimestamp:d})}i=vn.exec(e)}var p=[],h=0;if(r.forEach(function(t){var n=t.index;if(n!==h){var a=e.substring(h,n);p.push({type:"text",contents:a})}if("link"===t.type){var r={id:ge(),type:"link",contents:{uri:t.uri}};t.title&&(r.contents.title=t.title),p.push(r)}else"percentage-cookie"===t.type?p.push({id:ge(),type:"percentage-cookie",percentage:t.percentage}):"fraction-cookie"===t.type?p.push({id:ge(),type:"fraction-cookie",fraction:t.fraction}):"inline-markup"===t.type?p.push({id:ge(),type:"inline-markup",content:t.content,markupType:t.markupType}):"timestamp"===t.type&&p.push({id:ge(),type:"timestamp",firstTimestamp:t.firstTimestamp,secondTimestamp:t.secondTimestamp});h=t.index+t.rawText.length}),h!==e.length||a){var m=e.substring(h,e.length)+(a?"\n":"");p.push({type:"text",contents:m})}return p},Tn=function(e){var t={id:ge(),type:"table",contents:[[]],columnProperties:[]};e.map(function(e){return e.trim()}).forEach(function(e){if(e.startsWith("|-"))t.contents.push([]);else{var n=$.a.last(t.contents),a=e.substr(1,e.length-2).split("|");0===n.length?a.forEach(function(e){return n.push(e)}):a.forEach(function(e,t){n[t]+="\n".concat(e)})}}),t.contents=t.contents.map(function(e){return{id:ge(),contents:e.map(function(e){return{id:ge(),contents:_n(e,{excludeCookies:!0}),rawContents:e}})}}),0===$.a.last(t.contents).contents.length&&(t.contents=t.contents.slice(0,t.contents.length-1));var n=Math.max.apply(Math,Object(Q.a)(t.contents.map(function(e){return e.contents.length})));return t.contents.forEach(function(e){e.contents.length<n&&$.a.times(n-e.contents.length,function(){e.contents.push({id:ge(),contents:[],rawContents:""})})}),t},In=function e(t){for(var n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).excludeContentElements,a=void 0!==n&&n,r=t.split("\n"),i=/^\s*([-+*]|(\d+(\.|\)))) (.*)/,o=null,s=$.a.flatten(r.map(function(e,t){var n=e.match(/^( *)/)[0].length;return null!==o&&(n>o||!e.trim())?[{type:"raw-list-content",line:e}]:(o=null,e.match(i)&&!a?(o=n,[{type:"raw-list-header",line:e}]):e.trim().startsWith("|")&&!a?[{type:"raw-table",line:e}]:_n(e,{shouldAppendNewline:t!==r.length-1,excludeCookies:!0}))})),l=[],c=0;c<s.length;++c){var u=s[c];if("raw-table"===u.type){var d=$.a.takeWhile(s.slice(c),function(e){return"raw-table"===e.type}).map(function(e){return e.line});l.push(Tn(d)),c+=d.length-1}else"raw-list-header"===u.type?function(){var t=u.line.match(/^( *)/)[0].length,n=$.a.takeWhile(s.slice(c+1),function(e){return"raw-list-content"===e.type}).map(function(e){return e.line}).map(function(e){return e.startsWith(" ".repeat(t+2))?e.substr(t+2):e.substr(t+1)});""===n[n.length-1]&&(n[n.length-1]=" ");var a=e(n.join("\n")).toJS();c+=n.length;var r=!!u.line.match(/^\s*\d+[.)]/),o=u.line.match(i)[4],d=null;o.match(/^\s*\[@\d+\]/)&&(d=o.match(/^\s*\[@(\d+)\]/)[1],o=o.replace(/^\s*\[@\d+\]\s*/,""));var p=null,h=!!o.match(/^\s*\[[ X-]\]/);h&&(p={" ":"unchecked",X:"checked","-":"partial"}[o.match(/^\s*\[([ X-])\]/)[1]],o=o.replace(/^\s*\[[ X-]\]\s*/,""));var m={id:ge(),titleLine:_n(o),contents:a,forceNumber:d,isCheckbox:h,checkboxState:p},f=l.length-1;f>=0&&"list"===l[f].type?l[f].items.push(m):l.push({type:"list",id:ge(),items:[m],bulletCharacter:u.line.trim()[0],numberTerminatorCharacter:r?u.line.match(/\s*\d+([.)])/)[1]:null,isOrdered:r})}():l.push(u)}return Object(ee.fromJS)(l)},wn=function(e){var t=function(e){var t=Cn(/(DEADLINE|SCHEDULED|CLOSED):\s*/,yn),n=RegExp("("+t.toString().substring(1,t.toString().length-1)+")?"),a=Cn(/^\s*/,n,/\s*/,n,/\s*/,n,/\s*/),r=e.match(a),i=Object(ee.fromJS)([2,17,32].map(function(e){var t=r[e];return t?{type:t,timestamp:En(r,$.a.range(e+1,e+1+13)),id:ge()}:null}).filter(function(e){return!!e}));return i.size>0?{planningItems:i,strippedDescription:e.split("\n").filter(function(e){return!e.includes(r[0].trim())}).join("\n")}:{planningItems:Object(ee.fromJS)([]),strippedDescription:e}}(e),n=function(e){var t=e.split("\n"),n=t.findIndex(function(e){return":PROPERTIES:"===e.trim()}),a=t.findIndex(function(e){return":END:"===e.trim()});return-1!==n&&-1!==a&&e.trim().startsWith(":PROPERTIES:")?{propertyListItems:Object(ee.fromJS)(t.slice(n+1,a).map(function(e){var t=e.match(/:([^\s]*):(?: (.*))?/);if(!t)return null;var n=t[2]?_n(t[2]):null;return{property:t[1],value:n,id:ge()}}).filter(function(e){return!!e})),strippedDescription:t.slice(a+1).join("\n")}:{propertyListItems:Object(ee.List)(),strippedDescription:e}}(t.strippedDescription);return{planningItems:t.planningItems,propertyListItems:n.propertyListItems,strippedDescription:n.strippedDescription}},kn=Object(ee.fromJS)([{keywords:["TODO","DONE"],completedKeywords:["DONE"],default:!0}]),Sn=function(e,t){var n=t.flatMap(function(e){return e.get("keywords")}).filter(function(t){return e.startsWith(t+" ")}).first(),a=e;n&&(a=a.substr(n.length+1));var r=[];if(a.trimRight().endsWith(":")){var i=a.trimRight().split(" "),o=i[i.length-1];/^:[^\s]+:$/.test(o)&&(a=a.substr(0,a.length-o.length),r=o.split(":").filter(function(e){return""!==e}))}var s=_n(a);return Object(ee.fromJS)({title:s,rawTitle:a,todoKeyword:n,tags:r})},Dn=function(e,t,n){0===n.size&&(n=kn);var a=Sn(e,n);return Object(ee.fromJS)({titleLine:a,rawDescription:"",description:[],opened:!1,id:ge(),nestingLevel:t,planningItems:[],propertyListItems:[]})},Cn=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(function(e,t){return RegExp(e.toString().substring(1,e.toString().length-1)+t.toString().substring(1,t.toString().length-1))})},On=function(e){var t=new ee.List,n=e.split("\n"),a=new ee.List,r=new ee.List,i=new ee.List;return n.forEach(function(e){if(e.startsWith("*")){var n=e.indexOf(" ");-1===n&&(n=e.length);var o=e.substr(n+1);t=t.push(Dn(o,n,a))}else if(0===t.size)if(e.startsWith("#+TODO: ")||e.startsWith("#+TYP_TODO: ")){var s=e.substr(e.indexOf(":")+2).split(/\s/),l=s.filter(function(e){return"|"!==e}),c=s.indexOf("|"),u=c>=0?l.slice(c):[];a=a.push(Object(ee.fromJS)({keywords:l,completedKeywords:u,configLine:e,default:!1}))}else e.startsWith("#+")?r=r.push(e):i=i.push(e);else t=t.updateIn([t.size-1,"rawDescription"],function(t){return 0===t.length?e:t+"\n"+e})}),0===a.size&&(a=kn),t=t.map(function(e){var t=wn(e.get("rawDescription")),n=t.planningItems,a=t.propertyListItems,r=t.strippedDescription;return e.set("rawDescription",r).set("description",In(r)).set("planningItems",n).set("propertyListItems",a)}),Object(ee.fromJS)({headers:t,todoKeywordSets:a,fileConfigLines:r,linesBeforeHeadings:i})},An=function(e,t){var n=t.filter(function(e){return e}).length,a=t.length;return e.map(function(e){switch(e.get("type")){case"fraction-cookie":return e.set("fraction",Object(ee.List)([n,a]));case"percentage-cookie":return e.set("percentage",Math.floor(n/a*100));default:return e}})},Nn=function(e,t){for(var n=e.get("headers"),a=be(n,t),r=ye(n,t),i=[],o=0;o<r.size;++o){var s=r.get(o);i.push(s),o+=ye(n,s.get("id")).size}var l=i.map(function(e){return e.getIn(["titleLine","todoKeyword"])}).filter(function(e){return!!e}).map(function(t){return Re(e.get("todoKeywordSets"),t).get("completedKeywords").contains(t)});return 0===l.length&&(l=n.get(a).get("description").filter(function(e){return"list"===e.get("type")}).flatMap(function(e){return e.get("items")}).filter(function(e){return e.get("isCheckbox")}).map(function(e){return"checked"===e.get("checkboxState")}).toJS()),e.updateIn(["headers",a,"titleLine","title"],function(e){return An(e,l)}).updateIn(["headers",a,"titleLine"],function(e){return e.set("rawTitle",me(e.get("title")))})},Ln=function(e,t){var n=_e(e.get("headers"),t);return n?Nn(e,n):e},Mn=function(e,t){var n=t.headerId||e.get("selectedHeaderId");if(!n)return e;var a=e.get("headers"),r=ve(a,n),i=be(a,n),o=r.getIn(["titleLine","todoKeyword"]),s=Re(e.get("todoKeywordSets"),o),l=s.get("keywords").indexOf(o)+1,c=s.get("keywords").get(l)||"",u=r.get("planningItems").map(function(e,t){return[e,t]}).filter(function(e){var t=Object(d.a)(e,2),n=t[0];t[1];return!!n.getIn(["timestamp","repeaterType"])});if(s.get("completedKeywords").includes(c)&&u.size>0){u.forEach(function(t){var n=Object(d.a)(t,2),a=n[0],r=n[1];e=e.setIn(["headers",i,"planningItems",r,"timestamp"],function(e,t){if(!e.get("repeaterType"))return e;var n=null;switch(e.get("repeaterType")){case"+":n=pe(de(e),e.get("repeaterValue"),e.get("repeaterUnit"));break;case"++":for(n=pe(de(e),e.get("repeaterValue"),e.get("repeaterUnit"));Object(se.isBefore)(n,t);)n=pe(n,e.get("repeaterValue"),e.get("repeaterUnit"));break;case".+":n=pe(new Date,e.get("repeaterValue"),e.get("repeaterUnit"));break;default:return console.error("Unrecognized timestamp repeater type: ".concat(e.get("repeaterType"))),e}return void 0!==(e=e.set("day",ne()(n,"DD")).set("dayName",ne()(n,"ddd")).set("month",ne()(n,"MM")).set("year",ne()(n,"YYYY"))).get("startHour")&&null!==e.get("startHour")&&(e=e.set("startHour",ne()(n,"HH")).set("startMinute",ne()(n,"mm"))),e}(a.get("timestamp"),new Date))}),e=e.setIn(["headers",i,"titleLine","todoKeyword"],s.get("keywords").first());var p=ce({isActive:!1,withStartTime:!0}),h=[{type:"timestamp",id:ge(),firstTimestamp:p,secondTimestamp:null}];e=(e=e.updateIn(["headers",i,"propertyListItems"],function(e){return e.some(function(e){return"LAST_REPEAT"===e.get("property")})?e.map(function(e){return"LAST_REPEAT"===e.get("property")?e.set("value",Object(ee.fromJS)(h)):e}):e.push(Object(ee.fromJS)({property:"LAST_REPEAT",value:h,id:ge()}))})).updateIn(["headers",i],function(e){var t=e.get("rawDescription");return t.startsWith("\n")&&(t=t.slice(1)),t='\n- State "'.concat(c,'"       from "').concat(o,'"       ').concat(le(Object(ee.fromJS)(p)),"\n")+t,e.set("rawDescription",t).set("description",In(t))})}else e=e.setIn(["headers",i,"titleLine","todoKeyword"],c);return e=Ln(e,n)},Pn=function(e,t){var n=e.get("headers");if(void 0===e.get("selectedHeaderId"))return e.set("selectedHeaderId",n.getIn([0,"id"]));var a=function(e,t){return e.slice(t+1).find(function(t){return Te(e,t.get("id"))})}(n,be(n,e.get("selectedHeaderId")));return a?e.set("selectedHeaderId",a.get("id")):e},Rn=function(e,t){var n=e.get("headers"),a=function(e,t){return e.slice(0,t).reverse().find(function(t){return Te(e,t.get("id"))})}(n,be(n,e.get("selectedHeaderId")));return a?e.set("selectedHeaderId",a.get("id")):e},Hn=function(e,t){var n=e.get("opennessState");if(!n)return e;var a=n.get(e.get("path"));if(!a||0===a.size)return e;var r=e.get("headers");return a.forEach(function(e){r=function e(t,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(0===n.size)return t;var r=n.first(),i=t.findIndex(function(e){var t=e.getIn(["titleLine","rawTitle"]),n=e.get("nestingLevel");return t===r&&n<=a});if(-1===i)return t;t=t.update(i,function(e){return e.set("opened",!0)});var o=ye(t,t.getIn([i,"id"]));return o=e(o,n.rest(),a+1),t=t.take(i+1).concat(o).concat(t.takeLast(t.size-(i+1+o.size)))}(r,e)}),e.set("headers",r)},jn=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=e.get("headers");n||(n=Se(a,t));var r=be(a,n.get("id"));return e.updateIn(["headers",r],function(e){return e.set("rawDescription",me(e.get("description")))})},xn=function(e,t){var n=e.get("selectedTableCellId");return n?(e=e.update("headers",function(e){return Ne(e,n,function(e){return function(t){return t.insert(e+1,function(e){return e.get(0).set("id",ge()).update("contents",function(e){return e.map(function(e){return e.set("id",ge()).set("contents",new ee.List).set("rawContents","")})})}(t))}})}),jn(e,n)):e},Fn=function(e,t){var n=e.get("selectedTableCellId");return n?(e=e.update("headers",function(e){return Ne(e,n,function(e,t){return function(e){return e.map(function(e){return e.update("contents",function(e){return e.insert(t+1,Object(ee.fromJS)({id:ge(),contents:[],rawContents:""}))})})}})}),jn(e,n)):e},Un=function(e,t){var n=e.get("headers"),a=t.template,r=t.content,i=t.shouldPrepend,o=0===a.get("headerPaths").filter(function(e){return 0!==e.length}).size,s=o?null:we(n,a.get("headerPaths"));if(!s&&!o)return e;var l=function(e,t){var n=e.split("\n")[0].replace(/^\**\s*/,""),a=e.split("\n").slice(1).join("\n"),r=wn(a),i=r.planningItems,o=r.propertyListItems,s=r.strippedDescription;return Dn(n,1,t).set("rawDescription",s).set("description",In(s)).set("planningItems",i).set("propertyListItems",o)}(r,e.get("todoKeywordSets")).set("nestingLevel",o?1:s.get("nestingLevel")+1);if(o)return e.update("headers",function(e){return e.push(l)});var c=be(n,s.get("id")),u=Ee(n,s.get("id")),d=c+1+(i?0:u);return e=e.update("headers",function(e){return e.insert(d,l)}),e=Nn(e,s.get("id"))},Vn=function(e,t){var n=Oe(e.get("headers"),t.listItemId),a=n.path,r=n.listItemPart;if(r.get("contents").filter(function(e){return"list"===e.get("type")}).some(function(e){return e.get("items").some(function(e){return e.get("isCheckbox")})}))return e;var i={checked:"unchecked",unchecked:"checked",partial:"unchecked"}[r.get("checkboxState")];e=function e(t,n){var a=n.slice(0,n.length-4),r=t.getIn(a);if(!r.has("checkboxState"))return t;var i=r.get("contents").filter(function(e){return"list"===e.get("type")}).flatMap(function(e){return e.get("items").filter(function(e){return e.get("isCheckbox")}).map(function(e){return e.get("checkboxState")})});t=i.every(function(e){return"checked"===e})?t.setIn(a.concat(["checkboxState"]),"checked"):i.every(function(e){return"unchecked"===e})?t.setIn(a.concat(["checkboxState"]),"unchecked"):t.setIn(a.concat(["checkboxState"]),"partial");var o=i.map(function(e){switch(e){case"checked":return!0;case"unchecked":case"partial":default:return!1}}).toJS();return t=t.updateIn(a.concat("titleLine"),function(e){return An(e,o)}),r.get("isCheckbox")?e(t,a):t}(e=e.setIn(["headers"].concat(a).concat(["checkboxState"]),i),["headers"].concat(a));var o=a[0];return e=(e=Nn(e,e.getIn(["headers",o,"id"]))).updateIn(["headers",o],function(e){return e.set("rawDescription",me(e.get("description")))})},Bn=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=-1,r=e.get("headers");n?a=be(r,n.get("id")):a=Oe(r,t).path[0];return a>=0?e.updateIn(["headers",a],function(e){return e.set("rawDescription",me(e.get("description")))}):e},Wn=function(e,t){var n=e.get("selectedListItemId");if(!n)return e;var a=Oe(e.get("headers"),n),r=Object(ee.fromJS)({id:ge(),titleLine:[],contents:[],forceNumber:null,isCheckbox:!1});return a.listItemPart.get("isCheckbox")&&(r=r.set("isCheckbox",!0).set("checkboxState","unchecked")),e=e.update("headers",function(e){return Le(e,n,function(e){return function(t){return t.insert(e+1,r)}})}),Bn(e,n)},Gn=function(e,t){var n=e.get("selectedListItemId");if(!n)return e;var a=function(e,t){var n=Oe(e,t).path[0];return e.get(n)}(e.get("headers"),n);return e=(e=e.update("headers",function(e){return Le(e,n,function(e){return function(t){return t.delete(e)}})})).set("selectedListItemId",null),Bn(e,n,a)},Yn=function(e){var t=e.get("selectedListItemId");if(!t)return e;var n=Oe(e.get("headers"),t),a=n.path,r=n.listItemPart,i=a[a.length-1];if(a.filter(function(e){return"items"===e}).length<2)return e;var o=function(e,t){var n=Oe(e,t).path;return e.getIn(n.slice(0,n.length-4))}(e.getIn(["headers"]),t);return o.get("contents").filter(function(e){return"list"===e.get("type")}).map(function(e){return e.get("items").forEach(function(t,n){n>i&&(r=r.update("contents",function(n){return Me(n,t,e)}))})}),e=(e=e.update("headers",function(e){return Le(e,t,function(e){return function(e){return e.filter(function(e,t){return t<i})}})})).update("headers",function(e){return Le(e,o.get("id"),function(e){return function(t){return t.insert(e+1,r)}})}),Bn(e,t)},Kn=function(e,t){var n,a,r=(n=e.get("headers"),a=t.timestampId,n.map(function(e,t){var n=De(e.getIn(["titleLine","title"]),a);if(n){var r=n,i=r.path,o=r.timestampPart;return{path:[t,"titleLine","title"].concat(i),timestampPart:o}}if(n=De(e.get("description"),a)){var s=n,l=s.path,c=s.timestampPart;return{path:[t,"description"].concat(l),timestampPart:c}}return(n=e.get("propertyListItems").map(function(e,n){if(!e.get("value"))return null;var r=De(e.get("value"),a);if(r){var i=r.path,o=r.timestampPart;return{path:[t,"propertyListItems",n,"value"].concat(i),timestampPart:o}}return null}).filter(function(e){return!!e}).first())||null}).filter(function(e){return!!e}).first());if(!r)return e;var i=r.path,o=i[0];return e.setIn(["headers"].concat(i),t.newTimestamp).updateIn(["headers",o],function(e){return e.set("rawDescription",me(e.get("description")))}).updateIn(["headers",o],function(e){return e.setIn(["titleLine","rawTitle"],me(e.getIn(["titleLine","title"])))})},zn=function(e,t){return e.findIndex(function(e){return e.get("id")===t})},Jn=function(e,t){return t.newSettings?function(e,t){var n=Object(ee.fromJS)(JSON.parse(t.captureTemplates)).map(function(e){return e.set("id",ge())});return e.set("captureTemplates",n)}(e,t.newSettings):e},Xn=Object(y.c)({base:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ee.Map,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_LOADING_MESSAGE":return function(e,t){return e.set("loadingMessage",t.loadingMessage)}(e,t);case"HIDE_LOADING_MESSAGE":return function(e,t){return e.set("loadingMessage",null)}(e);case"SET_FONT_SIZE":return function(e,t){return e.set("fontSize",t.newFontSize)}(e,t);case"SET_BULLET_STYLE":return function(e,t){return e.set("bulletStyle",t.newBulletStyle)}(e,t);case"SET_SHOULD_TAP_TODO_TO_ADVANCE":return function(e,t){return e.set("shouldTapTodoToAdvance",t.newShouldTapTodoToAdvance)}(e,t);case"SET_AGENDA_DEFAULT_DEADLINE_DELAY_UNIT":return function(e,t){return e.set("agendaDefaultDeadlineDelayUnit",t.newAgendaDefaultDeadlineDelayUnit)}(e,t);case"SET_AGENDA_DEFAULT_DEADLINE_DELAY_VALUE":return function(e,t){return e.set("agendaDefaultDeadlineDelayValue",t.newAgendaDefaultDeadlineDelayValue)}(e,t);case"SET_SHOULD_STORE_SETTINGS_IN_SYNC_BACKEND":return function(e,t){return e.set("shouldStoreSettingsInSyncBackend",t.newShouldStoreSettingsInSyncBackend)}(e,t);case"SET_SHOULD_LIVE_SYNC":return function(e,t){return e.set("shouldLiveSync",t.shouldLiveSync)}(e,t);case"SET_SHOULD_SYNC_ON_BECOMING_VISIBLE":return function(e,t){return e.set("shouldSyncOnBecomingVisibile",t.shouldSyncOnBecomingVisibile)}(e,t);case"SET_HAS_UNSEEN_CHANGELOG":return function(e,t){return e.set("hasUnseenChangelog",t.newHasUnseenChangelog)}(e,t);case"SET_LAST_SEEN_CHANGELOG_HEADER":return function(e,t){return e.set("lastSeenChangelogHeader",t.newLastSeenChangelogHeader)}(e,t);case"SET_LAST_VIEWED_FILE":return function(e,t){return e.set("lastViewedPath",t.lastViewedPath).set("lastViewedContents",t.lastViewedContents)}(e,t);case"SET_CUSTOM_KEYBINDING":return function(e,t){return e.get("customKeybindings")||(e=e.set("customKeybindings",new ee.Map)),e.setIn(["customKeybindings",t.keybindingName],t.keybinding)}(e,t);case"RESTORE_BASE_SETTINGS":return bn(e,t);case"PUSH_MODAL_PAGE":return function(e,t){return e.update("modalPageStack",function(e){return e?e.push(t.modalPage):Object(ee.List)([t.modalPage])})}(e,t);case"POP_MODAL_PAGE":return function(e){return e.update("modalPageStack",function(e){return e?e.pop():e})}(e);case"CLEAR_MODAL_STACK":return function(e){return e.set("modalPageStack",Object(ee.List)())}(e);case"ACTIVATE_POPUP":return function(e,t){return e.set("activePopup",Object(ee.fromJS)({type:t.popupType,data:t.data}))}(e,t);case"CLOSE_POPUP":return function(e){return e.set("activePopup",null)}(e);case"SET_IS_LOADING":return function(e,t){return e.set("isLoading",t.isLoading)}(e,t);default:return e}},syncBackend:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ee.Map,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SIGN_OUT":return function(e,t){return e.set("isAuthenticated",!1).set("client",null)}(e);case"SET_CURRENT_FILE_BROWSER_DIRECTORY_LISTING":return function(e,t){return e.set("currentFileBrowserDirectoryListing",Object(ee.Map)({listing:t.directoryListing,hasMore:t.hasMore,additionalSyncBackendState:t.additionalSyncBackendState}))}(e,t);case"SET_IS_LOADING_MORE_DIRECTORY_LISTING":return function(e,t){return e.update("currentFileBrowserDirectoryListing",function(e){return e||Object(ee.Map)()}).setIn(["currentFileBrowserDirectoryListing","isLoadingMore"],t.isLoadingMore)}(e,t);default:return e}},org:S()(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ee.Map,t=arguments.length>1?arguments[1]:void 0;switch(t.dirtying&&(e=e.set("isDirty",!0)),t.type){case"DISPLAY_FILE":return function(e,t){var n=On(t.contents);return e.set("path",t.path).set("contents",t.contents).set("headers",n.get("headers")).set("todoKeywordSets",n.get("todoKeywordSets")).set("fileConfigLines",n.get("fileConfigLines")).set("linesBeforeHeadings",n.get("linesBeforeHeadings"))}(e,t);case"STOP_DISPLAYING_FILE":return function(e){return e.set("path",null).set("contents",null).set("headers",null).set("todoKeywordSets",null).set("fileConfigLines",null).set("linesBeforeHeadings",null)}(e);case"TOGGLE_HEADER_OPENED":return function(e,t){var n=e.get("headers"),a=be(n,t.headerId),r=ve(n,t.headerId).get("opened");return r&&e.get("focusedHeaderId")===t.headerId?e:(r&&ye(n,t.headerId).forEach(function(t,n){e=e.setIn(["headers",a+n+1,"opened"],!1)}),e.setIn(["headers",a,"opened"],!r))}(e,t);case"OPEN_HEADER":return function(e,t){var n=e.get("headers"),a=be(n,t.headerId);return e.setIn(["headers",a,"opened"],!0)}(e,t);case"SELECT_HEADER":return function(e,t){return e.set("selectedHeaderId",t.headerId)}(e,t);case"OPEN_PARENTS_OF_HEADER":return function(e,t){for(var n=e.get("headers"),a=t.headerId,r=_e(n,a);r;){var i=be(n,r);n=n.setIn([i,"opened"],!0),r=_e(n,r)}return e.set("headers",n)}(e,t);case"ADVANCE_TODO_STATE":return Mn(e,t);case"ENTER_EDIT_MODE":return function(e,t){return e.set("editMode",t.editModeType)}(e,t);case"EXIT_EDIT_MODE":return function(e,t){return e.set("editMode",null)}(e);case"UPDATE_HEADER_TITLE":return function(e,t){var n=e.get("headers"),a=be(n,t.headerId),r=Sn(t.newRawTitle,e.get("todoKeywordSets"));return e=e.setIn(["headers",a,"titleLine"],r),Ln(e,t.headerId)}(e,t);case"UPDATE_HEADER_DESCRIPTION":return function(e,t){var n=e.get("headers"),a=be(n,t.headerId);return e.updateIn(["headers",a],function(e){var n=wn(t.newRawDescription),a=n.planningItems,r=n.propertyListItems,i=n.strippedDescription;return e.set("rawDescription",i).set("description",In(i)).set("planningItems",a).set("propertyListItems",r)})}(e,t);case"ADD_HEADER":return function(e,t){var n=e.get("headers"),a=ve(n,t.headerId),r=be(n,t.headerId),i=ye(n,t.headerId),o=Dn("",a.get("nestingLevel"),e.get("todoKeywordSets"));return t.headerId===e.get("focusedHeaderId")&&(e=e.set("focusedHeaderId",null)),e.update("headers",function(e){return e.insert(r+i.size+1,o)})}(e,t);case"SELECT_NEXT_SIBLING_HEADER":return function(e,t){var n=e.get("headers"),a=ve(n,t.headerId),r=be(n,t.headerId),i=ye(n,t.headerId),o=n.get(r+i.size+1);return o&&o.get("nestingLevel")===a.get("nestingLevel")?e.set("selectedHeaderId",o.get("id")):e}(e,t);case"SELECT_NEXT_VISIBLE_HEADER":return Pn(e);case"SELECT_PREVIOUS_VISIBLE_HEADER":return Rn(e);case"REMOVE_HEADER":return function(e,t){var n=e.get("headers"),a=be(n,t.headerId),r=1+ye(n,t.headerId).size,i=_e(n,t.headerId);return $.a.times(r).forEach(function(){n=n.delete(a)}),t.headerId===e.get("focusedHeaderId")&&(e=e.set("focusedHeaderId",null)),e=e.set("headers",n),i&&(e=Nn(e,i)),e}(e,t);case"MOVE_HEADER_UP":return function(e,t){var n=e.get("headers"),a=be(n,t.headerId),r=function(e,t){for(var n=e.getIn([t,"nestingLevel"]),a=t-1;a>=0;--a){var r=e.get(a);if(r.get("nestingLevel")<n)return null;if(r.get("nestingLevel")===n)return a}return null}(n,a);if(null===r)return e;var i=ye(n,t.headerId);return $.a.times(1+i.size).forEach(function(){n=(n=n.insert(r,n.get(a+i.size))).delete(a+i.size+1)}),e.set("headers",n)}(e,t);case"MOVE_HEADER_DOWN":return function(e,t){var n=e.get("headers"),a=ve(n,t.headerId),r=be(n,t.headerId),i=ye(n,t.headerId),o=r+i.size+1,s=n.get(o);if(s.get("nestingLevel")<a.get("nestingLevel"))return e;var l=ye(n,s.get("id"));return $.a.times(1+l.size).forEach(function(){n=(n=n.insert(r,n.get(o+l.size))).delete(o+l.size+1)}),e.set("headers",n)}(e,t);case"MOVE_HEADER_LEFT":return function(e,t){var n=e.get("headers"),a=be(n,t.headerId),r=_e(n,t.headerId);return e=e.updateIn(["headers",a,"nestingLevel"],function(e){return Math.max(e-1,1)}),e=Nn(e,r),e=Ln(e,t.headerId)}(e,t);case"MOVE_HEADER_RIGHT":return function(e,t){var n=e.get("headers"),a=be(n,t.headerId),r=_e(n,t.headerId);return e=e.updateIn(["headers",a,"nestingLevel"],function(e){return e+1}),e=Ie(e,t.headerId),e=Nn(e,r),e=Ln(e,t.headerId)}(e,t);case"MOVE_SUBTREE_LEFT":return function(e,t){var n=e.get("headers"),a=ve(n,t.headerId),r=be(n,t.headerId),i=_e(n,t.headerId);if(1===a.get("nestingLevel"))return e;var o=ye(n,t.headerId);return e=e.updateIn(["headers",r,"nestingLevel"],function(e){return e-1}),o.forEach(function(t,n){e=e.updateIn(["headers",r+n+1,"nestingLevel"],function(e){return e-1})}),e=Nn(e,i),e=Ln(e,t.headerId)}(e,t);case"MOVE_SUBTREE_RIGHT":return function(e,t){var n=e.get("headers"),a=be(n,t.headerId),r=_e(n,t.headerId),i=ye(n,t.headerId);return e=e.updateIn(["headers",a,"nestingLevel"],function(e){return e+1}),i.forEach(function(t,n){e=e.updateIn(["headers",a+n+1,"nestingLevel"],function(e){return e+1})}),e=Nn(e,r),e=Ln(e,t.headerId),Ie(e,t.headerId)}(e,t);case"NO_OP":return function(e){return e.update("noOpCounter",function(e){return(e||0)+1})}(e);case"APPLY_OPENNESS_STATE":return Hn(e);case"SET_DIRTY":return function(e,t){return e.set("isDirty",t.isDirty)}(e,t);case"FOCUS_HEADER":return function(e,t){return e.set("focusedHeaderId",t.headerId)}(e,t);case"UNFOCUS_HEADER":return function(e){return e.set("focusedHeaderId",null)}(e);case"SET_SELECTED_TABLE_CELL_ID":return function(e,t){return e.set("selectedTableCellId",t.cellId)}(e,t);case"ADD_NEW_TABLE_ROW":return xn(e);case"REMOVE_TABLE_ROW":return function(e,t){var n=e.get("selectedTableCellId");if(!n)return e;var a=Se(e.get("headers"),n);return e=(e=e.update("headers",function(e){return Ne(e,n,function(e){return function(t){return t.delete(e)}})})).set("selectedTableCellId",null),jn(e,n,a)}(e);case"ADD_NEW_TABLE_COLUMN":return Fn(e);case"REMOVE_TABLE_COLUMN":return function(e,t){var n=e.get("selectedTableCellId");if(!n)return e;var a=Se(e.get("headers"),n);return e=(e=e.update("headers",function(e){return Ne(e,n,function(e,t){return function(e){return e.map(function(e){return e.update("contents",function(e){return e.delete(t)})})}})})).set("selectedTableCellId",null),jn(e,n,a)}(e);case"MOVE_TABLE_ROW_DOWN":return function(e){var t=e.get("selectedTableCellId");return t?(e=e.update("headers",function(e){return Ne(e,t,function(e){return function(t){return e+1===t.size?t:t.insert(e,t.get(e+1)).delete(e+2)}})}),jn(e,t)):e}(e);case"MOVE_TABLE_ROW_UP":return function(e,t){var n=e.get("selectedTableCellId");return n?(e=e.update("headers",function(e){return Ne(e,n,function(e){return function(t){return 0===e?t:t.insert(e-1,t.get(e)).delete(e+1)}})}),jn(e,n)):e}(e);case"MOVE_TABLE_COLUMN_LEFT":return function(e,t){var n=e.get("selectedTableCellId");return n?(e=e.update("headers",function(e){return Ne(e,n,function(e,t){return function(e){return 0===t?e:e.map(function(e){return e.update("contents",function(e){return 0===e.size?e:e.insert(t-1,e.get(t)).delete(t+1)})})}})}),jn(e,n)):e}(e);case"MOVE_TABLE_COLUMN_RIGHT":return function(e,t){var n=e.get("selectedTableCellId");return n?(e=e.update("headers",function(e){return Ne(e,n,function(e,t){return function(e){return t+1>=e.getIn([0,"contents"]).size?e:e.map(function(e){return e.update("contents",function(e){return 0===e.size?e:e.insert(t,e.get(t+1)).delete(t+2)})})}})}),jn(e,n)):e}(e);case"UPDATE_TABLE_CELL_VALUE":return function(e,t){return e=e.update("headers",function(e){return Ne(e,t.cellId,function(e,n){return function(a){return a.updateIn([e,"contents",n],function(e){return e.set("rawContents",t.newValue).set("contents",Object(ee.fromJS)(_n(t.newValue,{excludeCookies:!0})))})}})}),jn(e,t.cellId)}(e,t);case"INSERT_CAPTURE":return Un(e,t);case"CLEAR_PENDING_CAPTURE":return function(e){return e.set("pendingCapture",null)}(e);case"ADVANCE_CHECKBOX_STATE":return Vn(e,t);case"SET_SELECTED_LIST_ITEM_ID":return function(e,t){return e.set("selectedListItemId",t.listItemId)}(e,t);case"UPDATE_LIST_TITLE_VALUE":return function(e,t){var n=t.listItemId;return n?(e=e.update("headers",function(e){return Le(e,n,function(e){return function(n){return n.updateIn([e],function(e){return e.set("titleLine",Object(ee.fromJS)(_n(t.newValue)))})}})}),Bn(e,n)):e}(e,t);case"UPDATE_LIST_CONTENTS_VALUE":return function(e,t){var n=t.listItemId;return n?(e=e.update("headers",function(e){return Le(e,n,function(e){return function(n){return n.updateIn([e],function(e){return e.set("contents",Object(ee.fromJS)(In(t.newValue)))})}})}),Bn(e,n)):e}(e,t);case"ADD_NEW_LIST_ITEM":return Wn(e);case"SELECT_NEXT_SIBLING_LIST_ITEM":return function(e,t){var n=e.get("selectedListItemId");if(!n)return e;var a=Oe(e.get("headers"),n).path;return a[a.length-1]=a[a.length-1]+1,e=e.set("selectedListItemId",e.getIn(["headers"].concat(a).concat("id")))}(e);case"REMOVE_LIST_ITEM":return Gn(e);case"MOVE_LIST_ITEM_UP":return function(e){var t=e.get("selectedListItemId");return t?(e=e.update("headers",function(e){return Le(e,t,function(e){return function(t){return 0===e?t:t.insert(e-1,t.get(e)).delete(e+1)}})}),Bn(e,t)):e}(e);case"MOVE_LIST_ITEM_DOWN":return function(e){var t=e.get("selectedListItemId");return t?(e=e.update("headers",function(e){return Le(e,t,function(e){return function(t){return e+1===t.size?t:t.insert(e,t.get(e+1)).delete(e+2)}})}),Bn(e,t)):e}(e);case"MOVE_LIST_ITEM_LEFT":return function(e){var t=e.get("selectedListItemId");return t?Oe(e.get("headers"),t).listItemPart.get("contents").filter(function(e){return"list"===e.get("type")}).some(function(e){return e.get("items").size>0})?e:Yn(e):e}(e);case"MOVE_LIST_ITEM_RIGHT":return function(e){var t=e.get("selectedListItemId");if(!t)return e;var n=Oe(e.get("headers"),t),a=n.path,r=n.listItemPart,i=e.getIn(["headers"].concat(a.slice(0,a.length-2))),o=a[a.length-1]-1;if(o<0)return e;e=e.update("headers",function(e){return Le(e,t,function(e){return function(t){return t.delete(e)}})});var s=["headers"].concat(a.slice(0,a.length-1)).concat(o).concat("contents"),l=r.get("contents").filter(function(e){return"list"===e.get("type")});return r=r.update("contents",function(e){return e.filter(function(e){return"list"!==e.get("type")})}),e=e.updateIn(s,function(e){return Me(e,r,i)}),l.map(function(t){return t.get("items").forEach(function(n,a){e=e.updateIn(s,function(e){return Me(e,n,t)})})}),Bn(e,t)}(e);case"MOVE_LIST_SUBTREE_LEFT":return Yn(e,t);case"MOVE_LIST_SUBTREE_RIGHT":return function(e){var t=e.get("selectedListItemId");if(!t)return e;var n=Oe(e.get("headers"),t),a=n.path,r=n.listItemPart,i=e.getIn(["headers"].concat(a.slice(0,a.length-2))),o=a[a.length-1]-1;return o<0?e:(e=(e=e.update("headers",function(e){return Le(e,t,function(e){return function(t){return 0===e?t:t.delete(e)}})})).updateIn(["headers"].concat(a.slice(0,a.length-1)).concat(o).concat("contents"),function(e){return Me(e,r,i)}),Bn(e,t))}(e);case"SET_LAST_SYNC_AT":return function(e,t){return e.set("lastSyncAt",t.lastSyncAt)}(e,t);case"SET_HEADER_TAGS":return function(e,t){var n=e.get("headers"),a=be(n,t.headerId);return-1===a?e:e.setIn(["headers",a,"titleLine","tags"],t.tags)}(e,t);case"REORDER_TAGS":return function(e,t){var n=e.get("selectedHeaderId");if(!n)return e;var a=be(e.get("headers"),n);return e.updateIn(["headers",a,"titleLine","tags"],function(e){return e.splice(t.fromIndex,1).splice(t.toIndex,0,e.get(t.fromIndex))})}(e,t);case"REORDER_PROPERTY_LIST":return function(e,t){var n=t.headerId;if(!n)return e;var a=be(e.get("headers"),n);return e.updateIn(["headers",a,"propertyListItems"],function(e){return e.splice(t.fromIndex,1).splice(t.toIndex,0,e.get(t.fromIndex))})}(e,t);case"UPDATE_TIMESTAMP_WITH_ID":return Kn(e,t);case"UPDATE_PLANNING_ITEM_TIMESTAMP":return function(e,t){var n=t.headerId,a=t.planningItemIndex,r=t.newTimestamp,i=be(e.get("headers"),n);return e.setIn(["headers",i,"planningItems",a,"timestamp"],r)}(e,t);case"ADD_NEW_PLANNING_ITEM":return function(e,t){var n=be(e.get("headers"),t.headerId),a=Object(ee.fromJS)({id:ge(),type:t.planningType,timestamp:ce()});return e.updateIn(["headers",n,"planningItems"],function(e){return e?e.push(a):Object(ee.List)([a])})}(e,t);case"UPDATE_PROPERTY_LIST_ITEMS":return function(e,t){var n=be(e.get("headers"),t.headerId);return e.setIn(["headers",n,"propertyListItems"],t.newPropertyListItems)}(e,t);case"SET_ORG_FILE_ERROR_MESSAGE":return function(e,t){return e.set("orgFileErrorMessage",t.message)}(e,t);default:return e}},{filter:Object(k.includeAction)(["ADD_HEADER","REMOVE_HEADER","MOVE_HEADER_UP","MOVE_HEADER_DOWN","MOVE_HEADER_LEFT","MOVE_HEADER_RIGHT","MOVE_SUBTREE_LEFT","MOVE_SUBTREE_RIGHT","ADVANCE_TODO_STATE","EDIT_HEADER_TITLE","EDIT_HEADER_DESCRIPTION","NO_OP","ADD_NEW_TABLE_ROW","ADD_NEW_TABLE_COLUMN","MOVE_TABLE_ROW_DOWN","MOVE_TABLE_ROW_UP","MOVE_TABLE_COLUMN_LEFT","MOVE_TABLE_COLUMN_RIGHT","ADD_NEW_LIST_ITEM","REMOVE_LIST_ITEM","MOVE_LIST_ITEM_UP","MOVE_LIST_ITEM_DOWN","MOVE_LIST_ITEM_LEFT","MOVE_LIST_ITEM_RIGHT","MOVE_LIST_SUBTREE_LEFT","MOVE_LIST_SUBTREE_RIGHT","INSERT_CAPTURE"]),linearizeHistory:!0}),capture:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ee.Map,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_NEW_EMPTY_CAPTURE_TEMPLATE":return function(e){return e.get("captureTemplates")||(e=e.set("captureTemplates",new ee.List)),e.update("captureTemplates",function(e){return e.push(Object(ee.fromJS)({id:ge(),description:"",letter:"",iconName:"",isAvailableInAllOrgFiles:!0,orgFilesWhereAvailable:[""],headerPaths:[""],shouldPrepend:!1,template:""}))})}(e);case"UPDATE_TEMPLATE_FIELD_PATH_VALUE":return function(e,t){var n=zn(e.get("captureTemplates"),t.templateId);return e.setIn(["captureTemplates",n].concat(t.fieldPath),t.newValue)}(e,t);case"ADD_NEW_TEMPLATE_ORG_FILE_AVAILABILITY":return function(e,t){var n=zn(e.get("captureTemplates"),t.templateId);return e.updateIn(["captureTemplates",n,"orgFilesWhereAvailable"],function(e){return e.push("")})}(e,t);case"REMOVE_TEMPLATE_ORG_FILE_AVAILABILITY":return function(e,t){var n=zn(e.get("captureTemplates"),t.templateId);return e.updateIn(["captureTemplates",n,"orgFilesWhereAvailable"],function(e){return e.delete(t.orgFileAvailabilityIndex)})}(e,t);case"ADD_NEW_TEMPLATE_HEADER_PATH":return function(e,t){var n=zn(e.get("captureTemplates"),t.templateId);return e.updateIn(["captureTemplates",n,"headerPaths"],function(e){return e.push("")})}(e,t);case"REMOVE_TEMPLATE_HEADER_PATH":return function(e,t){var n=zn(e.get("captureTemplates"),t.templateId);return e.updateIn(["captureTemplates",n,"headerPaths"],function(e){return e.delete(t.headerPathIndex)})}(e,t);case"DELETE_TEMPLATE":return function(e,t){var n=zn(e.get("captureTemplates"),t.templateId);return e.update("captureTemplates",function(e){return e.delete(n)})}(e,t);case"RESTORE_CAPTURE_SETTINGS":return Jn(e,t);case"REORDER_CAPTURE_TEMPLATE":return function(e,t){return e.update("captureTemplates",function(e){return e.splice(t.fromIndex,1).splice(t.toIndex,0,e.get(t.fromIndex))})}(e,t);default:return e}}}),qn=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||y.d,Qn=function(e){return Object(y.e)(Xn,e,qn(Object(y.a)(E.a,w,Jt,qt)))},Zn=function(){!function(){if(sn){var e=localStorage.getItem("accessToken");e&&(localStorage.setItem("dropboxAccessToken",e),localStorage.removeItem("accessToken"))}}(),function(){if(sn){var e=localStorage.getItem("shouldStoreSettingsInDropbox");e&&(localStorage.setItem("shouldStoreSettingsInSyncBackend",e),localStorage.removeItem("shouldStoreSettingsInDropbox"))}}()},$n=function(e){var t=Object.create(null);return"string"!==typeof e?t:(e=e.trim().replace(/^(\?|#|&)/,""))?(e.split("&").forEach(function(e){var n=e.replace(/\+/g," ").split("="),a=n.shift(),r=n.length>0?n.join("="):void 0;a=decodeURIComponent(a),r=void 0===r?null:decodeURIComponent(r),void 0===t[a]?t[a]=r:Array.isArray(t[a])?t[a].push(r):t[a]=[t[a],r]}),t):t},ea=n(364),ta=n(22),na=n(33),aa=function(){return function(e,t){switch(t().syncBackend.get("client",{}).type){case"Dropbox":fn("dropboxAccessToken",null);break;case"Google Drive":var n=gapi.client.getToken();n&&(fn("googleDriveAccessToken",null),google.accounts.oauth2.revoke(n),gapi.client.setToken(""),window.location.reload())}fn("authenticatedSyncService",null),e({type:"SIGN_OUT"}),e(J()),e(C())}},ra=function(e,t,n){return{type:"SET_CURRENT_FILE_BROWSER_DIRECTORY_LISTING",directoryListing:e,hasMore:t,additionalSyncBackendState:n}},ia=function(e){return{type:"SET_IS_LOADING_MORE_DIRECTORY_LISTING",isLoadingMore:e}},oa=function(e){return function(t,n){t(D("Getting listing...")),window.console.log("reading directories"),n().syncBackend.get("client").getDirectoryListing(e).then(function(e){var n=e.listing,a=e.hasMore,r=e.additionalSyncBackendState;t(ra(n,a,r)),t(C())}).catch(function(e){var n="There was an error retrieving files! (status: ".concat(e.status,")");if(401===e.status||404===e.status){window.console.warn(n);var a=new na.Dropbox({clientId:"h1hbkipv02vmg9k",fetch:fetch}).getAuthenticationUrl(window.location.origin+"/org-web/");window.location=a}else alert(n);t(C())})}},sa=function(){return function(e,t){e(ia(!0));var n=t().syncBackend.get("client"),a=t().syncBackend.get("currentFileBrowserDirectoryListing");n.getMoreDirectoryListing(a.get("additionalSyncBackendState")).then(function(t){var n=t.listing,r=t.hasMore,i=t.additionalSyncBackendState,o=a.get("listing").concat(n);e(ra(o,r,i)),e(ia(!1))})}},la=function(e,t){return function(n,a){var r=a().syncBackend.get("client");switch(r.type){case"Dropbox":r.createFile("".concat(e,".org-web-bak"),t);break;case"Google Drive":e=e.startsWith("/")?e.substr(1):e,r.duplicateFile(e,function(e){return"".concat(e,".org-web-bak")})}}},ca=function(e){return function(t,n){t(D("Downloading file...")),n().syncBackend.get("client").getFileContents(e).then(function(n){t(pt(!1)),t(C()),t(la(e,n)),t(xe(Object(se.addSeconds)(new Date,5))),t(je(e,n)),t(dt())}).catch(function(e){if(401===e.status||404===e.status){var n=new na.Dropbox({clientId:"h1hbkipv02vmg9k",fetch:fetch}).getAuthenticationUrl(window.location.origin+"/org-web/");window.location=n}t(C()),t(O(!1)),t(zt("File not found"))})}},ua=function(e){var t=new na.Dropbox({accessToken:e,fetch:fetch}),n=function(e){return Object(ee.fromJS)(e.map(function(e){return{id:e.id,name:e.name,isDirectory:"folder"===e[".tag"],path:e.path_display}}))},a=function(e,n){return new Promise(function(a,r){return t.filesUpload({path:e,contents:n,mode:{".tag":"overwrite"},autorename:!0}).then(a).catch(r)})},r=function(e){return new Promise(function(n,a){return t.filesDownload({path:e}).then(function(e){var t=new FileReader;t.addEventListener("loadend",function(){return n({contents:t.result,lastModifiedAt:e.server_modified})}),t.readAsText(e.fileBlob)}).catch(function(e){e.error&&"not_found"===JSON.parse(e.error).error.path[".tag"]&&a()})})};return{type:"Dropbox",isSignedIn:function(){return new Promise(function(e){return e(!0)})},getDirectoryListing:function(e){return new Promise(function(a,r){t.filesListFolder({path:e}).then(function(e){return a({listing:n(e.entries),hasMore:e.has_more,additionalSyncBackendState:Object(ee.Map)({cursor:e.cursor})})}).catch(r)})},getMoreDirectoryListing:function(e){var a=e.get("cursor");return new Promise(function(e,r){return t.filesListFolderContinue({cursor:a}).then(function(t){return e({listing:n(t.entries),hasMore:t.has_more,additionalSyncBackendState:Object(ee.Map)({cursor:t.cursor})})})})},updateFile:a,createFile:a,getFileContentsAndMetadata:r,getFileContents:function(e){return new Promise(function(t,n){return r(e).then(function(e){var n=e.contents;return t(n)}).catch(n)})},deleteFile:function(e){return new Promise(function(n,a){return t.filesDelete({path:e}).then(n).catch(function(e){return a("path_lookup"===e.error.error[".tag"],e)})})}}},da=n(39),pa=n.n(da),ha=n(55),ma=function(){var e=function(){var e=!1,t=!1,n=[];return function(){return new Promise(function(a,r){e?a(window.gapi):window.gapi&&!t?(t=!0,new Promise(function(e,t){window.gapi.load("client",function(){window.gapi.client.init({apiKey:"",discoveryDocs:["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"]}).then(Object(ha.a)(pa.a.mark(function t(){var n,a;return pa.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:(n=gn("googleDriveAccessToken"))?(a=JSON.parse(n),window.gapi.client.setToken(a),e()):window.google.accounts.oauth2.initTokenClient({client_id:"",scope:"https://www.googleapis.com/auth/drive.file",callback:function(t){fn("authenticatedSyncService","Google Drive"),fn("googleDriveAccessToken",JSON.stringify(t)),e()}}).requestAccessToken({prompt:"consent"});case 2:case"end":return t.stop()}},t)})))})}).then(function(){e=!0,n.forEach(function(e){return e(window.gapi)}),a(window.gapi)})):n.push(a)})}}();window.gapi?e():window.handleGoogleDriveClientLoad=e;var t=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=new Promise(function(a,r){e().then(function(e){e.client.drive.files.list({pageSize:30,fields:"nextPageToken, files(id, name, mimeType, parents)",q:"'".concat(""===t?"root":t,"' in parents and trashed = false"),pageToken:n}).then(function(e){var n;a({listing:(n=e.result.files,Object(ee.fromJS)(n.map(function(e){return{id:e.id,name:e.name,isDirectory:"application/vnd.google-apps.folder"===e.mimeType,path:"/".concat(e.id)}}))),hasMore:!!e.result.nextPageToken,additionalSyncBackendState:Object(ee.Map)({currentDirectoryId:t,nextPageToken:e.result.nextPageToken})})}).catch(r)})}),r=new Promise(function(n,a){""===t?n(null):e().then(function(e){return e.client.drive.files.get({fileId:t,fields:"parents"})}).then(function(e){e.result.parents?n(e.result.parents[0]):n(null)}).catch(a)}),i=new Promise(function(t,n){window.rootFolderId?t(window.rootFolderId):e().then(function(e){return e.client.drive.files.get({fileId:"root",fields:"id"})}).then(function(e){window.rootFolderId=e.result.id,t(e.result.id)}).catch(n)});return new Promise(function(e,t){Promise.all([a,r,i]).then(function(t){var n=Object(d.a)(t,3),a=n[0],r=n[1],i=r===n[2]?"":r;a.additionalSyncBackendState=a.additionalSyncBackendState.set("parentId",i),e(a)})})},n=function(t,n){return new Promise(function(a,r){e().then(function(e){return e.client.drive.files.list({pageSize:1,fields:"files(id)",q:"'".concat(n,"' in parents and trashed = false and name = '").concat(t,"'")})}).then(function(e){return a(e.result.files.length>0?e.result.files[0].id:null)}).catch(r)})},a=function(t,n){return t=t.startsWith("/")?t.substr(1):t,e().then(function(e){fetch("https://www.googleapis.com/upload/drive/v3/files/".concat(t,"?uploadType=media"),{method:"PATCH",headers:{Authorization:"Bearer ".concat(e.auth.getToken().access_token)},body:n})})},r=function(t){return new Promise(function(n,a){e().then(function(e){t=t.startsWith("/")?t.substr(1):t;var r=new Promise(function(n){e.client.drive.files.get({fileId:t,alt:"media"}).then(function(e){return n(decodeURIComponent(escape(e.body)))}).catch(function(e){e.body&&"notFound"===JSON.parse(e.body).error.errors[0].reason&&a()})}),i=new Promise(function(n){e.client.drive.files.get({fileId:t,fields:"modifiedTime"}).then(function(e){n(e.result.modifiedTime)}).catch(function(e){e.body&&"notFound"===JSON.parse(e.body).error.errors[0].reason&&a()})});Promise.all([r,i]).then(function(e){var t=Object(d.a)(e,2),a=t[0],r=t[1];n({contents:a,lastModifiedAt:r})})})})},i=function(e){return new Promise(function(t,n){return r(e).then(function(e){var n=e.contents;return t(n)}).catch(n)})};return{type:"Google Drive",isSignedIn:function(){return new Promise(function(t,n){e().then(function(e){t(null!==e.client.getToken())})})},getDirectoryListing:function(e){return t(e.startsWith("/")?e.substr(1):e)},getMoreDirectoryListing:function(e){var n=e.get("currentDirectoryId"),a=e.get("nextPageToken");return t(n,a)},updateFile:a,createFile:function(t,r,i){return new Promise(function(o,s){n(t,r).then(function(n){return n?a(n,i).then(o).catch(s):e().then(function(e){e.client.drive.files.create({name:t,parents:r}).then(function(e){return a(e.result.id,i)}).then(o).catch(s)})}).catch(s)})},duplicateFile:function(t,a){return new Promise(function(r,i){e().then(function(e){e.client.drive.files.get({fileId:t,fields:"name, parents"}).then(function(o){if(o.result.name){var s=a(o.result.name),l=o.result.parents[0];n(s,l).then(function(n){var a=function(){e.client.drive.files.copy({fileId:t,parents:l,name:s}).then(function(e){r()}).catch(i)};n?e.client.drive.files.delete({fileId:n}).then(a).catch(i):a()})}else i()})})})},getFileContentsAndMetadata:r,getFileContents:i,getFileContentsByNameAndParent:function(e,t){return new Promise(function(a,r){return n(e,t).then(function(e){return i(e).then(a)})})},deleteFileByNameAndParent:function(t,n){return new Promise(function(a,r){e().then(function(e){return e.client.drive.files.list({pageSize:1,fields:"files(id)",q:"'".concat(n,"' in parents and trashed = false and name = '").concat(t,"'")}).then(function(t){t.result.files.length>0?e.client.drive.files.delete({fileId:t.result.files[0].id}).then(a).catch(r):a()})})})}}},fa=(n(268),n(366)),ba=n(367),va=n(363),ya=n(362),Ea=n(365),_a=(n(269),n(8)),Ta=n.n(_a),Ia=(n(270),function(){return l.a.createElement("div",{className:"privacy-policy-container"},l.a.createElement("h1",null,"Privacy Policy"),l.a.createElement("p",null,"Last updated: April 15th, 2019"),l.a.createElement("p",null,'We ("us" or "our") operate https://org-web.org (the "Site"). This page informs you of our policies regarding the collection, use and disclosure of Personal Information we receive from users of the Site.'),l.a.createElement("p",null,"We use your Personal Information only for providing and improving the Site. By using the Site, you agree to the collection and use of information in accordance with this policy."),l.a.createElement("h2",null,"Information Collection And Use"),l.a.createElement("p",null,'While using our Site, we may ask you to provide us with certain personally identifiable information that can be used to contact or identify you. Personally identifiable information may include, but is not limited to your name ("Personal Information").'),l.a.createElement("h2",null,"Log Data"),l.a.createElement("p",null,'Like many site operators, we collect information that your browser sends whenever you visit our Site ("Log Data").'),l.a.createElement("p",null,'This Log Data may include information such as your computer\'s Internet Protocol ("IP") address, browser type, browser version, the pages of our Site that you visit, the time and date of your visit, the time spent on those pages and other statistics.'),l.a.createElement("p",null,"In addition, we may use third party services such as Google Analytics that collect, monitor and analyze this data."),l.a.createElement("h2",null,"Cookies"),l.a.createElement("p",null,"Cookies are files with small amount of data, which may include an anonymous unique identifier. Cookies are sent to your browser from a web site and stored on your computer's hard drive."),l.a.createElement("p",null,'Like many sites, we use "cookies" to collect information. You can instruct your browser to refuse all cookies or to indicate when a cookie is being sent. However, if you do not accept cookies, you may not be able to use some portions of our Site.'),l.a.createElement("h2",null,"Security"),l.a.createElement("p",null,"The security of your Personal Information is important to us, but remember that no method of transmission over the Internet, or method of electronic storage, is 100% secure. While we strive to use commercially acceptable means to protect your Personal Information, we cannot guarantee its absolute security."),l.a.createElement("h2",null,"Changes To This Privacy Policy"),l.a.createElement("p",null,"This Privacy Policy is effective as of April 15th, 2019 and will remain in effect except with respect to any changes in its provisions in the future, which will be in effect immediately after being posted on this page."),l.a.createElement("p",null,"We reserve the right to update or change our Privacy Policy at any time and you should check this Privacy Policy periodically. Your continued use of the Service after we post any modifications to the Privacy Policy on this page will constitute your acknowledgment of the modifications and your consent to abide and be bound by the modified Privacy Policy."),l.a.createElement("p",null,"If we make any material changes to this Privacy Policy, we will notify you either through the email address you have provided us, or by placing a prominent notice on our website."),l.a.createElement("h2",null,"Contact"),l.a.createElement("p",null,"Us If you have any questions about this Privacy Policy, please contact us."))}),wa=n(361),ka=n(141),Sa=n.n(ka),Da=(n(271),function(e){function t(e){var n;return Object(p.a)(this,t),n=Object(m.a)(this,Object(f.a)(t).call(this,e)),$.a.bindAll(Object(g.a)(n),["handleChangelogClick","handleSettingsClick","handleModalPageDoneClick","handleSettingsSubPageBackClick","handleUndoClick","handleHelpClick"]),n}return Object(b.a)(t,e),Object(h.a)(t,[{key:"getPathRoot",value:function(){return this.props.location.pathname.split("/")[1]}},{key:"renderFileBrowserBackButton",value:function(){var e=this.props,t=e.location.pathname;if("Google Drive"===e.syncBackendType)return l.a.createElement("div",null);var n=t.substr("/files".length);if(n.endsWith("/")&&(n=n.substring(0,n.length-1)),""===n)return l.a.createElement("div",null);var a=n.split("/"),r=a[a.length-2],i=a.slice(0,a.length-1).join("/");return l.a.createElement(wa.a,{to:"/files".concat(i),className:"header-bar__back-button"},l.a.createElement("i",{className:"fas fa-chevron-left"}),l.a.createElement("span",{className:"header-bar__back-button__directory-path"},r,"/"))}},{key:"renderOrgFileBackButton",value:function(){var e=this.props.location.pathname.substr("/file".length);e.endsWith("/")&&(e=e.substring(0,e.length-1));var t=e.split("/"),n=t.slice(0,t.length-1).join("/");return l.a.createElement(wa.a,{to:"/files".concat(n),className:"header-bar__back-button"},l.a.createElement("i",{className:"fas fa-chevron-left"}),l.a.createElement("span",{className:"header-bar__back-button__directory-path"},"File browser"))}},{key:"renderLogo",value:function(){return l.a.createElement("div",{className:"header-bar__logo-container"},l.a.createElement("img",{className:"header-bar__logo",src:Sa.a,alt:"Logo",width:"30",height:"30"}),l.a.createElement("h2",{className:"header-bar__app-name"},"org-web"))}},{key:"renderSampleFileBackButton",value:function(){return l.a.createElement(wa.a,{to:"/",className:"header-bar__back-button"},l.a.createElement("i",{className:"fas fa-chevron-left"}),l.a.createElement("span",{className:"header-bar__back-button__directory-path"},"Home"))}},{key:"renderSignInBackButton",value:function(){return l.a.createElement(wa.a,{to:"/",className:"header-bar__back-button"},l.a.createElement("i",{className:"fas fa-chevron-left"}),l.a.createElement("span",{className:"header-bar__back-button__directory-path"},"Home"))}},{key:"handleSettingsSubPageBackClick",value:function(){this.props.base.popModalPage()}},{key:"renderSettingsSubPageBackButton",value:function(){return l.a.createElement("div",{className:"header-bar__back-button",onClick:this.handleSettingsSubPageBackClick},l.a.createElement("i",{className:"fas fa-chevron-left"}),l.a.createElement("span",{className:"header-bar__back-button__directory-path"},"Settings"))}},{key:"renderBackButton",value:function(){switch(this.props.activeModalPage){case"changelog":case"keyboard_shortcuts_editor":case"capture_templates_editor":case"sample":return this.renderSettingsSubPageBackButton();case"settings":return l.a.createElement("div",null)}switch(this.getPathRoot()){case"":return this.renderLogo();case"files":return this.renderFileBrowserBackButton();case"file":return this.renderOrgFileBackButton();case"sample":return this.renderSampleFileBackButton();case"sign_in":return this.renderSignInBackButton();default:return l.a.createElement("div",null)}}},{key:"renderTitle",value:function(){var e=function(e){return l.a.createElement("div",{className:"header-bar__title"},e)};switch(this.props.activeModalPage){case"changelog":return e("Changelog");case"settings":return e("Settings");case"keyboard_shortcuts_editor":return e("Shortcuts");case"capture_templates_editor":return e("Capture");case"sample":return e("Sample")}switch(this.getPathRoot()){case"sample":return e("Sample");case"sign_in":return e("Sign in")}return e("")}},{key:"handleChangelogClick",value:function(){this.props.base.pushModalPage("changelog")}},{key:"handleSettingsClick",value:function(){this.props.base.pushModalPage("settings")}},{key:"handleModalPageDoneClick",value:function(){this.props.base.clearModalStack()}},{key:"handleUndoClick",value:function(){this.props.isUndoEnabled&&this.props.undo.undo()}},{key:"handleHelpClick",value:function(){this.props.base.pushModalPage("settings"),this.props.base.pushModalPage("sample")}},{key:"renderActions",value:function(){var e=this.props,t=e.isAuthenticated,n=e.hasUnseenChangelog,a=e.activeModalPage,r=e.path,i=e.isUndoEnabled;if(a)return l.a.createElement("div",{className:"header-bar__actions",onClick:this.handleModalPageDoneClick},"Done");var o=Ta()("fas fa-undo header-bar__actions__item",{"header-bar__actions__item--disabled":!i}),c=Ta()("fas fa-cogs header-bar__actions__item",{"settings-icon--has-unseen-changelog":n});return l.a.createElement("div",{className:"header-bar__actions"},!t&&"sign_in"!==this.getPathRoot()&&l.a.createElement(wa.a,{to:"/sign_in"},l.a.createElement("div",{className:"header-bar__actions__item",title:"Sign in"},"Sign in")),!t&&l.a.createElement("a",{href:"https://github.com/DanielDe/org-web",target:"_blank",rel:"noopener noreferrer"},l.a.createElement("i",{className:"fab fa-github header-bar__actions__item"})),t&&!a&&!!r&&l.a.createElement(s.Fragment,null,l.a.createElement("i",{className:o,onClick:this.handleUndoClick,title:"Undo"}),l.a.createElement("i",{className:"fas fa-question-circle header-bar__actions__item",onClick:this.handleHelpClick,title:"Help"})),t&&l.a.createElement("i",{className:c,onClick:this.handleSettingsClick,title:"Settings"}))}},{key:"render",value:function(){var e=Ta()("header-bar",{"header-bar--with-logo":""===this.getPathRoot()});return l.a.createElement("div",{className:e},this.renderBackButton(),this.renderTitle(),this.renderActions())}}]),t}(s.PureComponent)),Ca=Object(Ea.a)(Object(v.b)(function(e,t){return{isAuthenticated:e.syncBackend.get("isAuthenticated"),hasUnseenChangelog:e.base.get("hasUnseenChangelog"),activeModalPage:e.base.get("modalPageStack",Object(ee.List)()).last(),path:e.org.present.get("path"),isUndoEnabled:e.org.past.length>0,syncBackendType:e.syncBackend.get("client")&&e.syncBackend.get("client").type}},function(e){return{base:Object(y.b)(a,e),undo:Object(y.b)(k.ActionCreators,e)}})(Da)),Oa=(n(273),function(){return l.a.createElement("div",{className:"landing-container"},l.a.createElement("h1",{className:"landing-app-name"},"org-web"),l.a.createElement("div",null,"(built at ".concat("7/31/2023, 9:09:55 AM",")")),l.a.createElement("h2",{className:"landing-tagline"},"Edit your org files online."),l.a.createElement("h2",{className:"landing-tagline"},"Optimized for mobile."),l.a.createElement("h2",{className:"landing-tagline"},"Syncs with Dropbox",l.a.createElement("br",null),"and Google Drive."),l.a.createElement(wa.a,{to:"/sample"},l.a.createElement("div",{className:"btn landing-button view-sample-button"},"View sample")),l.a.createElement(wa.a,{to:"/sign_in"},l.a.createElement("div",{className:"btn landing-button"},"Sign in")),l.a.createElement("div",{className:"mailing-list-signup-container"},"Interested in getting updates about org-web? Sign up for the"," ",l.a.createElement("a",{href:"http://eepurl.com/dK5F9w",target:"_blank",rel:"noopener noreferrer"},"mailing list")," ","(Or check out some"," ",l.a.createElement("a",{href:"https://us19.campaign-archive.com/home/?u=36b9d8082ddb55e6cc7e22339&id=f427625e31",target:"_blank",rel:"noopener noreferrer"},"past emails")," ","before you sign up)"))}),Aa=(n(274),Object(v.b)(function(e,t){var n=e.syncBackend.get("currentFileBrowserDirectoryListing");return{syncBackendType:e.syncBackend.get("client").type,listing:n?n.get("listing"):null,hasMore:!!n&&n.get("hasMore"),isLoadingMore:!!n&&n.get("isLoadingMore"),additionalSyncBackendState:!!n&&n.get("additionalSyncBackendState")}},function(e){return{syncBackend:Object(y.b)(o,e)}})(function(e){var t=e.path,n=e.listing,a=e.hasMore,r=e.isLoadingMore,i=e.syncBackendType,o=e.syncBackend,c=e.additionalSyncBackendState;Object(s.useEffect)(function(){return o.getDirectoryListing(t)},[t]);var u=""===t;return l.a.createElement("div",{className:"file-browser-container"},"Dropbox"===i&&l.a.createElement("h3",{className:"file-browser__header"},"Directory: ",u?"/":t),l.a.createElement("ul",{className:"file-browser__file-list"},!u&&l.a.createElement(wa.a,{to:"/files".concat(function(){switch(i){case"Dropbox":var e=t.split("/");return e.slice(0,e.length-1).join("/");case"Google Drive":return c.get("parentId")?"/"+c.get("parentId"):null;default:return null}}())},l.a.createElement("li",{className:"file-browser__file-list__element"},l.a.createElement("i",{className:"fas fa-folder file-browser__file-list__icon--directory"})," ..")),(n||[]).map(function(e){var t=e.get("isDirectory"),n=e.get("name").endsWith(".org-web-bak"),a=e.get("name").endsWith(".org"),r=".org-web-config.json"===e.get("name"),i=Ta()("file-browser__file-list__icon fas",{"fa-folder":t,"file-browser__file-list__icon--directory":t,"fa-file":!t&&!n&&!r,"file-browser__file-list__icon--not-org":!a,"fa-copy":n,"fa-cogs":r});return e.get("isDirectory")?l.a.createElement(wa.a,{to:"/files".concat(e.get("path")),key:e.get("id")},l.a.createElement("li",{className:"file-browser__file-list__element"},l.a.createElement("i",{className:i})," ",e.get("name"),"/")):l.a.createElement(wa.a,{to:"/file".concat(e.get("path")),key:e.get("id")},l.a.createElement("li",{className:"file-browser__file-list__element"},l.a.createElement("i",{className:i})," ",e.get("name")))}),a&&(r?l.a.createElement("li",{className:"file-browser__file-list__loading-more-container"},l.a.createElement("i",{className:"fas fa-spinner fa-lg fa-spin"})):l.a.createElement("li",{className:"file-browser__file-list__element file-browser__file-list__element--load-more-row",onClick:function(){return o.loadMoreDirectoryListing()}},"Load more..."))))})),Na=n(16),La=(n(284),function(e){var t=e.message,n=Object(s.useState)(!0),a=Object(d.a)(n,2),r=a[0],i=a[1],o=Object(s.useState)(t),c=Object(d.a)(o,2),u=c[0],p=c[1];Object(s.useEffect)(function(){t&&(p(t),i(!0))},[t]);var h=function(){return i(!1)};if(!r)return null;var m={opacity:Object(Na.spring)(t?.9:0,{stiffness:300})};return l.a.createElement(Na.Motion,{style:m,onRest:function(){t||(i(!1),p(null))}},function(e){return l.a.createElement("div",{className:"loading-indicator",style:e,onClick:h},u)})}),Ma=n(143),Pa=(n(289),n(290),n(26)),Ra=(n(294),n(295),n(296),n(297),n(298),function(e){var t=e.subPartDataAndHandlers,n=t.onEnterTableEditMode,a=t.onAddNewTableRow,r=t.onRemoveTableRow,i=t.onAddNewTableColumn,o=t.onRemoveTableColumn;return l.a.createElement("div",{className:"table-action-drawer-container"},l.a.createElement("div",{className:" table-action-drawer__edit-icon-container",onClick:n},l.a.createElement("i",{className:"fas fa-pencil-alt fa-lg"})),l.a.createElement("div",{className:"table-action-drawer__sub-icon-container",onClick:a},l.a.createElement("i",{className:"fas fa-plus fa-lg table-action-drawer__main-icon"}),l.a.createElement("i",{className:"fas fa-columns fa-sm table-action-drawer__sub-icon table-action-drawer__sub-icon--rotated"})),l.a.createElement("div",{className:"table-action-drawer__sub-icon-container",onClick:r},l.a.createElement("i",{className:"fas fa-times fa-lg table-action-drawer__main-icon"}),l.a.createElement("i",{className:"fas fa-columns fa-sm table-action-drawer__sub-icon table-action-drawer__sub-icon--rotated"})),l.a.createElement("div",{className:"table-action-drawer__sub-icon-container",onClick:i},l.a.createElement("i",{className:"fas fa-plus fa-lg table-action-drawer__main-icon"}),l.a.createElement("i",{className:"fas fa-columns fa-sm table-action-drawer__sub-icon"})),l.a.createElement("div",{className:"table-action-drawer__sub-icon-container",onClick:o},l.a.createElement("i",{className:"fas fa-times fa-lg table-action-drawer__main-icon"}),l.a.createElement("i",{className:"fas fa-columns fa-sm table-action-drawer__sub-icon"})))}),Ha=function(e){function t(e){var n;return Object(p.a)(this,t),n=Object(m.a)(this,Object(f.a)(t).call(this,e)),$.a.bindAll(Object(g.a)(n),["handleCellSelect","handleTextareaBlur","handleCellChange","handleInsertTimestamp","handleTextareaRef"]),n.state={rawCellValues:n.generateCellValueMap(e.table),shouldIgnoreBlur:!1},n}return Object(b.a)(t,e),Object(h.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this.props.subPartDataAndHandlers,n=t.onTableCellValueUpdate,a=t.selectedTableCellId,r=t.inTableEditMode,i=this.state.rawCellValues;e.subPartDataAndHandlers.inTableEditMode&&!r&&i.has(a)&&n(a,i.get(a)),this.props.table!==e.table&&this.setState({rawCellValues:this.generateCellValueMap(this.props.table)})}},{key:"generateCellValueMap",value:function(e){return Object(ee.Map)(e.get("contents").map(function(e){return e.get("contents").map(function(e){return[e.get("id"),e.get("rawContents")]})}).flatten())}},{key:"handleCellSelect",value:function(e){var t=this;return function(){return t.props.subPartDataAndHandlers.onTableCellSelect(e)}}},{key:"handleTextareaBlur",value:function(){var e=this;setTimeout(function(){e.state.shouldIgnoreBlur?e.setState({shouldIgnoreBlur:!1}):e.props.subPartDataAndHandlers.onExitTableEditMode()},0)}},{key:"handleCellChange",value:function(e){var t=this.state.rawCellValues,n=this.props.subPartDataAndHandlers.selectedTableCellId;this.setState({rawCellValues:t.set(n,e.target.value)})}},{key:"handleInsertTimestamp",value:function(){this.setState({shouldIgnoreBlur:!0});var e=this.state.rawCellValues,t=this.props.subPartDataAndHandlers.selectedTableCellId,n=e.get(t),a=this.textarea.selectionStart;this.setState({rawCellValues:e.set(t,n.substring(0,a)+ue()+n.substring(this.textarea.selectionEnd||a))}),this.textarea.focus()}},{key:"handleTextareaRef",value:function(e){this.textarea=e}},{key:"render",value:function(){var e=this,t=this.props,n=t.table,a=t.subPartDataAndHandlers,r=a.selectedTableCellId,i=a.inTableEditMode,o=a.shouldDisableActions,c=this.state.rawCellValues,u=n.get("contents").some(function(e){return e.get("contents").some(function(e){return e.get("id")===r})});return l.a.createElement(s.Fragment,null,l.a.createElement("table",{className:"table-part"},l.a.createElement("tbody",null,n.get("contents").map(function(t){return l.a.createElement("tr",{key:t.get("id")},t.get("contents").map(function(t){var n=t.get("id")===r,a=Ta()("table-part__cell",{"table-part__cell--selected":n});return l.a.createElement("td",{className:a,key:t.get("id"),onClick:e.handleCellSelect(t.get("id"))},n&&i?l.a.createElement("div",{className:"table-cell__edit-container"},l.a.createElement("textarea",{autoFocus:!0,className:"textarea",rows:"3",value:c.get(t.get("id")),onBlur:e.handleTextareaBlur,onChange:e.handleCellChange,ref:e.handleTextareaRef}),l.a.createElement("div",{className:"table-cell__insert-timestamp-button",onClick:e.handleInsertTimestamp},l.a.createElement("i",{className:"fas fa-plus insert-timestamp-icon"}),"Insert timestamp")):t.get("contents").size>0?l.a.createElement(Ga,{parts:t.get("contents"),subPartDataAndHandlers:e.props.subPartDataAndHandlers}):"   ")}))}))),l.a.createElement(Pa.UnmountClosed,{isOpened:u&&!o},l.a.createElement(Ra,{subPartDataAndHandlers:this.props.subPartDataAndHandlers})))}}]),t}(s.PureComponent),ja=(n(299),function(e,t,n){return{r:parseInt((t.r-e.r)*n+e.r,10),g:parseInt((t.g-e.g)*n+e.g,10),b:parseInt((t.b-e.b)*n+e.b,10),a:(t.a-e.a)*n+e.a}}),xa=function(e,t,n,a){return{r:e,g:t,b:n,a:a}},Fa=function(e){return"rgba(".concat(e.r,", ").concat(e.g,", ").concat(e.b,", ").concat(e.a,")")},Ua=(n(300),function(e){var t=e.state,n=e.onClick,a=xa(255,255,255,1),r=xa(94,52,140,1),i={colorFactor:Object(Na.spring)({checked:1,partial:1,unchecked:0}[t],{stiffness:300})};return l.a.createElement(Na.Motion,{style:i},function(e){var i=Fa(ja(a,r,e.colorFactor));return l.a.createElement("div",{className:"checkbox",onClick:n,style:{backgroundColor:i}},l.a.createElement("div",{className:"checkbox__inner-container"},"checked"===t&&l.a.createElement("i",{className:"fas fa-check"}),"partial"===t&&l.a.createElement("i",{className:"fas fa-minus"}),"unchecked"===t&&l.a.createElement("i",{className:"fas fa-square"})))})}),Va=(n(301),function(e){var t=e.subPartDataAndHandlers,n=t.onEnterListTitleEditMode,a=t.onEnterListContentsEditMode,r=t.onAddNewListItem,i=t.onRemoveListItem;return l.a.createElement("div",{className:"list-action-drawer-container"},l.a.createElement("div",{className:"list-action-drawer__row"},l.a.createElement("div",{className:"list-action-drawer__edit-icon-container",onClick:n},l.a.createElement("i",{className:"fas fa-pencil-alt fa-lg"})),l.a.createElement("span",{className:"list-action-drawer__separator"}),l.a.createElement("div",{className:"list-action-drawer__edit-icon-container",onClick:a},l.a.createElement("i",{className:"fas fa-edit fa-lg"})),l.a.createElement("span",{className:"list-action-drawer__separator"}),l.a.createElement("div",{className:"list-action-drawer__edit-icon-container",onClick:r},l.a.createElement("i",{className:"fas fa-plus fa-lg"})),l.a.createElement("span",{className:"list-action-drawer__separator"}),l.a.createElement("div",{className:"list-action-drawer__edit-icon-container",onClick:i},l.a.createElement("i",{className:"fas fa-times fa-lg"}))))}),Ba=function(e){function t(e){var n;return Object(p.a)(this,t),n=Object(m.a)(this,Object(f.a)(t).call(this,e)),$.a.bindAll(Object(g.a)(n),["handleListItemSelect","handleCheckboxClick","handleTextareaBlur","handleListTitleChange","handleListContentsChange","handleInsertTimestampListTitle","handleInsertTimestampListContents","handleTextareaRef"]),n.state={listTitleValues:n.generateListTitleValueMap(e.part),listContentsValues:n.generateListContentsValueMap(e.part),shouldIgnoreBlur:!1},n}return Object(b.a)(t,e),Object(h.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this.props.subPartDataAndHandlers,n=t.onListTitleValueUpdate,a=t.onListContentsValueUpdate,r=t.inListTitleEditMode,i=t.inListContentsEditMode,o=t.selectedListItemId,s=this.state,l=s.listTitleValues,c=s.listContentsValues;e.subPartDataAndHandlers.inListTitleEditMode&&!r&&l.has(o)&&n(o,l.get(o));var u=e.subPartDataAndHandlers.selectedListItemId;u!==o&&r&&e.subPartDataAndHandlers.inListTitleEditMode&&l.has(u)&&n(u,l.get(u)),e.subPartDataAndHandlers.inListContentsEditMode&&!i&&c.has(o)&&a(o,c.get(o)),u!==o&&i&&e.subPartDataAndHandlers.inListContentsEditMode&&c.has(u)&&a(u,c.get(u)),this.props.part!==e.part&&(this.setState({listTitleValues:this.generateListTitleValueMap(this.props.part)}),this.setState({listContentsValues:this.generateListContentsValueMap(this.props.part)}))}},{key:"generateListTitleValueMap",value:function(e){return Object(ee.Map)(e.get("items").map(function(e){return[e.get("id"),me(e.get("titleLine"))]}))}},{key:"generateListContentsValueMap",value:function(e){return Object(ee.Map)(e.get("items").map(function(e){return[e.get("id"),me(e.get("contents"))]}))}},{key:"handleListItemSelect",value:function(e){var t=this;return function(){return t.props.subPartDataAndHandlers.onListItemSelect(e)}}},{key:"handleCheckboxClick",value:function(e){var t=this;return function(){return t.props.subPartDataAndHandlers.onCheckboxClick(e)}}},{key:"handleTextareaBlur",value:function(){var e=this;setTimeout(function(){e.state.shouldIgnoreBlur?e.setState({shouldIgnoreBlur:!1}):e.props.subPartDataAndHandlers.onExitListTitleEditMode()},0)}},{key:"handleListTitleChange",value:function(e){var t=this.state.listTitleValues,n=this.props.subPartDataAndHandlers.selectedListItemId;this.setState({listTitleValues:t.set(n,e.target.value)})}},{key:"handleListContentsChange",value:function(e){var t=this.state.listContentsValues,n=this.props.subPartDataAndHandlers.selectedListItemId;this.setState({listContentsValues:t.set(n,e.target.value)})}},{key:"handleInsertTimestampListTitle",value:function(){this.setState({shouldIgnoreBlur:!0});var e=this.state.listTitleValues,t=this.props.subPartDataAndHandlers.selectedListItemId,n=e.get(t),a=this.textarea.selectionStart;this.setState({listTitleValues:e.set(t,n.substring(0,a)+ue()+n.substring(this.textarea.selectionEnd||a))}),this.textarea.focus()}},{key:"handleInsertTimestampListContents",value:function(){this.setState({shouldIgnoreBlur:!0});var e=this.state.listContentsValues,t=this.props.subPartDataAndHandlers.selectedListItemId,n=e.get(t),a=this.textarea.selectionStart;this.setState({listContentsValues:e.set(t,n.substring(0,a)+ue()+n.substring(this.textarea.selectionEnd||a))}),this.textarea.focus()}},{key:"handleTextareaRef",value:function(e){this.textarea=e}},{key:"renderContent",value:function(){var e=this,t=this.props,n=t.part,a=t.subPartDataAndHandlers,r=a.selectedListItemId,i=a.inListTitleEditMode,o=a.inListContentsEditMode,s=a.shouldDisableActions,c=this.state,u=c.listTitleValues,d=c.listContentsValues;return n.get("items").map(function(t){var n=t.get("id")===r,a=Ta()({"list-part__not_checkbox-container":!t.get("isCheckbox"),"list-part__checkbox-container":t.get("isCheckbox"),"list-part__item--selected":n});return l.a.createElement("li",{key:t.get("id"),value:t.get("forceNumber")},l.a.createElement("div",{className:a,onClick:e.handleListItemSelect(t.get("id"))},t.get("isCheckbox")&&l.a.createElement(Ua,{onClick:e.handleCheckboxClick(t.get("id")),state:t.get("checkboxState")}),n&&i?l.a.createElement("div",{className:"list-title-line__edit-container"},l.a.createElement("textarea",{autoFocus:!0,className:"textarea",rows:"3",ref:e.handleTextareaRef,value:u.get(t.get("id")),onBlur:e.handleTextareaBlur,onChange:e.handleListTitleChange}),l.a.createElement("div",{className:"list-title-line__insert-timestamp-button",onClick:e.handleInsertTimestampListTitle},l.a.createElement("i",{className:"fas fa-plus insert-timestamp-icon"}),"Insert timestamp")):u.get(t.get("id"))?l.a.createElement(Ga,{parts:t.get("titleLine"),subPartDataAndHandlers:e.props.subPartDataAndHandlers}):l.a.createElement("span",null,"\xa0")),l.a.createElement(Pa.UnmountClosed,{isOpened:n&&!s},l.a.createElement(Va,{subPartDataAndHandlers:e.props.subPartDataAndHandlers})),n&&o?l.a.createElement("div",{className:"list-contents__edit-container"},l.a.createElement("textarea",{autoFocus:!0,className:"textarea",rows:"8",ref:e.handleTextareaRef,value:d.get(t.get("id")),onBlur:e.handleTextareaBlur,onChange:e.handleListContentsChange}),l.a.createElement("div",{className:"list-contents__insert-timestamp-button",onClick:e.handleInsertTimestampListContents},l.a.createElement("i",{className:"fas fa-plus insert-timestamp-icon"}),"Insert timestamp")):l.a.createElement(Ga,{parts:t.get("contents"),subPartDataAndHandlers:e.props.subPartDataAndHandlers}))})}},{key:"render",value:function(){return l.a.createElement(s.Fragment,null,this.props.part.get("isOrdered")?l.a.createElement("ol",{className:"attributed-string__list-part attributed-string__list-part--ordered"},this.renderContent()):l.a.createElement("ul",{className:"attributed-string__list-part"},this.renderContent()))}}]),t}(s.PureComponent),Wa=(n(302),function(e){var t=e.part,n=e.subPartDataAndHandlers,a=n.onTimestampClick,r=n.shouldDisableActions,i=t.get("firstTimestamp"),o=t.get("secondTimestamp");return l.a.createElement("span",{className:"attributed-string__timestamp-part",onClick:function(){return r?void 0:a(t.get("id"))}},!!i&&le(i),!!o&&l.a.createElement(s.Fragment,null,"--",le(o)))}),Ga=function(e){var t,n=e.parts,a=e.subPartDataAndHandlers;return l.a.createElement("span",null,n.map(function(e){switch(e.get("type")){case"text":return e.get("contents");case"link":var n=e.getIn(["contents","uri"]),r=e.getIn(["contents","title"])||n;return l.a.createElement("a",{key:e.get("id"),href:n,target:"_blank",rel:"noopener noreferrer"},r);case"percentage-cookie":return t=Ta()("attributed-string__cookie-part",{"attributed-string__cookie-part--complete":100===parseInt(e.get("percentage"),10)}),l.a.createElement("span",{key:e.get("id"),className:t},"[",e.get("percentage"),"%]");case"fraction-cookie":return t=Ta()("attributed-string__cookie-part",{"attributed-string__cookie-part--complete":""!==e.getIn(["fraction",0])&&e.getIn(["fraction",0])===e.getIn(["fraction",1])}),l.a.createElement("span",{key:e.get("id"),className:t},"[",e.getIn(["fraction",0]),"/",e.getIn(["fraction",1]),"]");case"table":return l.a.createElement(Ha,{key:e.get("id"),table:e,subPartDataAndHandlers:a});case"list":return l.a.createElement(Ba,{key:e.get("id"),part:e,subPartDataAndHandlers:a});case"inline-markup":return t=Ta()("attributed-string__inline-markup","attributed-string__inline-markup--".concat(e.get("markupType"))),l.a.createElement("span",{key:e.get("id"),className:t},e.get("content"));case"timestamp":return l.a.createElement(Wa,{key:e.get("id"),part:e,subPartDataAndHandlers:a});default:return console.error("Unrecognized attributed string part type! ".concat(e.get("type"))),""}}))},Ya=function(e){function t(e){var n;return Object(p.a)(this,t),n=Object(m.a)(this,Object(f.a)(t).call(this,e)),$.a.bindAll(Object(g.a)(n),["handleRef","handleTitleSpanRef","handleTextareaRef","handleTitleClick","handleTextareaBlur","handleTitleChange","handleTitleFieldClick","handleTodoClick","handleTimestampClick","handleInsertTimestamp"]),n.state={titleValue:n.calculateRawTitle(e.header),containerWidth:null,shouldIgnoreBlur:!1},n}return Object(b.a)(t,e),Object(h.a)(t,[{key:"storeContainerWidth",value:function(){this.containerDiv&&this.setState({containerWidth:this.containerDiv.offsetWidth})}},{key:"componentDidMount",value:function(){this.storeContainerWidth()}},{key:"componentDidUpdate",value:function(e){var t=this,n=this.props.header;e.inEditMode&&!this.props.inEditMode&&this.props.org.updateHeaderTitle(n.get("id"),this.state.titleValue),e.header!==this.props.header&&this.setState({titleValue:this.calculateRawTitle(this.props.header)},function(){return t.storeContainerWidth()})}},{key:"handleRef",value:function(e){this.containerDiv=e}},{key:"handleTitleSpanRef",value:function(e){this.titleSpan=e}},{key:"handleTextareaRef",value:function(e){this.textarea=e}},{key:"calculateRawTitle",value:function(e){var t=e.getIn(["titleLine","todoKeyword"]),n=e.getIn(["titleLine","tags"]),a=e.getIn(["titleLine","rawTitle"]);return t&&(a="".concat(t," ").concat(a)),n&&n.size>0&&(a="".concat(a," :").concat(n.join(":"),":")),a}},{key:"handleTitleClick",value:function(e){var t=this.props,n=t.header,a=t.hasContent,r=t.isSelected,i=t.onClick;i?i():(!a||n.get("opened")&&!r||this.props.org.toggleHeaderOpened(n.get("id")),this.props.org.selectHeader(n.get("id")))}},{key:"handleTodoClick",value:function(e){var t=this.props,n=t.header,a=t.shouldTapTodoToAdvance,r=t.onClick;r?(r(),e.stopPropagation()):(this.props.org.selectHeader(n.get("id")),a&&this.props.org.advanceTodoState())}},{key:"handleTextareaBlur",value:function(e){var t=this;setTimeout(function(){t.state.shouldIgnoreBlur?t.setState({shouldIgnoreBlur:!1}):t.props.org.exitEditMode()},100)}},{key:"handleTitleChange",value:function(e){var t=e.target.value,n=t[t.length-1];this.state.titleValue!==t.substring(0,t.length-1)||"\n"!==n?this.setState({titleValue:t}):this.props.org.exitEditMode()}},{key:"handleTitleFieldClick",value:function(e){e.stopPropagation()}},{key:"handleTimestampClick",value:function(e){this.props.base.activatePopup("timestamp-editor",{timestampId:e})}},{key:"handleInsertTimestamp",value:function(e){this.setState({shouldIgnoreBlur:!0});var t=this.state.titleValue,n=this.textarea.selectionStart;this.setState({titleValue:t.substring(0,n)+ue()+t.substring(this.textarea.selectionEnd||n)}),this.textarea.focus(),e.stopPropagation()}},{key:"render",value:function(){var e=this.props,t=e.header,n=e.color,a=e.hasContent,r=e.inEditMode,i=e.shouldDisableActions,o=e.shouldDisableExplicitWidth,s=this.state.containerWidth,c=t.getIn(["titleLine","todoKeyword"]),u={color:n,wordBreak:"break-word"};return l.a.createElement("div",{className:"title-line",onClick:this.handleTitleClick,ref:this.handleRef,style:{width:o?"":s}},!r&&c?l.a.createElement("span",{className:Ta()("todo-keyword","todo-keyword--".concat(c.toLowerCase())),onClick:this.handleTodoClick},c):"",r?l.a.createElement("div",{className:"title-line__edit-container"},l.a.createElement("textarea",{autoFocus:!0,className:"textarea",rows:"3",ref:this.handleTextareaRef,value:this.state.titleValue,onBlur:this.handleTextareaBlur,onChange:this.handleTitleChange,onClick:this.handleTitleFieldClick}),l.a.createElement("div",{className:"title-line__insert-timestamp-button",onClick:this.handleInsertTimestamp},l.a.createElement("i",{className:"fas fa-plus insert-timestamp-icon"}),"Insert timestamp")):l.a.createElement("div",null,l.a.createElement("span",{style:u,ref:this.handleTitleSpanRef},l.a.createElement(Ga,{parts:t.getIn(["titleLine","title"]),subPartDataAndHandlers:{onTimestampClick:this.handleTimestampClick,shouldDisableActions:i}}),!t.get("opened")&&a?"...":""),t.getIn(["titleLine","tags"]).size>0&&l.a.createElement("div",null,t.getIn(["titleLine","tags"]).toSet().toList().filter(function(e){return!!e}).map(function(e){return l.a.createElement("div",{className:"header-tag",key:e},e)}))))}}]),t}(s.PureComponent),Ka=Object(v.b)(function(e,t){return{inEditMode:"title"===e.org.present.get("editMode")&&e.org.present.get("selectedHeaderId")===t.header.get("id"),shouldTapTodoToAdvance:e.base.get("shouldTapTodoToAdvance"),isSelected:e.org.present.get("selectedHeaderId")===t.header.get("id")}},function(e){return{org:Object(y.b)(r,e),base:Object(y.b)(a,e)}})(Ya),za=(n(303),n(304),function(e){function t(e){var n;return Object(p.a)(this,t),n=Object(m.a)(this,Object(f.a)(t).call(this,e)),$.a.bindAll(Object(g.a)(n),["handleTimestampClick"]),n}return Object(b.a)(t,e),Object(h.a)(t,[{key:"handleTimestampClick",value:function(e){var t=this;return function(){return t.props.onClick(e)}}},{key:"render",value:function(){var e=this,t=this.props.planningItems;return 0===t.size?null:l.a.createElement("div",null,t.map(function(t,n){return l.a.createElement("div",{key:t.get("id"),className:"planning-items__item-container"},l.a.createElement("div",{className:"planning-item__type"},t.get("type"),": "),l.a.createElement("div",{className:"planning-item__timestamp",onClick:e.handleTimestampClick(n)},le(t.get("timestamp"))))}))}}]),t}(s.PureComponent)),Ja=(n(305),function(e){var t=e.propertyListItems,n=e.shouldDisableActions,a=e.onTimestampClick,r=e.onEdit,i=Object(s.useState)(!0),o=Object(d.a)(i,2),c=o[0],u=o[1];return 0===t.size?null:l.a.createElement("div",{className:"property-list-container"},l.a.createElement("div",{className:"property-list__property",onClick:function(){return u(!c)}},":PROPERTIES:",c?"...":""),!c&&l.a.createElement(s.Fragment,null,t.map(function(e){return l.a.createElement("div",{className:"property-list__item-container",key:e.get("id")},l.a.createElement("div",{className:"property-list__property",onClick:n?null:r},":",e.get("property"),":"),l.a.createElement("div",{className:"property-list__value"},l.a.createElement(Ga,{parts:e.get("value")||[],subPartDataAndHandlers:{onTimestampClick:a,shouldDisableActions:n}})))}),l.a.createElement("div",{className:"property-list__property",onClick:r},":END:")))}),Xa=function(e){function t(e){var n;return Object(p.a)(this,t),n=Object(m.a)(this,Object(f.a)(t).call(this,e)),$.a.bindAll(Object(g.a)(n),["handleRef","handleTextareaRef","handleDescriptionChange","handleTableCellSelect","handleExitTableEditMode","handleTableCellValueUpdate","handleEnterTableEditMode","handleAddNewTableRow","handleRemoveTableRow","handleAddNewTableColumn","handleRemoveTableColumn","handleCheckboxClick","handleListItemSelect","handleEnterListTitleEditMode","handleExitListTitleEditMode","handleListTitleValueUpdate","handleEnterListContentsEditMode","handleExitListContentsEditMode","handleListContentsValueUpdate","handleAddNewListItem","handleRemoveListItem","handleTimestampClick","handleInsertTimestamp","handlePlanningItemTimestampClick","handlePropertyListEdit"]),n.state={descriptionValue:n.calculateRawDescription(e.header),containerWidth:null},n}return Object(b.a)(t,e),Object(h.a)(t,[{key:"storeContainerWidth",value:function(){this.containerDiv&&this.setState({containerWidth:this.containerDiv.offsetWidth})}},{key:"componentDidMount",value:function(){this.storeContainerWidth()}},{key:"componentDidUpdate",value:function(e){var t=this,n=this.props.header;e.inEditMode&&!this.props.inEditMode&&this.props.org.updateHeaderDescription(n.get("id"),this.state.descriptionValue),e.header!==this.props.header&&this.setState({descriptionValue:this.calculateRawDescription(this.props.header)},function(){return t.storeContainerWidth()})}},{key:"calculateRawDescription",value:function(e){var t=e.get("planningItems"),n=e.get("propertyListItems"),a=t.map(function(e){return"".concat(e.get("type"),": ").concat(le(e.get("timestamp")))}).join(" "),r="";n.size>0&&(r+=":PROPERTIES:\n",r+=n.map(function(e){return":".concat(e.get("property"),": ").concat(me(e.get("value")))}).join("\n"),r+="\n:END:");var i="";return a&&(i+=a+"\n"),r&&(i+=r+"\n"),i+=e.get("rawDescription")}},{key:"handleTextareaRef",value:function(e){this.textarea=e}},{key:"handleRef",value:function(e){this.containerDiv=e}},{key:"handleDescriptionChange",value:function(e){this.setState({descriptionValue:e.target.value})}},{key:"handleTableCellSelect",value:function(e){this.props.org.setSelectedTableCellId(e)}},{key:"handleExitTableEditMode",value:function(){this.props.org.exitEditMode()}},{key:"handleTableCellValueUpdate",value:function(e,t){this.props.org.updateTableCellValue(e,t)}},{key:"handleEnterTableEditMode",value:function(){this.props.org.enterEditMode("table")}},{key:"handleAddNewTableRow",value:function(){this.props.org.addNewTableRow()}},{key:"handleRemoveTableRow",value:function(){this.props.org.removeTableRow()}},{key:"handleAddNewTableColumn",value:function(){this.props.org.addNewTableColumn()}},{key:"handleRemoveTableColumn",value:function(){this.props.org.removeTableColumn()}},{key:"handleCheckboxClick",value:function(e){this.props.org.advanceCheckboxState(e)}},{key:"handleListItemSelect",value:function(e){this.props.org.setSelectedListItemId(e)}},{key:"handleEnterListTitleEditMode",value:function(){this.props.org.enterEditMode("list-title")}},{key:"handleExitListTitleEditMode",value:function(){this.props.org.exitEditMode()}},{key:"handleListTitleValueUpdate",value:function(e,t){this.props.org.updateListTitleValue(e,t)}},{key:"handleEnterListContentsEditMode",value:function(){this.props.org.enterEditMode("list-contents")}},{key:"handleExitListContentsEditMode",value:function(){this.props.org.exitEditMode()}},{key:"handleListContentsValueUpdate",value:function(e,t){this.props.org.updateListContentsValue(e,t)}},{key:"handleAddNewListItem",value:function(){this.props.org.addNewListItemAndEdit()}},{key:"handleRemoveListItem",value:function(){this.props.org.removeListItem()}},{key:"handleTimestampClick",value:function(e){this.props.base.activatePopup("timestamp-editor",{timestampId:e})}},{key:"handleInsertTimestamp",value:function(e){var t=this;e.preventDefault();var n=this.state.descriptionValue,a=this.textarea.selectionStart,r=ue(),i=a+r.length,o=n.substring(0,a)+r+n.substring(this.textarea.selectionEnd||a);this.setState({descriptionValue:o},function(){t.textarea.setSelectionRange(i,i)})}},{key:"handlePlanningItemTimestampClick",value:function(e){var t=this;return function(n){return t.props.base.activatePopup("timestamp-editor",{headerId:e,planningItemIndex:n})}}},{key:"handlePropertyListEdit",value:function(){var e=this.props.header;this.props.base.activatePopup("property-list-editor",{headerId:e.get("id")})}},{key:"render",value:function(){var e=this,t=this.props,n=t.header,a=t.inEditMode,r=t.selectedTableCellId,i=t.inTableEditMode,o=t.shouldDisableActions,c=t.selectedListItemId,u=t.inListTitleEditMode,d=t.inListContentsEditMode,p=this.state.containerWidth;if(!n.get("opened"))return l.a.createElement("div",null);var h=this.state.descriptionValue.match(/^\s*/),m=h?h[0]:"";return l.a.createElement("div",{className:"header-content-container nice-scroll",ref:this.handleRef,style:{width:p}},a?l.a.createElement("div",{className:"header-content__edit-container"},l.a.createElement("textarea",{autoFocus:!0,className:"textarea",rows:Math.min(10,this.state.descriptionValue.split("\n").length),ref:this.handleTextareaRef,value:this.state.descriptionValue,onChange:this.handleDescriptionChange,onFocus:function(e){var t=e.target;setTimeout(function(){t.scrollTop=t.scrollHeight},0)},onKeyDown:function(t){var n=t.target;if(n&&"Enter"===t.key){t.preventDefault();var a=n.value,r=n.selectionStart,i=a.substring(0,r),o=a.substring(r),s="\n"+m,l=i+s+o;n.value=l,n.setSelectionRange(r+s.length,r+s.length),0===o.length&&(n.scrollTop=n.scrollHeight),e.setState({descriptionValue:l})}}}),l.a.createElement("div",{className:"header-content__insert-timestamp-button",onMouseDown:this.handleInsertTimestamp},l.a.createElement("i",{className:"fas fa-plus insert-timestamp-icon"}),"Insert timestamp")):l.a.createElement(s.Fragment,null,l.a.createElement(za,{planningItems:n.get("planningItems"),onClick:this.handlePlanningItemTimestampClick(n.get("id"))}),l.a.createElement(Ja,{propertyListItems:n.get("propertyListItems"),onTimestampClick:this.handleTimestampClick,shouldDisableActions:o,onEdit:this.handlePropertyListEdit}),l.a.createElement(Ga,{parts:n.get("description"),subPartDataAndHandlers:{onTableCellSelect:this.handleTableCellSelect,selectedTableCellId:r,inTableEditMode:i,onExitTableEditMode:this.handleExitTableEditMode,onTableCellValueUpdate:this.handleTableCellValueUpdate,onEnterTableEditMode:this.handleEnterTableEditMode,onAddNewTableRow:this.handleAddNewTableRow,onRemoveTableRow:this.handleRemoveTableRow,onAddNewTableColumn:this.handleAddNewTableColumn,onRemoveTableColumn:this.handleRemoveTableColumn,onCheckboxClick:this.handleCheckboxClick,onListItemSelect:this.handleListItemSelect,onEnterListTitleEditMode:this.handleEnterListTitleEditMode,onExitListTitleEditMode:this.handleExitListTitleEditMode,onListTitleValueUpdate:this.handleListTitleValueUpdate,onEnterListContentsEditMode:this.handleEnterListContentsEditMode,onExitListContentsEditMode:this.handleExitListContentsEditMode,onListContentsValueUpdate:this.handleListContentsValueUpdate,onAddNewListItem:this.handleAddNewListItem,onRemoveListItem:this.handleRemoveListItem,selectedListItemId:c,inListTitleEditMode:u,inListContentsEditMode:d,onTimestampClick:this.handleTimestampClick,shouldDisableActions:o}})))}}]),t}(s.PureComponent),qa=Object(v.b)(function(e,t){return{inEditMode:"description"===e.org.present.get("editMode")&&e.org.present.get("selectedHeaderId")===t.header.get("id"),isSelected:e.org.present.get("selectedHeaderId")===t.header.get("id"),selectedTableCellId:e.org.present.get("selectedTableCellId"),inTableEditMode:"table"===e.org.present.get("editMode"),selectedListItemId:e.org.present.get("selectedListItemId"),inListTitleEditMode:"list-title"===e.org.present.get("editMode"),inListContentsEditMode:"list-contents"===e.org.present.get("editMode")}},function(e){return{org:Object(y.b)(r,e),base:Object(y.b)(a,e)}})(Xa),Qa=(n(306),function(e){function t(){return Object(p.a)(this,t),Object(m.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(b.a)(t,e),Object(h.a)(t,[{key:"iconWithFFClickCatcher",value:function(e,t){return l.a.createElement("div",{onClick:t,className:"header-action-drawer__ff-click-catcher-container"},l.a.createElement("div",{className:"header-action-drawer__ff-click-catcher"}),l.a.createElement("i",{className:e}))}},{key:"render",value:function(){var e=this.props,t=e.onEnterTitleEditMode,n=e.onEnterDescriptionEditMode,a=e.onTagsClick,r=e.isFocused,i=e.onFocus,o=e.onUnfocus,s=e.onAddNewHeader,c=e.onDeadlineClick,u=e.onScheduledClick;return l.a.createElement("div",{className:"header-action-drawer-container"},l.a.createElement("div",{className:"header-action-drawer__row"},this.iconWithFFClickCatcher("fas fa-pencil-alt fa-lg",t),l.a.createElement("span",{className:"header-action-drawer__separator"}),this.iconWithFFClickCatcher("fas fa-edit fa-lg",n),l.a.createElement("span",{className:"header-action-drawer__separator"}),this.iconWithFFClickCatcher("fas fa-tags fa-lg",a),l.a.createElement("span",{className:"header-action-drawer__separator"}),r?this.iconWithFFClickCatcher("fas fa-expand fa-lg",o):this.iconWithFFClickCatcher("fas fa-compress fa-lg",i),l.a.createElement("span",{className:"header-action-drawer__separator"}),this.iconWithFFClickCatcher("fas fa-plus fa-lg",s),l.a.createElement("div",{className:"header-action-drawer__deadline-scheduled-button",onClick:c},"Deadline"),l.a.createElement("span",{className:"header-action-drawer__separator"}),l.a.createElement("div",{className:"header-action-drawer__deadline-scheduled-button",onClick:u},"Scheduled")))}}]),t}(s.PureComponent)),Za=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).SWIPE_ACTION_ACTIVATION_DISTANCE=80,n.FREE_DRAG_ACTIVATION_DISTANCE=10,$.a.bindAll(Object(g.a)(n),["handleRef","handleMouseDown","handleMouseMove","handleMouseUp","handleMouseOut","handleTouchMove","handleTouchStart","handleTouchEnd","handleTouchCancel","handleHeaderClick","handleEnterTitleEditMode","handleEnterDescriptionEditMode","handleShowTagsModal","handleFocus","handleUnfocus","handleAddNewHeader","handleRest","handleDeadlineClick","handleScheduledClick"]),n.state={isDraggingFreely:!1,dragStartX:null,dragStartY:null,currentDragX:null,containerWidth:null,isPlayingRemoveAnimation:!1,heightBeforeRemove:null},n}return Object(b.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){this.containerDiv&&this.setState({containerWidth:this.containerDiv.offsetWidth})}},{key:"handleRef",value:function(e){this.containerDiv=e,this.props.onRef(e)}},{key:"handleDragStart",value:function(e,t,n){this.props.shouldDisableActions||this.props.inEditMode||e.target.closest(".table-part")||this.setState({dragStartX:t,dragStartY:n})}},{key:"handleDragMove",value:function(e,t){var n=this.state,a=n.dragStartX,r=n.dragStartY;null!==a&&(this.state.isDraggingFreely||Math.abs(e-a)>=this.FREE_DRAG_ACTIVATION_DISTANCE&&this.setState({isDraggingFreely:!0}),Math.abs(t-r)>=this.SWIPE_ACTION_ACTIVATION_DISTANCE/2?this.setState({dragStartX:null}):this.setState({currentDragX:e}))}},{key:"handleDragEnd",value:function(){var e=this.state,t=e.dragStartX,n=e.currentDragX;if(t&&n){var a=n-t;a>=this.SWIPE_ACTION_ACTIVATION_DISTANCE&&this.props.org.advanceTodoState(this.props.header.get("id")),-1*a>=this.SWIPE_ACTION_ACTIVATION_DISTANCE&&this.setState({isPlayingRemoveAnimation:!0,heightBeforeRemove:this.containerDiv.offsetHeight})}this.setState({dragStartX:null,currentDragX:null,isDraggingFreely:!1})}},{key:"handleDragCancel",value:function(){this.setState({dragStartX:null,currentDragX:null,isDraggingFreely:!1})}},{key:"handleMouseDown",value:function(e){this.handleDragStart(e,e.clientX,e.clientY)}},{key:"handleMouseMove",value:function(e){this.handleDragMove(e.clientX,e.clientY)}},{key:"handleMouseUp",value:function(){this.handleDragEnd()}},{key:"handleMouseOut",value:function(){this.handleDragCancel()}},{key:"handleTouchStart",value:function(e){this.handleDragStart(e,e.changedTouches[0].clientX,e.changedTouches[0].clientY)}},{key:"handleTouchMove",value:function(e){this.handleDragMove(e.changedTouches[0].clientX,e.changedTouches[0].clientY)}},{key:"handleTouchEnd",value:function(){this.handleDragEnd()}},{key:"handleTouchCancel",value:function(){this.handleDragCancel()}},{key:"handleHeaderClick",value:function(e){var t=e.target.classList;if(t.contains("header")||t.contains("header__bullet")){var n=this.props,a=n.header,r=n.hasContent,i=n.isSelected;!r||a.get("opened")&&!i||this.props.org.toggleHeaderOpened(a.get("id")),this.props.org.selectHeader(a.get("id"))}}},{key:"handleEnterTitleEditMode",value:function(){this.props.org.enterEditMode("title")}},{key:"handleEnterDescriptionEditMode",value:function(){this.props.org.openHeader(this.props.header.get("id")),this.props.org.enterEditMode("description")}},{key:"handleShowTagsModal",value:function(){this.props.base.activatePopup("tags-editor")}},{key:"handleFocus",value:function(){this.props.org.focusHeader(this.props.header.get("id"))}},{key:"handleUnfocus",value:function(){this.props.org.unfocusHeader()}},{key:"handleAddNewHeader",value:function(){this.props.org.addHeaderAndEdit(this.props.header.get("id"))}},{key:"handleRest",value:function(){this.state.isPlayingRemoveAnimation&&this.props.org.removeHeader(this.props.header.get("id"))}},{key:"handleDeadlineAndScheduledClick",value:function(e){var t=this.props.header,n=t.get("planningItems",[]).findIndex(function(t){return t.get("type")===e});-1===n?(this.props.org.addNewPlanningItem(t.get("id"),e),this.props.base.activatePopup("timestamp-editor",{headerId:t.get("id"),planningItemIndex:t.get("planningItems").size})):this.props.base.activatePopup("timestamp-editor",{headerId:t.get("id"),planningItemIndex:n}),this.props.org.openHeader(t.get("id"))}},{key:"handleDeadlineClick",value:function(){this.handleDeadlineAndScheduledClick("DEADLINE")}},{key:"handleScheduledClick",value:function(){this.handleDeadlineAndScheduledClick("SCHEDULED")}},{key:"render",value:function(){var e=this,t=this.props,n=t.header,a=t.color,r=t.hasContent,i=t.isSelected,o=t.bulletStyle,s=t.focusedHeader,c=t.isFocused,u=t.shouldDisableActions,d=s?n.get("nestingLevel")-s.get("nestingLevel")+1:n.get("nestingLevel"),p=this.state,h=p.dragStartX,m=p.currentDragX,f=p.isDraggingFreely,g=p.isPlayingRemoveAnimation,b=p.containerWidth,v={paddingLeft:20*d,marginLeft:h&&m&&f?m-h:g?Object(Na.spring)(-1*b,{stiffness:300}):Object(Na.spring)(0,{stiffness:300}),heightFactor:g?Object(Na.spring)(0,{stiffness:300}):1},y=Ta()("header",{"header--selected":i,"header--removing":g});return l.a.createElement(Na.Motion,{style:v,onRest:this.handleRest},function(t){var s=t.marginLeft,d=s>=e.SWIPE_ACTION_ACTIVATION_DISTANCE,p=-1*s>=e.SWIPE_ACTION_ACTIVATION_DISTANCE,h=xa(211,211,211,1),m=xa(0,128,0,1),f=xa(255,0,0,1),b={width:t.marginLeft,backgroundColorFactor:Object(Na.spring)(d?1:0,{stiffness:300})},v={width:-1*t.marginLeft,backgroundColorFactor:Object(Na.spring)(p?1:0,{stiffness:300})},E={display:s>30?"":"none"},_={display:-1*s>30?"":"none"},T=t.heightFactor,w=Object(I.a)(t,["heightFactor"]);return g&&(w.height=e.state.heightBeforeRemove*T),l.a.createElement("div",{className:y,style:w,ref:e.handleRef,onClick:e.handleHeaderClick,onMouseDown:e.handleMouseDown,onMouseMove:e.handleMouseMove,onMouseUp:e.handleMouseUp,onMouseOut:e.handleMouseOut,onTouchStart:e.handleTouchStart,onTouchMove:e.handleTouchMove,onTouchEnd:e.handleTouchEnd,onTouchCancel:e.handleTouchCancel},l.a.createElement(Na.Motion,{style:b},function(e){var t={width:e.width,backgroundColor:Fa(ja(h,m,e.backgroundColorFactor))};return l.a.createElement("div",{className:"left-swipe-action-container",style:t},l.a.createElement("i",{className:"fas fa-check swipe-action-container__icon swipe-action-container__icon--left",style:E}))}),l.a.createElement(Na.Motion,{style:v},function(e){var t={width:e.width,backgroundColor:Fa(ja(h,f,e.backgroundColorFactor))};return l.a.createElement("div",{className:"right-swipe-action-container",style:t},l.a.createElement("i",{className:"fas fa-times swipe-action-container__icon swipe-action-container__icon--right",style:_}))}),l.a.createElement("div",{style:{marginLeft:-16,color:a},className:"header__bullet"},"Fancy"===o?"\u25cf":"*"),l.a.createElement(Ka,{header:n,color:a,hasContent:r,isSelected:i,shouldDisableActions:u}),l.a.createElement(Pa.UnmountClosed,{isOpened:i&&!u,springConfig:{stiffness:300},style:{marginRight:v.width}},l.a.createElement(Qa,{onEnterTitleEditMode:e.handleEnterTitleEditMode,onEnterDescriptionEditMode:e.handleEnterDescriptionEditMode,isFocused:c,onTagsClick:e.handleShowTagsModal,onFocus:e.handleFocus,onUnfocus:e.handleUnfocus,onAddNewHeader:e.handleAddNewHeader,onDeadlineClick:e.handleDeadlineClick,onScheduledClick:e.handleScheduledClick})),l.a.createElement(qa,{header:n,shouldDisableActions:u}))})}}]),t}(s.PureComponent),$a=Object(v.b)(function(e,t){var n=e.org.present.get("focusedHeaderId")?ve(e.org.present.get("headers"),e.org.present.get("focusedHeaderId")):null;return{bulletStyle:e.base.get("bulletStyle"),focusedHeader:n,isFocused:!!n&&n.get("id")===t.header.get("id"),inEditMode:!!e.org.present.get("editMode")}},function(e){return{org:Object(y.b)(r,e),base:Object(y.b)(a,e)}})(Za),er=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(f.a)(t).call(this,e))).headerRefs={},$.a.bindAll(Object(g.a)(n),["handleHeaderRef"]),n}return Object(b.a)(t,e),Object(h.a)(t,[{key:"componentDidUpdate",value:function(e){if(e.selectedHeaderId!==this.props.selectedHeaderId){var t=this.headerRefs[this.props.selectedHeaderId];if(t){var n=t.getBoundingClientRect(),a=document.documentElement.clientHeight;(n.top>.9*a||n.bottom<0)&&t.scrollIntoView()}}}},{key:"handleHeaderRef",value:function(e){var t=this;return function(n){return t.headerRefs[e]=n}}},{key:"render",value:function(){var e=this,t=this.props,n=t.headers,a=t.selectedHeaderId,r=t.focusedHeaderId,i=t.shouldDisableActions,o=n.map(function(e){return{header:e,displayed:!1,hasContent:!!e.get("rawDescription")||0!==e.get("planningItems").size||0!==e.get("propertyListItems").size}}).toArray();if(o.forEach(function(e,t){var n=e.header.get("nestingLevel");o.slice(0,t).every(function(e){return e.header.get("nestingLevel")>=n})&&(e.displayed=!0);for(var a=o.slice(t+1),r=0;r<a.length;++r){var i=a[r];if(i.header.get("nestingLevel")<=n)break;e.hasContent=!0,i.displayed=e.header.get("opened")&&e.displayed}}),r){var s=o.findIndex(function(e){return e.header.get("id")===r});o.slice(0,s).forEach(function(e){return e.displayed=!1});var c=Ee(n,r);o.slice(s+c+1).forEach(function(e){return e.displayed=!1})}var u=["rgba(38, 143, 214, 1)","rgba(42, 164, 168, 1)","rgba(181, 142, 78, 1)","rgba(220, 64, 95, 1)","rgba(101, 128, 152, 1)","rgba(146, 164, 175, 1)","rgba(203, 85, 83, 1)","rgba(108, 119, 202, 1)"],d=o.filter(function(e){return e.displayed}),p=Ta()("header-list-container",{"header-list-container--focused":!!r});return l.a.createElement("div",{className:p},d.map(function(t,n){var r=t.header,o=u[(r.get("nestingLevel")-1)%u.length];return l.a.createElement($a,{key:r.get("id"),header:r,color:o,hasContent:t.hasContent,isSelected:r.get("id")===a,onRef:e.handleHeaderRef(r.get("id")),shouldDisableActions:i})}))}}]),t}(s.PureComponent),tr=Object(v.b)(function(e,t){return{headers:e.org.present.get("headers"),selectedHeaderId:e.org.present.get("selectedHeaderId"),focusedHeaderId:e.org.present.get("focusedHeaderId")}},function(e){return{}})(er),nr=(n(307),n(308),function(e){function t(e){var n;return Object(p.a)(this,t),n=Object(m.a)(this,Object(f.a)(t).call(this,e)),$.a.bindAll(Object(g.a)(n),["handleClick"]),n}return Object(b.a)(t,e),Object(h.a)(t,[{key:"handleClick",value:function(){var e=this.props,t=e.onClick;e.isDisabled||t()}},{key:"render",value:function(){var e,t=this.props,n=t.iconName,a=t.subIconName,r=t.isDisabled,i=t.shouldRotateSubIcon,o=t.letter,s=t.additionalClassName,c=t.style,u=t.tooltip,d=t.shouldSpinSubIcon,p=t.onRef,h=Ta()("btn","btn--circle","action-drawer__btn",s||"",(e={fas:!o,"fa-lg":!o},Object(_.a)(e,"fa-".concat(n),!o),Object(_.a)(e,"action-drawer__btn--with-sub-icon",!!a),Object(_.a)(e,"btn--disabled",r),Object(_.a)(e,"action-drawer__btn--letter",!!o),e)),m=Ta()("fas","fa-xs","fa-".concat(a),"action-drawer__btn__sub-icon",{"action-drawer__btn__sub-icon--rotated":i,"fa-spin":d});return l.a.createElement("button",{className:h,onClick:this.handleClick,style:c,title:u,ref:p},!!o&&o,!!a&&l.a.createElement("i",{className:m}))}}]),t}(s.PureComponent)),ar=Object(v.b)(function(e,t){return{inEditMode:!!e.org.present.get("editMode"),selectedHeaderId:e.org.present.get("selectedHeaderId"),isDirty:e.org.present.get("isDirty"),isFocusedHeaderActive:!!e.org.present.get("focusedHeaderId"),selectedTableCellId:e.org.present.get("selectedTableCellId"),selectedListItemId:e.org.present.get("selectedListItemId"),captureTemplates:e.capture.get("captureTemplates",new ee.List),path:e.org.present.get("path"),isLoading:e.base.get("isLoading")}},function(e){return{org:Object(y.b)(r,e),capture:Object(y.b)(i,e),base:Object(y.b)(a,e)}})(function(e){var t=e.org,n=e.selectedHeaderId,a=e.base,r=e.staticFile,i=e.captureTemplates,o=e.path,c=e.selectedTableCellId,u=e.selectedListItemId,p=e.inEditMode,h=e.isLoading,m=e.shouldDisableSyncButtons,f=Object(s.useState)(!1),g=Object(d.a)(f,2),b=g[0],v=g[1],y=Object(s.useState)(!1),E=Object(d.a)(y,2),_=E[0],I=E[1];Object(s.useEffect)(function(){t.noOp()},[]),Object(s.useEffect)(function(){return document.querySelector("html").style.paddingBottom="90px",function(){return document.querySelector("html").style.paddingBottom="0px"}});var w=Object(s.useRef)(null),k=Object(s.useMemo)(function(){return w.current?w.current.getBoundingClientRect():null},[w.current]),S=function(){return n?t.moveHeaderUp(n):c?t.moveTableRowUp():t.moveListItemUp()},D=function(){return n?t.moveHeaderDown(n):c?t.moveTableRowDown():t.moveListItemDown()},C=function(){return n?t.moveHeaderLeft(n):c?t.moveTableColumnLeft():t.moveListItemLeft()},O=function(){return n?t.moveHeaderRight(n):c?t.moveTableColumnRight():t.moveListItemRight()},A=function(){return n?t.moveSubtreeLeft(n):t.moveListSubtreeLeft()},N=function(){return n?t.moveSubtreeRight(n):t.moveListSubtreeRight()},L=function(){return"sample"===r?He:i.filter(function(e){return e.get("isAvailableInAllOrgFiles")||e.get("orgFilesWhereAvailable").map(function(e){return e.trim().startsWith("/")?e.trim():"/"+e.trim()}).includes((o||"").trim())})},M=function(){return v(!b)},P=function(){_||0!==L().size?I(!_):alert("You don't have any capture templates set up for this file! Add some in Settings > Capture Templates")};return l.a.createElement("div",{className:"action-drawer-container nice-scroll"},p?l.a.createElement("button",{className:"btn action-drawer__done-btn",onClick:function(){return t.exitEditMode()}},"Done"):l.a.createElement(s.Fragment,null,l.a.createElement(nr,{iconName:"cloud",subIconName:"sync-alt",shouldSpinSubIcon:h,isDisabled:m,onClick:function(){return t.sync()},style:{opacity:b||_?0:1},tooltip:"Sync changes"}),function(){var e={opacity:_?0:1};b||(e.boxShadow="none");var t=0;k&&(t=window.screen.width/2-(k.x+k.width/2));var n={centerXOffset:Object(Na.spring)(b?t:0,{stiffness:300}),topRowYOffset:Object(Na.spring)(b?150:0,{stiffness:300}),bottomRowYOffset:Object(Na.spring)(b?80:0,{stiffness:300}),firstColumnXOffset:Object(Na.spring)(b?70:0,{stiffness:300}),secondColumnXOffset:Object(Na.spring)(b?140:0,{stiffness:300})},a=null,r="Move header up",i="Move header down",o="Move header left",d="Move header right";return c?(a="table",r="Move row up",i="Move row down",o="Move column left",d="Move column right"):u&&(a="list",r="Move list up",i="Move list down",o="Move list left",d="Move list right"),l.a.createElement(Na.Motion,{style:n},function(t){return l.a.createElement("div",{className:"action-drawer__arrow-buttons-container",style:{left:t.centerXOffset}},l.a.createElement(nr,{additionalClassName:"action-drawer__arrow-button",iconName:"arrow-up",subIconName:a,isDisabled:!1,onClick:S,style:Object(T.a)({},e,{bottom:t.topRowYOffset}),tooltip:r}),l.a.createElement(nr,{additionalClassName:"action-drawer__arrow-button",iconName:"arrow-down",subIconName:a,isDisabled:!1,onClick:D,style:Object(T.a)({},e,{bottom:t.bottomRowYOffset}),tooltip:i}),l.a.createElement(nr,{additionalClassName:"action-drawer__arrow-button",iconName:"arrow-left",subIconName:a,isDisabled:!1,onClick:C,style:Object(T.a)({},e,{bottom:t.bottomRowYOffset,right:t.firstColumnXOffset}),tooltip:o}),l.a.createElement(nr,{additionalClassName:"action-drawer__arrow-button",iconName:"arrow-right",subIconName:a,isDisabled:!1,onClick:O,style:Object(T.a)({},e,{bottom:t.bottomRowYOffset,left:t.firstColumnXOffset}),tooltip:d}),!c&&l.a.createElement(s.Fragment,null,l.a.createElement(nr,{additionalClassName:"action-drawer__arrow-button",iconName:"chevron-left",subIconName:a,isDisabled:!1,onClick:A,style:Object(T.a)({},e,{bottom:t.bottomRowYOffset,right:t.secondColumnXOffset}),tooltip:"Move entire subtree left"}),l.a.createElement(nr,{additionalClassName:"action-drawer__arrow-button",iconName:"chevron-right",subIconName:a,isDisabled:!1,onClick:N,style:Object(T.a)({},e,{bottom:t.bottomRowYOffset,left:t.secondColumnXOffset}),tooltip:"Move entire subtree right"})),l.a.createElement(nr,{iconName:b?"times":"arrows-alt",subIconName:a,additionalClassName:"action-drawer__main-arrow-button",isDisabled:!1,onClick:M,style:{opacity:_?0:1},tooltip:b?"Hide movement buttons":"Show movement buttons",onRef:w}))})}(),l.a.createElement(nr,{iconName:"calendar-alt",shouldSpinSubIcon:h,isDisabled:!1,onClick:function(){return a.activatePopup("agenda")},style:{opacity:b||_?0:1},tooltip:"Show agenda"}),function(){var e=L(),t={position:"absolute",zIndex:0,left:0,opacity:b?0:1};_||(t.boxShadow="none");var n={opacity:b?0:1,position:"relative",zIndex:1},r={bottom:Object(Na.spring)(_?70:0,{stiffness:300})};return l.a.createElement(Na.Motion,{style:r},function(r){return l.a.createElement("div",{className:"action-drawer__capture-buttons-container"},l.a.createElement(nr,{iconName:_?"times":"list-ul",isDisabled:!1,onClick:P,style:n,tooltip:_?"Hide capture templates":"Show capture templates"}),e.map(function(e,n){return l.a.createElement(nr,{key:e.get("id"),letter:e.get("letter"),iconName:e.get("iconName"),isDisabled:!1,onClick:(i=e.get("id"),function(){I(!1),a.activatePopup("capture",{templateId:i})}),style:Object(T.a)({},t,{bottom:r.bottom*(n+1)}),tooltip:'Activate "'.concat(e.get("description"),'" capture template')});var i}))})}()))}),rr=(n(309),n(310),function(e){var t=e.isEnabled,n=e.onToggle,a=xa(255,255,255,1),r=xa(94,52,140,1),i={colorFactor:Object(Na.spring)(t?1:0,{stiffness:300})},o={marginLeft:Object(Na.spring)(t?42:0,{stiffness:300})};return l.a.createElement(Na.Motion,{style:i},function(e){var t=Fa(ja(a,r,e.colorFactor));return l.a.createElement("div",{className:"switch",style:{backgroundColor:t},onClick:n},l.a.createElement(Na.Motion,{style:o},function(e){return l.a.createElement("div",{className:"switch__grabber",style:e})}))})}),ir=(n(311),function(e){var t=e.children,n=e.shouldIncludeCloseButton,a=e.onClose,r=Object(s.useState)(!1),i=Object(d.a)(r,2),o=i[0],c=i[1],u=Object(s.useState)(null),p=Object(d.a)(u,2),h=p[0],m=p[1];Object(s.useLayoutEffect)(function(){c(!0)},[]);var f=Object(s.useRef)(),g=Object(s.useRef)(),b=Object(s.useRef)();Object(s.useLayoutEffect)(function(){b.current=g.current.offsetHeight});var v=function(e){return e.stopPropagation()},y=function(){return c(!1)},E=function(e){return f.current=e.targetTouches[0].clientY},_=function(e){if(!e.target.classList.contains("drag-handle")){var t=f.current>e.targetTouches[0].clientY;t&&g.current.scrollHeight-g.current.scrollTop<=g.current.clientHeight?e.preventDefault():t||0!==g.current.scrollTop||(e.preventDefault(),m(e.targetTouches[0].clientY-f.current))}},T=function(e){return c(h<=.3*b.current),void m(null)};Object(s.useEffect)(function(){return g.current?(g.current.addEventListener("touchstart",E),g.current.addEventListener("touchmove",_),g.current.addEventListener("touchend",T),g.current.addEventListener("touchcancel",T),function(){g.current.removeEventListener("touchstart",E),g.current.removeEventListener("touchmove",_),g.current.removeEventListener("touchend",T),g.current.removeEventListener("touchcancel",T)}):null},[g.current,h]),Object(s.useEffect)(function(){setTimeout(function(){g.current.style.left="0",setTimeout(function(){g.current.style.left="-1px"},0)},0)},[t]);var I=Ta()("drawer-outer-container",{"drawer-outer-container--visible":o}),w={offsetY:h||Object(Na.spring)(o?0:b.current||window.innerHeight,{stiffness:300})};return l.a.createElement(Na.Motion,{style:w,onRest:function(){return!o&&a?a():void 0}},function(e){var r={transform:"translateY(".concat(e.offsetY,"px)")};return l.a.createElement("div",{className:I,onClick:a?y:null},l.a.createElement("div",{onClick:v,className:"drawer-inner-container nice-scroll",ref:g,style:r},l.a.createElement("div",{className:"drawer__grabber"}),n&&l.a.createElement("button",{className:"fas fa-times fa-lg drawer__close-button",onClick:y}),t))})}),or=function(e){var t=e.template,n=e.onCapture,a=e.headers,r=e.onClose,i=Object(s.useMemo)(function(){return fe(t.get("template"))},[t.get("template")]),o=Object(d.a)(i,2),c=o[0],u=o[1],p=0===t.get("headerPaths").filter(function(e){return 0!==e.length}).size,h=Object(s.useMemo)(function(){return we(a,t.get("headerPaths"))},[a,t.get("headerPaths")]),m=Object(s.useState)(c),f=Object(d.a)(m,2),g=f[0],b=f[1],v=Object(s.useState)(t.get("shouldPrepend")),y=Object(d.a)(v,2),E=y[0],_=y[1],T=Object(s.useRef)(null);Object(s.useEffect)(function(){T.current&&(T.current.focus(),null!==u&&(T.current.selectionStart=u,T.current.selectionEnd=u))},[T]);return l.a.createElement(ir,{onClose:r},l.a.createElement("div",{className:"capture-modal-header"},l.a.createElement(nr,{letter:t.get("letter"),iconName:t.get("iconName"),isDisabled:!1,onClick:function(){},style:{marginRight:20}}),l.a.createElement("span",null,t.get("description"))),l.a.createElement("div",{className:Ta()("capture-modal-header-path",{"capture-modal-header-path--top-level":p})},p?"Top level header":t.get("headerPaths").join(" > ")),h||p?l.a.createElement(s.Fragment,null,l.a.createElement("textarea",{className:"textarea capture-modal-textarea",rows:"4",value:g,onChange:function(e){return b(e.target.value)},ref:T}),l.a.createElement("div",{className:"capture-modal-button-container"},l.a.createElement("div",{className:"capture-modal-prepend-container"},l.a.createElement("span",{className:"capture-modal-prepend-label"},"Prepend:"),l.a.createElement(rr,{isEnabled:E,onToggle:function(){return _(!E)}})),l.a.createElement("button",{className:"btn capture-modal-button",onClick:function(){return n(t.get("id"),g,E)}},"Capture"))):l.a.createElement("div",{className:"capture-modal-error-message"},"The specified header path doesn't exist in this org file!"),l.a.createElement("br",null))},sr=(n(312),function(e){var t=e.lastServerModifiedAt,n=e.onPull,a=e.onPush,r=e.onCancel;return l.a.createElement(ir,null,l.a.createElement("h2",{className:"sync-confirmation-modal__header"},"Sync conflict"),"Since you last pulled, a newer version of the file has been pushed to the server. The newer version is from:",l.a.createElement("br",null),l.a.createElement("br",null),l.a.createElement("div",{className:"sync-confirmation-modal__last-sync-time"},ne()(t,"MMMM Do, YYYY [at] h:mm:ss a"),l.a.createElement("br",null),"(",Object(se.distanceInWordsToNow)(t)," ago)"),l.a.createElement("div",{className:"sync-confirmation-modal__buttons-container"},l.a.createElement("button",{className:"btn sync-confirmation-modal__button",onClick:n},"Pull latest version from server"),l.a.createElement("button",{className:"btn sync-confirmation-modal__button",onClick:a},"Overwrite server version"),l.a.createElement("button",{className:"btn sync-confirmation-modal__button",onClick:r},"Cancel sync")),l.a.createElement("br",null))}),lr=(n(313),function(e){function t(e){var n;return Object(p.a)(this,t),n=Object(m.a)(this,Object(f.a)(t).call(this,e)),$.a.bindAll(Object(g.a)(n),["handleRemoveTag","handleAddNewTag","handleTagChange"]),n.state={allTags:e.allTags},n}return Object(b.a)(t,e),Object(h.a)(t,[{key:"componentDidUpdate",value:function(e){var t=e.header.getIn(["titleLine","tags"]),n=this.props.header.getIn(["titleLine","tags"]);t.size===n.size-1&&""===n.last()&&this.lastTextfield&&this.lastTextfield.focus()}},{key:"handleTagChange",value:function(e){var t=this;return function(n){var a=t.props.header.getIn(["titleLine","tags"]);t.props.onChange(a.set(e,n.target.value.replace(/(\s+|:)/g,"")))}}},{key:"handleRemoveTag",value:function(e){var t=this;return function(){var n=t.props.header.getIn(["titleLine","tags"]);t.props.onChange(n.delete(e))}}},{key:"handleAddNewTag",value:function(){var e=this.props.header.getIn(["titleLine","tags"]);this.props.onChange(e.push(""))}},{key:"handleExistingTagClick",value:function(e){var t=this;return function(){var n=t.props.header.getIn(["titleLine","tags"]);n.includes(e)?t.props.onChange(n.filter(function(t){return t!==e})):t.props.onChange(n.push(e))}}},{key:"render",value:function(){var e=this,t=this.props,n=t.header,a=t.onClose,r=this.state.allTags,i=n.getIn(["titleLine","tags"]);return l.a.createElement(ir,{onClose:a},l.a.createElement("h2",{className:"drawer-modal__title"},"Edit tags"),0===i.size?l.a.createElement("div",{className:"no-tags-message"},"This header doesn't have any tags.",l.a.createElement("br",null),l.a.createElement("br",null),"Click the ",l.a.createElement("i",{className:"fas fa-plus"})," button to add a new one, or choose from the list of all of your tags below."):l.a.createElement(ta.c,{droppableId:"tags-editor-droppable",type:"TAG"},function(t,n){return l.a.createElement("div",Object.assign({className:"tags-container",ref:t.innerRef},t.droppableProps),l.a.createElement(s.Fragment,null,i.map(function(t,n){return l.a.createElement(ta.b,{draggableId:"tag--".concat(n),index:n,key:n},function(a,r){return l.a.createElement("div",Object.assign({className:Ta()("tag-container",{"tag-container--dragging":r.isDragging}),ref:a.innerRef},a.draggableProps),l.a.createElement("input",{type:"text",className:"textfield tag-container__textfield",value:t,onChange:e.handleTagChange(n),ref:function(t){return e.lastTextfield=t}}),l.a.createElement("div",{className:"tag-container__actions-container"},l.a.createElement("i",{className:"fas fa-times fa-lg",onClick:e.handleRemoveTag(n)}),l.a.createElement("i",Object.assign({className:"fas fa-bars fa-lg tag-container__drag-handle drag-handle"},a.dragHandleProps))))})}),t.placeholder))}),l.a.createElement("div",{className:"tags-editor__add-new-container"},l.a.createElement("button",{className:"fas fa-plus fa-lg btn btn--circle",onClick:this.handleAddNewTag})),l.a.createElement("hr",{className:"tags-editor__separator"}),l.a.createElement("h2",{className:"tags-editor__title"},"All tags"),l.a.createElement("div",{className:"all-tags-container"},r.filter(function(e){return!!e}).map(function(t){var n=Ta()("all-tags__tag",{"all-tags__tag--in-use":i.includes(t)});return l.a.createElement("div",{className:n,key:t,onClick:e.handleExistingTagClick(t)},t)})))}}]),t}(s.PureComponent)),cr=(n(348),n(349),n(350),function(e){var t=e.buttons,n=e.selectedButton,a=e.useEqualWidthTabs,r=e.onSelect,i=function(e){return function(){return r(e)}},o=Ta()("tab-buttons",{"tab-buttons--equal-width-tabs":a}),s={gridTemplateColumns:a?"repeat(".concat(t.length,", 1fr)"):null};return l.a.createElement("div",{className:o,style:s},t.map(function(e){var t=Ta()("tab-buttons__btn",{"tab-buttons__btn--selected":e===n});return l.a.createElement("div",{key:e,className:t,onClick:i(e)},e)}))}),ur=function(e){function t(e){var n;return Object(p.a)(this,t),n=Object(m.a)(this,Object(f.a)(t).call(this,e)),$.a.bindAll(Object(g.a)(n),["handleActiveToggle","handleDateChange","handleAddRepeater","handleRemoveRepeater","handleRepeaterTypeChange","handleRepeaterValueChange","handleRepeaterUnitChange","handleAddDelay","handleRemoveDelay","handleDelayTypeChange","handleDelayValueChange","handleDelayUnitChange"]),n}return Object(b.a)(t,e),Object(h.a)(t,[{key:"handleActiveToggle",value:function(){this.props.onChange(this.props.timestamp.update("isActive",function(e){return!e}))}},{key:"handleDateChange",value:function(e){var t=this.props,n=t.onChange,a=t.timestamp,r=ne()(oe()(e.target.value),"YYYY MM DD ddd").split(" "),i=Object(d.a)(r,4),o=i[0],s=i[1],l=i[2],c=i[3];n(a.set("year",o).set("month",s).set("day",l).set("dayName",c))}},{key:"handleAddTime",value:function(e){var t=this;return function(){var n=t.props,a=n.onChange,r=n.timestamp,i="start"===e?["startHour","startMinute"]:["endHour","endMinute"],o=Object(d.a)(i,2),s=o[0],l=o[1],c=ne()(new Date,"HH:mm").split(":"),u=Object(d.a)(c,2),p=u[0],h=u[1];a(r.set(s,p).set(l,h))}}},{key:"handleRemoveTime",value:function(e){var t=this;return function(){var n=t.props,a=n.onChange,r=n.timestamp,i="start"===e?["startHour","startMinute"]:["endHour","endMinute"],o=Object(d.a)(i,2),s=o[0],l=o[1];a(r.set(s,null).set(l,null))}}},{key:"handleTimeChange",value:function(e){var t=this;return function(n){var a=t.props,r=a.onChange,i=a.timestamp,o="start"===e?["startHour","startMinute"]:["endHour","endMinute"],s=Object(d.a)(o,2),l=s[0],c=s[1],u=n.target.value.split(":"),p=Object(d.a)(u,2),h=p[0],m=p[1];h=h.startsWith("0")?h.substring(1):h,r(i.set(l,h).set(c,m))}}},{key:"handleAddRepeater",value:function(){var e=this.props;(0,e.onChange)(e.timestamp.set("repeaterType","+").set("repeaterValue",1).set("repeaterUnit","h"))}},{key:"handleRemoveRepeater",value:function(){var e=this.props;(0,e.onChange)(e.timestamp.set("repeaterType",null).set("repeaterValue",null).set("repeaterUnit",null))}},{key:"handleRepeaterTypeChange",value:function(e){var t=this.props;(0,t.onChange)(t.timestamp.set("repeaterType",e))}},{key:"handleRepeaterValueChange",value:function(e){var t=this.props;(0,t.onChange)(t.timestamp.set("repeaterValue",e.target.value))}},{key:"handleRepeaterUnitChange",value:function(e){var t=this.props;(0,t.onChange)(t.timestamp.set("repeaterUnit",e))}},{key:"handleAddDelay",value:function(){var e=this.props;(0,e.onChange)(e.timestamp.set("delayType","-").set("delayValue",1).set("delayUnit","h"))}},{key:"handleRemoveDelay",value:function(){var e=this.props;(0,e.onChange)(e.timestamp.set("delayType",null).set("delayValue",null).set("delayUnit",null))}},{key:"handleDelayTypeChange",value:function(e){var t=this.props;(0,t.onChange)(t.timestamp.set("delayType",e))}},{key:"handleDelayValueChange",value:function(e){var t=this.props;(0,t.onChange)(t.timestamp.set("delayValue",e.target.value))}},{key:"handleDelayUnitChange",value:function(e){var t=this.props;(0,t.onChange)(t.timestamp.set("delayUnit",e))}},{key:"renderTimeField",value:function(e,t,n,a){var r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];return l.a.createElement("div",{className:"timestamp-editor__field-container timestamp-editor__field-container--inline"},l.a.createElement("div",{className:"timestamp-editor__field-title"},e),l.a.createElement("div",{className:"timestamp-editor__field"},n?l.a.createElement(s.Fragment,null,l.a.createElement("input",{type:"time",className:"timestamp-editor__time-input",value:"".concat(n.padStart(2,"0"),":").concat(a.padStart(2,"0")),onChange:this.handleTimeChange(t)}),r&&l.a.createElement("i",{className:"fas fa-times fa-lg timestamp-editor__icon timestamp-editor__icon--remove",onClick:this.handleRemoveTime(t)})):l.a.createElement("i",{className:"fas fa-plus timestamp-editor__icon timestamp-editor__icon--add",onClick:this.handleAddTime(t)})))}},{key:"renderRepeater",value:function(){var e=this.props.timestamp.toJS(),t=e.repeaterType,n=e.repeaterValue,a=e.repeaterUnit;return l.a.createElement("div",{className:"timestamp-editor__field-container"},l.a.createElement("div",{className:"timestamp-editor__field-title"},"Repeater"),l.a.createElement("div",{className:"timestamp-editor__field timestamp-editor__field--delay-repeater"},t?l.a.createElement(s.Fragment,null,l.a.createElement("div",{className:"timestamp-editor__delay-repeater-type"},l.a.createElement(cr,{buttons:["+","++",".+"],selectedButton:t||"+",onSelect:this.handleRepeaterTypeChange})),l.a.createElement("input",{type:"number",min:"1",className:"textfield delay-repeater-value-input",value:n||1,onChange:this.handleRepeaterValueChange}),l.a.createElement("div",null,l.a.createElement(cr,{buttons:"hdwmy".split(""),selectedButton:a||"h",onSelect:this.handleRepeaterUnitChange})),l.a.createElement("i",{className:"fas fa-times fa-lg timestamp-editor__icon timestamp-editor__icon--remove",onClick:this.handleRemoveRepeater})):l.a.createElement("i",{className:"fas fa-plus timestamp-editor__icon timestamp-editor__icon--add",onClick:this.handleAddRepeater})))}},{key:"renderDelay",value:function(){var e=this.props.timestamp.toJS(),t=e.delayType,n=e.delayValue,a=e.delayUnit;return l.a.createElement("div",{className:"timestamp-editor__field-container"},l.a.createElement("div",{className:"timestamp-editor__field-title"},"Delay"),l.a.createElement("div",{className:"timestamp-editor__field"},t?l.a.createElement(s.Fragment,null,l.a.createElement("div",{className:"timestamp-editor__delay-repeater-type"},l.a.createElement(cr,{buttons:["-","--"],selectedButton:t||"-",onSelect:this.handleDelayTypeChange})),l.a.createElement("input",{type:"number",min:"1",className:"textfield delay-repeater-value-input",value:n||1,onChange:this.handleDelayValueChange}),l.a.createElement("div",null,l.a.createElement(cr,{buttons:"hdwmy".split(""),selectedButton:a||"h",onSelect:this.handleDelayUnitChange})),l.a.createElement("i",{className:"fas fa-times fa-lg timestamp-editor__icon timestamp-editor__icon--remove",onClick:this.handleRemoveDelay})):l.a.createElement("i",{className:"fas fa-plus timestamp-editor__icon timestamp-editor__icon--add",onClick:this.handleAddDelay})))}},{key:"render",value:function(){var e=this.props.timestamp,t=e.toJS(),n=t.isActive,a=t.year,r=t.month,i=t.day,o=t.startHour,s=t.startMinute,c=t.endHour,u=t.endMinute;return l.a.createElement("div",null,l.a.createElement("div",{className:"timestamp-editor__render"},le(e)),l.a.createElement("div",{className:"timestamp-editor__date-time-fields-container"},l.a.createElement("div",{className:"timestamp-editor__field-container timestamp-editor__field-container--inline"},l.a.createElement("div",{className:"timestamp-editor__field-title"},"Active"),l.a.createElement("div",{className:"timestamp-editor__field"},l.a.createElement(rr,{isEnabled:n,onToggle:this.handleActiveToggle}))),l.a.createElement("div",{className:"timestamp-editor__field-container timestamp-editor__field-container--inline"},l.a.createElement("div",{className:"timestamp-editor__field-title"},"Date"),l.a.createElement("div",{className:"timestamp-editor__field"},l.a.createElement("input",{type:"date",className:"timestamp-editor__date-input",onChange:this.handleDateChange,value:"".concat(a,"-").concat(r,"-").concat(i)}))),this.renderTimeField("Start time","start",o,s,!c),!!o&&this.renderTimeField("End time","end",c,u)),this.renderRepeater(),this.renderDelay())}}]),t}(s.PureComponent),dr=function(e){function t(e){var n;return Object(p.a)(this,t),n=Object(m.a)(this,Object(f.a)(t).call(this,e)),$.a.bindAll(Object(g.a)(n),["handleAddEndTimestamp","handleRemoveEndTimestamp"]),n}return Object(b.a)(t,e),Object(h.a)(t,[{key:"handleChange",value:function(e){var t=this;return function(n){return t.props.onChange(t.props.timestamp.set(e,n))}}},{key:"handleAddEndTimestamp",value:function(){var e=this.props.timestamp,t=ne()(new Date,"YYYY MM DD ddd").split(" "),n=Object(d.a)(t,4),a=n[0],r=n[1],i=n[2],o=n[3];this.props.onChange(e.set("secondTimestamp",Object(ee.Map)({year:a,month:r,day:i,dayName:o,isActive:e.getIn(["firstTimestamp","isActive"])})))}},{key:"handleRemoveEndTimestamp",value:function(){this.props.onChange(this.props.timestamp.set("secondTimestamp",null))}},{key:"render",value:function(){var e=this.props,t=e.timestamp,n=e.onClose,a=e.singleTimestampOnly;return l.a.createElement(ir,{onClose:n},l.a.createElement("h2",{className:"timestamp-editor__title"},"Edit timestamp"),l.a.createElement(ur,{timestamp:t.get("firstTimestamp"),onChange:this.handleChange("firstTimestamp")}),!a&&(t.get("secondTimestamp")?l.a.createElement(s.Fragment,null,l.a.createElement("div",{className:"timestamp-editor__separator"},l.a.createElement("div",{className:"timestamp-editor__separator__margin-line"}),"to",l.a.createElement("div",{className:"timestamp-editor__separator__margin-line"})),l.a.createElement(ur,{timestamp:t.get("secondTimestamp"),onChange:this.handleChange("secondTimestamp")}),l.a.createElement("div",{className:"timestamp-editor__button-container"},l.a.createElement("button",{className:"btn timestamp-editor__add-new-button",onClick:this.handleRemoveEndTimestamp},"Remove end timestamp"))):l.a.createElement("div",{className:"timestamp-editor__button-container"},l.a.createElement("button",{className:"btn timestamp-editor__add-new-button",onClick:this.handleAddEndTimestamp},"Add end timestamp"))),l.a.createElement("br",null))}}]),t}(s.PureComponent),pr=(n(351),function(e){function t(e){var n;return Object(p.a)(this,t),n=Object(m.a)(this,Object(f.a)(t).call(this,e)),$.a.bindAll(Object(g.a)(n),["handleAddNewItem"]),n}return Object(b.a)(t,e),Object(h.a)(t,[{key:"componentDidUpdate",value:function(e){var t=e.propertyListItems,n=this.props.propertyListItems;t.size===n.size-1&&""===n.last().get("property")&&this.lastTextfield&&this.lastTextfield.focus()}},{key:"handlePropertyChange",value:function(e){var t=this;return function(n){var a=t.props.propertyListItems.findIndex(function(t){return t.get("id")===e});t.props.onChange(t.props.propertyListItems.setIn([a,"property"],n.target.value))}}},{key:"handleValueChange",value:function(e){var t=this;return function(n){var a=t.props,r=a.propertyListItems,i=a.onChange,o=r.findIndex(function(t){return t.get("id")===e});i(r.setIn([o,"value"],Object(ee.fromJS)(_n(n.target.value))))}}},{key:"handleRemoveItem",value:function(e){var t=this;return function(){return t.props.onChange(t.props.propertyListItems.filter(function(t){return t.get("id")!==e}))}}},{key:"handleAddNewItem",value:function(){this.props.onChange(this.props.propertyListItems.push(Object(ee.fromJS)({property:"",value:"",id:ge()})))}},{key:"render",value:function(){var e=this,t=this.props,n=t.onClose,a=t.propertyListItems;return l.a.createElement(ir,{onClose:n},l.a.createElement("h2",{className:"drawer-modal__title"},"Edit property list"),0===a.size?l.a.createElement("div",{className:"no-items-message"},"There are no items in this property list.",l.a.createElement("br",null),l.a.createElement("br",null),"Click the ",l.a.createElement("i",{className:"fas fa-plus"})," button to add a new one."):l.a.createElement(ta.c,{droppableId:"property-list-editor-droppable",type:"PROPERTY-LIST"},function(t,n){return l.a.createElement("div",Object.assign({className:"property-list-editor__items-container",ref:t.innerRef},t.droppableProps),l.a.createElement(s.Fragment,null,a.map(function(t,n){return l.a.createElement(ta.b,{draggableId:"property-list-item--".concat(n),index:n,key:t.get("id")},function(n,a){return l.a.createElement("div",Object.assign({className:Ta()("property-list-editor__item-container",{"property-list-editor__item-container--dragging":a.isDragging}),ref:n.innerRef},n.draggableProps),l.a.createElement("div",{className:"item__textfields-container"},l.a.createElement("input",{type:"text",className:"textfield item-container__textfield",value:t.get("property"),onChange:e.handlePropertyChange(t.get("id")),ref:function(t){return e.lastTextfield=t}}),l.a.createElement("input",{type:"text",className:"textfield item-container__textfield",value:me(t.get("value")),onChange:e.handleValueChange(t.get("id"))})),l.a.createElement("div",{className:"item-container__actions-container"},l.a.createElement("i",{className:"fas fa-times fa-lg",onClick:e.handleRemoveItem(t.get("id"))}),l.a.createElement("i",Object.assign({className:"fas fa-bars fa-lg item-container__drag-handle drag-handle"},n.dragHandleProps))))})}),t.placeholder))}),l.a.createElement("div",{className:"property-list-editor__add-new-container"},l.a.createElement("button",{className:"fas fa-plus fa-lg btn btn--circle",onClick:this.handleAddNewItem})))}}]),t}(s.PureComponent)),hr=(n(352),n(353),function(e){function t(){return Object(p.a)(this,t),Object(m.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(b.a)(t,e),Object(h.a)(t,[{key:"handleHeaderClick",value:function(e){var t=this;return function(){return t.props.onHeaderClick(e)}}},{key:"render",value:function(){var e=this,t=this.props,n=t.date,a=t.headers,r=t.todoKeywordSets,i=t.dateDisplayType,o=t.onToggleDateDisplayType,c=t.agendaDefaultDeadlineDelayValue,u=t.agendaDefaultDeadlineDelayUnit,p=Object(se.startOfDay)(n),h=Object(se.endOfDay)(n),m=a.flatMap(function(e){return e.get("planningItems").filter(function(t){var a=t.get("timestamp");if(!a.get("isActive"))return!1;var i=de(a);if(!!e.getIn(["titleLine","todoKeyword"])&&function(e,t){return Re(e,t).get("completedKeywords").includes(t)}(r,e.getIn(["titleLine","todoKeyword"])))return!1;if("DEADLINE"===t.get("type")){if(Object(se.isToday)(n)){if(Object(se.isBefore)(i,new Date))return!0;var o=a.get("delayType")?[a.get("delayValue"),a.get("delayUnit")]:[c,u],s=Object(d.a)(o,2),l=function(e,t,n){return{h:Object(se.subHours)(e,t),d:Object(se.subDays)(e,t),w:Object(se.subWeeks)(e,t),m:Object(se.subMonths)(e,t),y:Object(se.subYears)(e,t)}[n]}(i,s[0],s[1]);return Object(se.isAfter)(n,l)||Object(se.isEqual)(n,l)}return Object(se.isWithinRange)(i,p,h)}if("SCHEDULED"===t.get("type")){var m=i;if(a.get("delayType")){var f=e.get("propertyListItems").some(function(e){return"LAST_REPEAT"===e.get("property")});"--"!==a.get("delayType")||f||(m=pe(i,a.get("delayValue"),a.get("delayUnit")))}return!(!Object(se.isToday)(n)||!Object(se.isAfter)(n,m))||Object(se.isWithinRange)(m,p,h)}return!1}).map(function(t){return[t,e]})}).sortBy(function(e){var t=Object(d.a)(e,2),n=t[0],a=(t[1],n.get("timestamp").toJS()),r=a.startHour;return[r?0:1,r,a.startMinute,a.endHour,a.endMinute,a.month,a.day]});return l.a.createElement("div",{className:"agenda-day__container"},l.a.createElement("div",{className:"agenda-day__title"},Object(se.isToday)(n)&&l.a.createElement("div",{className:"agenda-day__today-indicator"}),l.a.createElement("div",{className:"agenda-day__title__day-name"},ne()(n,"dddd")),l.a.createElement("div",{className:"agenda-day__title__date"},ne()(n,"MMMM Do, YYYY"))),l.a.createElement("div",{className:"agenda-day__headers-container"},m.map(function(t){var n=Object(d.a)(t,2),a=n[0],r=n[1],c=de(a.get("timestamp")),u=!!r.getIn(["titleLine","todoKeyword"]),p=Ta()("agenda-day__header-planning-date",{"agenda-day__header-planning-date--overdue":u&&Object(se.isPast)(c)});return l.a.createElement("div",{key:a.get("id"),className:"agenda-day__header-container"},l.a.createElement("div",{className:"agenda-day__header__planning-item-container"},l.a.createElement("div",{className:"agenda-day__header-planning-type"},a.get("type")),l.a.createElement("div",{className:p,onClick:o},"absolute"===i?ne()(c,"MM/DD"):"".concat(Object(se.distanceInWordsToNow)(c)," ago"),!!a.getIn(["timestamp","startHour"])&&l.a.createElement(s.Fragment,null,l.a.createElement("br",null),ne()(c,"h:mma")))),l.a.createElement("div",{className:"agenda-day__header__header-container"},l.a.createElement(Ka,{header:r,color:"black",hasContent:!1,isSelected:!1,shouldDisableActions:!0,shouldDisableExplicitWidth:!0,onClick:e.handleHeaderClick(r.get("id"))})))})))}}]),t}(s.PureComponent)),mr=function(e){function t(e){var n;return Object(p.a)(this,t),n=Object(m.a)(this,Object(f.a)(t).call(this,e)),$.a.bindAll(Object(g.a)(n),["handleTimeframeTypeChange","handleNextDateClick","handlePreviousDateClick","handleHeaderClick","handleToggleDateDisplayType"]),n.state={selectedDate:new Date,timeframeType:"Week",dateDisplayType:"absolute"},n}return Object(b.a)(t,e),Object(h.a)(t,[{key:"handleTimeframeTypeChange",value:function(e){this.setState({timeframeType:e})}},{key:"handleNextDateClick",value:function(){var e=this.state,t=e.selectedDate;switch(e.timeframeType){case"Day":this.setState({selectedDate:Object(se.addDays)(t,1)});break;case"Week":this.setState({selectedDate:Object(se.addWeeks)(t,1)});break;case"Month":this.setState({selectedDate:Object(se.addMonths)(t,1)});break;default:return""}}},{key:"handleHeaderClick",value:function(e){this.props.onClose(),this.props.org.selectHeaderAndOpenParents(e)}},{key:"handlePreviousDateClick",value:function(){var e=this.state,t=e.selectedDate;switch(e.timeframeType){case"Day":this.setState({selectedDate:Object(se.subDays)(t,1)});break;case"Week":this.setState({selectedDate:Object(se.subWeeks)(t,1)});break;case"Month":this.setState({selectedDate:Object(se.subMonths)(t,1)});break;default:return""}}},{key:"handleToggleDateDisplayType",value:function(){var e=this.state.dateDisplayType;this.setState({dateDisplayType:"absolute"===e?"relative":"absolute"})}},{key:"calculateTimeframeHeader",value:function(){var e=this.state,t=e.selectedDate;switch(e.timeframeType){case"Day":return ne()(t,"MMMM Do");case"Week":var n=Object(se.startOfWeek)(t),a=Object(se.addWeeks)(n,1);return"".concat(ne()(n,"MMM Do")," - ").concat(ne()(a,"MMM Do")," (W").concat(ne()(n,"W"),")");case"Month":return ne()(t,"MMMM");default:return""}}},{key:"render",value:function(){var e=this,t=this.props,n=t.onClose,a=t.headers,r=t.todoKeywordSets,i=t.agendaDefaultDeadlineDelayValue,o=t.agendaDefaultDeadlineDelayUnit,s=this.state,c=s.timeframeType,u=s.selectedDate,d=s.dateDisplayType,p=[];switch(c){case"Day":p=[u];break;case"Week":var h=Object(se.startOfWeek)(u);p=$.a.range(7).map(function(e){return Object(se.addDays)(h,e)});break;case"Month":var m=Object(se.startOfMonth)(u);p=$.a.range(Object(se.getDaysInMonth)(u)).map(function(e){return Object(se.addDays)(m,e)})}return l.a.createElement(ir,{onClose:n},l.a.createElement("h2",{className:"agenda__title"},"Agenda"),l.a.createElement("div",{className:"agenda__tab-container"},l.a.createElement(cr,{buttons:["Day","Week","Month"],selectedButton:c,onSelect:this.handleTimeframeTypeChange,useEqualWidthTabs:!0})),l.a.createElement("div",{className:"agenda__timeframe-header-container"},l.a.createElement("i",{className:"fas fa-chevron-left fa-lg",onClick:this.handlePreviousDateClick}),l.a.createElement("div",{className:"agenda__timeframe-header"},this.calculateTimeframeHeader()),l.a.createElement("i",{className:"fas fa-chevron-right fa-lg",onClick:this.handleNextDateClick})),l.a.createElement("div",{className:"agenda__days-container"},p.map(function(t){return l.a.createElement(hr,{key:ne()(t),date:t,headers:a,onHeaderClick:e.handleHeaderClick,todoKeywordSets:r,dateDisplayType:d,onToggleDateDisplayType:e.handleToggleDateDisplayType,agendaDefaultDeadlineDelayValue:i,agendaDefaultDeadlineDelayUnit:o})})),l.a.createElement("br",null))}}]),t}(s.PureComponent),fr=Object(v.b)(function(e){return{todoKeywordSets:e.org.present.get("todoKeywordSets"),agendaDefaultDeadlineDelayValue:e.base.get("agendaDefaultDeadlineDelayValue")||5,agendaDefaultDeadlineDelayUnit:e.base.get("agendaDefaultDeadlineDelayUnit")||"d"}},function(e){return{org:Object(y.b)(r,e)}})(mr),gr=[["Select next header","selectNextVisibleHeader","ctrl+n"],["Select previous header","selectPreviousVisibleHeader","ctrl+p"],["Toggle header opened","toggleHeaderOpened","tab"],["Advance todo state","advanceTodo","ctrl+t"],["Edit title","editTitle","ctrl+h"],["Edit description","editDescription","ctrl+d"],["Exit edit mode","exitEditMode","command+enter"],["Add header","addHeader","ctrl+enter"],["Remove header","removeHeader","backspace"],["Move header up","moveHeaderUp","ctrl+command+p"],["Move header down","moveHeaderDown","ctrl+command+n"],["Move header left","moveHeaderLeft","ctrl+command+b"],["Move header right","moveHeaderRight","ctrl+command+f"],["Undo","undo","ctrl+shift+-"]],br=function(e){return gr.map(function(t){var n=Object(d.a)(t,3),a=n[0],r=(n[1],n[2]);return[a,e.get(a,r)]})},vr=function(e){function t(e){var n;return Object(p.a)(this,t),n=Object(m.a)(this,Object(f.a)(t).call(this,e)),$.a.bindAll(Object(g.a)(n),["handleSelectNextVisibleHeaderHotKey","handleSelectPreviousVisibleHeaderHotKey","handleToggleHeaderOpenedHotKey","handleAdvanceTodoHotKey","handleEditTitleHotKey","handleEditDescriptionHotKey","handleExitEditModeHotKey","handleAddHeaderHotKey","handleRemoveHeaderHotKey","handleMoveHeaderUpHotKey","handleMoveHeaderDownHotKey","handleMoveHeaderLeftHotKey","handleMoveHeaderRightHotKey","handleUndoHotKey","handleContainerRef","handleCapture","handlePopupClose","handleSyncConfirmationPull","handleSyncConfirmationPush","handleSyncConfirmationCancel","handleTagsChange","handlePropertyListItemsChange"]),n.state={hasUncaughtError:!1},n}return Object(b.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.staticFile,n=e.path,a=e.loadedPath;t?(this.props.base.loadStaticFile(t),"changelog"===t&&this.props.base.setHasUnseenChangelog(!1),setTimeout(function(){return document.querySelector("html").scrollTop=0},0)):n&&n!==a&&this.props.syncBackend.downloadFile(n)}},{key:"componentWillUnmount",value:function(){this.props.staticFile?this.props.base.unloadStaticFile():this.props.org.stopDisplayingFile()}},{key:"componentDidUpdate",value:function(){var e=this.props,t=e.headers;e.pendingCapture&&t&&t.size>0&&this.props.org.insertPendingCapture()}},{key:"componentDidCatch",value:function(e){ga("send","event","error","OrgFile componentDidCatch",e),this.setState({hasUncaughtError:!0})}},{key:"handleSelectNextVisibleHeaderHotKey",value:function(){this.props.org.selectNextVisibleHeader()}},{key:"handleSelectPreviousVisibleHeaderHotKey",value:function(){this.props.org.selectPreviousVisibleHeader()}},{key:"handleToggleHeaderOpenedHotKey",value:function(){var e=this.props.selectedHeaderId;e&&this.props.org.toggleHeaderOpened(e)}},{key:"handleAdvanceTodoHotKey",value:function(){this.props.org.advanceTodoState()}},{key:"handleEditTitleHotKey",value:function(){this.props.org.enterEditMode("title")}},{key:"handleEditDescriptionHotKey",value:function(){this.props.org.openHeader(this.props.selectedHeaderId),this.props.org.enterEditMode("description")}},{key:"handleExitEditModeHotKey",value:function(){this.props.org.exitEditMode(),this.container.focus()}},{key:"handleAddHeaderHotKey",value:function(){this.props.org.addHeaderAndEdit(this.props.selectedHeaderId)}},{key:"handleRemoveHeaderHotKey",value:function(){var e=this.props.selectedHeaderId;this.props.org.selectNextSiblingHeader(e),this.props.org.removeHeader(e)}},{key:"handleMoveHeaderUpHotKey",value:function(){this.props.org.moveHeaderUp(this.props.selectedHeaderId)}},{key:"handleMoveHeaderDownHotKey",value:function(){this.props.org.moveHeaderDown(this.props.selectedHeaderId)}},{key:"handleMoveHeaderLeftHotKey",value:function(){this.props.org.moveHeaderLeft(this.props.selectedHeaderId)}},{key:"handleMoveHeaderRightHotKey",value:function(){this.props.org.moveHeaderRight(this.props.selectedHeaderId)}},{key:"handleUndoHotKey",value:function(){this.props.undo.undo()}},{key:"handleContainerRef",value:function(e){this.container=e,this.container&&this.container.focus()}},{key:"handleCapture",value:function(e,t,n){this.props.org.insertCapture(e,t,n)}},{key:"handlePopupClose",value:function(){this.props.base.closePopup()}},{key:"handleSyncConfirmationPull",value:function(){this.props.org.sync({forceAction:"pull"}),this.props.base.closePopup()}},{key:"handleSyncConfirmationPush",value:function(){this.props.org.sync({forceAction:"push"}),this.props.base.closePopup()}},{key:"handleSyncConfirmationCancel",value:function(){this.props.base.closePopup()}},{key:"handleTagsChange",value:function(e){this.props.org.setHeaderTags(this.props.selectedHeaderId,e)}},{key:"handlePropertyListItemsChange",value:function(e){this.props.org.updatePropertyListItems(this.props.activePopupData.get("headerId"),e)}},{key:"handleTimestampChange",value:function(e){var t=this;return e.get("timestampId")?function(n){return t.props.org.updateTimestampWithId(e.get("timestampId"),n)}:function(n){return t.props.org.updatePlanningItemTimestamp(e.get("headerId"),e.get("planningItemIndex"),n.get("firstTimestamp"))}}},{key:"renderActivePopup",value:function(){var e=this.props,t=e.activePopupType,n=e.activePopupData,a=e.captureTemplates,r=e.headers,i=e.selectedHeader;switch(t){case"sync-confirmation":return l.a.createElement(sr,{lastServerModifiedAt:n.get("lastServerModifiedAt"),onPull:this.handleSyncConfirmationPull,onPush:this.handleSyncConfirmationPush,onCancel:this.handleSyncConfirmationCancel});case"capture":return l.a.createElement(or,{template:a.find(function(e){return e.get("id")===n.get("templateId")}),headers:r,onCapture:this.handleCapture,onClose:this.handlePopupClose});case"tags-editor":return i?l.a.createElement(lr,{header:i,allTags:Object(ee.OrderedSet)(r.flatMap(function(e){return e.getIn(["titleLine","tags"])})).sort(),onClose:this.handlePopupClose,onChange:this.handleTagsChange}):null;case"timestamp-editor":var o=null;return o=n.get("timestampId")?function(e,t){return e.map(function(e){return Pe(e.getIn(["titleLine","title"]),t)||Pe(e.get("description"),t)||e.get("propertyListItems").map(function(e){return Pe(e.get("value"),t)}).filter(function(e){return!!e}).first()}).find(function(e){return!!e})}(r,n.get("timestampId")):Object(ee.fromJS)({firstTimestamp:ve(r,n.get("headerId")).getIn(["planningItems",n.get("planningItemIndex"),"timestamp"])}),l.a.createElement(dr,{timestamp:o,singleTimestampOnly:!n.get("timestampId"),onClose:this.handlePopupClose,onChange:this.handleTimestampChange(n)});case"property-list-editor":return l.a.createElement(pr,{onClose:this.handlePopupClose,onChange:this.handlePropertyListItemsChange,propertyListItems:ve(r,n.get("headerId")).get("propertyListItems")});case"agenda":return l.a.createElement(fr,{onClose:this.handlePopupClose,headers:r});default:return null}}},{key:"render",value:function(){var e=this.props,t=e.headers,n=e.shouldDisableDirtyIndicator,a=e.shouldDisableSyncButtons,r=e.shouldDisableActions,i=e.isDirty,o=e.parsingErrorMessage,c=e.path,u=e.staticFile,p=e.customKeybindings,h=e.inEditMode,m=e.orgFileErrorMessage;if(!c&&!u)return l.a.createElement(va.a,{to:"/files"});if(this.state.hasUncaughtError)return l.a.createElement("div",{className:"error-message-container"},"Uh oh, you ran into a bug!",l.a.createElement("br",null),l.a.createElement("br",null),"This was probably the result of an error in attempting to parse your org file. It'd be super helpful if you could"," ",l.a.createElement("a",{href:"https://github.com/DanielDe/org-web/issues/new",target:"_blank",rel:"noopener noreferrer"},"create an issue")," ","(and include the org file if possible!)");if(m)return l.a.createElement("div",{className:"error-message-container"},m);if(!t)return l.a.createElement("div",null);var f=$.a.fromPairs(function(e){return gr.map(function(t){var n=Object(d.a)(t,3),a=n[0],r=n[1],i=n[2];return[r,e.get(a,i)]})}(p)),g=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n){t&&h||t&&["TEXTAREA","INPUT"].includes(document.activeElement.nodeName)||(n.preventDefault(),e(n))}},b={selectNextVisibleHeader:g(this.handleSelectNextVisibleHeaderHotKey),selectPreviousVisibleHeader:g(this.handleSelectPreviousVisibleHeaderHotKey),toggleHeaderOpened:g(this.handleToggleHeaderOpenedHotKey,!0),advanceTodo:g(this.handleAdvanceTodoHotKey),editTitle:g(this.handleEditTitleHotKey),editDescription:g(this.handleEditDescriptionHotKey),exitEditMode:g(this.handleExitEditModeHotKey),addHeader:g(this.handleAddHeaderHotKey),removeHeader:g(this.handleRemoveHeaderHotKey,!0),moveHeaderUp:g(this.handleMoveHeaderUpHotKey),moveHeaderDown:g(this.handleMoveHeaderDownHotKey),moveHeaderLeft:g(this.handleMoveHeaderLeftHotKey),moveHeaderRight:g(this.handleMoveHeaderRightHotKey),undo:g(this.handleUndoHotKey)};return l.a.createElement(Ma.HotKeys,{keyMap:f,handlers:b},l.a.createElement("div",{className:"org-file-container",tabIndex:"-1",ref:this.handleContainerRef},0===t.size?l.a.createElement("div",{className:"org-file__parsing-error-message"},l.a.createElement("h3",null,"Couldn't parse file"),o?l.a.createElement(s.Fragment,null,o):l.a.createElement(s.Fragment,null,"If you think this is a bug, please"," ",l.a.createElement("a",{href:"https://github.com/DanielDe/org-web/issues/new",target:"_blank",rel:"noopener noreferrer"},"create an issue")," ","and include the org file if possible!")):l.a.createElement(tr,{shouldDisableActions:r}),i&&!n&&l.a.createElement("div",{className:"dirty-indicator"},"Unpushed changes"),!r&&l.a.createElement(ar,{shouldDisableSyncButtons:a,staticFile:u}),this.renderActivePopup()))}}]),t}(s.PureComponent),yr=Object(v.b)(function(e,t){var n=e.org.present.get("headers"),a=e.org.present.get("selectedHeaderId"),r=e.base.get("activePopup");return{headers:n,selectedHeaderId:a,isDirty:e.org.present.get("isDirty"),loadedPath:e.org.present.get("path"),selectedHeader:n&&n.find(function(e){return e.get("id")===a}),customKeybindings:e.base.get("customKeybindings"),inEditMode:!!e.org.present.get("editMode"),activePopupType:r?r.get("type"):null,activePopupData:r?r.get("data"):null,captureTemplates:e.capture.get("captureTemplates").concat(He),pendingCapture:e.org.present.get("pendingCapture"),orgFileErrorMessage:e.org.present.get("orgFileErrorMessage")}},function(e){return{base:Object(y.b)(a,e),syncBackend:Object(y.b)(o,e),org:Object(y.b)(r,e),undo:Object(y.b)(k.ActionCreators,e),capture:Object(y.b)(i,e)}})(vr),Er=(n(354),Object(Ea.a)(Object(v.b)(function(e,t){return{fontSize:e.base.get("fontSize")||"Regular",bulletStyle:e.base.get("bulletStyle")||"Classic",shouldTapTodoToAdvance:e.base.get("shouldTapTodoToAdvance"),agendaDefaultDeadlineDelayValue:e.base.get("agendaDefaultDeadlineDelayValue")||5,agendaDefaultDeadlineDelayUnit:e.base.get("agendaDefaultDeadlineDelayUnit")||"d",shouldStoreSettingsInSyncBackend:e.base.get("shouldStoreSettingsInSyncBackend"),shouldLiveSync:e.base.get("shouldLiveSync"),shouldSyncOnBecomingVisibile:e.base.get("shouldSyncOnBecomingVisibile"),hasUnseenChangelog:e.base.get("hasUnseenChangelog")}},function(e){return{syncBackend:Object(y.b)(o,e),base:Object(y.b)(a,e)}})(function(e){var t=e.fontSize,n=e.bulletStyle,a=e.shouldTapTodoToAdvance,r=e.shouldStoreSettingsInSyncBackend,i=e.shouldLiveSync,o=e.shouldSyncOnBecomingVisibile,s=e.agendaDefaultDeadlineDelayValue,c=e.agendaDefaultDeadlineDelayUnit,u=e.hasUnseenChangelog,d=e.syncBackend,p=e.base;return l.a.createElement("div",{className:"settings-container"},l.a.createElement("div",{className:"setting-container"},l.a.createElement("div",{className:"setting-label"},"Last built"),"7/31/2023, 9:09:55 AM"),l.a.createElement("div",{className:"setting-container"},l.a.createElement("div",{className:"setting-label"},"Font size"),l.a.createElement(cr,{buttons:["Regular","Large"],selectedButton:t,onSelect:function(e){return p.setFontSize(e)}})),l.a.createElement("div",{className:"setting-container"},l.a.createElement("div",{className:"setting-label"},"Bullet style"),l.a.createElement(cr,{buttons:["Classic","Fancy"],selectedButton:n,onSelect:function(e){return p.setBulletStyle(e)}})),l.a.createElement("div",{className:"setting-container"},l.a.createElement("div",{className:"setting-label"},"Tap TODO to advance state"),l.a.createElement(rr,{isEnabled:a,onToggle:function(){return p.setShouldTapTodoToAdvance(!a)}})),l.a.createElement("div",{className:"setting-container"},l.a.createElement("div",{className:"setting-label"},"Live sync",l.a.createElement("div",{className:"setting-label__description"},"If enabled, changes are automatically pushed to the sync backend as you make them.")),l.a.createElement(rr,{isEnabled:i,onToggle:function(){return p.setShouldLiveSync(!i)}})),l.a.createElement("div",{className:"setting-container"},l.a.createElement("div",{className:"setting-label"},"Sync on application becoming visible",l.a.createElement("div",{className:"setting-label__description"},"If enabled, the current org file is pulled from the sync backend when the browser tab becomes visible. This prevents you from having a stale file before starting to make changes to it.")),l.a.createElement(rr,{isEnabled:o,onToggle:function(){return p.setShouldSyncOnBecomingVisibile(!o)}})),l.a.createElement("div",{className:"setting-container"},l.a.createElement("div",{className:"setting-label"},"Store settings in sync backend",l.a.createElement("div",{className:"setting-label__description"},"Store settings and keyboard shortcuts in a .org-web-config.json file in your sync backend to sync betweeen multiple devices.")),l.a.createElement(rr,{isEnabled:r,onToggle:function(){return p.setShouldStoreSettingsInSyncBackend(!r)}})),l.a.createElement("div",{className:"setting-container setting-container--vertical"},l.a.createElement("div",{className:"setting-label"},"Default DEADLINE warning period"),l.a.createElement("div",{className:"default-deadline-warning-container"},l.a.createElement("input",{type:"number",min:"0",className:"textfield default-deadline-value-textfield",value:s,onChange:function(e){return p.setAgendaDefaultDeadlineDelayValue(e.target.value)}}),l.a.createElement(cr,{buttons:"hdwmy".split(""),selectedButton:c,onSelect:function(e){return p.setAgendaDefaultDeadlineDelayUnit(e)}}))),l.a.createElement("div",{className:"settings-buttons-container"},l.a.createElement("button",{className:"btn settings-btn",onClick:function(){return p.pushModalPage("capture_templates_editor")}},"Capture templates"),l.a.createElement("button",{className:"btn settings-btn",onClick:function(){return p.pushModalPage("keyboard_shortcuts_editor")}},"Keyboard shortcuts"),l.a.createElement("hr",{className:"settings-button-separator"}),l.a.createElement("button",{className:"btn settings-btn",onClick:function(){return p.pushModalPage("changelog")}},"Changelog",u&&l.a.createElement("div",{className:"changelog-badge-container"},l.a.createElement("i",{className:"fas fa-gift"}))),l.a.createElement("button",{className:"btn settings-btn",onClick:function(){return p.pushModalPage("sample")}},"Help"),l.a.createElement("button",{className:"btn settings-btn"},l.a.createElement("a",{href:"https://github.com/DanielDe/org-web",target:"_blank",rel:"noopener noreferrer",style:{color:"white"}},"Github repo ",l.a.createElement("i",{className:"fas fa-external-link-alt fa-sm"}))),l.a.createElement("hr",{className:"settings-button-separator"}),l.a.createElement("button",{className:"btn settings-btn"},l.a.createElement("a",{href:"http://eepurl.com/dK5F9w",target:"_blank",rel:"noopener noreferrer",style:{color:"white"}},"Mailing list ",l.a.createElement("i",{className:"fas fa-external-link-alt fa-sm"}))),l.a.createElement("div",{className:"settings-button-help-text"},"Sign up for the mailing list if you're interested in getting occasional (","<","1 per week) updates on org-web. Or take a look at some"," ",l.a.createElement("a",{href:"https://us19.campaign-archive.com/home/?u=36b9d8082ddb55e6cc7e22339&id=f427625e31",target:"_blank",rel:"noopener noreferrer"},"past emails")," ","before you sign up. You can unsubscribe at any time!"),l.a.createElement("button",{className:"btn settings-btn"},l.a.createElement("a",{href:"https://twitter.com/org_web_org",target:"_blank",rel:"noopener noreferrer",style:{color:"white"}},"Twitter ",l.a.createElement("i",{className:"fas fa-external-link-alt fa-sm"}))),l.a.createElement("hr",{className:"settings-button-separator"}),l.a.createElement("button",{className:"btn settings-btn",onClick:function(){return window.confirm("Are you sure you want to sign out?")?d.signOut():void 0}},"Sign out")))}))),_r=(n(355),function(e){function t(e){var n;return Object(p.a)(this,t),n=Object(m.a)(this,Object(f.a)(t).call(this,e)),$.a.bindAll(Object(g.a)(n),["handleRebindClick","handleKeyPress"]),n.state={isEditMode:!1},n}return Object(b.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.rebindArea.addEventListener("blur",function(){return e.setState({isEditMode:!1})})}},{key:"handleRebindClick",value:function(){this.setState({isEditMode:!0}),document.addEventListener("keypress",this.handleKeyPress)}},{key:"handleKeyPress",value:function(e){this.setState({isEditMode:!1}),document.removeEventListener("keypress",this.handleKeyPress);var t=null;if(t=e.code.startsWith("Key")?e.code.substr(3).toLowerCase():e.code.startsWith("Digit")?e.code.substr(5):{Minus:"-",Equal:"=",Backspace:"backspace",Enter:"enter",Return:"return",Tab:"tab",BracketLeft:"[",BracketRight:"]",Semicolon:";",Quote:'"',Backslash:"\\",Comma:",",Period:".",Slash:"/"}[e.code]){var n=[["ctrlKey","ctrl"],["altKey","alt"],["metaKey","meta"],["shiftKey","shift"]].filter(function(t){var n=Object(d.a)(t,2),a=n[0];n[1];return e[a]}).map(function(e){var t=Object(d.a)(e,2);t[0];return t[1]}).join("+"),a="".concat(n).concat(n?"+":"").concat(t);this.props.onBindingChange(this.props.name,a)}}},{key:"symbolizeKeybinding",value:function(e){if(!e)return"";return[["ctrl","^"],["alt","\u2325"],["option","\u2325"],["command","\u2318"],["meta","\u2318"],["shift","\u21e7"],["backspace","\u232b"],["return","\u23ce"],["enter","\u23ce"],["left","\u2190"],["right","\u2192"],["up","\u2191"],["down","\u2193"]].reduce(function(e,t){var n=Object(d.a)(t,2),a=n[0],r=n[1];return e.replace(RegExp("".concat(a,"\\+?")),r)},e)}},{key:"render",value:function(){var e=this,t=this.props,n=t.name,a=t.binding,r=this.state.isEditMode,i=Ta()("keyboard-shortcut-container__shortcut-key",{"keyboard-shortcut-container__shortcut-key--edit-mode":r});return l.a.createElement("div",{className:"keyboard-shortcut-container"},l.a.createElement("div",{className:"keyboard-shortcut-container__shortcut-name"},n),l.a.createElement("div",{className:i,onClick:this.handleRebindClick,tabIndex:"-1",ref:function(t){return e.rebindArea=t}},r?"...":this.symbolizeKeybinding(a)))}}]),t}(s.PureComponent)),Tr=(n(356),Object(Ea.a)(Object(v.b)(function(e,t){return{customKeybindings:e.base.get("customKeybindings")||Object(ee.Map)()}},function(e){return{base:Object(y.b)(a,e)}})(function(e){var t=e.customKeybindings,n=e.base,a=function(e,a){var r=br(t).filter(function(e){var t=Object(d.a)(e,2);return t[0],t[1]===a})[0];r?alert('That binding is already in use for "'.concat(r[0],'"')):n.setCustomKeybinding(e,a)};return l.a.createElement("div",{className:"keyboard-shortcuts-editor-container"},br(t).map(function(e){var t=Object(d.a)(e,2),n=t[0],r=t[1];return l.a.createElement(_r,{key:n,name:n,binding:r,onBindingChange:a})}))}))),Ir=(n(357),n(358),function(e){var t=e.template,n=e.index,a=e.onFieldPathUpdate,r=e.onAddNewTemplateOrgFileAvailability,i=e.onRemoveTemplateOrgFileAvailability,o=e.onAddNewTemplateHeaderPath,c=e.onRemoveTemplateHeaderPath,u=e.onDeleteTemplate,p=e.syncBackendType,h=Object(s.useState)(!!t.get("description")),m=Object(d.a)(h,2),f=m[0],g=m[1],b=function(){return g(!f)},v=function(e){return function(n){return a(t.get("id"),[e],n.target.value)}},y=function(){return a(t.get("id"),["isAvailableInAllOrgFiles"],!t.get("isAvailableInAllOrgFiles"))},E=function(){return a(t.get("id"),["shouldPrepend"],!t.get("shouldPrepend"))},_=function(){r(t.get("id"))},T=function(e){return function(){return i(t.get("id"),e)}},I=function(e){return function(n){return a(t.get("id"),["orgFilesWhereAvailable",e],n.target.value)}},w=function(){return o(t.get("id"))},k=function(e){return function(){return c(t.get("id"),e)}},S=function(e){return function(n){return a(t.get("id"),["headerPaths",e],n.target.value)}},D=function(){window.confirm('Are you sure you want to delete the "'.concat(t.get("description"),'" template?'))&&u(t.get("id"))},C=Ta()("fas fa-2x fa-caret-right capture-template-container__header__caret",{"capture-template-container__header__caret--rotated":!f});return l.a.createElement(ta.b,{draggableId:"capture-template--".concat(t.get("id")),index:n},function(e,n){return l.a.createElement("div",Object.assign({className:Ta()("capture-template-container",{"capture-template-container--dragging":n.isDragging}),ref:e.innerRef},e.draggableProps),l.a.createElement("div",{className:"capture-template-container__header",onClick:b},l.a.createElement("i",{className:C}),l.a.createElement(nr,{iconName:t.get("iconName"),letter:t.get("letter"),onClick:function(){},style:{marginRight:20}}),l.a.createElement("span",{className:"capture-template-container__header__title"},t.get("description")),l.a.createElement("i",Object.assign({className:"fas fa-bars fa-lg capture-template-container__header__drag-handle"},e.dragHandleProps))),l.a.createElement(Pa.UnmountClosed,{isOpened:!f,springConfig:{stiffness:300}},l.a.createElement("div",{className:"capture-template-container__content"},function(e){return l.a.createElement("div",{className:"capture-template__field-container"},l.a.createElement("div",{className:"capture-template__field"},l.a.createElement("div",null,"Description:"),l.a.createElement("input",{type:"text",className:"textfield",value:e.get("description",""),onChange:v("description")})))}(t),function(e){return l.a.createElement("div",{className:"capture-template__field-container"},l.a.createElement("div",{className:"capture-template__field"},l.a.createElement("div",null,"Letter:"),l.a.createElement("input",{type:"text",className:"textfield capture-template__letter-textfield",maxLength:"1",value:e.get("letter",""),onChange:v("letter"),autoCapitalize:"none"})),l.a.createElement("div",{className:"capture-template__field__or-container"},l.a.createElement("div",{className:"capture-template__field__or-line"}),l.a.createElement("div",{className:"capture-template__field__or"},"or"),l.a.createElement("div",{className:"capture-template__field__or-line"})),l.a.createElement("div",{className:"capture-template__field"},l.a.createElement("div",null,"Icon name:"),l.a.createElement("input",{type:"text",className:"textfield",value:e.get("iconName"),onChange:v("iconName"),autoCapitalize:"none",autoCorrect:"none"})),l.a.createElement("div",{className:"capture-template__help-text"},"Instead of a letter, you can specify the name of any free Font Awesome icon (like lemon or calendar-plus) to use as the capture icon. You can search the available icons"," ",l.a.createElement("a",{href:"https://fontawesome.com/icons?d=gallery&s=solid&m=free",target:"_blank",rel:"noopener noreferrer"},"here"),"."))}(t),function(e){return l.a.createElement("div",{className:"capture-template__field-container"},l.a.createElement("div",{className:"capture-template__field"},l.a.createElement("div",null,"Available in all org files?"),l.a.createElement(rr,{isEnabled:e.get("isAvailableInAllOrgFiles"),onToggle:y})),l.a.createElement("div",{className:"capture-template__help-text"},"You can make this capture template available in all org files, or just the ones you specify.","Dropbox"===p&&l.a.createElement(s.Fragment,null," ","Specify full paths starting from the root of your Dropbox, like"," ",l.a.createElement("code",null,"/org/todo.org")),"Google Drive"===p&&l.a.createElement(s.Fragment,null," ","Specify the file id of each file. You can find the file id in the URL of the file in org-web (e.g.,"," ",l.a.createElement("code",null,"/file/","<file id>"),").")),l.a.createElement(Pa.UnmountClosed,{isOpened:!e.get("isAvailableInAllOrgFiles"),springConfig:{stiffness:300}},l.a.createElement("div",{className:"multi-textfields-container"},e.get("orgFilesWhereAvailable").map(function(e,t){return l.a.createElement("div",{key:"org-file-availability-".concat(t),className:"multi-textfield-container"},l.a.createElement("input",{type:"text",placeholder:"e.g., /org/todo.org",className:"textfield multi-textfield-field",value:e,onChange:I(t)}),l.a.createElement("button",{className:"fas fa-times fa-lg remove-multi-textfield-button",onClick:T(t)}))})),l.a.createElement("div",{className:"add-new-multi-textfield-button-container"},l.a.createElement("button",{className:"fas fa-plus add-new-multi-textfield-button",onClick:_}))))}(t),function(e){return l.a.createElement("div",{className:"capture-template__field-container"},l.a.createElement("div",{className:"capture-template__field",style:{marginTop:7}},l.a.createElement("div",null,"Header path")),l.a.createElement("div",{className:"capture-template__help-text"},"Specify the path to the header under which the new header should be filed. One header per textfield."),l.a.createElement("div",{className:"multi-textfields-container"},e.get("headerPaths").map(function(e,t){return l.a.createElement("div",{key:"header-path-".concat(t),className:"multi-textfield-container"},l.a.createElement("input",{type:"text",placeholder:"e.g., Todos",className:"textfield multi-textfield-field",value:e,onChange:S(t)}),l.a.createElement("button",{className:"fas fa-times fa-lg remove-multi-textfield-button",onClick:k(t)}))})),l.a.createElement("div",{className:"add-new-multi-textfield-button-container"},l.a.createElement("button",{className:"fas fa-plus add-new-multi-textfield-button",onClick:w})))}(t),function(e){return l.a.createElement("div",{className:"capture-template__field-container"},l.a.createElement("div",{className:"capture-template__field"},l.a.createElement("div",null,"Prepend?"),l.a.createElement(rr,{isEnabled:e.get("shouldPrepend"),onToggle:E})),l.a.createElement("div",{className:"capture-template__help-text"},"By default, new captured headers are appended to the specified header path. Enable this setting to prepend them instead."))}(t),function(e){return l.a.createElement("div",{className:"capture-template__field-container"},l.a.createElement("div",{className:"capture-template__field",style:{marginTop:7}},l.a.createElement("div",null,"Template")),l.a.createElement("textarea",{className:"textarea template-textarea",rows:"3",value:e.get("template"),onChange:v("template")}),l.a.createElement("div",{className:"capture-template__help-text"},"The template for creating the capture item. You can use the following template variables that will be expanded upon capture:",l.a.createElement("ul",null,l.a.createElement("li",null,l.a.createElement("code",null,"%?")," - Place the cursor here."),l.a.createElement("li",null,l.a.createElement("code",null,"%t")," - Timestamp, date only."),l.a.createElement("li",null,l.a.createElement("code",null,"%T")," - Timestamp, with date and time."),l.a.createElement("li",null,l.a.createElement("code",null,"%u")," - Inactive timestamp, date only."),l.a.createElement("li",null,l.a.createElement("code",null,"%U")," - Inactive timestamp, with date and time."),l.a.createElement("li",null,l.a.createElement("code",null,"%","<custom variable>")," - A custom variable from a URL param capture. See"," ",l.a.createElement("a",{href:"https://github.com/DanielDe/org-web/#capture-params-and-siri-support"},"the README file")," ","for more details."))))}(t),l.a.createElement("div",{className:"capture-template__field-container capture-template__delete-button-container"},l.a.createElement("button",{className:"btn settings-btn capture-template__delete-button",onClick:D},"Delete template")))))})}),wr=Object(v.b)(function(e,t){return{captureTemplates:e.capture.get("captureTemplates",new ee.List),syncBackendType:e.syncBackend.get("client").type}},function(e){return{capture:Object(y.b)(i,e)}})(function(e){var t=e.captureTemplates,n=e.syncBackendType,a=e.capture,r=function(e,t,n){return a.updateTemplateFieldPathValue(e,t,n)},i=function(e){return a.addNewTemplateOrgFileAvailability(e)},o=function(e,t){return a.removeTemplateOrgFileAvailability(e,t)},c=function(e){return a.addNewTemplateHeaderPath(e)},u=function(e,t){return a.removeTemplateHeaderPath(e,t)},d=function(e){return a.deleteTemplate(e)},p=function(e,t){return a.reorderCaptureTemplate(e,t)};return l.a.createElement("div",null,l.a.createElement(ta.c,{droppableId:"capture-templates-editor-droppable",type:"CAPTURE-TEMPLATE"},function(e,a){return l.a.createElement("div",Object.assign({className:"capture-templates-container",ref:e.innerRef},e.droppableProps),0===t.size?l.a.createElement("div",{className:"no-capture-templates-message"},"You don't currently have any capture templates - add one by pressing the"," ",l.a.createElement("i",{className:"fas fa-plus"})," button.",l.a.createElement("br",null),l.a.createElement("br",null),"Capture templates show up in the action drawer and give you quick access to creating new headers (like org-capture)."):l.a.createElement(s.Fragment,null,t.map(function(e,t){return l.a.createElement(Ir,{key:e.get("id"),index:t,template:e,syncBackendType:n,onFieldPathUpdate:r,onAddNewTemplateOrgFileAvailability:i,onRemoveTemplateOrgFileAvailability:o,onAddNewTemplateHeaderPath:c,onRemoveTemplateHeaderPath:u,onDeleteTemplate:d,onReorder:p})}),e.placeholder))}),l.a.createElement("div",{className:"new-capture-template-button-container"},l.a.createElement("button",{className:"fas fa-plus fa-lg btn btn--circle",onClick:function(){return a.addNewEmptyCaptureTemplate()}})))}),kr=(n(359),n(149)),Sr=n.n(kr),Dr=n(150),Cr=n.n(Dr),Or=function(e){function t(e){var n;return Object(p.a)(this,t),n=Object(m.a)(this,Object(f.a)(t).call(this,e)),$.a.bindAll(Object(g.a)(n),["handleDropboxClick","handleGoogleDriveClick"]),n}return Object(b.a)(t,e),Object(h.a)(t,[{key:"handleDropboxClick",value:function(){fn("authenticatedSyncService","Dropbox");var e=new na.Dropbox({clientId:"h1hbkipv02vmg9k",fetch:fetch}).getAuthenticationUrl(window.location.origin+"/org-web/");window.location=e}},{key:"handleGoogleDriveClick",value:function(){try{gapi.load("client",function(){window.gapi.client.init({apiKey:"",discoveryDocs:["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"]}).then(Object(ha.a)(pa.a.mark(function e(){return pa.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:google.accounts.oauth2.initTokenClient({client_id:"",scope:"https://www.googleapis.com/auth/drive.file",callback:function(e){fn("authenticatedSyncService","Google Drive"),fn("googleDriveAccessToken",JSON.stringify(e)),window.location.reload()}}).requestAccessToken({prompt:"consent"});case 2:case"end":return e.stop()}},e)})))})}catch(e){return void alert("The Google Drive API client isn't available - you might be blocking it with an ad blocker")}}},{key:"render",value:function(){return l.a.createElement("div",{className:"sync-service-sign-in-container"},l.a.createElement("p",{className:"sync-service-sign-in__help-text"},"org-web syncs your files with Dropbox or Google Drive. Choose your preferred sync backend below to sign in."),l.a.createElement("div",{className:"sync-service-container",onClick:this.handleDropboxClick},l.a.createElement("img",{src:Sr.a,alt:"Dropbox logo",className:"dropbox-logo"})),l.a.createElement("div",{className:"sync-service-container",onClick:this.handleGoogleDriveClick},l.a.createElement("img",{src:Cr.a,alt:"Google Drive logo",className:"google-drive-logo"})))}}]),t}(s.PureComponent),Ar=function(e){function t(e){var n;return Object(p.a)(this,t),n=Object(m.a)(this,Object(f.a)(t).call(this,e)),$.a.bindAll(Object(g.a)(n),["renderChangelogFile","renderSampleFile","renderFileBrowser","renderFile"]),n}return Object(b.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.lastSeenChangelogHeader,n=e.isAuthenticated,a=On('* January 20th, 2022\r\n** Fix a bug in which an extra newline is inserted for a new header\r\n* October 6th, 2021\r\n** First-class support for plain lists thanks to @kjmatsuda on GitHub\r\n* November 1st, 2018 (afternoon)\r\n** Add support for the [[https://orgmode.org/manual/Deadlines-and-scheduling.html#Deadlines-and-scheduling][-- delay type]] with SCHEDULED items\r\n* November 1st, 2018\r\n** Added support for [[https://orgmode.org/manual/Repeated-tasks.html][timestamp repeaters]]\r\nWhen you advance a header to a DONE state, if there is a DEADLINE or SCHEDULED planning item on that header, those timestamps will be advanced according to the specified repeater.\r\n* October 31st, 2018\r\n** Added a "Live sync" setting to automatically push changes as you make them, instead of requiring you to manually sync.\r\n** Happy Halloween!\r\n* October 22nd, 2018 (afternoon)\r\n** Added a [[http://eepurl.com/dK5F9w][mailing list]]! You can also find a link to sign up on the settings screen\r\nI plan on sending less than 1 email per week, and you can easily unsubscribe at any time!\r\n* October 22nd, 2018\r\n** Added first class support for property lists. Tap on any of the properties to bring up an editor (that won\'t work in this file, but you can try it out in the sample file!).\r\n:PROPERTIES:\r\n:prop1: value 1\r\n:prop2: value 2\r\n:END:\r\n* October 17th, 2018\r\n** Added a basic agenda view - try tapping the new calendar button at the bottom of the screen!\r\n* October 4th, 2018\r\n** Implemented new (kinda slicker?) modal component\r\n* October 2nd, 2018\r\n** Added buttons to add/edit deadline and scheduled timestamps\r\n* September 23rd, 2018\r\n** Added native support for displaying and editing timestamps\r\n* September 18th, 2018 (afternoon)\r\n** Parse and display inline markup like ~this~ and +this+ and *this* and /this/\r\n* September 18th, 2018\r\n** Added URL params for capture, specifically for Siri Shortcuts support!\r\n*** Check out [[https://www.icloud.com/shortcuts/4e51e8b748d14a50aa70ac6fb963f775][this sample Siri Shortcut]] or [[https://github.com/DanielDe/org-web/#capture-params-and-siri-support][the README file]] for more information\r\n* September 13th, 2018\r\n** Added support for Google Drive!\r\n*** You can now use Google Drive as a sync backend. Just choose it as an option when you click "Sign in".\r\n*** Please let me know if you run into any issues with Google Drive by [[https://github.com/DanielDe/org-web/issues/new][creating an issue]]!\r\n* September 5th, 2018\r\n** Native tag support and editor\r\n*** A new button in the header action drawer brings up the tag editor\r\n*** From here you can modify, add, and reorder tags\r\n* September 3rd, 2018\r\n** Huge UI overhaul!\r\n*** Removed the action drawer, replaced with just three buttons: Sync, Movement, and Capture Templates\r\n*** All other actions now available via header action drawer, table action drawer, or swipe actions\r\n*** See the Help/Sample file in Settings for more details!\r\n* September 2nd, 2018\r\n** Replaced "push" and "pull" buttons with a single "sync" button\r\n* August 31st, 2018\r\n** Added mini action drawer to selected headers for easier access to edit and focus buttons\r\n* August 30th, 2018\r\n** Moved undo button into the header\r\n*** This is one step in a major UI overhaul\r\n** Moved links to Github and Changelog into the settings page\r\n* August 29th, 2018\r\n** You can now swipe on headers to trigger common actions:\r\n*** Swipe right to advance the todo state\r\n*** Swipe left to remove the header\r\n*** This only works on touchscreen devices\r\n* August 28th, 2018\r\n** Capture templates are now reorderable (just drag and drop!)\r\n* August 23rd, 2018\r\n** Added native support for cookies like [1/2] and [50%]\r\n*** TODO Sample todo\r\n*** DONE Another sample todo\r\n*** They\'re also supported in plain checkbox lists [3/3] [100%]\r\n- [X] item 1\r\n- [X] item 2\r\n- [X] item 3\r\n* August 21st, 2018\r\n** Added native support for plain lists and checkboxes\r\nPlain lists:\r\n\r\n- Example 1\r\n- Example 2\r\n\r\nOrdered lists:\r\n\r\n1. Example 1\r\n2. Example 2\r\n20. [@20] Example 20\r\n\r\nAnd checkboxes:\r\n\r\n- [ ] checkbox 1\r\n  - [ ] checkbox 2\r\n    - [ ] checkbox 3\r\n  - [X] checkbox 4\r\n* August 18th, 2018\r\n** Added capture templates\r\n*** Now under Settings > Capture Templates you can specify capture templates which show up as custom buttons in the action drawer for easily capturing items in your org file\r\n* August 12th, 2018\r\n** Native support for tables!\r\n| ta | da |\r\n|----+----|\r\n| \ud83c\udf89 | \ud83c\udf8a |\r\n*** Tables will now be rendered as HTML tables\r\n*** When a table cell is selected, the action drawer will populate with additional actions to manipulate tables (more details on this in the sample file)\r\n*** Format specifiers (like <r> and <10>) aren\'t yet natively supported\r\n* August 9th, 2018\r\n** Improved navigation with back buttons a la an iOS UINavigationController\r\n* August 6th, 2018\r\n** Implemented new setting to store settings in a .org-web-config.json file in your Dropbox. This will keep settings in sync across multiple devices.\r\n* August 2nd, 2018\r\n** Added keyboard shortcuts, as well as a way to set custom bindings\r\n*** Find it in Settings > Keyboard shortcuts\r\n* August 1st, 2018\r\n** Added routing (and therefore back/forward button support)\r\n* July 31st, 2018 (afternoon)\r\n** Implemented a "Focus" button - see the sample file for details.\r\n** Other minor niceties and bug fixes.\r\n* July 31st, 2018\r\n** Finished a complete rewrite to use more modern tooling and best practices\r\n*** Achieved almost complete parity with the original version, minus a couple features that weren\'t used often. Please let me know if those features were important to you (or if you notice any bugs) by [[https://github.com/DanielDe/org-web/issues/new][creating an issue]].\r\n** More features coming soon!\r\n* July 4th, 2017\r\n** Fixed bug with preserving header openness state across reloads\r\n* June 3rd, 2017\r\n** Added setting to preserve open headers across reloads\r\n* May 29th, 2017\r\n** Added setting to enable tapping the TODO label to advance the TODO state\r\n** Fixed export bug that caused blank descriptions to be exported as a newline\r\n* May 21st, 2017\r\n** Added some schnazzy (sp?) icons to the file chooser\r\n* May 20th, 2017\r\n** Added force touch/3d touch on devices that support it\r\n*** Force push the add header button (+) to reveal a new button that adds a new TODO header\r\n*** More uses of force push to come!\r\n* May 13th, 2017\r\n** Display tags more natively\r\n** Added link to the Github repo - bug reports, feature requests, and pull requests welcome!\r\n* May 7th, 2017\r\n** Confirmation is no longer required to remove a header, since its easy to undo now\r\n** Fixed bug where first action couldn\'t be undone\r\n* May 6th, 2017\r\n** Added undo button\r\n* April 29th, 2017\r\n** Backups are now made on first load of a file, rather than with every push. Should speed things up a bit!\r\n** Added some nice animations\r\n* April 27th, 2017\r\n** org-web is now open source! [[https://github.com/DanielDe/org-web]]\r\n** Added setting for larger font size\r\n** Added setting for fancy bullets\r\n** Added setting for cozier header spacing\r\n** Added a button to view new features (what you\'re reading now!)\r\n').getIn(["headers",0,"titleLine","rawTitle"]);n&&t&&a!==t&&this.props.base.setHasUnseenChangelog(!0),this.props.base.setLastSeenChangelogHeader(a)}},{key:"componentDidUpdate",value:function(){this.shouldPromptWhenLeaving()?window.onbeforeunload=function(){return!0}:window.onbeforeunload=void 0}},{key:"componentWillUnmount",value:function(){window.onbeforeunload=void 0}},{key:"renderChangelogFile",value:function(){return l.a.createElement(yr,{staticFile:"changelog",shouldDisableDirtyIndicator:!0,shouldDisableActions:!0,shouldDisableSyncButtons:!1,parsingErrorMessage:"The contents of changelog.org couldn't be loaded. You probably forgot to set the environment variable - see the Development section of README.org for details!"})}},{key:"renderSampleFile",value:function(){return l.a.createElement(yr,{staticFile:"sample",shouldDisableDirtyIndicator:!0,shouldDisableActionDrawer:!1,shouldDisableSyncButtons:!0,parsingErrorMessage:"The contents of sample.org couldn't be loaded. You probably forgot to set the environment variable - see the Development section of README.org for details!"})}},{key:"renderFileBrowser",value:function(e){var t=e.match.params.path,n=void 0===t?"":t;return n&&(n="/"+n),l.a.createElement(Aa,{path:n})}},{key:"renderFile",value:function(e){var t=e.match.params.path;return t&&(t="/"+t),l.a.createElement(yr,{path:t,shouldDisableDirtyIndicator:!1,shouldDisableActionDrawer:!1,shouldDisableSyncButtons:!1})}},{key:"shouldPromptWhenLeaving",value:function(){return this.props.location.pathname.startsWith("/file/")&&this.props.isDirty}},{key:"render",value:function(){var e=this.props,t=e.isAuthenticated,n=e.loadingMessage,a=e.fontSize,r=e.activeModalPage,i=e.pendingCapture,o=e.location.pathname,c=!!i&&"/file".concat(i.get("capturePath")),u=c&&c!==o,d=Ta()("entry-container",{"entry-container--large-font":"Large"===a});return l.a.createElement("div",{className:d},l.a.createElement(Ca,null),l.a.createElement(La,{message:n}),l.a.createElement(fa.a,{when:this.shouldPromptWhenLeaving(),message:function(){return"You have unpushed changes - are you sure you want to leave this page?"}}),"changelog"===r?this.renderChangelogFile():t?["keyboard_shortcuts_editor","settings","capture_templates_editor","sample"].includes(r)?l.a.createElement(s.Fragment,null,"settings"===r&&l.a.createElement(Er,null),"keyboard_shortcuts_editor"===r&&l.a.createElement(Tr,null),"capture_templates_editor"===r&&l.a.createElement(wr,null),"sample"===r&&this.renderSampleFile()):l.a.createElement(ba.a,null,u&&l.a.createElement(va.a,{to:c}),l.a.createElement(ya.a,{path:"/privacy-policy",exact:!0,component:Ia}),l.a.createElement(ya.a,{path:"/file/:path+",render:this.renderFile}),l.a.createElement(ya.a,{path:"/files/:path*",render:this.renderFileBrowser}),l.a.createElement(va.a,{to:"/files"})):l.a.createElement(ba.a,null,l.a.createElement(ya.a,{path:"/privacy-policy",exact:!0,component:Ia}),l.a.createElement(ya.a,{path:"/sample",exact:!0,render:this.renderSampleFile}),l.a.createElement(ya.a,{path:"/sign_in",exact:!0,component:Or}),l.a.createElement(ya.a,{path:"/",exact:!0,component:Oa}),l.a.createElement(va.a,{to:"/"})))}}]),t}(s.PureComponent),Nr=Object(Ea.a)(Object(v.b)(function(e,t){return{loadingMessage:e.base.get("loadingMessage"),isAuthenticated:e.syncBackend.get("isAuthenticated"),fontSize:e.base.get("fontSize"),lastSeenChangelogHeader:e.base.get("lastSeenChangelogHeader"),activeModalPage:e.base.get("modalPageStack",Object(ee.List)()).last(),pendingCapture:e.org.present.get("pendingCapture"),isDirty:e.org.present.get("isDirty")}},function(e){return{syncBackend:Object(y.b)(o,e),org:Object(y.b)(r,e),base:Object(y.b)(a,e)}})(Ar)),Lr=function(e){function t(e){var n;Object(p.a)(this,t),n=Object(m.a)(this,Object(f.a)(t).call(this,e)),Zn();var a=pn();window.initialHash=window.location.hash.substring(0);var r=$n(window.location.hash),i=gn("authenticatedSyncService",!0),o=null;if(i)switch(i){case"Dropbox":var s=r.access_token;if(s)o=ua(s),a.syncBackend=Object(ee.Map)({isAuthenticated:!0,client:o}),fn("dropboxAccessToken",s),window.location.hash="";else{var l=gn("dropboxAccessToken",!0);l&&(o=ua(l),a.syncBackend=Object(ee.Map)({isAuthenticated:!0,client:o}))}break;case"Google Drive":o=ma(),a.syncBackend=Object(ee.Map)({isAuthenticated:!0,client:o})}var c=$n(window.location.search),u=c.captureFile,h=c.captureTemplateName,b=c.captureContent;if(u&&h){var v=u.startsWith("/")?u:"/".concat(u),y=Object(ee.Map)(Object.entries(c).map(function(e){var t=Object(d.a)(e,2),n=t[0],a=t[1];return n.startsWith("captureVariable_")?[n.substring("captureVariable_".length),a]:null}).filter(function(e){return!!e}));a.org.present=a.org.present.set("pendingCapture",Object(ee.Map)({capturePath:v,captureTemplateName:h,captureContent:b,customCaptureVariables:y}))}return n.store=Qn(a),n.store.subscribe(mn(n.store)),o?o.isSignedIn().then(function(e){e?hn(n.store.dispatch,n.store.getState):n.store.dispatch(aa())}):n.store.getState().org.present.get("pendingCapture")&&n.store.dispatch(A("You need to sign in before you can use capture templates",5e3)),$.a.bindAll(Object(g.a)(n),["handleDragEnd"]),n}return Object(b.a)(t,e),Object(h.a)(t,[{key:"handleDragEnd",value:function(e){e.destination&&("CAPTURE-TEMPLATE"===e.type?this.store.dispatch(on(e.source.index,e.destination.index)):"TAG"===e.type?this.store.dispatch(Vt(e.source.index,e.destination.index)):"PROPERTY-LIST"===e.type&&this.store.dispatch(Bt(e.source.index,e.destination.index)))}},{key:"render",value:function(){return l.a.createElement(ta.a,{onDragEnd:this.handleDragEnd},l.a.createElement(ea.a,{basename:"/org-web"},l.a.createElement(v.a,{store:this.store},l.a.createElement("div",{className:"App"},l.a.createElement(Nr,null)))))}}]),t}(s.PureComponent),Mr=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Pr(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}u.a.render(l.a.createElement(Lr,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/org-web",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("/org-web","/service-worker.js");Mr?(function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):Pr(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):Pr(e)})}}()}},[[151,1,2]]]);
//# sourceMappingURL=main.765a5522.chunk.js.map