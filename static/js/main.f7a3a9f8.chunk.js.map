{"version":3,"sources":["components/HeaderBar/org-web.svg","components/SyncServiceSignIn/dropbox.svg","components/SyncServiceSignIn/google_drive.png","middleware/google_analytics_logging.js","actions/base.js","lib/timestamps.js","lib/export_org.js","lib/capture_template_substitution.js","lib/id_generator.js","lib/org_utils.js","lib/sample_capture_templates.js","actions/org.js","middleware/live_sync.js","middleware/sync_on_becoming_visible.js","actions/capture.js","util/settings_persister.js","reducers/base.js","lib/parse_org.js","reducers/org.js","reducers/capture.js","reducers/index.js","reducers/sync_backend.js","store.js","migrations/index.js","migrations/migrate_access_token_to_dropbox_access_token.js","migrations/migrate_store_in_dropbox_to_store_in_sync_backend.js","util/parse_query_string.js","actions/sync_backend.js","sync_backend_clients/dropbox_sync_backend_client.js","sync_backend_clients/google_drive_sync_backend_client.js","components/PrivacyPolicy/index.js","components/HeaderBar/index.js","components/Landing/index.js","components/FileBrowser/index.js","components/LoadingIndicator/index.js","components/OrgFile/components/AttributedString/components/TablePart/TableActionDrawer/index.js","components/OrgFile/components/AttributedString/components/TablePart/index.js","lib/color.js","components/UI/Checkbox/index.js","components/OrgFile/components/AttributedString/components/ListPart/ListActionDrawer/index.js","components/OrgFile/components/AttributedString/components/ListPart/index.js","components/OrgFile/components/AttributedString/components/TimestampPart/index.js","components/OrgFile/components/AttributedString/index.js","components/OrgFile/components/TitleLine/index.js","components/OrgFile/components/HeaderContent/components/PlanningItems/index.js","components/OrgFile/components/HeaderContent/components/PropertyListItems/index.js","components/OrgFile/components/HeaderContent/index.js","components/OrgFile/components/Header/components/HeaderActionDrawer/index.js","components/OrgFile/components/Header/index.js","components/OrgFile/components/HeaderList/index.js","components/OrgFile/components/ActionDrawer/components/ActionButton/index.js","components/OrgFile/components/ActionDrawer/index.js","components/UI/Switch/index.js","components/UI/Drawer/index.js","components/OrgFile/components/CaptureModal/index.js","components/OrgFile/components/SyncConfirmationModal/index.js","components/OrgFile/components/TagsEditorModal/index.js","components/UI/TabButtons/index.js","components/OrgFile/components/TimestampEditorModal/components/TimestampEditor/index.js","components/OrgFile/components/TimestampEditorModal/index.js","components/OrgFile/components/PropertyListEditorModal/index.js","components/OrgFile/components/AgendaModal/components/AgendaDay/index.js","components/OrgFile/components/AgendaModal/index.js","lib/keybindings.js","components/OrgFile/index.js","components/Settings/index.js","components/KeyboardShortcutsEditor/components/ShortcutRow/index.js","components/KeyboardShortcutsEditor/index.js","components/CaptureTemplatesEditor/components/CaptureTemplate/index.js","components/CaptureTemplatesEditor/index.js","components/SyncServiceSignIn/index.js","components/Entry/index.js","App.js","registerServiceWorker.js","index.js"],"names":["module","exports","__webpack_require__","p","google_analytics_logging","store","next","action","type","payload","Object","objectWithoutProperties","eventFieldsToRedact","SET_CURRENT_FILE_BROWSER_DIRECTORY_LISTING","AUTHENTICATE","DISPLAY_FILE","forEach","field","objectSpread","defineProperty","ga","JSON","stringify","setLoadingMessage","loadingMessage","hideLoadingMessage","setIsLoading","isLoading","setDisappearingLoadingMessage","delay","dispatch","setTimeout","setLastViewedFile","lastViewedPath","lastViewedContents","loadStaticFile","staticFile","getState","org","present","get","displayFile","changelog","sample","unloadStaticFile","stopDisplayingFile","base","setFontSize","newFontSize","setBulletStyle","newBulletStyle","setShouldTapTodoToAdvance","newShouldTapTodoToAdvance","setAgendaDefaultDeadlineDelayUnit","newAgendaDefaultDeadlineDelayUnit","setAgendaDefaultDeadlineDelayValue","newAgendaDefaultDeadlineDelayValue","setShouldLiveSync","shouldLiveSync","setShouldSyncOnBecomingVisibile","shouldSyncOnBecomingVisibile","setShouldStoreSettingsInSyncBackend","newShouldStoreSettingsInSyncBackend","client","syncBackend","deleteFile","catch","doesFileNotExist","error","alert","concat","deleteFileByNameAndParent","window","previousSettingsFileContents","setHasUnseenChangelog","newHasUnseenChangelog","setLastSeenChangelogHeader","newLastSeenChangelogHeader","setCustomKeybinding","keybindingName","keybinding","restoreBaseSettings","newSettings","pushModalPage","modalPage","popModalPage","clearModalStack","activatePopup","popupType","data","closePopup","renderAsText","timestamp","_timestamp$toJS","toJS","isActive","year","month","day","dayName","startHour","startMinute","endHour","endMinute","repeaterType","repeaterValue","repeaterUnit","delayType","delayValue","delayUnit","timestampText","getCurrentTimestamp","_ref","arguments","length","undefined","_ref$isActive","_ref$withStartTime","withStartTime","time","Date","formatDate","getCurrentTimestampAsText","locale","navigator","language","startsWith","koLocale","dateForTimestamp","_timestamp$toJS2","timestampString","padStart","parseDate","addTimestampUnitToDate","date","numUnits","timestampUnit","h","addHours","d","addDays","w","addWeeks","m","addMonths","y","addYears","formattedAttributedStringText","parts","map","part","getIn","join","attributedStringToRawText","prevParts","unshift","zip","linkPart","_ref2","slicedToArray","prevPart","text","tablePart","rowHeights","row","Math","max","apply","toConsumableArray","cell","_","countBy","numColumns","size","columnWidths","times","columnIndex","content","lineLengths","split","line","trim","dropRight","flatten","rowIndex","rowHeight","contentRows","lineIndex","formattedLineLengths","padCount","repeat","contentRow","separator","columnWidth","tablePartToRawText","listPart","bulletCharacter","previousNumber","item","optionalLeadingSpace","titleText","contentText","indentedContentText","listItemText","number","forceNumber","stateCharacter","checked","unchecked","partial","listPartToRawText","timestampPartToRawText","console","optionalNewlinePrefix","includes","endsWith","capture_template_substitution","templateString","customVariables","Map","substitutions","%t","%T","%u","%U","entrySeq","key","value","substitutedString","entries","_ref3","_ref4","formatString","replace","RegExp","cursorIndex","indexOf","id_generator","nextId","indexOfHeaderWithId","headers","headerId","findIndex","header","headerWithId","subheadersOfHeaderWithId","headerIndex","afterHeaders","slice","nextSiblingHeaderIndex","siblingHeader","numSubheadersOfHeaderWithId","parentIdOfHeaderWithId","parentHeader","reverse","find","previousHeader","isHeaderVisible","parentHeaderId","openDirectParent","state","i","directParentIdOfHeaderWithId","parentHeaderIndex","setIn","headerWithPath","headerPath","firstHeader","first","skip","tablePartContainsCellId","cellId","some","headerThatContainsTableCellId","doesAttributedStringContainTableCellId","filter","pathAndPartOfTimestampItemWithIdInAttributedString","timestampId","partIndex","path","timestampPart","itemIndex","pathAndPart","result","cellIndex","pathAndPartOfListContainingItemIdInAttributedString","itemId","listPartContainsItemId","pathAndPartOfListItemWithIdInHeaders","listItemId","pathAndPartOfListItemWithIdInAttributedString","listItemPart","pathAndPartOfTableContainingCellIdInHeaders","pathAndPartOfTableContainingCellIdInAttributedString","updateTableContainingCellId","updaterCallbackGenerator","_pathAndPartOfTableCo","rowIndexContainingCellId","columnIndexContainingCellId","updateIn","updateListContainingListItemId","_pathAndPartOfListCon","pathAndPartOfListContainingItemIdInHeaders","itemIndexContainingId","updateContentsWithListItemAddition","listItem","last","insertIdx","insert","set","generateId","List","fromJS","id","items","numberTerminatorCharacter","isOrdered","update","push","timestampWithIdInAttributedString","todoKeywordSetForKeyword","todoKeywordSets","keyword","keywordSet","contains","description","headerPaths","iconName","isAvailableInAllOrgFiles","letter","orgFilesWhereAvailable","shouldPrepend","template","isSample","contents","setLastSyncAt","lastSyncAt","ActionTypes","CLEAR_HISTORY","unfocusHeader","sync","_ref$forceAction","forceAction","_ref$successMessage","successMessage","_ref$shouldSuppressMe","shouldSuppressMessages","setOrgFileErrorMessage","getFileContentsAndMetadata","then","lastModifiedAt","isDirty","lastServerModifiedAt","isAfter","updateFile","fileConfigLines","linesBeforeHeadings","configContent","todoKeywordSet","nestingLevel","titleLine","todoKeyword","rawTitle","tags","tag","planningItems","planningItemsContent","planningItem","trimRight","propertyListItems","propertyListItem","property","rawDescription","exportOrg","setDirty","addSeconds","toString","applyOpennessState","openHeader","toggleHeaderOpened","selectHeader","setSelectedTableCellId","setSelectedListItemId","selectHeaderAndOpenParents","advanceTodoState","dirtying","enterEditMode","editModeType","exitEditMode","updateHeaderTitle","newRawTitle","updateHeaderDescription","newRawDescription","addHeader","selectNextSiblingHeader","addHeaderAndEdit","selectNextVisibleHeader","selectPreviousVisibleHeader","removeHeader","moveHeaderUp","moveHeaderDown","moveHeaderLeft","moveHeaderRight","moveSubtreeLeft","moveSubtreeRight","focusHeader","noOp","addNewTableRow","removeTableRow","addNewTableColumn","removeTableColumn","moveTableRowDown","moveTableRowUp","moveTableColumnLeft","moveTableColumnRight","updateTableCellValue","newValue","insertCapture","templateId","capture","sampleCaptureTemplates","clearPendingCapture","insertPendingCapture","pendingCapture","templateName","captureContent","customCaptureVariables","history","pushState","location","pathname","_substituteTemplateVa","substituteTemplateVariables","_substituteTemplateVa2","substitutedTemplate","initialCursorIndex","substring","advanceCheckboxState","updateListTitleValue","updateListContentsValue","addNewListItem","selectNextSiblingListItem","addNewListItemAndEdit","removeListItem","moveListItemUp","moveListItemDown","moveListItemLeft","moveListItemRight","moveListSubtreeLeft","moveListSubtreeRight","setHeaderTags","reorderTags","fromIndex","toIndex","reorderPropertyList","updateTimestampWithId","newTimestamp","updatePlanningItemTimestamp","planningItemIndex","addNewPlanningItem","planningType","updatePropertyListItems","newPropertyListItems","message","live_sync","debouncedDispatchSync","debounce","sync_on_becoming_visible","addEventListener","addNewEmptyCaptureTemplate","updateTemplateFieldPathValue","fieldPath","addNewTemplateOrgFileAvailability","removeTemplateOrgFileAvailability","orgFileAvailabilityIndex","addNewTemplateHeaderPath","removeTemplateHeaderPath","headerPathIndex","deleteTemplate","restoreCaptureSettings","reorderCaptureTemplate","isLocalStorageAvailable","localStorage","setItem","getItem","e","debouncedPushConfigToSyncBackend","syncBackendClient","createFile","maxWait","persistableFields","category","name","shouldStoreInConfig","default","getFieldsToPersist","fields","depreacted","getConfigFileContents","fieldsToPersist","fromPairs","readInitialState","initialState","past","future","parse","templates","opennessState","opennessStateJSONString","readOpennessState","loadSettingsFromConfigFile","fileContentsPromise","getFileContents","getFileContentsByNameAndParent","configFileContents","config","_error","subscribeToChanges","settingsFileContents","currentFilePath","openHeaderPaths","getOpenHeaderPaths","openedHeaders","_loop","_i","title","subheaders","openSubheaderPaths","openedSubheaderPath","persistField","getPersistedField","nullable","applyCategorySettingsFromConfig","markupAndCookieRegex","timestampRegex","timestampFromRegexMatch","match","partIndices","_partIndices$map","_partIndices$map2","typeBracket","timeStart","timeEnd","firstDelayRepeatType","firstDelayRepeatValue","firstDelayRepeatUnit","secondDelayRepeatType","secondDelayRepeatValue","secondDelayRepeatUnit","parseMarkupAndCookies","rawText","_ref5","_ref5$shouldAppendNew","shouldAppendNewline","matches","excludeCookies","exec","uri","index","percentCookieMatch","percentage","fractionCookieMatch","fraction","markupType","~","*","/","+","=","markupPrefixLength","firstTimestamp","range","secondTimestamp","lineParts","startIndex","trailingText","parseTable","tableLines","table","columnProperties","lastRow","lineCells","substr","cellContents","rawContents","maxNumColumns","parseRawText","_ref6$excludeContentE","excludeContentElements","lines","LIST_HEADER_REGEX","currentListHeaderNestingLevel","rawLineParts","numLeadingSpaces","processedLineParts","linePart","takeWhile","contentLines","checkboxState","isCheckbox"," ","X","-","newListItem","lastIndex","parseDescriptionPrefixElements","planningItemsParse","singlePlanningItemRegex","concatRegexes","optionalSinglePlanningItemRegex","planningRegex","planningMatch","planningTypeIndex","strippedDescription","_parsePlanningItems","propertyListParse","propertiesLineIndex","endLineIndex","parsePropertyList","defaultKeywordSets","keywords","completedKeywords","parseTitleLine","flatMap","titleParts","possibleTags","test","newHeaderWithTitle","opened","_len","regexes","Array","_key","reduce","prev","curr","parseOrg","fileContents","keywordTokens","pipeIndex","configLine","_parseDescriptionPref2","updateCookiesInAttributedStringWithChildCompletionStates","completionStates","doneCount","isDone","totalCount","floor","updateCookiesOfHeaderWithId","directChildren","subheader","updateCookiesOfParentOfHeaderWithId","currentTodoState","currentTodoSet","newStateIndex","newTodoState","indexedPlanningItemsWithRepeaters","currentDate","newDate","isBefore","applyRepeater","lastRepeatTimestamp","newLastRepeatValue","nextVisibleHeader","nextVisibleHeaderAfterIndex","previousVisibleHeader","previousVisibleHeaderAfterIndex","fileOpennessState","prevMemoHeader","findLast","prevOpened","openHeaderPath","openHeaderWithPath","maxNestingLevel","firstTitle","rest","take","takeLast","nextMemoHeader","nextOpened","updateDescriptionOfHeaderContainingTableCell","selectedTableCellId","rows","newEmptyTableRowLikeRows","_rowIndex","colIndex","isTopLevelTarget","newHeader","_parseDescriptionPref","newHeaderFromText","numSubheaders","newIndex","newCheckboxState","updateParentListCheckboxes","itemPath","parentListItemPath","parentListItem","has","childrenCheckedStates","checkboxItem","every","childCompletionStates","updateDescriptionOfHeaderContainingListItem","selectedListItemId","newItem","containingHeader","headerThatContainsListItemId","delete","selectedListItem","selectedListItemIndex","partOfPath","parentListItemWithIdInHeaders","_item","_pathAndPart2","_pathAndPart3","propertyListItemIndex","plistPathAndPart","indexOfTemplateWithId","captureTemplates","applyCaptureSettingsFromConfig","combineReducers","stack","pop","signOut","listing","directoryListing","hasMore","additionalSyncBackendState","setCurrentFileBrowserDirectoryListing","currentFileBrowserDirectoryListing","isLoadingMore","setIsLoadingMoreDirectoryListing","undoable","parsedFile","isOpened","openParentsOfHeader","newTitleLine","nextSibling","numHeadersToRemove","previousSiblingIndex","indexOfPreviousSibling","nextSiblingIndex","nextSiblingSubheaders","previousParentHeaderId","counter","prevSiblingItemIndex","prevSiblingItemContentsPath","childrenListParts","selectedHeaderId","splice","newPlanningItem","includeAction","linearizeHistory","templateIndex","orgFiles","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","src_store","createStore","rootReducer","applyMiddleware","thunk","googleAnalyticsLogger","liveSync","syncOnBecomingVisible","migrations","accessToken","removeItem","migrateAccessTokenToDropboxAccessToken","shouldStoreSettingsInDropbox","migrateStoreInDropboxToStoreInSyncBackend","parseQueryString","str","ret","create","param","shift","val","decodeURIComponent","isArray","token","gapi","getToken","google","accounts","oauth2","revoke","setToken","reload","getDirectoryListing","log","msg","status","warn","authURL","Dropbox","clientId","process","fetch","getAuthenticationUrl","origin","loadMoreDirectoryListing","getMoreDirectoryListing","extendedListing","pushBackup","pathOrFileId","duplicateFile","fileName","downloadFile","dropbox_sync_backend_client","dropboxClient","transformDirectoryListing","entry","isDirectory","path_display","uploadFile","Promise","resolve","reject","filesUpload","mode",".tag","autorename","filesDownload","response","reader","FileReader","server_modified","readAsText","fileBlob","Response","isSignedIn","filesListFolder","has_more","cursor","filesListFolderContinue","filesDelete","google_drive_sync_backend_client","getAPIClient","isInited","isIniting","afterInitCallbacks","load","init","apiKey","discoveryDocs","asyncToGenerator","regenerator_default","a","mark","_callee","googleDriveAccessTokenString","googleDriveAccessToken","wrap","_context","initTokenClient","client_id","scope","callback","requestAccessToken","prompt","stop","handleGoogleDriveClientLoad","getFiles","directoryId","nextPageToken","fileListPromise","drive","files","list","pageSize","q","pageToken","mimeType","currentDirectoryId","fileParentPromise","fileId","parents","rootFolderIdPromise","rootFolderId","all","parentId","directoryParentId","fileIdByNameAndParent","method","Authorization","auth","access_token","body","alt","escape","errors","reason","fileModifiedTimePromise","modifiedTime","_ref6","fileNameCallback","getResponse","newFileName","backupFileId","makeCopy","copy","copyResponse","listResponse","PrivacyPolicy","react_default","createElement","className","HeaderBar","props","_this","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","bindAll","assertThisInitialized","_this$props","syncBackendType","directoryPath","pathParts","parentDirectoryName","parentPath","Link","to","filePath","src","logo","width","height","onClick","handleSettingsSubPageBackClick","activeModalPage","renderSettingsSubPageBackButton","getPathRoot","renderLogo","renderFileBrowserBackButton","renderOrgFileBackButton","renderSampleFileBackButton","renderSignInBackButton","titleContainerWithText","isUndoEnabled","undo","_this$props2","isAuthenticated","hasUnseenChangelog","handleModalPageDoneClick","undoIconClassName","classNames","header-bar__actions__item--disabled","settingsIconClassName","settings-icon--has-unseen-changelog","href","target","rel","react","handleUndoClick","handleHelpClick","handleSettingsClick","header-bar--with-logo","renderBackButton","renderTitle","renderActions","PureComponent","withRouter","connect","bindActionCreators","baseActions","undoActions","Landing","syncBackendActions","useEffect","isTopLevelDirectory","getParentDirectoryPath","file","isBackupFile","isOrgFile","isSettingsFile","iconClass","fa-folder","file-browser__file-list__icon--directory","fa-file","file-browser__file-list__icon--not-org","fa-copy","fa-cogs","LoadingIndicator","_useState","useState","_useState2","shouldRenderIndicator","setShouldRenderIndicator","_useState3","_useState4","lastMessage","setLastMessage","handleClick","style","opacity","spring","stiffness","react_motion","onRest","TableActionDrawer","_ref$subPartDataAndHa","subPartDataAndHandlers","onEnterTableEditMode","onAddNewTableRow","onRemoveTableRow","onAddNewTableColumn","onRemoveTableColumn","TablePart","rawCellValues","generateCellValueMap","shouldIgnoreBlur","prevProps","_this$props$subPartDa","onTableCellValueUpdate","inTableEditMode","setState","_this2","onTableCellSelect","_this3","onExitTableEditMode","event","cellValue","insertionIndex","textarea","selectionStart","selectionEnd","focus","_this4","_this$props$subPartDa2","shouldDisableActions","isTableSelected","isCellSelected","table-part__cell--selected","handleCellSelect","autoFocus","onBlur","handleTextareaBlur","onChange","handleCellChange","ref","handleTextareaRef","handleInsertTimestamp","AttributedString","react_collapse_lib","interpolateColors","colorA","colorB","interpolationFactor","r","parseInt","g","b","rgbaObject","rgbaString","rgba","Checkbox","uncheckedColor","checkedColor","checkboxStyle","colorFactor","backgroundColor","ListActionDrawer","onEnterListTitleEditMode","onEnterListContentsEditMode","onAddNewListItem","onRemoveListItem","ListPart","listTitleValues","generateListTitleValueMap","listContentsValues","generateListContentsValueMap","onListTitleValueUpdate","onListContentsValueUpdate","inListTitleEditMode","inListContentsEditMode","_this$state","prevSelectedListItemId","onListItemSelect","onCheckboxClick","onExitListTitleEditMode","listTitleValue","listContentsValue","_this5","_this$state2","isItemSelected","lineContainerClass","list-part__not_checkbox-container","list-part__checkbox-container","list-part__item--selected","handleListItemSelect","handleCheckboxClick","handleListTitleChange","handleInsertTimestampListTitle","handleListContentsChange","handleInsertTimestampListContents","renderContent","TimestampPart","onTimestampClick","attributed-string__cookie-part--complete","TablePart_TablePart","ListPart_ListPart","TitleLine","titleValue","calculateRawTitle","containerWidth","containerDiv","offsetWidth","storeContainerWidth","inEditMode","div","span","titleSpan","hasContent","isSelected","shouldTapTodoToAdvance","stopPropagation","newTitle","lastCharacter","_this$props3","color","shouldDisableExplicitWidth","titleStyle","wordBreak","handleTitleClick","handleRef","toLowerCase","handleTodoClick","handleTitleChange","handleTitleFieldClick","handleTitleSpanRef","handleTimestampClick","toSet","toList","orgActions","PlanningItems","PropertyListItems","onEdit","isDrawerCollapsed","setIsDrawerCollapsed","HeaderContent","descriptionValue","calculateRawDescription","planningItemsText","propertyListItemsText","descriptionText","preventDefault","newCursorPos","newText","setSelectionRange","isFocused","indentLevel","startWhitespaces","indentStr","editMinLines","leftMargin","marginLeft","min","handleDescriptionChange","onFocus","scrollTop","scrollHeight","onKeyDown","currentContent","caretPosition","beforeText","afterText","newlineText","PlanningItems_PlanningItems","handlePlanningItemTimestampClick","handlePropertyListEdit","handleTableCellSelect","handleExitTableEditMode","handleTableCellValueUpdate","handleEnterTableEditMode","handleAddNewTableRow","handleRemoveTableRow","handleAddNewTableColumn","handleRemoveTableColumn","handleEnterListTitleEditMode","handleExitListTitleEditMode","handleListTitleValueUpdate","handleEnterListContentsEditMode","onExitListContentsEditMode","handleExitListContentsEditMode","handleListContentsValueUpdate","handleAddNewListItem","handleRemoveListItem","HeaderActionDrawer","onEnterTitleEditMode","onEnterDescriptionEditMode","onUnfocus","iconWithFFClickCatcher","Header","SWIPE_ACTION_ACTIVATION_DISTANCE","FREE_DRAG_ACTIVATION_DISTANCE","isDraggingFreely","dragStartX","dragStartY","currentDragX","isPlayingRemoveAnimation","heightBeforeRemove","onRef","dragX","dragY","closest","abs","swipeDistance","offsetHeight","handleDragStart","clientX","clientY","handleDragMove","handleDragEnd","handleDragCancel","changedTouches","classList","existingDeadlinePlanningItemIndex","handleDeadlineAndScheduledClick","bulletStyle","focusedHeader","_this$state3","paddingLeft","heightFactor","header--selected","header--removing","handleRest","interpolatedStyle","swipedDistance","isLeftActionActivated","isRightActionActivated","disabledColor","leftActivatedColor","rightActivatedColor","leftSwipeActionContainerStyle","backgroundColorFactor","rightSwipeActionContainerStyle","leftIconStyle","display","rightIconStyle","headerStyle","handleHeaderClick","onMouseDown","handleMouseDown","onMouseMove","handleMouseMove","onMouseUp","handleMouseUp","onMouseOut","handleMouseOut","onTouchStart","handleTouchStart","onTouchMove","handleTouchMove","onTouchEnd","handleTouchEnd","onTouchCancel","handleTouchCancel","leftInterpolatedStyle","leftStyle","rightInterpolatedStyle","rightStyle","components_TitleLine","springConfig","marginRight","HeaderActionDrawer_HeaderActionDrawer","handleEnterTitleEditMode","handleEnterDescriptionEditMode","onTagsClick","handleShowTagsModal","handleFocus","handleUnfocus","onAddNewHeader","handleAddNewHeader","onDeadlineClick","handleDeadlineClick","onScheduledClick","handleScheduledClick","components_HeaderContent","HeaderList","headerRefs","selectedHeaderDiv","boundingRectangle","getBoundingClientRect","viewportHeight","document","documentElement","clientHeight","top","bottom","scrollIntoView","focusedHeaderId","headerRenderData","displayed","toArray","headerRenderDatum","previousRenderDatum","followingHeaders","followingHeaderIndex","followingHeader","focusedHeaderIndex","headerColors","displayedHeaderRenderData","header-list-container--focused","components_Header","handleHeaderRef","ActionButton","isDisabled","_classNames","subIconName","shouldRotateSubIcon","additionalClassName","tooltip","shouldSpinSubIcon","fas","fa-lg","subIconClassName","action-drawer__btn__sub-icon--rotated","fa-spin","isFocusedHeaderActive","captureActions","shouldDisableSyncButtons","isDisplayingArrowButtons","setIsDisplayingArrowButtons","isDisplayingCaptureButtons","setIsDisplayingCaptureButtons","querySelector","paddingBottom","mainArrowButton","useRef","mainArrowButtonBoundingRect","useMemo","current","handleUpClick","handleDownClick","handleLeftClick","handleRightClick","handleMoveSubtreeLeftClick","handleMoveSubtreeRightClick","getAvailableCaptureTemplates","availablePath","handleMainArrowButtonClick","handleMainCaptureButtonClick","ActionButton_ActionButton","baseArrowButtonStyle","boxShadow","centerXOffset","screen","x","animatedStyles","topRowYOffset","bottomRowYOffset","firstColumnXOffset","secondColumnXOffset","subIconNameStr","tooltipUpStr","tooltipDownStr","tooltipLeftStr","tooltipRightStr","left","right","renderMovementButtons","availableCaptureTemplates","baseCaptureButtonStyle","position","zIndex","mainButtonStyle","animatedStyle","renderCaptureButtons","UI_Switch","isEnabled","onToggle","enabledColor","switchStyle","grabberStyle","Drawer","children","shouldIncludeCloseButton","onClose","isVisible","setIsVisible","dragOffsetY","setDragOffsetY","useLayoutEffect","initialClientY","innerContainer","innerContainerHeight","handleInnerContainerClick","handleClose","targetTouches","isScrollingDown","handleTouchEndOrCancel","removeEventListener","outerClassName","drawer-outer-container--visible","innerStyle","offsetY","innerHeight","transform","CaptureModal","onCapture","_useMemo","_useMemo2","targetHeader","textareaValue","setTextareaValue","setShouldPrepend","capture-modal-header-path--top-level","SyncConfirmationModal","onPull","onPush","onCancel","distanceInWordsToNow","TagsEditorModal","allTags","prevTags","currentTags","lastTextfield","tagIndex","newTag","headerTags","react_beautiful_dnd_esm","droppableId","provided","snapshot","assign","innerRef","droppableProps","draggableId","tag-container--dragging","isDragging","draggableProps","handleTagChange","textfield","handleRemoveTag","dragHandleProps","placeholder","handleAddNewTag","all-tags__tag--in-use","handleExistingTagClick","TabButtons","buttons","selectedButton","useEqualWidthTabs","onSelect","handleButtonClick","buttonName","containerClassName","tab-buttons--equal-width-tabs","gridTemplateColumns","tab-buttons__btn--selected","TimestampEditor","_formatDate$split","_formatDate$split2","newYear","newMonth","newDay","newDayName","startOrEnd","_this2$props","hourKey","minuteKey","_formatDate$split3","_formatDate$split4","hour","minute","_this3$props","_this4$props","_event$target$value$s","_event$target$value$s2","newRepeaterType","_this$props4","_this$props5","newRepeaterUnit","_this$props6","_this$props7","_this$props8","newDelayType","_this$props9","_this$props10","newDelayUnit","_this$props11","label","timeKey","showRemoveButton","handleTimeChange","handleRemoveTime","handleAddTime","_this$props$timestamp","handleRepeaterTypeChange","handleRepeaterValueChange","handleRepeaterUnitChange","handleRemoveRepeater","handleAddRepeater","_this$props$timestamp2","handleDelayTypeChange","handleDelayValueChange","handleDelayUnitChange","handleRemoveDelay","handleAddDelay","handleActiveToggle","handleDateChange","renderTimeField","renderRepeater","renderDelay","TimestampEditorModal","singleTimestampOnly","TimestampEditor_TimestampEditor","handleChange","handleRemoveEndTimestamp","handleAddEndTimestamp","PropertyListEditorModal","prevItems","currentItems","propertyListItemId","property-list-editor__item-container--dragging","handlePropertyChange","handleValueChange","handleRemoveItem","handleAddNewItem","AgendaDay","onHeaderClick","dateDisplayType","onToggleDateDisplayType","agendaDefaultDeadlineDelayValue","agendaDefaultDeadlineDelayUnit","dateStart","startOfDay","dateEnd","endOfDay","planningItemsAndHeaders","planningItemDate","isTodoKeywordCompleted","isToday","appearDate","subHours","subDays","subWeeks","subMonths","subYears","subtractTimestampUnitFromDate","isEqual","isWithinRange","hasBeenRepeated","sortBy","_planningItem$get$toJ","hasTodoKeyword","dateClassName","agenda-day__header-planning-date--overdue","isPast","AgendaModal","selectedDate","timeframeType","weekStart","startOfWeek","weekEnd","_this$state4","dates","daysAfter","monthStart","startOfMonth","getDaysInMonth","handleTimeframeTypeChange","handlePreviousDateClick","calculateTimeframeHeader","handleNextDateClick","AgendaDay_AgendaDay","handleToggleDateDisplayType","DEFAULT_BINDINGS","calculateNamedKeybindings","customKeybindings","bindingName","binding","OrgFile","hasUncaughtError","loadedPath","container","newTags","activePopupData","popupData","activePopupType","selectedHeader","handleSyncConfirmationPull","handleSyncConfirmationPush","handleSyncConfirmationCancel","handleCapture","handlePopupClose","TagsEditorModal_TagsEditorModal","OrderedSet","sort","handleTagsChange","editingTimestamp","timestampWithId","TimestampEditorModal_TimestampEditorModal","handleTimestampChange","PropertyListEditorModal_PropertyListEditorModal","handlePropertyListItemsChange","components_AgendaModal","shouldDisableDirtyIndicator","parsingErrorMessage","orgFileErrorMessage","Redirect","keyMap","bindingAction","calculateActionedKeybindings","preventDefaultAndHandleEditMode","ignoreInEditMode","activeElement","nodeName","handlers","handleSelectNextVisibleHeaderHotKey","handleSelectPreviousVisibleHeaderHotKey","handleToggleHeaderOpenedHotKey","advanceTodo","handleAdvanceTodoHotKey","editTitle","handleEditTitleHotKey","editDescription","handleEditDescriptionHotKey","handleExitEditModeHotKey","handleAddHeaderHotKey","handleRemoveHeaderHotKey","handleMoveHeaderUpHotKey","handleMoveHeaderDownHotKey","handleMoveHeaderLeftHotKey","handleMoveHeaderRightHotKey","handleUndoHotKey","index_es","tabIndex","handleContainerRef","components_HeaderList","components_ActionDrawer","renderActivePopup","activePopup","fontSize","shouldStoreSettingsInSyncBackend","confirm","ShortcutRow","isEditMode","rebindArea","handleKeyPress","code","Minus","Equal","Backspace","Enter","Return","Tab","BracketLeft","BracketRight","Semicolon","Quote","Backslash","Comma","Period","Slash","newModifiers","modifier","newBinding","onBindingChange","currentBinding","symbol","rebindAreaClassName","keyboard-shortcut-container__shortcut-key--edit-mode","handleRebindClick","symbolizeKeybinding","handleBindingChange","alreadyInUseBinding","ShortcutRow_ShortcutRow","CaptureTemplate","onFieldPathUpdate","onAddNewTemplateOrgFileAvailability","onRemoveTemplateOrgFileAvailability","onAddNewTemplateHeaderPath","onRemoveTemplateHeaderPath","onDeleteTemplate","isCollapsed","setIsCollapsed","handleHeaderBarClick","updateField","fieldName","toggleAvailabilityInAllOrgFiles","togglePrepend","handleAddNewOrgFileAvailability","handleRemoveOrgFileAvailability","handleOrgFileAvailabilityChange","handleAddNewHeaderPath","handleRemoveHeaderPath","handleHeaderPathChange","handleDeleteClick","caretClassName","capture-template-container__header__caret--rotated","capture-template-container--dragging","renderDescriptionField","maxLength","autoCapitalize","autoCorrect","renderIconField","orgFilePath","renderOrgFileAvailability","marginTop","renderHeaderPaths","renderPrependField","renderTemplateField","handleFieldPathUpdate","handleAddNewTemplateOrgFileAvailability","handleRemoveTemplateOrgFileAvailability","handleAddNewTemplateHeaderPath","handleRemoveTemplateHeaderPath","handleDeleteTemplate","handleReorderTemplate","onReorder","SyncServiceSignIn","handleDropboxClick","DropboxLogo","handleGoogleDriveClick","GoogleDriveLogo","Entry","lastSeenChangelogHeader","firstHeaderTitle","shouldPromptWhenLeaving","onbeforeunload","components_OrgFile","shouldDisableActionDrawer","_ref$match$params$pat","params","components_FileBrowser","pendingCapturePath","shouldRedirectToCapturePath","entry-container--large-font","components_HeaderBar","Prompt","when","renderChangelogFile","components_Settings","components_KeyboardShortcutsEditor","components_CaptureTemplatesEditor","renderSampleFile","Switch","Route","exact","component","render","renderFile","renderFileBrowser","App","runAllMigrations","initialHash","hash","hashContents","authenticatedSyncService","dropboxAccessToken","createDropboxSyncBackendClient","persistedDropboxAccessToken","createGoogleDriveSyncBackendClient","queryStringContents","search","captureFile","captureTemplateName","capturePath","Store","subscribe","destination","source","onDragEnd","HashRouter","basename","es","components_Entry","Boolean","hostname","serviceWorker","ready","registration","unregister","ReactDOM","App_App","getElementById"],"mappings":"6EAAAA,EAAAC,QAAiBC,EAAAC,EAAuB,yDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,yDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,g3MCEzBC,EAAA,SAAAC,GAAK,OAAI,SAAAC,GAAI,OAAI,SAAAC,GAAU,IAClCC,EAAqBD,EAArBC,KAASC,EADyBC,OAAAC,EAAA,EAAAD,CACbH,EADa,UAGlCK,EAAsB,CAC1BC,2CAA4C,CAAC,oBAC7CC,aAAc,CAAC,sBACfC,aAAc,CAAC,aAWjB,OARMH,EAAoBJ,IACxBI,EAAoBJ,GAAMQ,QAAQ,SAAAC,GAChCR,EAAOC,OAAAQ,EAAA,EAAAR,CAAA,GAAQD,EAARC,OAAAS,EAAA,EAAAT,CAAA,GAAkBO,EAAQ,mBAIrCG,GAAG,OAAQ,QAAS,SAAUZ,EAAMa,KAAKC,UAAUb,IAE5CH,EAAKC,uBCfDgB,EAAoB,SAAAC,GAAc,MAAK,CAClDhB,KAAM,sBACNgB,mBAGWC,EAAqB,iBAAO,CACvCjB,KAAM,yBAGKkB,EAAe,SAAAC,GAAS,MAAK,CACxCnB,KAAM,iBACNmB,cAGWC,EAAgC,SAACJ,EAAgBK,GAAjB,OAA2B,SAAAC,GACtEA,EAASP,EAAkBC,IAC3BO,WAAW,kBAAMD,EAASL,MAAuBI,KAGtCG,EAAoB,SAACC,EAAgBC,GAAjB,MAAyC,CACxE1B,KAAM,uBACNyB,iBACAC,uBAGWC,EAAiB,SAAAC,GAC5B,OAAO,SAACN,EAAUO,GAChBP,EACEE,EAAkBK,IAAWC,IAAIC,QAAQC,IAAI,QAASH,IAAWC,IAAIC,QAAQC,IAAI,cAQnFV,EAASW,GAAY,KALA,CACnBC,UAAS,wxOACTC,OAAM,ijYACNP,OAMOQ,EAAmB,WAC9B,OAAO,SAACd,EAAUO,GAChBP,EAASe,MAEHR,IAAWS,KAAKN,IAAI,mBACxBV,EACEW,GACEJ,IAAWS,KAAKN,IAAI,kBACpBH,IAAWS,KAAKN,IAAI,0BAOjBO,EAAc,SAAAC,GAAW,MAAK,CACzCxC,KAAM,gBACNwC,gBAGWC,EAAiB,SAAAC,GAAc,MAAK,CAC/C1C,KAAM,mBACN0C,mBAGWC,EAA4B,SAAAC,GAAyB,MAAK,CACrE5C,KAAM,iCACN4C,8BAGWC,EAAoC,SAAAC,GAAiC,MAAK,CACrF9C,KAAM,yCACN8C,sCAGWC,EAAqC,SAAAC,GAAkC,MAAK,CACvFhD,KAAM,0CACNgD,uCAGWC,EAAoB,SAAAC,GAAc,MAAK,CAClDlD,KAAM,uBACNkD,mBAGWC,EAAkC,SAAAC,GAA4B,MAAK,CAC9EpD,KAAM,sCACNoD,iCAGWC,EAAsC,SAAAC,GACjD,OAAO,SAAChC,EAAUO,GAMhB,GALAP,EAAS,CACPtB,KAAM,4CACNsD,yCAGGA,EAAqC,CACxC,IAAMC,EAAS1B,IAAW2B,YAAYxB,IAAI,UAC1C,OAAQuB,EAAOvD,MACb,IAAK,UACHuD,EACGE,WAAW,yBACXC,MAAM,SAACC,EAAkBC,GAAnB,OACLD,EACI,KACAE,MAAK,sEAAAC,OACmEF,MAGhF,MACF,IAAK,eACHL,EAAOQ,0BAA0B,uBAAwB,QAK7DC,OAAOC,6BAA+B,QAK/BC,EAAwB,SAAAC,GAAqB,MAAK,CAC7DnE,KAAM,2BACNmE,0BAGWC,EAA6B,SAAAC,GAA0B,MAAK,CACvErE,KAAM,iCACNqE,+BAGWC,EAAsB,SAACC,EAAgBC,GAAjB,MAAiC,CAClExE,KAAM,wBACNuE,iBACAC,eAGWC,EAAsB,SAAAC,GAAW,MAAK,CACjD1E,KAAM,wBACN0E,gBAGWC,EAAgB,SAAAC,GAAS,MAAK,CACzC5E,KAAM,kBACN4E,cAGWC,EAAe,iBAAO,CACjC7E,KAAM,mBAGK8E,EAAkB,iBAAO,CACpC9E,KAAM,sBAGK+E,EAAgB,SAACC,EAAWC,GAAZ,MAAsB,CACjDjF,KAAM,iBACNgF,YACAC,SAGWC,EAAa,iBAAO,CAC/BlF,KAAM,oHCtJKmF,GAAe,SAAAC,GAAa,IAAAC,EAiBnCD,EAAUE,OAfZC,EAFqCF,EAErCE,SACAC,EAHqCH,EAGrCG,KACAC,EAJqCJ,EAIrCI,MACAC,EALqCL,EAKrCK,IACAC,EANqCN,EAMrCM,QACAC,EAPqCP,EAOrCO,UACAC,EARqCR,EAQrCQ,YACAC,EATqCT,EASrCS,QACAC,EAVqCV,EAUrCU,UACAC,EAXqCX,EAWrCW,aACAC,EAZqCZ,EAYrCY,cACAC,EAbqCb,EAarCa,aACAC,EAdqCd,EAcrCc,UACAC,EAfqCf,EAerCe,WACAC,EAhBqChB,EAgBrCgB,UAGEC,EAAgB,GAUpB,OATAA,GAAiBf,EAAW,IAAM,IAClCe,GAAa,GAAAxC,OAAO0B,EAAP,KAAA1B,OAAe2B,EAAf,KAAA3B,OAAwB4B,GACrCY,GAAmBX,EAAF,IAAA7B,OAAgB6B,GAAY,GAC7CW,GAAmBV,EAAF,IAAA9B,OAAkB8B,EAAlB,KAAA9B,OAA+B+B,GAAgB,GAChES,GAAmBR,EAAF,IAAAhC,OAAgBgC,EAAhB,KAAAhC,OAA2BiC,GAAc,GAC1DO,GAAmBN,EAAF,IAAAlC,OAAqBkC,GAArBlC,OAAoCmC,GAApCnC,OAAoDoC,GAAiB,GACtFI,GAAmBH,EAAF,IAAArC,OAAkBqC,GAAlBrC,OAA8BsC,GAA9BtC,OAA2CuC,GAAc,GAC1EC,GAAiBf,EAAW,IAAM,KAKvBgB,GAAsB,WAAqD,IAAAC,EAAAC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAP,GAAOG,EAAAJ,EAAlDjB,gBAAkD,IAAAqB,KAAAC,EAAAL,EAAjCM,qBAAiC,IAAAD,KAChFE,EAAO,IAAIC,KAEX5B,EAAY,CAChBG,WACAC,KAAMyB,KAAWF,EAAM,QACvBtB,MAAOwB,KAAWF,EAAM,MACxBrB,IAAKuB,KAAWF,EAAM,MACtBpB,QAASsB,KAAWF,EAAM,OAC1BnB,UAAW,KACXC,YAAa,KACbC,QAAS,KACTC,UAAW,KACXC,aAAc,KACdC,cAAe,KACfC,aAAc,KACdC,UAAW,KACXC,WAAY,KACZC,UAAW,MAQb,OALIS,IACF1B,EAAUQ,UAAYqB,KAAWF,EAAM,MACvC3B,EAAUS,YAAcoB,KAAWF,EAAM,OAGpC3B,GAGI8B,GAA4B,qBAAApD,OACnCmD,KAAW,IAAID,KAAQ,iBAAkB,CAC3CG,OAAQC,UAAUC,SAASC,WAAW,MAAQC,UAAWZ,IAFpB,MAK5Ba,GAAmB,SAAApC,GAAa,IAAAqC,EACUrC,EAAUE,OAAvDE,EADmCiC,EACnCjC,KAAMC,EAD6BgC,EAC7BhC,MAAOC,EADsB+B,EACtB/B,IAAKE,EADiB6B,EACjB7B,UAAWC,EADM4B,EACN5B,YAEjC6B,EAAe,GAAA5D,OAAM0B,EAAN,KAAA1B,OAAc2B,EAAd,KAAA3B,OAAuB4B,GAK1C,OAJME,GAAeC,IACnB6B,GAAe,IAAA5D,OAAQ8B,EAAU+B,SAAS,EAAG,KAA9B,KAAA7D,OAAsC+B,IAGhD+B,KAAUF,IAGNG,GAAyB,SAACC,EAAMC,EAAUC,GAAjB,MACnC,CACCC,EAAGC,oBAASJ,EAAMC,GAClBI,EAAGC,mBAAQN,EAAMC,GACjBM,EAAGC,oBAASR,EAAMC,GAClBQ,EAAGC,qBAAUV,EAAMC,GACnBU,EAAGC,oBAASZ,EAAMC,IAClBC,ICxFEW,GAAgC,SAAAC,GACpC,OAAOA,EACJC,IAAI,SAAAC,GACH,OAAQA,EAAK9G,IAAI,SACf,IAAK,OACH,OAAO8G,EAAK9G,IAAI,YAClB,IAAK,OACH,OAAI8G,EAAKC,MAAM,CAAC,WAAY,UACnBD,EAAKC,MAAM,CAAC,WAAY,UAExBD,EAAKC,MAAM,CAAC,WAAY,QAEnC,IAAK,QAEL,QACE,MAAO,MAGZC,KAAK,KA8IGC,GAA4B,SAAAL,GACvC,IAAKA,EACH,MAAO,GAGT,IAAMM,EAAYN,EAAMO,QAAQ,MAEhC,OAAOP,EACJQ,IAAIF,GACJL,IAAI,SAAArC,GAAsB,IAjLL6C,EAiLKC,EAAApJ,OAAAqJ,EAAA,EAAArJ,CAAAsG,EAAA,GAApBsC,EAAoBQ,EAAA,GAAdE,EAAcF,EAAA,GACrBG,EAAO,GACX,OAAQX,EAAK9G,IAAI,SACf,IAAK,OACHyH,EAAOX,EAAK9G,IAAI,YAChB,MACF,IAAK,OACHyH,GAxLgBJ,EAwLSP,GAvLlBC,MAAM,CAAC,WAAY,UAChC,KAAAjF,OAAYuF,EAASN,MAAM,CAAC,WAAY,QAAxC,MAAAjF,OAAoDuF,EAASN,MAAM,CAAC,WAAY,UAAhF,MAEA,KAAAjF,OAAYuF,EAASN,MAAM,CAAC,WAAY,QAAxC,MAqLM,MACF,IAAK,kBACHU,EAAI,IAAA3F,OAAOgF,EAAKC,MAAM,CAAC,WAAY,KAAO,GAAtC,KAAAjF,OAA4CgF,EAAKC,MAAM,CAAC,WAAY,KAAO,GAA3E,KACJ,MACF,IAAK,oBACHU,EAAI,IAAA3F,OAAOgF,EAAK9G,IAAI,eAAiB,GAAjC,MACJ,MACF,IAAK,QACHyH,EApKiB,SAAAC,GACzB,IAAMC,EAAaD,EAChB1H,IAAI,YACJ6G,IAAI,SAAAe,GAAG,OACNC,KAAKC,IAALC,MAAAF,KAAI3J,OAAA8J,EAAA,EAAA9J,CACC0J,EAAI5H,IAAI,YAAY6G,IAAI,SAAAoB,GAAI,OAAKC,IAAEC,QAAQF,EAAKjI,IAAI,gBAAgB,OAAS,GAAK,QAGxFsD,OAEG8E,EAAaV,EAAUX,MAAM,CAAC,WAAY,EAAG,aAAasB,KAC1DC,EAAeJ,IAAEK,MAAMH,GAAYvB,IAAI,SAAA2B,GAAW,OACtDX,KAAKC,IAALC,MAAAF,KAAI3J,OAAA8J,EAAA,EAAA9J,CACCwJ,EAAU1H,IAAI,YAAY6G,IAAI,SAAAe,GAC/B,IAAMa,EAAUb,EAAIb,MAAM,CAAC,WAAYyB,EAAa,aAE9CE,EADgB/B,GAA8B8B,GAClBE,MAAM,MAAM9B,IAAI,SAAA+B,GAAI,OAAIA,EAAKC,OAAOnE,SACtE,OAAOmD,KAAKC,IAALC,MAAAF,KAAI3J,OAAA8J,EAAA,EAAA9J,CAAQwK,UA0CzB,OArCmBR,IAAEY,UACnBZ,IAAEa,QACArB,EACG1H,IAAI,YACJ6G,IAAI,SAACe,EAAKoB,GACT,IAAMC,EAAYtB,EAAWqB,GAEvBE,EAAchB,IAAEK,MAAMU,GACzBpC,IAAI,SAAAsC,GAAS,OACZvB,EACG5H,IAAI,YACJ6G,IAAI,SAACoB,EAAMO,GACV,IAAMC,EAAUR,EAAKjI,IAAI,YAEnBoJ,EADgBzC,GAA8B8B,GAEjDE,MAAM,MACN9B,IAAI,SAAA+B,GAAI,OAAIA,EAAKC,OAAOnE,SACrBkE,GAAQX,EAAKjI,IAAI,eAAe2I,MAAM,MAAMQ,IAAc,IAAIN,OAE9DQ,EAAWf,EAAaE,GAAeY,EAAqBD,GAElE,OAAOP,EAAO,IAAIU,OAAOD,KAE1B/F,OACA0D,KAAK,SAETH,IAAI,SAAA0C,GAAU,WAAAzH,OAASyH,EAAT,QAEXC,EACJ,IAAMlB,EAAazB,IAAI,SAAA4C,GAAW,MAAI,IAAIH,OAAOG,EAAc,KAAIzC,KAAK,KAAO,IAEjF,OAAOkC,EAAYpH,OAAO0H,KAE3BlG,SAIW0D,KAAK,MAyGR0C,CAAmB5C,GAC1B,MACF,IAAK,OACHW,EAzGgB,SAAAkC,GACxB,IAAMC,EAAkBD,EAAS3J,IAAI,mBAEjC6J,EAAiB,EACrB,OAAOF,EACJ3J,IAAI,SACJ6G,IAAI,SAAAiD,GACH,IAAMC,EAAwBJ,EAAS3J,IAAI,cAAoC,MAApB4J,EAAgC,GAAN,IAE/EI,EAAY/C,GAA0B6C,EAAK9J,IAAI,cAE/CiK,EAAchD,GAA0B6C,EAAK9J,IAAI,aACjDkK,EAAsBD,EACzBtB,MAAM,MACN9B,IAAI,SAAA+B,GAAI,OAAOA,EAAKC,OAAP,GAAA/G,OAAmBiI,EAAnB,MAAAjI,OAA4C8G,GAAS,KAClE5B,KAAK,MAEJmD,EAAe,KACnB,GAAIR,EAAS3J,IAAI,aAAc,CAC7B,IAAIoK,IAAWP,EACXQ,EAAcP,EAAK9J,IAAI,eAY3B,GAXMqK,IAEJR,EADAO,EAASC,GAIXF,EAAY,GAAArI,OAAMsI,GAANtI,OAAe6H,EAAS3J,IAAI,8BAElCqK,IACJF,GAAY,MAAArI,OAAUuI,EAAV,MAGVP,EAAK9J,IAAI,cAAe,CAC1B,IAAMsK,EAAiB,CACrBC,QAAS,IACTC,UAAW,IACXC,QAAS,KACTX,EAAK9J,IAAI,kBAEXmK,GAAY,KAAArI,OAASwI,EAAT,KAGdH,GAAY,IAAArI,OAAQkI,OACf,CAGL,GAFAG,EAAY,GAAArI,OAAMiI,GAANjI,OAA6B8H,GAErCE,EAAK9J,IAAI,cAAe,CAC1B,IAAMsK,EAAiB,CACrBC,QAAS,IACTC,UAAW,IACXC,QAAS,KACTX,EAAK9J,IAAI,kBAEXmK,GAAY,KAAArI,OAASwI,EAAT,KAGdH,GAAY,IAAArI,OAAQkI,GAOtB,OAJMC,IACJE,GAAY,KAAArI,OAASoI,IAGhBC,IAERnD,KAAK,MAwCO0D,CAAkB5D,GACzB,MACF,IAAK,YACHW,EAxCqB,SAAAX,GAC7B,IAAIW,EAAOtE,GAAa2D,EAAK9G,IAAI,mBAKjC,OAJI8G,EAAK9G,IAAI,qBACXyH,GAAI,KAAA3F,OAASqB,GAAa2D,EAAK9G,IAAI,sBAG9ByH,EAkCQkD,CAAuB7D,GAC9B,MACF,QACE8D,QAAQhJ,MAAR,qEAAAE,OACuEgF,EAAK9G,IAAI,UAIpF,IAAI6K,EAAwB,GAY5B,OAXMrD,IACA,CAAC,OAAQ,SAASsD,SAAStD,EAASxH,IAAI,SAC1C6K,EAAwB,KAEH,SAArB/D,EAAK9G,IAAI,SACgB,SAAzBwH,EAASxH,IAAI,SACZwH,EAASxH,IAAI,YAAY+K,SAAS,QAEnCF,EAAwB,OAGrBA,EAAwBpD,IAEhCT,KAAK,KC9NKgE,GAAA,SAACC,GAA4C,IAA5BC,EAA4BzG,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAV0G,iBAChD,IAAKF,EACH,MAAO,CAAC,GAAI,MAGd,IAAMG,EAAgB,CACpBC,KAAA,IAAAvJ,OAAUmD,KAAW,IAAID,KAAQ,kBAAjC,KACAsG,KAAA,IAAAxJ,OAAUmD,KAAW,IAAID,KAAQ,wBAAjC,KACAuG,KAAA,IAAAzJ,OAAUmD,KAAW,IAAID,KAAQ,kBAAjC,KACAwG,KAAA,IAAA1J,OAAUmD,KAAW,IAAID,KAAQ,wBAAjC,MAGFkG,EAAgBO,WAAWjN,QAAQ,SAAAgG,GAAkB,IAAA8C,EAAApJ,OAAAqJ,EAAA,EAAArJ,CAAAsG,EAAA,GAAhBkH,EAAgBpE,EAAA,GAAXqE,EAAWrE,EAAA,GACnD8D,EAAa,IAAAtJ,OAAK4J,IAASC,IAG7B,IAAIC,EAAoBX,EACxB/C,IAAE2D,QAAQT,GAAe5M,QACvB,SAAAsN,GAAA,IAAAC,EAAA7N,OAAAqJ,EAAA,EAAArJ,CAAA4N,EAAA,GAAEE,EAAFD,EAAA,GAAgBJ,EAAhBI,EAAA,UACGH,EAAoBA,EAAkBK,QAAQC,OAAOF,EAAc,KAAML,KAG9E,IAAMQ,EAAcP,EAAkBd,SAAS,MAAQc,EAAkBQ,QAAQ,MAAQ,KAGzF,MAAO,CAFPR,EAAoBA,EAAkBK,QAAQ,MAAO,IAE1BE,IC7BdE,GAAA,WACb,IAAIC,EAAS,EACb,OAAO,kBAAMA,KAFA,GCIFC,GAAsB,SAACC,EAASC,GAC3C,OAAOD,EAAQE,UAAU,SAAAC,GAAM,OAAIA,EAAO3M,IAAI,QAAUyM,KAG7CG,GAAe,SAACJ,EAASC,GACpC,OAAOD,EAAQxM,IAAIuM,GAAoBC,EAASC,KAGrCI,GAA2B,SAACL,EAASC,GAChD,IAAME,EAASC,GAAaJ,EAASC,GAC/BK,EAAcP,GAAoBC,EAASC,GAE3CM,EAAeP,EAAQQ,MAAMF,EAAc,GAC3CG,EAAyBF,EAAaL,UAAU,SAAAQ,GACpD,OAAOA,EAAclN,IAAI,iBAAmB2M,EAAO3M,IAAI,kBAGzD,OAAgC,IAA5BiN,EACKF,EAEAA,EAAaC,MAAM,EAAGC,IAIpBE,GAA8B,SAACX,EAASC,GAAV,OACzCI,GAAyBL,EAASC,GAAUpE,MAqBjC+E,GAAyB,SAACZ,EAASC,GAC9C,IAAME,EAASC,GAAaJ,EAASC,GAC/BK,EAAcP,GAAoBC,EAASC,GAG3CY,EADkBb,EAAQQ,MAAM,EAAGF,GAAaQ,UACjBC,KACnC,SAAAC,GAAc,OAAIA,EAAexN,IAAI,gBAAkB2M,EAAO3M,IAAI,kBAGpE,OAAKqN,EAIEA,EAAarN,IAAI,MAHf,MAwBLyN,GAAkB,SAAlBA,EAAmBjB,EAASC,GAChC,IAAMiB,EAAiBN,GAAuBZ,EAASC,GACvD,IAAKiB,EACH,OAAO,EAGT,IAAML,EAAeT,GAAaJ,EAASkB,GAC3C,OAAOL,EAAarN,IAAI,WAAayN,EAAgBjB,EAASa,EAAarN,IAAI,QAapE2N,GAAmB,SAACC,EAAOnB,GACtC,IAAMiB,EA1EoC,SAAClB,EAASC,GAIpD,IAHA,IAAME,EAASC,GAAaJ,EAASC,GAG5BoB,EAFWtB,GAAoBC,EAASC,GAEtB,EAAGoB,GAAK,IAAKA,EAAG,CACzC,IAAML,EAAiBhB,EAAQxM,IAAI6N,GAEnC,GAAIL,EAAexN,IAAI,kBAAoB2M,EAAO3M,IAAI,gBAAkB,EACtE,OAAOwN,EAAexN,IAAI,MAG5B,GAAIwN,EAAexN,IAAI,gBAAkB2M,EAAO3M,IAAI,gBAClD,OAAO,KAIX,OAAO,KA0DgB8N,CAA6BF,EAAM5N,IAAI,WAAYyM,GAC1E,GAAuB,OAAnBiB,EAAyB,CAC3B,IAAMK,EAAoBxB,GAAoBqB,EAAM5N,IAAI,WAAY0N,GACpEE,EAAQA,EAAMI,MAAM,CAAC,UAAWD,EAAmB,WAAW,GAGhE,OAAOH,GA8BIK,GAAiB,SAAjBA,EAAkBzB,EAAS0B,GACtC,GAAwB,IAApBA,EAAW7F,KACb,OAAO,KAGT,IAAM8F,EAAc3B,EAAQe,KAC1B,SAAAZ,GAAM,OACkD,OAAtDS,GAAuBZ,EAASG,EAAO3M,IAAI,QAC3C2M,EAAO5F,MAAM,CAAC,YAAa,aAAa8B,SAAWqF,EAAWE,QAAQvF,SAE1E,OAAKsF,EAImB,IAApBD,EAAW7F,KACN8F,EAIFF,EADYpB,GAAyBL,EAAS2B,EAAYnO,IAAI,OACnCkO,EAAWG,KAAK,IARzC,MAuCLC,GAA0B,SAAC5G,EAAW6G,GAAZ,OAC9B7G,EACG1H,IAAI,YACJwO,KAAK,SAAA5G,GAAG,OAAIA,EAAI5H,IAAI,YAAYwO,KAAK,SAAAvG,GAAI,OAAIA,EAAKjI,IAAI,QAAUuO,OAaxDE,GAAgC,SAACjC,EAAS+B,GAAV,OAC3C/B,EAAQe,KAAK,SAAAZ,GAAM,OAZ0B,SAAzC+B,EAA0C9H,EAAO2H,GAAR,OAC7C3H,EACG+H,OAAO,SAAA7H,GAAI,MAAI,CAAC,QAAS,QAAQgE,SAAShE,EAAK9G,IAAI,WACnDwO,KAAK,SAAA1H,GAAI,MACa,UAArBA,EAAK9G,IAAI,QACLsO,GAAwBxH,EAAMyH,GAC9BzH,EACG9G,IAAI,SACJwO,KAAK,SAAA1E,GAAI,OAAI4E,EAAuC5E,EAAK9J,IAAI,YAAauO,OAI9DG,CAAuC/B,EAAO3M,IAAI,eAAgBuO,MAE9EK,GAAqD,SAArDA,EAAsDhI,EAAOiI,GAAR,OAChEjI,EACGC,IAAI,SAACC,EAAMgI,GACV,MAAyB,cAArBhI,EAAK9G,IAAI,SAA2B8G,EAAK9G,IAAI,QAAU6O,EAClD,CACLE,KAAM,CAACD,GACPE,cAAelI,GAEa,SAArBA,EAAK9G,IAAI,QACX8G,EACJ9G,IAAI,SACJ6G,IAAI,SAACiD,EAAMmF,GACV,IAAIC,EAAcN,EAChB9E,EAAK9J,IAAI,YACT6O,GAEF,GAAMK,EAAa,KACTH,EAAwBG,EAAxBH,KAAMC,EAAkBE,EAAlBF,cACd,MAAO,CACLD,KAAM,CAACD,EAAW,QAASG,EAAW,YAAYnN,OAAOiN,GACzDC,iBAGF,IAAIE,EAAcN,EAChB9E,EAAK9J,IAAI,aACT6O,GAEF,GAAMK,EAAa,KACTH,EAAwBG,EAAxBH,KAAMC,EAAkBE,EAAlBF,cACd,MAAO,CACLD,KAAM,CAACD,EAAW,QAASG,EAAW,aAAanN,OAAOiN,GAC1DC,iBAGF,OAAO,OAIZL,OAAO,SAAAQ,GAAM,QAAMA,IACnBf,QAC2B,UAArBtH,EAAK9G,IAAI,QACX8G,EACJ9G,IAAI,YACJ6G,IAAI,SAACe,EAAKoB,GACT,OAAOpB,EACJ5H,IAAI,YACJ6G,IAAI,SAACoB,EAAMmH,GACV,IAAMF,EAAcN,EAClB3G,EAAKjI,IAAI,YACT6O,GAEF,GAAMK,EAAa,KACTH,EAAwBG,EAAxBH,KAAMC,EAAkBE,EAAlBF,cACd,MAAO,CACLD,KAAM,CACJD,EACA,WACA9F,EACA,WACAoG,EACA,YACAtN,OAAOiN,GACTC,iBAGF,OAAO,OAGVL,OAAO,SAAAQ,GAAM,QAAMA,IACnBf,UAEJO,OAAO,SAAAQ,GAAM,QAAMA,IACnBf,QAEI,OAGVO,OAAO,SAAAQ,GAAM,QAAMA,IACnBf,SAwGQiB,GAAsD,SAAtDA,EAAuDzI,EAAO0I,GAAR,OACjE1I,EACGC,IAAI,SAACC,EAAMgI,GACV,MAAyB,SAArBhI,EAAK9G,IAAI,QAzGY,SAAC2J,EAAU2F,GAAX,OAC7B3F,EAAS3J,IAAI,SAASwO,KAAK,SAAA1E,GAAI,OAAIA,EAAK9J,IAAI,QAAUsP,IAyG5CC,CAAuBzI,EAAMwI,GACxB,CAAEP,KAAM,CAACD,GAAYnF,SAAU7C,GAE/BA,EACJ9G,IAAI,SACJ6G,IAAI,SAACiD,EAAMmF,GACV,IAAMC,EAAcG,EAClBvF,EAAK9J,IAAI,YACTsP,GAEF,GAAMJ,EAAa,KACTH,EAAmBG,EAAnBH,KAAMpF,EAAauF,EAAbvF,SACd,MAAO,CACLoF,KAAM,CAACD,EAAW,QAASG,EAAW,YAAYnN,OAAOiN,GACzDpF,YAGF,OAAO,OAGVgF,OAAO,SAAAQ,GAAM,QAAMA,IACnBf,QAGE,OAGVO,OAAO,SAAAQ,GAAM,QAAMA,IACnBf,SA6DQoB,GAAuC,SAAChD,EAASiD,GAAV,OAClDjD,EACG3F,IAAI,SAAC8F,EAAQG,GACZ,IAAMoC,EA7LiD,SAAhDQ,EAAiD9I,EAAO6I,GAAR,OAC3D7I,EACGC,IAAI,SAACC,EAAMgI,GACV,MAAyB,SAArBhI,EAAK9G,IAAI,QACJ8G,EACJ9G,IAAI,SACJ6G,IAAI,SAACiD,EAAMmF,GACV,GAAInF,EAAK9J,IAAI,QAAUyP,EACrB,MAAO,CACLV,KAAM,CAACD,EAAW,QAASG,GAC3BU,aAAc7F,GAGhB,IAAMoF,EAAcQ,EAClB5F,EAAK9J,IAAI,YACTyP,GAEF,GAAMP,EAAa,KACTH,EAAuBG,EAAvBH,KAAMY,EAAiBT,EAAjBS,aACd,MAAO,CACLZ,KAAM,CAACD,EAAW,QAASG,EAAW,YAAYnN,OAAOiN,GACzDY,gBAGF,OAAO,OAIZhB,OAAO,SAAAQ,GAAM,QAAMA,IACnBf,QAEI,OAGVO,OAAO,SAAAQ,GAAM,QAAMA,IACnBf,QA0JqBsB,CAClB/C,EAAO3M,IAAI,eACXyP,GAEF,IAAKP,EACH,OAAO,KANmB,IASpBH,EAAuBG,EAAvBH,KAAMY,EAAiBT,EAAjBS,aACd,MAAO,CACLZ,KAAM,CAACjC,EAAa,eAAehL,OAAOiN,GAC1CY,kBAGHhB,OAAO,SAAAQ,GAAM,QAAMA,IACnBf,SAEQwB,GAA8C,SAACpD,EAAS+B,GAAV,OACzD/B,EACG3F,IAAI,SAAC8F,EAAQG,GACZ,IAAMoC,EA5KwD,SAAvDW,EAAwDjJ,EAAO2H,GAAR,OAClE3H,EACGC,IAAI,SAACC,EAAMgI,GACV,MAAyB,UAArBhI,EAAK9G,IAAI,QACPsO,GAAwBxH,EAAMyH,GACzB,CAAEQ,KAAM,CAACD,GAAYpH,UAAWZ,GAEhC,KAEqB,SAArBA,EAAK9G,IAAI,QACX8G,EACJ9G,IAAI,SACJ6G,IAAI,SAACiD,EAAMmF,GACV,IAAMC,EAAcW,EAClB/F,EAAK9J,IAAI,YACTuO,GAEF,GAAMW,EAAa,KACTH,EAAoBG,EAApBH,KAAMrH,EAAcwH,EAAdxH,UACd,MAAO,CACLqH,KAAM,CAACD,EAAW,QAASG,EAAW,YAAYnN,OAAOiN,GACzDrH,aAGF,OAAO,OAGViH,OAAO,SAAAQ,GAAM,QAAMA,IACnBf,QAEI,OAGVO,OAAO,SAAAQ,GAAM,QAAMA,IACnBf,QA0IqByB,CAClBlD,EAAO3M,IAAI,eACXuO,GAEF,IAAKW,EACH,OAAO,KANmB,IASpBH,EAAoBG,EAApBH,KAAMrH,EAAcwH,EAAdxH,UACd,MAAO,CACLqH,KAAM,CAACjC,EAAa,eAAehL,OAAOiN,GAC1CrH,eAGHiH,OAAO,SAAAQ,GAAM,QAAMA,IACnBf,SAEQ0B,GAA8B,SAACtD,EAAS+B,EAAQwB,GAA6B,IAAAC,EAC5DJ,GAA4CpD,EAAS+B,GAAzEQ,EADgFiB,EAChFjB,KAAMrH,EAD0EsI,EAC1EtI,UAERuI,EAA2BvI,EAC9B1H,IAAI,YACJ0M,UAAU,SAAA9E,GAAG,OAAIA,EAAI5H,IAAI,YAAYwO,KAAK,SAAAvG,GAAI,OAAIA,EAAKjI,IAAI,QAAUuO,MAClE2B,EAA8BxI,EACjCX,MAAM,CAAC,WAAYkJ,EAA0B,aAC7CvD,UAAU,SAAAzE,GAAI,OAAIA,EAAKjI,IAAI,QAAUuO,IAExC,OAAO/B,EAAQ2D,SACbpB,EAAKjN,OAAO,CAAC,aACbiO,EAAyBE,EAA0BC,KAgD1CE,GAAiC,SAAC5D,EAASiD,EAAYM,GAA6B,IAAAM,EArNvC,SAAC7D,EAAS8C,GAAV,OACxD9C,EACG3F,IAAI,SAAC8F,EAAQG,GACZ,IAAMoC,EAAcG,GAClB1C,EAAO3M,IAAI,eACXsP,GAEF,IAAKJ,EACH,OAAO,KANmB,IASpBH,EAAmBG,EAAnBH,KAAMpF,EAAauF,EAAbvF,SACd,MAAO,CACLoF,KAAM,CAACjC,EAAa,eAAehL,OAAOiN,GAC1CpF,cAGHgF,OAAO,SAAAQ,GAAM,QAAMA,IACnBf,QAoMwBkC,CAA2C9D,EAASiD,GAAvEV,EADuFsB,EACvFtB,KAEFwB,EAHyFF,EACjF1G,SAGX3J,IAAI,SACJ0M,UAAU,SAAA5C,GAAI,OAAIA,EAAK9J,IAAI,QAAUyP,IAExC,OAAOjD,EAAQ2D,SAASpB,EAAKjN,OAAO,CAAC,UAAWiO,EAAyBQ,KAG9DC,GAAqC,SAAC5J,EAAO6J,GAA8B,IAApB9G,EAAoBlF,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAT,KAC7E,GAAmB,IAAfmC,EAAMyB,MAA2C,SAA7BzB,EAAM8J,OAAO1Q,IAAI,QAAoB,CAC3D,IAAM2Q,EAAY/J,EAAMyB,KAEtBzB,EADI+C,EACI/C,EAAMgK,OAAOD,EAA+BhH,EA/BVkH,IAAI,KAAMC,MAAcD,IAAI,QAAS,IAAIE,UAiC3EnK,EAAMgK,OAAOD,EA1CzBK,kBAAO,CACLhT,KAAM,OACNiT,GAAIH,KACJI,MAAO,GACPtH,gBAAiB,IACjBuH,0BAA2B,KAC3BC,WAAW,KAwCb,OAAOxK,EAAMC,IAAI,SAAAC,GACf,OAAQA,EAAK9G,IAAI,SACf,IAAK,OACH,OAAO8G,EAAKuK,OAAO,QAAS,SAAAH,GAAK,OAAIA,EAAMI,KAAKb,KAClD,QACE,OAAO3J,MAKFyK,GAAoC,SAAC3K,EAAOiI,GACvD,IAAKjI,EACH,OAAO,KAGT,IAAMsI,EAAcN,GAAmDhI,EAAOiI,GAC9E,OAAMK,EACGA,EAAYF,cAEZ,MAoBEwC,GAA2B,SAACC,EAAiBC,GAAlB,OACtCD,EAAgBlE,KAAK,SAAAoE,GAAU,OAAIA,EAAW3R,IAAI,YAAY4R,SAASF,MACvED,EAAgBrD,SCloBH4C,qBAAO,CACpB,CACEa,YAAa,YACbC,YAAa,CAAC,UAAW,aACzBC,SAAU,QACVd,GAAIH,KACJkB,0BAA0B,EAC1BC,OAAQ,GACRC,uBAAwB,GACxBC,eAAe,EACfC,SAAU,YACVC,UAAU,GAEZ,CACER,YAAa,uBACbC,YAAa,CAAC,UAAW,SAAU,SAAU,UAAW,OAAQ,QAChEC,SAAU,cACVd,GAAIH,KACJkB,0BAA0B,EAC1BC,OAAQ,GACRC,uBAAwB,GACxBC,eAAe,EACfC,SAAU,yCACVC,UAAU,KCTDpS,GAAc,SAAC8O,EAAMuD,GAAP,MAAqB,CAC9CtU,KAAM,eACN+Q,OACAuD,aAGWC,GAAgB,SAAAC,GAAU,MAAK,CAC1CxU,KAAM,mBACNwU,eAGWnS,GAAqB,WAChC,OAAO,SAACf,EAAUO,GAChBP,EAAS,CAAEtB,KAAM,yBACjBsB,EAAS,CAAEtB,KAAMyU,cAAYC,gBAC7BpT,EAASqT,MACTrT,EAAS4D,KACT5D,EAASiT,GAAc,SAIdK,GACX,eAAApO,EAAAC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAII,GAJJoO,EAAArO,EACEsO,mBADF,IAAAD,EACgB,KADhBA,EAAAE,EAAAvO,EAEEwO,sBAFF,IAAAD,EAEmB,iBAFnBA,EAAAE,EAAAzO,EAGE0O,8BAHF,IAAAD,KAAA,OAKA,SAAC3T,EAAUO,GACT,IAAM0B,EAAS1B,IAAW2B,YAAYxB,IAAI,UACpC+O,EAAOlP,IAAWC,IAAIC,QAAQC,IAAI,QAC3B,OAAT+O,IAICmE,GACH5T,EAASP,EAAkB,eAE7BO,EAASJ,GAAa,IACtBI,EAAS6T,GAAuB,OAEhC5R,EACG6R,2BAA2BrE,GAC3BsE,KAAK,SAAA/L,GAAkC,IAA/BgL,EAA+BhL,EAA/BgL,SAAUgB,EAAqBhM,EAArBgM,eACXC,EAAU1T,IAAWC,IAAIC,QAAQC,IAAI,WACrCwT,EAAuB5N,KAAU0N,GACjCd,EAAa3S,IAAWC,IAAIC,QAAQC,IAAI,cAE1CyT,mBAAQjB,EAAYgB,IAAyC,SAAhBV,EAC3CS,EACFhS,EACGmS,WACC3E,ELgKD,SAACvC,EAASiF,EAAiBkC,EAAiBC,GACzD,IAAIC,EAAgB,GAwEpB,OAtEIF,EAAgBtL,KAAO,IACzBwL,EAAgBF,EAAgB3M,KAAK,MAAQ,MAG1CyK,EAAgBzR,IAAI,GAAGA,IAAI,aAC9B6T,EACEA,EACApC,EACG5K,IAAI,SAAAiN,GACH,OAAOA,EAAe9T,IAAI,gBAE3BgH,KAAK,MACR,MAGA4M,EAAoBvL,KAAO,IAC7BwL,GAAgCD,EAAoB5M,KAAK,OAIvD6M,EAAcnP,OAAS,IACzBmP,GAAgC,MAiD3BA,EA9CerH,EACnBlJ,OACAuD,IAAI,SAAA8F,GACH,IAAI2F,EAAW,GAYf,GAXAA,GAAY,IAAIhJ,OAAOqD,EAAOoH,cAE1BpH,EAAOqH,UAAUC,cACnB3B,GAAQ,IAAAxQ,OAAQ6K,EAAOqH,UAAUC,cAEnC3B,GAAQ,IAAAxQ,OAAQ6K,EAAOqH,UAAUE,UAE7BvH,EAAOqH,UAAUG,KAAKzP,OAAS,IACjC4N,GAAQ,KAAAxQ,OAAS6K,EAAOqH,UAAUG,KAAKxF,OAAO,SAAAyF,GAAG,QAAMA,IAAKpN,KAAK,KAAzD,MAGN2F,EAAO0H,cAAc3P,OAAS,EAAG,CACnC,IAAM4P,EAAuB3H,EAAO0H,cACjCxN,IACC,SAAA0N,GAAY,SAAAzS,OAAOyS,EAAavW,KAApB,MAAA8D,OAA6BqB,GAAa6N,kBAAOuD,EAAanR,eAE3E4D,KAAK,KACLwN,YACHlC,GAAQ,OAAAxQ,OAAWwS,GAoBrB,OAjBI3H,EAAO8H,kBAAkB/P,OAAS,IACpC4N,GAAY,iBACZ3F,EAAO8H,kBAAkBjW,QAAQ,SAAAkW,GAC/BpC,GAAQ,MAAAxQ,OAAU4S,EAAiBC,SAA3B,MAAA7S,OAAwCmF,GAC9C+J,kBAAO0D,EAAiB/I,WAG5B2G,GAAY,aAGV3F,EAAOkF,cACJlF,EAAOiI,eAAetP,WAAW,OAA0C,IAAjCqH,EAAOiI,eAAelQ,SACnE4N,GAAY,MAEdA,GAAY3F,EAAOiI,gBAGdtC,IAERtL,KAAK,MKtOM6N,CACEhV,IAAWC,IAAIC,QAAQC,IAAI,WAC3BH,IAAWC,IAAIC,QAAQC,IAAI,mBAC3BH,IAAWC,IAAIC,QAAQC,IAAI,mBAC3BH,IAAWC,IAAIC,QAAQC,IAAI,yBAG9BqT,KAAK,WACCH,GACH5T,EAASF,EAA8B4T,EAAgB,MAEzD1T,EAASJ,GAAa,IACtBI,EAASwV,IAAS,IAClBxV,EAASiT,GAAcwC,sBAAW,IAAI/P,KAAQ,OAE/CtD,MAAM,SAAAE,GACLC,MAAK,wCAAAC,OAAyCF,EAAMoT,aACpD1V,EAASL,KACTK,EAASJ,GAAa,OAGrBgU,GACH5T,EAASF,EAA8B,kBAAmB,MAE5DE,EAASJ,GAAa,KAGpBqU,GAA2B,SAAhBT,GACbxT,EAASL,KACTK,EAASJ,GAAa,IACtBI,EAASyD,EAAc,oBAAqB,CAAEyQ,4BAE9ClU,EAASW,GAAY8O,EAAMuD,IAC3BhT,EAAS2V,MACT3V,EAASwV,IAAS,IAClBxV,EAASiT,GAAcwC,sBAAW,IAAI/P,KAAQ,KACzCkO,GACH5T,EAASF,EAA8B,wBAAyB,MAElEE,EAASJ,GAAa,OAI3BwC,MAAM,WACLpC,EAASL,KACTK,EAASJ,GAAa,IACtBI,EAAS6T,GAAuB,wBAI3B+B,GAAa,SAAAzI,GAAQ,MAAK,CACrCzO,KAAM,cACNyO,aAGW0I,GAAqB,SAAA1I,GAAQ,MAAK,CAC7CzO,KAAM,uBACNyO,aAGW2I,GAAe,SAAA3I,GAAQ,OAAI,SAAAnN,GACtCA,EAAS,CAAEtB,KAAM,gBAAiByO,aAE5BA,IACJnN,EAAS+V,GAAuB,OAChC/V,EAASgW,GAAsB,UAItBC,GAA6B,SAAA9I,GAAQ,OAAI,SAAAnN,GACpDA,EAAS8V,GAAa3I,IACtBnN,EAAS,CAAEtB,KAAM,yBAA0ByO,eAGhC+I,GAAmB,iBAAsB,CACpDxX,KAAM,qBACNyO,SAF8BhI,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAY,KAG1CgR,UAAU,IAGCC,GAAgB,SAAAC,GAAY,MAAK,CAC5C3X,KAAM,kBACN2X,iBAGWC,GAAe,iBAAO,CACjC5X,KAAM,mBAGK6X,GAAoB,SAACpJ,EAAUqJ,GAAX,MAA4B,CAC3D9X,KAAM,sBACNyO,WACAqJ,cACAL,UAAU,IAGCM,GAA0B,SAACtJ,EAAUuJ,GAAX,MAAkC,CACvEhY,KAAM,4BACNyO,WACAuJ,oBACAP,UAAU,IAGCQ,GAAY,SAAAxJ,GAAQ,MAAK,CACpCzO,KAAM,aACNyO,WACAgJ,UAAU,IAGCS,GAA0B,SAAAzJ,GAAQ,MAAK,CAClDzO,KAAM,6BACNyO,aAGW0J,GAAmB,SAAA1J,GAAQ,OAAI,SAAAnN,GAC1CA,EAAS2W,GAAUxJ,IACnBnN,EAAS4W,GAAwBzJ,IACjCnN,EAASoW,GAAc,YAGZU,GAA0B,SAAA3J,GAAQ,MAAK,CAClDzO,KAAM,6BACNyO,aAGW4J,GAA8B,SAAA5J,GAAQ,MAAK,CACtDzO,KAAM,iCACNyO,aAGW6J,GAAe,SAAA7J,GAAQ,MAAK,CACvCzO,KAAM,gBACNyO,WACAgJ,UAAU,IAGCc,GAAe,SAAA9J,GAAQ,MAAK,CACvCzO,KAAM,iBACNyO,WACAgJ,UAAU,IAGCe,GAAiB,SAAA/J,GAAQ,MAAK,CACzCzO,KAAM,mBACNyO,WACAgJ,UAAU,IAGCgB,GAAiB,SAAAhK,GAAQ,MAAK,CACzCzO,KAAM,mBACNyO,WACAgJ,UAAU,IAGCiB,GAAkB,SAAAjK,GAAQ,MAAK,CAC1CzO,KAAM,oBACNyO,WACAgJ,UAAU,IAGCkB,GAAkB,SAAAlK,GAAQ,MAAK,CAC1CzO,KAAM,oBACNyO,WACAgJ,UAAU,IAGCmB,GAAmB,SAAAnK,GAAQ,MAAK,CAC3CzO,KAAM,qBACNyO,WACAgJ,UAAU,IAGCoB,GAAc,SAAApK,GAAQ,MAAK,CACtCzO,KAAM,eACNyO,aAGWkG,GAAgB,iBAAO,CAClC3U,KAAM,mBAGK8Y,GAAO,iBAAO,CACzB9Y,KAAM,UAGKiX,GAAqB,iBAAO,CACvCjX,KAAM,yBAGK8W,GAAW,SAAAvB,GAAO,MAAK,CAClCvV,KAAM,YACNuV,YAGW8B,GAAyB,SAAA9G,GAAM,OAAI,SAAAjP,GAC9CA,EAAS,CAAEtB,KAAM,6BAA8BuQ,WAEzCA,IACJjP,EAAS8V,GAAa,OACtB9V,EAASgW,GAAsB,UAItByB,GAAiB,iBAAO,CACnC/Y,KAAM,oBACNyX,UAAU,IAGCuB,GAAiB,iBAAO,CACnChZ,KAAM,mBACNyX,UAAU,IAGCwB,GAAoB,iBAAO,CACtCjZ,KAAM,uBACNyX,UAAU,IAGCyB,GAAoB,iBAAO,CACtClZ,KAAM,sBACNyX,UAAU,IAGC0B,GAAmB,iBAAO,CACrCnZ,KAAM,sBACNyX,UAAU,IAGC2B,GAAiB,iBAAO,CACnCpZ,KAAM,oBACNyX,UAAU,IAGC4B,GAAsB,iBAAO,CACxCrZ,KAAM,yBACNyX,UAAU,IAGC6B,GAAuB,iBAAO,CACzCtZ,KAAM,0BACNyX,UAAU,IAGC8B,GAAuB,SAAChJ,EAAQiJ,GAAT,MAAuB,CACzDxZ,KAAM,0BACNuQ,SACAiJ,WACA/B,UAAU,IAGCgC,GAAgB,SAACC,EAAYjP,EAAS0J,GAAtB,OAAwC,SAAC7S,EAAUO,GAC9EP,EAAS4D,KAMT5D,EAAS,CAAEtB,KAAM,iBAAkBoU,SAJlBvS,IACd8X,QAAQ3X,IAAI,oBACZ8B,OAAO8V,IACPrK,KAAK,SAAA6E,GAAQ,OAAIA,EAASpS,IAAI,QAAU0X,IACEjP,UAAS0J,gBAAesD,UAAU,MAGpEoC,GAAsB,iBAAO,CACxC7Z,KAAM,0BAGK8Z,GAAuB,kBAAM,SAACxY,EAAUO,GACnD,IAAMkY,EAAiBlY,IAAWC,IAAIC,QAAQC,IAAI,kBAC5CgY,EAAeD,EAAe/X,IAAI,uBAClCiY,EAAiBF,EAAe/X,IAAI,kBACpCkY,EAAyBH,EAAe/X,IAAI,0BAElDV,EAASuY,MACT7V,OAAOmW,QAAQC,UAAU,GAAI,GAAIpW,OAAOqW,SAASC,UAEjD,IAAMlG,EAAWvS,IACd8X,QAAQ3X,IAAI,oBACZ2O,OACC,SAAAyD,GAAQ,OACNA,EAASpS,IAAI,6BACboS,EAASpS,IAAI,0BAA0B8K,SAASjL,IAAWC,IAAIC,QAAQC,IAAI,WAE9EuN,KAAK,SAAA6E,GAAQ,OAAIA,EAASpS,IAAI,eAAe6I,SAAWmP,EAAanP,SACxE,GAAKuJ,EAcL,GAJqBnE,GACnBpO,IAAWC,IAAIC,QAAQC,IAAI,WAC3BoS,EAASpS,IAAI,gBAEf,CA/BgE,IAAAuY,EAyCdC,GAChDpG,EAASpS,IAAI,YACbkY,GA3C8DO,EAAAva,OAAAqJ,EAAA,EAAArJ,CAAAqa,EAAA,GAyCzDG,EAzCyDD,EAAA,GAyCpCE,EAzCoCF,EAAA,GA8C1DhQ,EAAYkQ,EAAF,GAAA7W,OACT4W,EAAoBE,UACrB,EACAD,IAHU7W,OAIRmW,GAJQnW,OAIS4W,EAAoBE,UAAUD,IAJvC,GAAA7W,OAKT4W,GALS5W,OAKamW,GAE7B3Y,EAASmY,GAAcrF,EAASpS,IAAI,MAAOyI,EAAS2J,EAASpS,IAAI,mBACjEV,EAASsT,GAAK,CAAEI,eAAgB,wBAtB9B1T,EACEF,EAA6B,oBAAA0C,OACPsQ,EAASpS,IAAI,eADN,sCAE3B,WAjBJV,EACEF,EAA6B,oBAAA0C,OACPkW,EADO,sDAE3B,QAoCKa,GAAuB,SAAApJ,GAAU,MAAK,CACjDzR,KAAM,yBACNyR,aACAgG,UAAU,IAGCH,GAAwB,SAAA7F,GAAU,OAAI,SAAAnQ,GACjDA,EAAS,CAAEtB,KAAM,4BAA6ByR,eAExCA,IACJnQ,EAAS8V,GAAa,OACtB9V,EAAS+V,GAAuB,UAIvByD,GAAuB,SAACrJ,EAAY+H,GAAb,MAA2B,CAC7DxZ,KAAM,0BACNyR,aACA+H,WACA/B,UAAU,IAGCsD,GAA0B,SAACtJ,EAAY+H,GAAb,MAA2B,CAChExZ,KAAM,6BACNyR,aACA+H,WACA/B,UAAU,IAGCuD,GAAiB,iBAAO,CACnChb,KAAM,oBACNyX,UAAU,IAGCwD,GAA4B,iBAAO,CAC9Cjb,KAAM,kCAGKkb,GAAwB,kBAAM,SAAA5Z,GACzCA,EAAS0Z,MACT1Z,EAAS2Z,MACT3Z,EAASoW,GAAc,iBAGZyD,GAAiB,iBAAO,CACnCnb,KAAM,mBACNyX,UAAU,IAGC2D,GAAiB,iBAAO,CACnCpb,KAAM,oBACNyX,UAAU,IAGC4D,GAAmB,iBAAO,CACrCrb,KAAM,sBACNyX,UAAU,IAGC6D,GAAmB,iBAAO,CACrCtb,KAAM,sBACNyX,UAAU,IAGC8D,GAAoB,iBAAO,CACtCvb,KAAM,uBACNyX,UAAU,IAGC+D,GAAsB,iBAAO,CACxCxb,KAAM,yBACNyX,UAAU,IAGCgE,GAAuB,iBAAO,CACzCzb,KAAM,0BACNyX,UAAU,IAGCiE,GAAgB,SAACjN,EAAU0H,GAAX,MAAqB,CAChDnW,KAAM,kBACNyO,WACA0H,OACAsB,UAAU,IAGCkE,GAAc,SAACC,EAAWC,GAAZ,MAAyB,CAClD7b,KAAM,eACN4b,YACAC,UACApE,UAAU,IAGCqE,GAAsB,SAACF,EAAWC,GAAZ,OAAwB,SAACva,EAAUO,GAAX,OACzDP,EAAS,CACPtB,KAAM,wBACN4b,YACAC,UACApN,SAAU5M,IAAWS,KAAKyG,MAAM,CAAC,cAAe,OAAQ,aACxD0O,UAAU,MAGDsE,GAAwB,SAAClL,EAAamL,GAAd,MAAgC,CACnEhc,KAAM,2BACN6Q,cACAmL,eACAvE,UAAU,IAGCwE,GAA8B,SAACxN,EAAUyN,EAAmBF,GAA9B,MAAgD,CACzFhc,KAAM,iCACNyO,WACAyN,oBACAF,eACAvE,UAAU,IAGC0E,GAAqB,SAAC1N,EAAU2N,GAAX,MAA6B,CAC7Dpc,KAAM,wBACNyO,WACA2N,eACA3E,UAAU,IAGC4E,GAA0B,SAAC5N,EAAU6N,GAAX,MAAqC,CAC1Etc,KAAM,6BACNyO,WACA6N,uBACA7E,UAAU,IAGCtC,GAAyB,SAAAoH,GAAO,MAAK,CAChDvc,KAAM,6BACNuc,YC1gBaC,GAAA,SAAA3c,GAAK,OAAI,SAAAC,GAAI,OAAI,SAAAC,GAK9B,OAJIA,EAAO0X,UAAY5X,EAAMgC,WAAWS,KAAKN,IAAI,mBAC/CnC,EAAMyB,SAASsT,GAAK,CAAEM,wBAAwB,KAGzCpV,EAAKC,MCCV0c,GAAwBC,mBALP,SAAA7c,GAAK,OAAIA,EAAMyB,SAASsT,GAAK,CAAEM,wBAAwB,MAKzB,KAEpCyH,GAAA,SAAA9c,GAAK,OAAI,SAAAC,GAAI,OAAI,SAAAC,GAO9B,OANAiE,OAAO4Y,iBAAiB,mBAAoB,WACtC/c,EAAMgC,WAAWS,KAAKN,IAAI,iCAC5Bya,GAAsB5c,KAInBC,EAAKC,MCjBD8c,GAA6B,iBAAO,CAC/C7c,KAAM,mCAGK8c,GAA+B,SAACpD,EAAYqD,EAAWvD,GAAxB,MAAsC,CAChFxZ,KAAM,mCACN0Z,aACAqD,YACAvD,aAGWwD,GAAoC,SAAAtD,GAAU,MAAK,CAC9D1Z,KAAM,yCACN0Z,eAGWuD,GAAoC,SAACvD,EAAYwD,GAAb,MAA2C,CAC1Fld,KAAM,wCACN0Z,aACAwD,6BAGWC,GAA2B,SAAAzD,GAAU,MAAK,CACrD1Z,KAAM,+BACN0Z,eAGW0D,GAA2B,SAAC1D,EAAY2D,GAAb,MAAkC,CACxErd,KAAM,8BACN0Z,aACA2D,oBAGWC,GAAiB,SAAA5D,GAAU,MAAK,CAC3C1Z,KAAM,kBACN0Z,eAGW6D,GAAyB,SAAA7Y,GAAW,MAAK,CACpD1E,KAAM,2BACN0E,gBAGW8Y,GAAyB,SAAC5B,EAAWC,GAAZ,MAAyB,CAC7D7b,KAAM,2BACN4b,YACAC,YCpCW4B,GAA0B,WACrC,IAEE,OADAC,aAAaC,QAAQ,OAAQ,QACW,SAAjCD,aAAaE,QAAQ,QAC5B,MAAOC,GACP,OAAO,IAILC,GAAmC5T,IAAEwS,SACzC,SAACqB,EAAmBzJ,GAClB,OAAQyJ,EAAkB/d,MACxB,IAAK,UACH+d,EACGC,WAAW,wBAAyB1J,GACpC5Q,MAAM,SAAAE,GAAK,OACVC,MAAK,oEAAAC,OAAqEF,MAE9E,MACF,IAAK,eACHma,EACGC,WAAW,uBAAwB,OAAQ1J,GAC3C5Q,MAAM,SAAAE,GAAK,OACVC,MAAK,oEAAAC,OAAqEF,QAMpF,IACA,CAAEqa,QAAS,MAGAC,GAAoB,CAC/B,CACEC,SAAU,OACVC,KAAM,WACNpe,KAAM,WACNqe,qBAAqB,GAEvB,CACEF,SAAU,OACVC,KAAM,cACNpe,KAAM,WACNqe,qBAAqB,GAEvB,CACEF,SAAU,OACVC,KAAM,yBACNpe,KAAM,UACNqe,qBAAqB,GAGvB,CACEF,SAAU,OACVC,KAAM,iCACNpe,KAAM,WACNqe,qBAAqB,GAEvB,CACEF,SAAU,OACVC,KAAM,kCACNpe,KAAM,WACNqe,qBAAqB,GAGvB,CACEF,SAAU,OACVC,KAAM,mCACNpe,KAAM,UACNqe,qBAAqB,GAEvB,CACEF,SAAU,OACVC,KAAM,0BACNpe,KAAM,WACNqe,qBAAqB,GAEvB,CACEF,SAAU,OACVC,KAAM,oBACNpe,KAAM,OACNqe,qBAAqB,GAEvB,CACEF,SAAU,OACVC,KAAM,iBACNpe,KAAM,UACNqe,qBAAqB,GAEvB,CACEF,SAAU,OACVC,KAAM,+BACNpe,KAAM,UACNqe,qBAAqB,GAEvB,CACEF,SAAU,UACVC,KAAM,mBACNpe,KAAM,OACNqe,qBAAqB,EACrBC,QAAS,IAAIvL,UASXwL,GAAqB,SAAC3O,EAAO4O,GAAR,OACzBA,EACG7N,OAAO,SAAAlQ,GAAK,OAAKA,EAAMge,aACvB9N,OAAO,SAAAlQ,GAAK,MAAuB,QAAnBA,EAAM0d,WACtBtV,IAAI,SAAApI,GAAK,OAAIA,EAAM2d,OACnBvV,IAAI,SAAApI,GAAK,MAAI,CAACA,EAAOmP,EAAM9N,IAAIC,QAAQC,IAAIvB,MAC3CqD,OACCoa,GACGvN,OAAO,SAAAlQ,GAAK,MAAuB,QAAnBA,EAAM0d,WACtBtV,IAAI,SAAApI,GAAK,MACO,SAAfA,EAAMT,KACF,CACES,EAAM2d,KACNvd,KAAKC,UAAU8O,EAAMnP,EAAM0d,UAAUnc,IAAIvB,EAAM2d,OAAS3d,EAAM6d,SAAW,KAE3E,CAAC7d,EAAM2d,KAAMxO,EAAMnP,EAAM0d,UAAUnc,IAAIvB,EAAM2d,WAIrDM,GAAwB,SAAAC,GAAe,OAC3C9d,KAAKC,UACHoJ,IAAE0U,UACAD,EAAgBhO,OAAO,SAAAnK,GAAA,IAAA8C,EAAApJ,OAAAqJ,EAAA,EAAArJ,CAAAsG,EAAA,GAAE4X,EAAF9U,EAAA,GAAAA,EAAA,UAAqB,CAAC,2BAA2BwD,SAASsR,MAEnF,KACA,IA8BSS,GAAmB,WAC9B,GAAKpB,KAAL,CAIA,IAAIqB,EAAe,CACjBtb,YAAa2J,iBACbrL,IAAK,CACHid,KAAM,GACNhd,QAASoL,iBACT6R,OAAQ,IAEV1c,KAAM6K,iBACNwM,QAASxM,kBAGX+Q,GAAkB1d,QAAQ,SAAAC,GACxB,IAAIkN,EAAQ+P,aAAaE,QAAQnd,EAAM2d,MAEpB,aAAf3d,EAAMT,KACM,SAAV2N,IACFA,EAAQ,MAEc,YAAflN,EAAMT,KACf2N,EAAkB,SAAVA,EACgB,SAAflN,EAAMT,OAIb2N,EAHGA,EAGKqF,kBAAOnS,KAAKoe,MAAMtR,IAFlBlN,EAAM6d,SAAW,IAAInR,QAMV,QAAnB1M,EAAM0d,SACRW,EAAare,EAAM0d,UAAUpc,QAAU+c,EAAare,EAAM0d,UAAUpc,QAAQ8Q,IAC1EpS,EAAM2d,KACNzQ,GAGFmR,EAAare,EAAM0d,UAAYW,EAAare,EAAM0d,UAAUtL,IAAIpS,EAAM2d,KAAMzQ,KAK5EmR,EAAanF,QAAQ3X,IAAI,sBAC3B8c,EAAanF,QAAUmF,EAAanF,QAAQtG,OAAO,mBAAoB,SAAA6L,GAAS,OAC9EA,EAAUrW,IAAI,SAAAuL,GAAQ,OAAIA,EAASvB,IAAI,KAAMC,WAIjD,IAAMqM,EA9GyB,WAC/B,IAAMC,EAA0B1B,aAAaE,QAAQ,kBACrD,OAASwB,EAA0Bve,KAAKoe,MAAMG,GAA2B,KA4GnDC,GAUtB,OATMF,IACJL,EAAahd,IAAIC,QAAU+c,EAAahd,IAAIC,QAAQ8Q,IAAI,gBAAiBG,kBAAOmM,KAIlFnb,OAAOC,6BAA+Bya,GACpCH,GAAmBO,EAAcZ,KAG5BY,IAGIQ,GAA6B,SAAChe,EAAUO,GACnD,IAAMkc,EAAoBlc,IAAW2B,YAAYxB,IAAI,UACrD,GAAK+b,EAAL,CAIA,IAAIwB,EAAsB,KAC1B,OAAQxB,EAAkB/d,MACxB,IAAK,UACHuf,EAAsBxB,EAAkByB,gBAAgB,yBACxD,MACF,IAAK,eACHD,EAAsBxB,EAAkB0B,+BACtC,uBACA,QAMNF,EACGlK,KAAK,SAAAqK,GACJ,IACE,IAAMC,EAAS9e,KAAKoe,MAAMS,GAC1Bpe,EAASmD,EAAoBkb,IAC7Bre,EAASic,GAAuBoC,IAChC,MAAOC,OAKVlc,MAAM,gBAGEmc,GAAqB,SAAAhgB,GAChC,OAAK4d,KAGI,WACL,IAAM7N,EAAQ/P,EAAMgC,WAEd8c,EAAkBJ,GAAmB3O,EAAOsO,IAIlD,GAFAS,EAAgBne,QAAQ,SAAAsN,GAAA,IAAAC,EAAA7N,OAAAqJ,EAAA,EAAArJ,CAAA4N,EAAA,GAAEsQ,EAAFrQ,EAAA,GAAQJ,EAARI,EAAA,UAAmB2P,aAAaC,QAAQS,EAAMzQ,KAElEiC,EAAMtN,KAAKN,IAAI,oCAAqC,CACtD,IAAM8d,EAAuBpB,GAAsBC,GAE/C3a,OAAOC,+BAAiC6b,GAC1ChC,GAAiClO,EAAMpM,YAAYxB,IAAI,UAAW8d,GAGpE9b,OAAOC,6BAA+B6b,EAGxC,IAAMC,EAAkBnQ,EAAM9N,IAAIC,QAAQC,IAAI,QAC9C,GAAM+d,GAAmBnQ,EAAM9N,IAAIC,QAAQC,IAAI,WAAY,CACzD,IAAMge,ENrLoB,SAArBC,EAAqBzR,GAEhC,IADA,IAAI0R,EAAgB,GADuBC,EAAA,SAAAC,GAGzC,IAAMzR,EAASH,EAAQxM,IAAI6N,GAC3B,IAAKlB,EAAO3M,IAAI,UACd,OADyB6N,EAAAuQ,EACzB,WAGF,IAAMC,EAAQ1R,EAAO5F,MAAM,CAAC,YAAa,aAEnCuX,EAAazR,GAAyBL,EAASG,EAAO3M,IAAI,OAC1Due,EAAqBN,EAAmBK,GAE1CC,EAAmB7Z,OAAS,EAC9B6Z,EAAmB/f,QAAQ,SAAAggB,GACzBN,EAAc5M,KAAK,CAAC+M,GAAOvc,OAAO0c,MAGpCN,EAAc5M,KAAK,CAAC+M,IAGtBxQ,GAAKyQ,EAAWjW,KArByBwF,EAAAuQ,GAElCvQ,EAAI,EAAGA,EAAIrB,EAAQnE,OAAQwF,EAAGsQ,EAA9BtQ,GAsBT,OAAOqQ,EM6JuBD,CAAmBrQ,EAAM9N,IAAIC,QAAQC,IAAI,YAE7Dmd,EAAgB,GACdC,EAA0B1B,aAAaE,QAAQ,kBACjDwB,IACFD,EAAgBte,KAAKoe,MAAMG,IAG7BD,EAAcY,GAAmBC,EACjCtC,aAAaC,QAAQ,iBAAkB9c,KAAKC,UAAUqe,MA9BnD,cAoCEsB,GAAe,SAAChgB,EAAOkN,GAC7B8P,MAGHC,aAAaC,QAAQld,EAAOkN,IAInB+S,GAAoB,SAACjgB,GAA4B,IAArBkgB,EAAqBla,UAAAC,OAAA,QAAAC,IAAAF,UAAA,IAAAA,UAAA,GAC5D,GAAKgX,KAEE,CACL,IAAM9P,EAAQ+P,aAAaE,QAAQnd,GACnC,OAAIkgB,GACe,SAAVhT,EAAmB,KAEnBA,EANT,OAAO,MChRLlJ,GAAsB,SAACmL,EAAO7P,GAClC,OAAKA,EAAO2E,YDmGiC,SAACkL,EAAO+P,EAAQxB,GAgB7D,OAfAD,GACGvN,OAAO,SAAAlQ,GAAK,OAAIA,EAAM0d,WAAaA,IACnCxN,OAAO,SAAAlQ,GAAK,OAAIA,EAAM4d,sBACtB1N,OACC,SAAAlQ,GAAK,MAGY,4BAAfA,EAAM2d,OAET5d,QAAQ,SAAAC,GAEFmP,EADU,SAAfnP,EAAMT,KACO4P,EAAMiD,IAAIpS,EAAM2d,KAAMpL,kBAAOnS,KAAKoe,MAAMU,EAAOlf,EAAM2d,SACrDxO,EAAMiD,IAAIpS,EAAM2d,KAAMuB,EAAOlf,EAAM2d,SAG7CxO,EC/GAgR,CAAgChR,EAAO7P,EAAO2E,YAAa,QAHzDkL,GC3CLiR,GACJ,slBACIC,GACJ,kOAEIC,GAA0B,SAACC,EAAOC,GAAgB,IAAAC,EAelDD,EAAYpY,IAAI,SAAAiI,GAAS,OAAIkQ,EAAMlQ,KAfeqQ,EAAAjhB,OAAAqJ,EAAA,EAAArJ,CAAAghB,EAAA,IAEpDE,EAFoDD,EAAA,GAGpD3b,EAHoD2b,EAAA,GAIpD1b,EAJoD0b,EAAA,GAKpDzb,EALoDyb,EAAA,GAMpDxb,EANoDwb,EAAA,GAOpDE,EAPoDF,EAAA,GAQpDG,EARoDH,EAAA,GASpDI,EAToDJ,EAAA,GAUpDK,EAVoDL,EAAA,GAWpDM,EAXoDN,EAAA,GAYpDO,EAZoDP,EAAA,IAapDQ,EAboDR,EAAA,IAcpDS,EAdoDT,EAAA,IAiBtD,IAAK3b,EACH,OAAO,KAlB6C,IAwBlDQ,EAAcC,EAAeC,EAC7BC,EAAWC,EAAYC,EAzB2BG,EAqBnB6a,EAAYA,EAAU1W,MAAM,KAAO,GArBhBrB,EAAApJ,OAAAqJ,EAAA,EAAArJ,CAAAsG,EAAA,GAqB/CZ,EArB+C0D,EAAA,GAqBpCzD,EArBoCyD,EAAA,GAAAwE,EAsBvBwT,EAAUA,EAAQ3W,MAAM,KAAO,GAtBRoD,EAAA7N,OAAAqJ,EAAA,EAAArJ,CAAA4N,EAAA,GAsB/ChI,EAtB+CiI,EAAA,GAsBtChI,EAtBsCgI,EAAA,GA8CtD,MAnBI,CAAC,IAAK,KAAM,MAAMjB,SAASyU,IAC7Bvb,EAAeub,EACftb,EAAgBub,EAChBtb,EAAeub,GACN,CAAC,IAAK,MAAM3U,SAASyU,KAC9Bpb,EAAYob,EACZnb,EAAaob,EACbnb,EAAYob,GAEV,CAAC,IAAK,KAAM,MAAM3U,SAAS4U,IAC7B1b,EAAe0b,EACfzb,EAAgB0b,EAChBzb,EAAe0b,GACN,CAAC,IAAK,MAAM9U,SAAS4U,KAC9Bvb,EAAYub,EACZtb,EAAaub,EACbtb,EAAYub,GAGP,CACLrc,SAA0B,MAAhB6b,EACV5b,OACAC,QACAC,MACAC,UACAC,YACAC,cACAC,UACAC,YACAC,eACAC,gBACAC,eACAC,YACAC,aACAC,cAISwb,GAAwB,SACnCC,GAKA,IAHG,IAAAC,EAAAtb,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GADsD,GACtDub,EAAAD,EADDE,2BACC,IAAAD,KACGE,GADHH,EAD4BI,eAEf,IACZnB,EAAQH,GAAqBuB,KAAKN,GAC/Bd,GAAO,CACZ,GAAMA,EAAM,GACVkB,EAAQ5O,KAAK,CACXtT,KAAM,OACN8hB,QAASd,EAAM,GACfqB,IAAKrB,EAAM,GACXsB,MAAOtB,EAAMsB,aAEV,GAAMtB,EAAM,IAAQA,EAAM,GAC/BkB,EAAQ5O,KAAK,CACXtT,KAAM,OACN8hB,QAASd,EAAM,GACfqB,IAAKrB,EAAM,GACXX,MAAOW,EAAM,GACbsB,MAAOtB,EAAMsB,aAEV,GAAMtB,EAAM,GAAI,CACrB,IAAMuB,EAAqBvB,EAAM,GAAGA,MAAM,UAC1CkB,EAAQ5O,KAAK,CACXtT,KAAM,oBACN8hB,QAASd,EAAM,GACfwB,WAAYD,EAAmB,GAC/BD,MAAOtB,EAAMsB,aAEV,GAAMtB,EAAM,GAAI,CACrB,IAAMyB,EAAsBzB,EAAM,GAAGA,MAAM,gBAC3CkB,EAAQ5O,KAAK,CACXtT,KAAM,kBACN8hB,QAASd,EAAM,GACf0B,SAAU,CAACD,EAAoB,GAAIA,EAAoB,IACvDH,MAAOtB,EAAMsB,aAEV,GAAMtB,EAAM,IAAK,CACtB,IAAM2B,EAAa,CACjBC,IAAK,cACLC,IAAK,OACLC,IAAK,SACLC,IAAK,gBACL7Y,EAAG,YACH8Y,IAAK,YACLhC,EAAM,KAEFiC,EAAqBjC,EAAM,IAAIta,OAErCwb,EAAQ5O,KAAK,CACXtT,KAAM,gBACN8hB,QAASd,EAAM,GAAGpG,UAAUqI,EAAoBjC,EAAM,IAAIta,OAAS,EAAIuc,GACvEX,MAAOtB,EAAMsB,MAAQW,EACrBxY,QAASuW,EAAM,IACf2B,oBAEG,GAAM3B,EAAM,IAAK,CACtB,IAAMkC,EAAiBnC,GAAwBC,EAAO9W,IAAEiZ,MAAM,GAAI,KAC5DC,EAAkBrC,GAAwBC,EAAO9W,IAAEiZ,MAAM,GAAI,KAEnEjB,EAAQ5O,KAAK,CACXtT,KAAM,YACN8hB,QAASd,EAAM,GACfsB,MAAOtB,EAAMsB,MACbY,iBACAE,oBAGJpC,EAAQH,GAAqBuB,KAAKN,GAGpC,IAAMuB,EAAY,GACdC,EAAa,EAuDjB,GAtDApB,EAAQ1hB,QAAQ,SAAAwgB,GACd,IAAIsB,EAAQtB,EAAMsB,MAElB,GAAIA,IAAUgB,EAAY,CACxB,IAAM7Z,EAAOqY,EAAQlH,UAAU0I,EAAYhB,GAC3Ce,EAAU/P,KAAK,CACbtT,KAAM,OACNsU,SAAU7K,IAId,GAAmB,SAAfuX,EAAMhhB,KAAiB,CACzB,IAAMqJ,EAAW,CACf4J,GAAIH,KACJ9S,KAAM,OACNsU,SAAU,CACR+N,IAAKrB,EAAMqB,MAGXrB,EAAMX,QACRhX,EAASiL,SAAS+L,MAAQW,EAAMX,OAElCgD,EAAU/P,KAAKjK,OACS,sBAAf2X,EAAMhhB,KACfqjB,EAAU/P,KAAK,CACbL,GAAIH,KACJ9S,KAAM,oBACNwiB,WAAYxB,EAAMwB,aAEI,oBAAfxB,EAAMhhB,KACfqjB,EAAU/P,KAAK,CACbL,GAAIH,KACJ9S,KAAM,kBACN0iB,SAAU1B,EAAM0B,WAEM,kBAAf1B,EAAMhhB,KACfqjB,EAAU/P,KAAK,CACbL,GAAIH,KACJ9S,KAAM,gBACNyK,QAASuW,EAAMvW,QACfkY,WAAY3B,EAAM2B,aAEI,cAAf3B,EAAMhhB,MACfqjB,EAAU/P,KAAK,CACbL,GAAIH,KACJ9S,KAAM,YACNkjB,eAAgBlC,EAAMkC,eACtBE,gBAAiBpC,EAAMoC,kBAI3BE,EAAatC,EAAMsB,MAAQtB,EAAMc,QAAQpb,SAGvC4c,IAAexB,EAAQpb,QAAUub,EAAqB,CACxD,IAAMsB,EACJzB,EAAQlH,UAAU0I,EAAYxB,EAAQpb,SAAWub,EAAsB,KAAO,IAChFoB,EAAU/P,KAAK,CACbtT,KAAM,OACNsU,SAAUiP,IAId,OAAOF,GAGHG,GAAa,SAAAC,GACjB,IAAMC,EAAQ,CACZzQ,GAAIH,KACJ9S,KAAM,QACNsU,SAAU,CAAC,IACXqP,iBAAkB,IAGpBF,EACG5a,IAAI,SAAA+B,GAAI,OAAIA,EAAKC,SACjBrK,QAAQ,SAAAoK,GACP,GAAIA,EAAKtD,WAAW,MAClBoc,EAAMpP,SAAShB,KAAK,QACf,CACL,IAAMsQ,EAAU1Z,IAAEwI,KAAKgR,EAAMpP,UACvBuP,EAAYjZ,EAAKkZ,OAAO,EAAGlZ,EAAKlE,OAAS,GAAGiE,MAAM,KAEjC,IAAnBiZ,EAAQld,OACVmd,EAAUrjB,QAAQ,SAAAyJ,GAAI,OAAI2Z,EAAQtQ,KAAKrJ,KAEvC4Z,EAAUrjB,QAAQ,SAACujB,EAAc3S,GAC/BwS,EAAQxS,IAAR,KAAAtN,OAA2BigB,QAOrCL,EAAMpP,SAAWoP,EAAMpP,SAASzL,IAAI,SAAAe,GAAG,MAAK,CAC1CqJ,GAAIH,KACJwB,SAAU1K,EAAIf,IAAI,SAAAmb,GAAW,MAAK,CAChC/Q,GAAIH,KACJwB,SAAUuN,GAAsBmC,EAAa,CAAE7B,gBAAgB,IAC/D6B,oBAK2C,IAA3C9Z,IAAEwI,KAAKgR,EAAMpP,UAAUA,SAAS5N,SAClCgd,EAAMpP,SAAWoP,EAAMpP,SAAStF,MAAM,EAAG0U,EAAMpP,SAAS5N,OAAS,IAInE,IAAMud,EAAgBpa,KAAKC,IAALC,MAAAF,KAAI3J,OAAA8J,EAAA,EAAA9J,CAAQwjB,EAAMpP,SAASzL,IAAI,SAAAe,GAAG,OAAIA,EAAI0K,SAAS5N,WAazE,OAZAgd,EAAMpP,SAAS9T,QAAQ,SAAAoJ,GACjBA,EAAI0K,SAAS5N,OAASud,GACxB/Z,IAAEK,MAAM0Z,EAAgBra,EAAI0K,SAAS5N,OAAQ,WAC3CkD,EAAI0K,SAAShB,KAAK,CAChBL,GAAIH,KACJwB,SAAU,GACV0P,YAAa,SAMdN,GAGIQ,GAAe,SAAfA,EAAgBpC,GAkD3B,IAlDgF,IAAAqC,GAAA1d,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAP,IAAnC2d,8BAA0C,IAAAD,KAC1EE,EAAQvC,EAAQnX,MAAM,MAEtB2Z,EAAoB,gCAEtBC,EAAgC,KAC9BC,EAAeta,IAAEa,QACrBsZ,EAAMxb,IAAI,SAAC+B,EAAMO,GACf,IAAMsZ,EAAmB7Z,EAAKoW,MAAM,SAAS,GAAGta,OAEhD,OACoC,OAAlC6d,IACCE,EAAmBF,IAAkC3Z,EAAKC,QAEpD,CACL,CACE7K,KAAM,mBACN4K,UAIJ2Z,EAAgC,KAE1B3Z,EAAKoW,MAAMsD,KAAuBF,GACtCG,EAAgCE,EAEzB,CACL,CACEzkB,KAAM,kBACN4K,UAGKA,EAAKC,OAAOvD,WAAW,OAAS8c,EAClC,CACL,CACEpkB,KAAM,YACN4K,SAIGiX,GAAsBjX,EAAM,CACjCqX,oBAAqB9W,IAAckZ,EAAM3d,OAAS,EAClDyb,gBAAgB,QAOpBuC,EAAqB,GAClB5T,EAAY,EAAGA,EAAY0T,EAAa9d,SAAUoK,EAAW,CACpE,IAAM6T,EAAWH,EAAa1T,GAC9B,GAAsB,cAAlB6T,EAAS3kB,KAAsB,CACjC,IAAMyjB,EAAavZ,IAAE0a,UACnBJ,EAAaxV,MAAM8B,GACnB,SAAAhI,GAAI,MAAkB,cAAdA,EAAK9I,OACb6I,IAAI,SAAAC,GAAI,OAAIA,EAAK8B,OAEnB8Z,EAAmBpR,KAAKkQ,GAAWC,IAEnC3S,GAAa2S,EAAW/c,OAAS,MACN,oBAAlBie,EAAS3kB,KAA4B,WAC9C,IAAMykB,EAAmBE,EAAS/Z,KAAKoW,MAAM,SAAS,GAAGta,OACnDme,EAAe3a,IAAE0a,UACrBJ,EAAaxV,MAAM8B,EAAY,GAC/B,SAAAhI,GAAI,MAAkB,qBAAdA,EAAK9I,OAEZ6I,IAAI,SAAAC,GAAI,OAAIA,EAAK8B,OACjB/B,IAAI,SAAA+B,GAAI,OACPA,EAAKtD,WAAW,IAAIgE,OAAOmZ,EAAmB,IAC1C7Z,EAAKkZ,OAAOW,EAAmB,GAC/B7Z,EAAKkZ,OAAOW,EAAmB,KAEO,KAA1CI,EAAaA,EAAane,OAAS,KACrCme,EAAaA,EAAane,OAAS,GAAK,KAE1C,IAAM4N,EAAW4P,EAAaW,EAAa7b,KAAK,OAAO1D,OAEvDwL,GAAa+T,EAAane,OAE1B,IAAM0M,IAAcuR,EAAS/Z,KAAKoW,MAAM,eAGpCpW,EAAO+Z,EAAS/Z,KAAKoW,MAAMsD,GAAmB,GAE9CjY,EAAc,KACdzB,EAAKoW,MAAM,kBACb3U,EAAczB,EAAKoW,MAAM,kBAAkB,GAC3CpW,EAAOA,EAAKqD,QAAQ,kBAAmB,KAGzC,IAAI6W,EAAgB,KACdC,IAAena,EAAKoW,MAAM,iBAC5B+D,IAEFD,EAAgB,CACdE,IAAK,YACLC,EAAG,UACHC,IAAK,WAJgBta,EAAKoW,MAAM,mBAAmB,IAOrDpW,EAAOA,EAAKqD,QAAQ,mBAAoB,KAG1C,IAAMkX,EAAc,CAClBlS,GAAIH,KACJkD,UAAW6L,GAAsBjX,GACjC0J,WACAjI,cACA0Y,aACAD,iBAGIM,EAAYV,EAAmBhe,OAAS,EAC1C0e,GAAa,GAA4C,SAAvCV,EAAmBU,GAAWplB,KAClD0kB,EAAmBU,GAAWlS,MAAMI,KAAK6R,GAEzCT,EAAmBpR,KAAK,CACtBtT,KAAM,OACNiT,GAAIH,KACJI,MAAO,CAACiS,GACRvZ,gBAAiB+Y,EAAS/Z,KAAKC,OAAO,GACtCsI,0BAA2BC,EAAYuR,EAAS/Z,KAAKoW,MAAM,gBAAgB,GAAK,KAChF5N,cA9D0C,GAkE9CsR,EAAmBpR,KAAKqR,GAI5B,OAAO3R,kBAAO0R,IAsGHW,GAAiC,SAAAvD,GAC5C,IAAMwD,EApG2B,SAAAxD,GACjC,IAAMyD,EAA0BC,GAAc,kCAAmC1E,IAC3E2E,EAAkCvX,OACtC,IACEqX,EACGvO,WACA4D,UAAU,EAAG2K,EAAwBvO,WAAWtQ,OAAS,GAC5D,MAGEgf,EAAgBF,GACpB,OACAC,EACA,MACAA,EACA,MACAA,EACA,OAEIE,EAAgB7D,EAAQd,MAAM0E,GAE9BrP,EAAgBrD,kBACpB,CAAC,EAAG,GAAI,IACLnK,IAAI,SAAA+c,GACH,IAAM5lB,EAAO2lB,EAAcC,GAC3B,OAAK5lB,EASE,CAAEA,OAAMoF,UALG2b,GAChB4E,EACAzb,IAAEiZ,MAAMyC,EAAoB,EAAGA,EAAoB,EAAI,KAG/B3S,GAAIH,MARrB,OAUVnC,OAAO,SAAA7E,GAAI,QAAMA,KAGtB,OAAIuK,EAAchM,KAAO,EAYhB,CAAEgM,gBAAewP,oBANwB/D,EAC7CnX,MAAM,MACNgG,OAAO,SAAA/F,GACN,OAAQA,EAAKkC,SAAS6Y,EAAc,GAAG9a,UAExC7B,KAAK,OAGD,CAAEqN,cAAerD,kBAAO,IAAK6S,oBAAqB/D,GA+ChCgE,CAAoBhE,GACzCiE,EA5CkB,SAAAjE,GACxB,IAAMuC,EAAQvC,EAAQnX,MAAM,MACtBqb,EAAsB3B,EAAM3V,UAAU,SAAA9D,GAAI,MAAoB,iBAAhBA,EAAKC,SACnDob,EAAe5B,EAAM3V,UAAU,SAAA9D,GAAI,MAAoB,UAAhBA,EAAKC,SAElD,OAC2B,IAAzBmb,IACkB,IAAlBC,GACCnE,EAAQjX,OAAOvD,WAAW,gBA4BtB,CACLmP,kBArBwBzD,kBACxBqR,EACGrV,MAAMgX,EAAsB,EAAGC,GAC/Bpd,IAAI,SAAA+B,GACH,IAAMoW,EAAQpW,EAAKoW,MAAM,wBACzB,IAAKA,EACH,OAAO,KAGT,IAAMrT,EAAUqT,EAAM,GAAKa,GAAsBb,EAAM,IAAM,KAE7D,MAAO,CACLrK,SAAUqK,EAAM,GAChBrT,QACAsF,GAAIH,QAGPnC,OAAO,SAAAQ,GAAM,QAAMA,KAKtB0U,oBAAqBxB,EAAMrV,MAAMiX,EAAe,GAAGjd,KAAK,OA5BjD,CACLyN,kBAAmB1D,kBACnB8S,oBAAqB/D,GAgCCoE,CAAkBZ,EAAmBO,qBAE/D,MAAO,CACLxP,cAAeiP,EAAmBjP,cAClCI,kBAAmBsP,EAAkBtP,kBACrCoP,oBAAqBE,EAAkBF,sBAIrCM,GAAqBnT,kBAAO,CAChC,CACEoT,SAAU,CAAC,OAAQ,QACnBC,kBAAmB,CAAC,QACpB/H,SAAS,KAIAgI,GAAiB,SAACtQ,EAAWvC,GACxC,IAGMwC,EAHcxC,EAAgB8S,QAAQ,SAAAzQ,GAC1C,OAAOA,EAAe9T,IAAI,cAEI2O,OAAO,SAAA+C,GAAO,OAAIsC,EAAU1O,WAAWoM,EAAU,OAAMtD,QACnF8F,EAAWF,EACXC,IACFC,EAAWA,EAAS4N,OAAO7N,EAAYvP,OAAS,IAIlD,IAAIyP,EAAO,GACX,GAAID,EAASM,YAAYzJ,SAAS,KAAM,CACtC,IAAMyZ,EAAatQ,EAASM,YAAY7L,MAAM,KACxC8b,EAAeD,EAAWA,EAAW9f,OAAS,GAChD,aAAaggB,KAAKD,KACpBvQ,EAAWA,EAAS4N,OAAO,EAAG5N,EAASxP,OAAS+f,EAAa/f,QAC7DyP,EAAOsQ,EAAa9b,MAAM,KAAKgG,OAAO,SAAAyF,GAAG,MAAY,KAARA,KAIjD,IAAMiK,EAAQwB,GAAsB3L,GAEpC,OAAOlD,kBAAO,CAAEqN,QAAOnK,WAAUD,cAAaE,UAGnCwQ,GAAqB,SAAC/b,EAAMmL,EAActC,GACxB,IAAzBA,EAAgBpJ,OAClBoJ,EAAkB0S,IAGpB,IAAMnQ,EAAYsQ,GAAe1b,EAAM6I,GACvC,OAAOT,kBAAO,CACZgD,YACAY,eAAgB,GAChB/C,YAAa,GACb+S,QAAQ,EACR3T,GAAIH,KACJiD,eACAM,cAAe,GACfI,kBAAmB,MAIjB+O,GAAgB,mBAAAqB,EAAApgB,UAAAC,OAAIogB,EAAJ,IAAAC,MAAAF,GAAAG,EAAA,EAAAA,EAAAH,EAAAG,IAAIF,EAAJE,GAAAvgB,UAAAugB,GAAA,OACpBF,EAAQG,OAAO,SAACC,EAAMC,GAAP,OACbjZ,OACEgZ,EAAKlQ,WAAW4D,UAAU,EAAGsM,EAAKlQ,WAAWtQ,OAAS,GACpDygB,EAAKnQ,WAAW4D,UAAU,EAAGuM,EAAKnQ,WAAWtQ,OAAS,OAkBjD0gB,GAAW,SAAAC,GACtB,IAAI7Y,EAAU,IAAIuE,QACZsR,EAAQgD,EAAa1c,MAAM,MAE7B8I,EAAkB,IAAIV,QACtB4C,EAAkB,IAAI5C,QACtB6C,EAAsB,IAAI7C,QAwD9B,OAtDAsR,EAAM7jB,QAAQ,SAAAoK,GACZ,GAAIA,EAAKtD,WAAW,KAAM,CACxB,IAAIyO,EAAenL,EAAKwD,QAAQ,MACV,IAAlB2H,IACFA,EAAenL,EAAKlE,QAEtB,IAAM2Z,EAAQzV,EAAKkZ,OAAO/N,EAAe,GACzCvH,EAAUA,EAAQ8E,KAAKqT,GAAmBtG,EAAOtK,EAActC,SAE/D,GAAqB,IAAjBjF,EAAQnE,KACV,GAAIO,EAAKtD,WAAW,aAAesD,EAAKtD,WAAW,gBAAiB,CAClE,IACMggB,EADiB1c,EAAKkZ,OAAOlZ,EAAKwD,QAAQ,KAAO,GAClBzD,MAAM,MACrCyb,EAAWkB,EAAc3W,OAAO,SAAA+C,GAAO,MAAgB,MAAZA,IAE3C6T,EAAYD,EAAclZ,QAAQ,KAClCiY,EAAoBkB,GAAa,EAAInB,EAASpX,MAAMuY,GAAa,GAEvE9T,EAAkBA,EAAgBH,KAChCN,kBAAO,CACLoT,WACAC,oBACAmB,WAAY5c,EACZ0T,SAAS,UAGJ1T,EAAKtD,WAAW,MACzBqO,EAAkBA,EAAgBrC,KAAK1I,GAEvCgL,EAAsBA,EAAoBtC,KAAK1I,QAGjD4D,EAAUA,EAAQ2D,SAAS,CAAC3D,EAAQnE,KAAO,EAAG,kBAAmB,SAAAuM,GAAc,OACnD,IAA1BA,EAAelQ,OAAekE,EAAOgM,EAAiB,KAAOhM,MAMxC,IAAzB6I,EAAgBpJ,OAClBoJ,EAAkB0S,IAGpB3X,EAAUA,EAAQ3F,IAAI,SAAA8F,GAAU,IAAA8Y,EAE5BpC,GAA+B1W,EAAO3M,IAAI,mBADpCqU,EADsBoR,EACtBpR,cAAeI,EADOgR,EACPhR,kBAAmBoP,EADZ4B,EACY5B,oBAG1C,OAAOlX,EACJkE,IAAI,iBAAkBgT,GACtBhT,IAAI,cAAeqR,GAAa2B,IAChChT,IAAI,gBAAiBwD,GACrBxD,IAAI,oBAAqB4D,KAGvBzD,kBAAO,CACZxE,UACAiF,kBACAkC,kBACAC,yBCziBE8R,GAA2D,SAAC9e,EAAO+e,GACvE,IAAMC,EAAYD,EAAiBhX,OAAO,SAAAkX,GAAM,OAAIA,IAAQnhB,OACtDohB,EAAaH,EAAiBjhB,OAEpC,OAAOkC,EAAMC,IAAI,SAAAC,GACf,OAAQA,EAAK9G,IAAI,SACf,IAAK,kBACH,OAAO8G,EAAK+J,IAAI,WAAYE,gBAAK,CAAC6U,EAAWE,KAC/C,IAAK,oBACH,OAAOhf,EAAK+J,IAAI,aAAchJ,KAAKke,MAAOH,EAAYE,EAAc,MACtE,QACE,OAAOhf,MAKTkf,GAA8B,SAACpY,EAAOnB,GAM1C,IALA,IAAMD,EAAUoB,EAAM5N,IAAI,WACpB8M,EAAcP,GAAoBC,EAASC,GAC3C6R,EAAazR,GAAyBL,EAASC,GAE/CwZ,EAAiB,GACdpY,EAAI,EAAGA,EAAIyQ,EAAWjW,OAAQwF,EAAG,CACxC,IAAMqY,EAAY5H,EAAWte,IAAI6N,GACjCoY,EAAe3U,KAAK4U,GAGpBrY,GAD4BhB,GAAyBL,EAAS0Z,EAAUlmB,IAAI,OACnDqI,KAG3B,IAAIsd,EAAmBM,EACpBpf,IAAI,SAAA8F,GAAM,OAAIA,EAAO5F,MAAM,CAAC,YAAa,kBACzC4H,OAAO,SAAAsF,GAAW,QAAMA,IACxBpN,IAAI,SAAAoN,GAAW,OACdzC,GAAyB5D,EAAM5N,IAAI,mBAAoBiU,GACpDjU,IAAI,qBACJ4R,SAASqC,KAehB,OAXgC,IAA5B0R,EAAiBjhB,SACnBihB,EAAmBnZ,EAChBxM,IAAI8M,GACJ9M,IAAI,eACJ2O,OAAO,SAAA7H,GAAI,MAAyB,SAArBA,EAAK9G,IAAI,UACxBukB,QAAQ,SAAA5a,GAAQ,OAAIA,EAAS3J,IAAI,WACjC2O,OAAO,SAAA7E,GAAI,OAAIA,EAAK9J,IAAI,gBACxB6G,IAAI,SAAAiD,GAAI,MAAkC,YAA9BA,EAAK9J,IAAI,mBACrBsD,QAGEsK,EACJuC,SAAS,CAAC,UAAWrD,EAAa,YAAa,SAAU,SAAAuR,GAAK,OAC7DqH,GAAyDrH,EAAOsH,KAEjExV,SAAS,CAAC,UAAWrD,EAAa,aAAc,SAAAkH,GAAS,OACxDA,EAAUnD,IAAI,WAAY5J,GAA0B+M,EAAUhU,IAAI,cAIlEmmB,GAAsC,SAACvY,EAAOnB,GAClD,IAAMiB,EAAiBN,GAAuBQ,EAAM5N,IAAI,WAAYyM,GACpE,OAAKiB,EAIEsY,GAA4BpY,EAAOF,GAHjCE,GAML4H,GAAmB,SAAC5H,EAAO7P,GAC/B,IAAM0O,EAAW1O,EAAO0O,UAAYmB,EAAM5N,IAAI,oBAC9C,IAAKyM,EACH,OAAOmB,EAGT,IAAMpB,EAAUoB,EAAM5N,IAAI,WACpB2M,EAASC,GAAaJ,EAASC,GAC/BK,EAAcP,GAAoBC,EAASC,GAE3C2Z,EAAmBzZ,EAAO5F,MAAM,CAAC,YAAa,gBAC9Csf,EAAiB7U,GAAyB5D,EAAM5N,IAAI,mBAAoBomB,GAGxEE,EADoBD,EAAermB,IAAI,YAAYoM,QAAQga,GACvB,EACpCG,EAAeF,EAAermB,IAAI,YAAYA,IAAIsmB,IAAkB,GAEpEE,EAAoC7Z,EACvC3M,IAAI,iBACJ6G,IAAI,SAAC0N,EAAc+L,GAAf,MAAyB,CAAC/L,EAAc+L,KAC5C3R,OAAO,SAAAnK,GAAA,IAAA8C,EAAApJ,OAAAqJ,EAAA,EAAArJ,CAAAsG,EAAA,GAAE+P,EAAFjN,EAAA,GAAAA,EAAA,WAA6BiN,EAAaxN,MAAM,CAAC,YAAa,mBAExE,GACEsf,EAAermB,IAAI,qBAAqB8K,SAASyb,IACjDC,EAAkCne,KAAO,EACzC,CACAme,EAAkChoB,QAAQ,SAAAsN,GAAuC,IAAAC,EAAA7N,OAAAqJ,EAAA,EAAArJ,CAAA4N,EAAA,GAArCyI,EAAqCxI,EAAA,GAAvBmO,EAAuBnO,EAAA,GAC/E6B,EAAQA,EAAMI,MACZ,CAAC,UAAWlB,EAAa,gBAAiBoN,EAAmB,ab5FxC,SAAC9W,EAAWqjB,GACvC,IAAKrjB,EAAUpD,IAAI,gBACjB,OAAOoD,EAGT,IAAIsjB,EAAU,KACd,OAAQtjB,EAAUpD,IAAI,iBACpB,IAAK,IACH0mB,EAAU7gB,GACRL,GAAiBpC,GACjBA,EAAUpD,IAAI,iBACdoD,EAAUpD,IAAI,iBAEhB,MACF,IAAK,KAMH,IALA0mB,EAAU7gB,GACRL,GAAiBpC,GACjBA,EAAUpD,IAAI,iBACdoD,EAAUpD,IAAI,iBAET2mB,oBAASD,EAASD,IACvBC,EAAU7gB,GACR6gB,EACAtjB,EAAUpD,IAAI,iBACdoD,EAAUpD,IAAI,iBAGlB,MACF,IAAK,KACH0mB,EAAU7gB,GACR,IAAIb,KACJ5B,EAAUpD,IAAI,iBACdoD,EAAUpD,IAAI,iBAEhB,MACF,QAEE,OADA4K,QAAQhJ,MAAR,yCAAAE,OAAuDsB,EAAUpD,IAAI,kBAC9DoD,EAeX,YANmCuB,KANnCvB,EAAYA,EACTyN,IAAI,MAAO5L,KAAWyhB,EAAS,OAC/B7V,IAAI,UAAW5L,KAAWyhB,EAAS,QACnC7V,IAAI,QAAS5L,KAAWyhB,EAAS,OACjC7V,IAAI,OAAQ5L,KAAWyhB,EAAS,UAErB1mB,IAAI,cAA6D,OAA/BoD,EAAUpD,IAAI,eAC5DoD,EAAYA,EACTyN,IAAI,YAAa5L,KAAWyhB,EAAS,OACrC7V,IAAI,cAAe5L,KAAWyhB,EAAS,QAGrCtjB,EayCDwjB,CAAcrS,EAAavU,IAAI,aAAc,IAAIgF,SAIrD4I,EAAQA,EAAMI,MACZ,CAAC,UAAWlB,EAAa,YAAa,eACtCuZ,EAAermB,IAAI,YAAYoO,SAGjC,IAAMyY,EAAsBtiB,GAAoB,CAAEhB,UAAU,EAAOuB,eAAe,IAC5EgiB,EAAqB,CACzB,CACE9oB,KAAM,YACNiT,GAAIH,KACJoQ,eAAgB2F,EAChBzF,gBAAiB,OAmBrBxT,GAhBAA,EAAQA,EAAMuC,SAAS,CAAC,UAAWrD,EAAa,qBAAsB,SAAA2H,GAAiB,OACrFA,EAAkBjG,KAAK,SAAA1E,GAAI,MAA6B,gBAAzBA,EAAK9J,IAAI,cACpCyU,EAAkB5N,IAAI,SAAAiD,GAAI,MACC,gBAAzBA,EAAK9J,IAAI,YACL8J,EAAK+G,IAAI,QAASG,kBAAO8V,IACzBhd,IAEN2K,EAAkBnD,KAChBN,kBAAO,CACL2D,SAAU,cACVhJ,MAAOmb,EACP7V,GAAIH,WAKAX,SAAS,CAAC,UAAWrD,GAAc,SAAAH,GAC/C,IAAIiI,EAAiBjI,EAAO3M,IAAI,kBAUhC,OATI4U,EAAetP,WAAW,QAC5BsP,EAAiBA,EAAe5H,MAAM,IAGxC4H,EACE,cAAA9S,OAAcykB,EAAd,kBAAAzkB,OAA2CskB,EAA3C,YAAAtkB,OAAsEqB,GACpE6N,kBAAO6V,IADT,MAEQjS,EAEHjI,EACJkE,IAAI,iBAAkB+D,GACtB/D,IAAI,cAAeqR,GAAatN,WAGrChH,EAAQA,EAAMI,MAAM,CAAC,UAAWlB,EAAa,YAAa,eAAgByZ,GAK5E,OAFA3Y,EAAQuY,GAAoCvY,EAAOnB,IAyE/C2J,GAA0B,SAACxI,EAAO7P,GACtC,IAAMyO,EAAUoB,EAAM5N,IAAI,WAE1B,QAAsC2E,IAAlCiJ,EAAM5N,IAAI,oBACZ,OAAO4N,EAAMiD,IAAI,mBAAoBrE,EAAQzF,MAAM,CAAC,EAAG,QAGzD,IAEMggB,ETtPmC,SAACva,EAASM,GAEnD,OADyBN,EAAQQ,MAAMF,EAAc,GAC7BS,KAAK,SAAAZ,GAAM,OAAIc,GAAgBjB,EAASG,EAAO3M,IAAI,SSoPjDgnB,CAA4Bxa,EAFlCD,GAAoBC,EAASoB,EAAM5N,IAAI,sBAI3D,OAAK+mB,EAIEnZ,EAAMiD,IAAI,mBAAoBkW,EAAkB/mB,IAAI,OAHlD4N,GAMLyI,GAA8B,SAACzI,EAAO7P,GAC1C,IAAMyO,EAAUoB,EAAM5N,IAAI,WAGpBinB,ET9PuC,SAACza,EAASM,GAEvD,OADwBN,EAAQQ,MAAM,EAAGF,GAAaQ,UAC/BC,KAAK,SAAAZ,GAAM,OAAIc,GAAgBjB,EAASG,EAAO3M,IAAI,SS4P5CknB,CAAgC1a,EAF1CD,GAAoBC,EAASoB,EAAM5N,IAAI,sBAI3D,OAAKinB,EAIErZ,EAAMiD,IAAI,mBAAoBoW,EAAsBjnB,IAAI,OAHtD4N,GA4KLqH,GAAqB,SAACrH,EAAO7P,GACjC,IAAMof,EAAgBvP,EAAM5N,IAAI,iBAChC,IAAKmd,EACH,OAAOvP,EAGT,IAAMuZ,EAAoBhK,EAAcnd,IAAI4N,EAAM5N,IAAI,SACtD,IAAKmnB,GAAgD,IAA3BA,EAAkB9e,KAC1C,OAAOuF,EAGT,IAEIpB,EAAUoB,EAAM5N,IAAI,WAElBonB,EAAiB5a,EAAQ6a,SAAS,SAAA1a,GAEtC,MANiB,SAKAA,EAAO5F,MAAM,CAAC,YAAa,eAGxCugB,IAAaF,GAAiBA,EAAepnB,IAAI,UAEvDmnB,EAAkB3oB,QAAQ,SAAA+oB,GACxB/a,ETnY8B,SAArBgb,EAAsBhb,EAAS0B,GAAoC,IAAxBuZ,EAAwBhjB,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAN,EACxE,GAAwB,IAApByJ,EAAW7F,KACb,OAAOmE,EAGT,IAAMkb,EAAaxZ,EAAWE,QACxBtB,EAAcN,EAAQE,UAAU,SAAAC,GACpC,IAAMuH,EAAWvH,EAAO5F,MAAM,CAAC,YAAa,aACtCgN,EAAepH,EAAO3M,IAAI,gBAChC,OAAOkU,IAAawT,GAAc3T,GAAgB0T,IAEpD,IAAqB,IAAjB3a,EACF,OAAON,EAGTA,EAAUA,EAAQ6E,OAAOvE,EAAa,SAAAH,GAAM,OAAIA,EAAOkE,IAAI,UAAU,KAErE,IAAIyN,EAAazR,GAAyBL,EAASA,EAAQzF,MAAM,CAAC+F,EAAa,QAQ/E,OAPAwR,EAAakJ,EAAmBlJ,EAAYpQ,EAAWyZ,OAAQF,EAAkB,GAEjFjb,EAAUA,EACPob,KAAK9a,EAAc,GACnBhL,OAAOwc,GACPxc,OAAO0K,EAAQqb,SAASrb,EAAQnE,MAAQyE,EAAc,EAAIwR,EAAWjW,QS4W5Dmf,CAAmBhb,EAAS+a,KAGxC,IAAMO,EAAiBtb,EAAQ6a,SAAS,SAAA1a,GAEtC,MAhBiB,SAeAA,EAAO5F,MAAM,CAAC,YAAa,eAGxCghB,IAAaD,GAAiBA,EAAe9nB,IAAI,UAGvD,GADA4N,EAAQA,EAAMiD,IAAI,UAAWrE,IACV,IAAf8a,IAAuC,IAAfS,EAAqB,CAC/C,IAAMtb,EAAWqb,EAAe9nB,IAAI,MAEpC4N,GADAA,EAAQA,EAAMiD,IAAI,mBAAoBpE,IACxBoE,IAAI,kBAAmBpE,GAGvC,OAAOmB,GAOHoa,GAA+C,SAACpa,EAAOW,GAA0B,IAAlB5B,EAAkBlI,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAT,KACtE+H,EAAUoB,EAAM5N,IAAI,WACrB2M,IACHA,EAAS8B,GAA8BjC,EAAS+B,IAElD,IAAMzB,EAAcP,GAAoBC,EAASG,EAAO3M,IAAI,OAE5D,OAAO4N,EAAMuC,SAAS,CAAC,UAAWrD,GAAc,SAAAH,GAAM,OACpDA,EAAOkE,IAAI,iBAAkB5J,GAA0B0F,EAAO3M,IAAI,oBAIhE+W,GAAiB,SAACnJ,EAAO7P,GAC7B,IAAMkqB,EAAsBra,EAAM5N,IAAI,uBACtC,OAAKioB,GAILra,EAAQA,EAAMyD,OAAO,UAAW,SAAA7E,GAAO,OACrCsD,GACEtD,EACAyb,EACA,SAAAjf,GAAQ,OAAI,SAAAkf,GAAI,OAAIA,EAAKtX,OAAO5H,EAAW,ETtDT,SAAAkf,GAAI,OAC1CA,EACGloB,IAAI,GACJ6Q,IAAI,KAAMC,MACVO,OAAO,WAAY,SAAAiB,GAAQ,OAC1BA,EAASzL,IAAI,SAAAoB,GAAI,OACfA,EAAK4I,IAAI,KAAMC,MAAcD,IAAI,WAAY,IAAIE,SAAQF,IAAI,cAAe,QSgDhCsX,CAAyBD,SAIpEF,GAA6Cpa,EAAOqa,IAXlDra,GAmCLqJ,GAAoB,SAACrJ,EAAO7P,GAChC,IAAMkqB,EAAsBra,EAAM5N,IAAI,uBACtC,OAAKioB,GAILra,EAAQA,EAAMyD,OAAO,UAAW,SAAA7E,GAAO,OACrCsD,GACEtD,EACAyb,EACA,SAACG,EAAWC,GAAZ,OAAyB,SAAAH,GAAI,OAC3BA,EAAKrhB,IAAI,SAAAe,GAAG,OACVA,EAAIyJ,OAAO,WAAY,SAAAiB,GAAQ,OAAIA,EAAS1B,OAAOyX,EAAW,ETnFtErX,kBAAO,CACLC,GAAIH,KACJwB,SAAU,GACV0P,YAAa,eSqFRgG,GAA6Cpa,EAAOqa,IAdlDra,GAyJL6J,GAAgB,SAAC7J,EAAO7P,GAC5B,IAAMyO,EAAUoB,EAAM5N,IAAI,WAClBoS,EAAqCrU,EAArCqU,SAAU3J,EAA2B1K,EAA3B0K,QAAS0J,EAAkBpU,EAAlBoU,cAErBmW,EAA0F,IAAvElW,EAASpS,IAAI,eAAe2O,OAAO,SAAAI,GAAI,OAAoB,IAAhBA,EAAKrK,SAAc2D,KAEjFgF,EAAeib,EACjB,KACAra,GAAezB,EAAS4F,EAASpS,IAAI,gBACzC,IAAKqN,IAAiBib,EACpB,OAAO1a,EAGT,IAAM2a,EDpNyB,SAACzI,EAASrO,GACzC,IAAMuC,EAAY8L,EAAQnX,MAAM,MAAM,GAAGsD,QAAQ,UAAW,IACtD4F,EAAciO,EAAQnX,MAAM,MAAMqE,MAAM,GAAGhG,KAAK,MAFOwhB,EAK3DnF,GAA+BxR,GADzBwC,EAJqDmU,EAIrDnU,cAAeI,EAJsC+T,EAItC/T,kBAAmBoP,EAJmB2E,EAInB3E,oBAG1C,OAAOc,GAAmB3Q,EAAW,EAAGvC,GACrCZ,IAAI,iBAAkBgT,GACtBhT,IAAI,cAAeqR,GAAa2B,IAChChT,IAAI,gBAAiBwD,GACrBxD,IAAI,oBAAqB4D,GCyMVgU,CAAkBhgB,EAASmF,EAAM5N,IAAI,oBAAoB6Q,IACzE,eACAyX,EAAmB,EAAIjb,EAAarN,IAAI,gBAAkB,GAG5D,GAAIsoB,EACF,OAAO1a,EAAMyD,OAAO,UAAW,SAAA7E,GAAO,OAAIA,EAAQ8E,KAAKiX,KAEvD,IAAMxa,EAAoBxB,GAAoBC,EAASa,EAAarN,IAAI,OAClE0oB,EAAgBvb,GAA4BX,EAASa,EAAarN,IAAI,OACtE2oB,EAAW5a,EAAoB,GAAKoE,EAAgB,EAAIuW,GAM9D,OAJA9a,EAAQA,EAAMyD,OAAO,UAAW,SAAA7E,GAAO,OAAIA,EAAQoE,OAAO+X,EAAUJ,KAEpE3a,EAAQoY,GAA4BpY,EAAOP,EAAarN,IAAI,QA2D1D6Y,GAAuB,SAACjL,EAAO7P,GACnC,IAAMmR,EAAcM,GAAqC5B,EAAM5N,IAAI,WAAYjC,EAAO0R,YAC9EV,EAAuBG,EAAvBH,KAAMY,EAAiBT,EAAjBS,aAMd,GAJkCA,EAC/B3P,IAAI,YACJ2O,OAAO,SAAA7H,GAAI,MAAyB,SAArBA,EAAK9G,IAAI,UACxBwO,KAAK,SAAA7E,GAAQ,OAAIA,EAAS3J,IAAI,SAASwO,KAAK,SAAA1E,GAAI,OAAIA,EAAK9J,IAAI,kBAE9D,OAAO4N,EAGT,IAAMgb,EAAmB,CACvBre,QAAS,YACTC,UAAW,UACXC,QAAS,aACTkF,EAAa3P,IAAI,kBAGnB4N,EAtEiC,SAA7Bib,EAA8Bjb,EAAOkb,GACzC,IAAMC,EAAqBD,EAAS9b,MAAM,EAAG8b,EAASpkB,OAAS,GACzDskB,EAAiBpb,EAAM7G,MAAMgiB,GACnC,IAAKC,EAAeC,IAAI,iBACtB,OAAOrb,EAGT,IAAMsb,EAAwBF,EAC3BhpB,IAAI,YACJ2O,OAAO,SAAA7H,GAAI,MAAyB,SAArBA,EAAK9G,IAAI,UACxBukB,QAAQ,SAAA5a,GAAQ,OACfA,EACG3J,IAAI,SACJ2O,OAAO,SAAA7E,GAAI,OAAIA,EAAK9J,IAAI,gBACxB6G,IAAI,SAAAsiB,GAAY,OAAIA,EAAanpB,IAAI,qBAI1C4N,EADEsb,EAAsBE,MAAM,SAAAxb,GAAK,MAAc,YAAVA,IAC/BA,EAAMI,MAAM+a,EAAmBjnB,OAAO,CAAC,kBAAmB,WACzDonB,EAAsBE,MAAM,SAAAxb,GAAK,MAAc,cAAVA,IACtCA,EAAMI,MAAM+a,EAAmBjnB,OAAO,CAAC,kBAAmB,aAE1D8L,EAAMI,MAAM+a,EAAmBjnB,OAAO,CAAC,kBAAmB,WAGpE,IAAMunB,EAAwBH,EAC3BriB,IAAI,SAAA+G,GACH,OAAQA,GACN,IAAK,UACH,OAAO,EACT,IAAK,YAEL,IAAK,UAEL,QACE,OAAO,KAGZtK,OAMH,OAJAsK,EAAQA,EAAMuC,SAAS4Y,EAAmBjnB,OAAO,aAAc,SAAAkS,GAAS,OACtE0R,GAAyD1R,EAAWqV,KAGlEL,EAAehpB,IAAI,cACd6oB,EAA2Bjb,EAAOmb,GAElCnb,EAuBDib,CADRjb,EAAQA,EAAMI,MAAM,CAAC,WAAWlM,OAAOiN,GAAMjN,OAAO,CAAC,kBAAmB8mB,GAC9B,CAAC,WAAW9mB,OAAOiN,IAE7D,IAAMjC,EAAciC,EAAK,GAMzB,OAJAnB,GADAA,EAAQoY,GAA4BpY,EAAOA,EAAM7G,MAAM,CAAC,UAAW+F,EAAa,SAClEqD,SAAS,CAAC,UAAWrD,GAAc,SAAAH,GAAM,OACrDA,EAAOkE,IAAI,iBAAkB5J,GAA0B0F,EAAO3M,IAAI,oBAQhEspB,GAA8C,SAAC1b,EAAO6B,GAA8B,IAAlB9C,EAAkBlI,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAT,KAC3EqI,GAAe,EACbN,EAAUoB,EAAM5N,IAAI,WACrB2M,EAIHG,EAAcP,GAAoBC,EAASG,EAAO3M,IAAI,OAFtD8M,EADoB0C,GAAqChD,EAASiD,GACxCV,KAAK,GAKjC,OAAIjC,GAAe,EACVc,EAAMuC,SAAS,CAAC,UAAWrD,GAAc,SAAAH,GAAM,OACpDA,EAAOkE,IAAI,iBAAkB5J,GAA0B0F,EAAO3M,IAAI,mBAG7D4N,GA4CLoL,GAAiB,SAACpL,EAAO7P,GAC7B,IAAMwrB,EAAqB3b,EAAM5N,IAAI,sBACrC,IAAKupB,EACH,OAAO3b,EAGT,IAAMsB,EAAcM,GAClB5B,EAAM5N,IAAI,WACVupB,GAGEC,ET5YJxY,kBAAO,CACLC,GAAIH,KACJkD,UAAW,GACX1B,SAAU,GACVjI,YAAa,KACb0Y,YAAY,ISmZd,OAXI7T,EAAYS,aAAa3P,IAAI,gBAC/BwpB,EAAUA,EAAQ3Y,IAAI,cAAc,GAAMA,IAAI,gBAAiB,cAGjEjD,EAAQA,EAAMyD,OAAO,UAAW,SAAA7E,GAAO,OACrC4D,GACE5D,EACA+c,EACA,SAAAta,GAAS,OAAI,SAAAiC,GAAK,OAAIA,EAAMN,OAAO3B,EAAY,EAAGua,QAG/CF,GAA4C1b,EAAO2b,IAqBtDpQ,GAAiB,SAACvL,EAAO7P,GAC7B,IAAMwrB,EAAqB3b,EAAM5N,IAAI,sBACrC,IAAKupB,EACH,OAAO3b,EAGT,IAAM6b,ETzsBoC,SAACjd,EAASiD,GACpD,IACM3C,EADc0C,GAAqChD,EAASiD,GAClCV,KAAK,GACrC,OAAOvC,EAAQxM,IAAI8M,GSssBM4c,CAA6B9b,EAAM5N,IAAI,WAAYupB,GAY5E,OAFA3b,GARAA,EAAQA,EAAMyD,OAAO,UAAW,SAAA7E,GAAO,OACrC4D,GACE5D,EACA+c,EACA,SAAAta,GAAS,OAAI,SAAAiC,GAAK,OAAIA,EAAMyY,OAAO1a,SAIzB4B,IAAI,qBAAsB,MAEjCyY,GAA4C1b,EAAO2b,EAAoBE,IAsH1EjQ,GAAsB,SAAA5L,GAC1B,IAAM2b,EAAqB3b,EAAM5N,IAAI,sBACrC,IAAKupB,EACH,OAAO3b,EAGT,IAAMsB,EAAcM,GAClB5B,EAAM5N,IAAI,WACVupB,GAEIxa,EAAyCG,EAAzCH,KAAoB6a,EAAqB1a,EAAnCS,aACNka,EAAwB9a,EAAKA,EAAKrK,OAAS,GACjD,GAAIqK,EAAKJ,OAAO,SAAAmb,GAAU,MAAmB,UAAfA,IAAwBplB,OAAS,EAC7D,OAAOkJ,EAGT,IAAMob,ET7jBqC,SAACxc,EAASiD,GACrD,IACMV,EADcS,GAAqChD,EAASiD,GAC5DV,KACN,OAAOvC,EAAQzF,MAAMgI,EAAK/B,MAAM,EAAG+B,EAAKrK,OAAS,IS0jB1BqlB,CACrBnc,EAAM7G,MAAM,CAAC,YACbwiB,GAgCF,OA7BAP,EACGhpB,IAAI,YACJ2O,OAAO,SAAA7H,GAAI,MAAyB,SAArBA,EAAK9G,IAAI,UACxB6G,IAAI,SAAA8C,GAAQ,OACXA,EAAS3J,IAAI,SAASxB,QAAQ,SAACsL,EAAMmF,GAC/BA,EAAY4a,IACdD,EAAmBA,EAAiBvY,OAAO,WAAY,SAAAiB,GAAQ,OAC7D9B,GAAmC8B,EAAUxI,EAAMH,UAc7DiE,GARAA,EAAQA,EAAMyD,OAAO,UAAW,SAAA7E,GAAO,OACrC4D,GACE5D,EACA+c,EACA,SAAAta,GAAS,OAAI,SAAAiC,GAAK,OAAIA,EAAMvC,OAAO,SAACqb,EAAO1J,GAAR,OAAkBA,EAAQuJ,UAInDxY,OAAO,UAAW,SAAA7E,GAAO,OACrC4D,GACE5D,EACAwc,EAAehpB,IAAI,MACnB,SAAAiP,GAAS,OAAI,SAAAiC,GAAK,OAAIA,EAAMN,OAAO3B,EAAY,EAAG2a,QAI/CN,GAA4C1b,EAAO2b,IA6EtDxP,GAAwB,SAACnM,EAAO7P,GACpC,ITt0BwDyO,EAASqC,ESs0B3DK,GTt0BkD1C,ESu0BtDoB,EAAM5N,IAAI,WTv0BqD6O,ESw0B/D9Q,EAAO8Q,YTv0BTrC,EACG3F,IAAI,SAAC8F,EAAQG,GACZ,IAAIoC,EAAcN,GAChBjC,EAAO5F,MAAM,CAAC,YAAa,UAC3B8H,GAEF,GAAMK,EAAa,KAAA+a,EACe/a,EAAxBH,EADSkb,EACTlb,KAAMC,EADGib,EACHjb,cACd,MAAO,CACLD,KAAM,CAACjC,EAAa,YAAa,SAAShL,OAAOiN,GACjDC,iBAQJ,GAJAE,EAAcN,GACZjC,EAAO3M,IAAI,eACX6O,GAEiB,KAAAqb,EACehb,EAAxBH,EADSmb,EACTnb,KAAMC,EADGkb,EACHlb,cACd,MAAO,CACLD,KAAM,CAACjC,EAAa,eAAehL,OAAOiN,GAC1CC,iBA2BJ,OAvBAE,EAAcvC,EACX3M,IAAI,qBACJ6G,IAAI,SAAC6N,EAAkByV,GACtB,IAAKzV,EAAiB1U,IAAI,SACxB,OAAO,KAGT,IAAMoqB,EAAmBxb,GACvB8F,EAAiB1U,IAAI,SACrB6O,GAEF,GAAMub,EAAkB,KACdrb,EAAwBqb,EAAxBrb,KAAMC,EAAkBob,EAAlBpb,cACd,MAAO,CACLD,KAAM,CAACjC,EAAa,oBAAqBqd,EAAuB,SAASroB,OAAOiN,GAChFC,iBAIJ,OAAO,OAERL,OAAO,SAAAQ,GAAM,QAAMA,IACnBf,UAKI,OAERO,OAAO,SAAAQ,GAAM,QAAMA,IACnBf,SSixBH,IAAKc,EACH,OAAOtB,EANsC,IASvCmB,EAASG,EAATH,KACFjC,EAAciC,EAAK,GAEzB,OAAOnB,EACJI,MAAM,CAAC,WAAWlM,OAAOiN,GAAOhR,EAAOic,cACvC7J,SAAS,CAAC,UAAWrD,GAAc,SAAAH,GAAM,OACxCA,EAAOkE,IAAI,iBAAkB5J,GAA0B0F,EAAO3M,IAAI,mBAEnEmQ,SAAS,CAAC,UAAWrD,GAAc,SAAAH,GAAM,OACxCA,EAAOqB,MACL,CAAC,YAAa,YACd/G,GAA0B0F,EAAO5F,MAAM,CAAC,YAAa,eC9vCvDsjB,GAAwB,SAACnN,EAAWxF,GAAZ,OAC5BwF,EAAUxQ,UAAU,SAAA0F,GAAQ,OAAIA,EAASpS,IAAI,QAAU0X,KAoEnD6D,GAAyB,SAAC3N,EAAO7P,GACrC,OAAKA,EAAO2E,YJ4FgC,SAACkL,EAAO+P,GACpD,IAAM2M,EAAmBtZ,kBAAOnS,KAAKoe,MAAMU,EAAO2M,mBAAmBzjB,IAAI,SAAAuL,GAAQ,OAC/EA,EAASvB,IAAI,KAAMC,QAGrB,OAAOlD,EAAMiD,IAAI,mBAAoByZ,GI7F9BC,CAA+B3c,EAAO7P,EAAO2E,aAH3CkL,GCtCI4c,eAAgB,CAC7BlqB,KJwCa,WAA+B,IAA9BsN,EAA8BnJ,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAtB,IAAI0G,OAAOpN,EAAW0G,UAAAC,OAAA,EAAAD,UAAA,QAAAE,EAC5C,OAAQ5G,EAAOC,MACb,IAAK,sBACH,OA9EoB,SAAC4P,EAAO7P,GAAR,OAAmB6P,EAAMiD,IAAI,iBAAkB9S,EAAOiB,gBA8EnED,CAAkB6O,EAAO7P,GAClC,IAAK,uBACH,OA9EqB,SAAC6P,EAAO7P,GAAR,OAAmB6P,EAAMiD,IAAI,iBAAkB,MA8E7D5R,CAAmB2O,GAC5B,IAAK,gBACH,OA9Ec,SAACA,EAAO7P,GAAR,OAAmB6P,EAAMiD,IAAI,WAAY9S,EAAOyC,aA8EvDD,CAAYqN,EAAO7P,GAC5B,IAAK,mBACH,OA9EiB,SAAC6P,EAAO7P,GAAR,OAAmB6P,EAAMiD,IAAI,cAAe9S,EAAO2C,gBA8E7DD,CAAemN,EAAO7P,GAC/B,IAAK,iCACH,OA9E4B,SAAC6P,EAAO7P,GAAR,OAChC6P,EAAMiD,IAAI,yBAA0B9S,EAAO6C,2BA6EhCD,CAA0BiN,EAAO7P,GAC1C,IAAK,yCACH,OA7EoC,SAAC6P,EAAO7P,GAAR,OACxC6P,EAAMiD,IAAI,iCAAkC9S,EAAO+C,mCA4ExCD,CAAkC+M,EAAO7P,GAClD,IAAK,0CACH,OA5EqC,SAAC6P,EAAO7P,GAAR,OACzC6P,EAAMiD,IAAI,kCAAmC9S,EAAOiD,oCA2EzCD,CAAmC6M,EAAO7P,GACnD,IAAK,4CACH,OA3EsC,SAAC6P,EAAO7P,GAAR,OAC1C6P,EAAMiD,IAAI,mCAAoC9S,EAAOuD,qCA0E1CD,CAAoCuM,EAAO7P,GACpD,IAAK,uBACH,OA1EoB,SAAC6P,EAAO7P,GAAR,OAAmB6P,EAAMiD,IAAI,iBAAkB9S,EAAOmD,gBA0EnED,CAAkB2M,EAAO7P,GAClC,IAAK,sCACH,OA1EkC,SAAC6P,EAAO7P,GAAR,OACtC6P,EAAMiD,IAAI,+BAAgC9S,EAAOqD,8BAyEtCD,CAAgCyM,EAAO7P,GAChD,IAAK,2BACH,OAzEwB,SAAC6P,EAAO7P,GAAR,OAC5B6P,EAAMiD,IAAI,qBAAsB9S,EAAOoE,uBAwE5BD,CAAsB0L,EAAO7P,GACtC,IAAK,iCACH,OAxE6B,SAAC6P,EAAO7P,GAAR,OACjC6P,EAAMiD,IAAI,0BAA2B9S,EAAOsE,4BAuEjCD,CAA2BwL,EAAO7P,GAC3C,IAAK,uBACH,OAvEoB,SAAC6P,EAAO7P,GAAR,OACxB6P,EACGiD,IAAI,iBAAkB9S,EAAO0B,gBAC7BoR,IAAI,qBAAsB9S,EAAO2B,oBAoEzBF,CAAkBoO,EAAO7P,GAClC,IAAK,wBACH,OApEsB,SAAC6P,EAAO7P,GAKlC,OAJK6P,EAAM5N,IAAI,uBACb4N,EAAQA,EAAMiD,IAAI,oBAAqB,IAAI1F,SAGtCyC,EAAMI,MAAM,CAAC,oBAAqBjQ,EAAOwE,gBAAiBxE,EAAOyE,YA+D7DF,CAAoBsL,EAAO7P,GACpC,IAAK,wBACH,OAAO0E,GAAoBmL,EAAO7P,GACpC,IAAK,kBACH,OAxDgB,SAAC6P,EAAO7P,GAAR,OACpB6P,EAAMyD,OAAO,iBAAkB,SAAAoZ,GAAK,OAChCA,EAAQA,EAAMnZ,KAAKvT,EAAO6E,WAAamO,gBAAK,CAAChT,EAAO6E,cAsD7CD,CAAciL,EAAO7P,GAC9B,IAAK,iBACH,OArDe,SAAA6P,GAAK,OACxBA,EAAMyD,OAAO,iBAAkB,SAAAoZ,GAAK,OAAOA,EAAQA,EAAMC,MAAQD,IAoDtD5nB,CAAa+K,GACtB,IAAK,oBACH,OApDkB,SAAAA,GAAK,OAAIA,EAAMiD,IAAI,iBAAkBE,mBAoDhDjO,CAAgB8K,GACzB,IAAK,iBACH,OApDgB,SAACA,EAAO7P,GAAR,OACpB6P,EAAMiD,IACJ,cACAG,kBAAO,CACLhT,KAAMD,EAAOiF,UACbC,KAAMlF,EAAOkF,QA+CNF,CAAc6K,EAAO7P,GAC9B,IAAK,cACH,OA7Ca,SAAA6P,GAAK,OAAIA,EAAMiD,IAAI,cAAe,MA6CxC3N,CAAW0K,GACpB,IAAK,iBACH,OA7Ce,SAACA,EAAO7P,GAAR,OAAmB6P,EAAMiD,IAAI,YAAa9S,EAAOoB,WA6CzDD,CAAa0O,EAAO7P,GAC7B,QACE,OAAO6P,IIpFXpM,YCnBa,WAA+B,IAA9BoM,EAA8BnJ,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAtB,IAAI0G,OAAOpN,EAAW0G,UAAAC,OAAA,EAAAD,UAAA,QAAAE,EAC5C,OAAQ5G,EAAOC,MACb,IAAK,WACH,OAtBU,SAAC4P,EAAO7P,GAAR,OAAmB6P,EAAMiD,IAAI,mBAAmB,GAAOA,IAAI,SAAU,MAsBxE8Z,CAAQ/c,GACjB,IAAK,6CACH,OAtBwC,SAACA,EAAO7P,GAAR,OAC5C6P,EAAMiD,IACJ,qCACA1F,eAAI,CACFyf,QAAS7sB,EAAO8sB,iBAChBC,QAAS/sB,EAAO+sB,QAChBC,2BAA4BhtB,EAAOgtB,8BAgB5BC,CAAsCpd,EAAO7P,GACtD,IAAK,wCACH,OAdmC,SAAC6P,EAAO7P,GAAR,OACvC6P,EACGyD,OAAO,qCAAsC,SAAA4Z,GAAkC,OAC5EA,GAA0E9f,mBAE7E6C,MAAM,CAAC,qCAAsC,iBAAkBjQ,EAAOmtB,eAS9DC,CAAiCvd,EAAO7P,GACjD,QACE,OAAO6P,IDWX9N,IAAKsrB,IF+vCQ,WAA+B,IAA9Bxd,EAA8BnJ,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAtB,IAAI0G,OAAOpN,EAAW0G,UAAAC,OAAA,EAAAD,UAAA,QAAAE,EAK5C,OAJI5G,EAAO0X,WACT7H,EAAQA,EAAMiD,IAAI,WAAW,IAGvB9S,EAAOC,MACb,IAAK,eACH,OAtwCc,SAAC4P,EAAO7P,GAC1B,IAAMstB,EAAajG,GAASrnB,EAAOuU,UAEnC,OAAO1E,EACJiD,IAAI,OAAQ9S,EAAOgR,MACnB8B,IAAI,WAAY9S,EAAOuU,UACvBzB,IAAI,UAAWwa,EAAWrrB,IAAI,YAC9B6Q,IAAI,kBAAmBwa,EAAWrrB,IAAI,oBACtC6Q,IAAI,kBAAmBwa,EAAWrrB,IAAI,oBACtC6Q,IAAI,sBAAuBwa,EAAWrrB,IAAI,wBA6vClCC,CAAY2N,EAAO7P,GAC5B,IAAK,uBACH,OA5vCqB,SAAA6P,GAAK,OAC9BA,EACGiD,IAAI,OAAQ,MACZA,IAAI,WAAY,MAChBA,IAAI,UAAW,MACfA,IAAI,kBAAmB,MACvBA,IAAI,kBAAmB,MACvBA,IAAI,sBAAuB,MAqvCnBxQ,CAAmBuN,GAC5B,IAAK,uBACH,OA9uCqB,SAACA,EAAO7P,GACjC,IAAMyO,EAAUoB,EAAM5N,IAAI,WAEpB8M,EAAcP,GAAoBC,EAASzO,EAAO0O,UAClD6e,EAAW1e,GAAaJ,EAASzO,EAAO0O,UAAUzM,IAAI,UAE5D,OAAIsrB,GAAY1d,EAAM5N,IAAI,qBAAuBjC,EAAO0O,SAC/CmB,GAGL0d,GACiBze,GAAyBL,EAASzO,EAAO0O,UACjDjO,QAAQ,SAAC0nB,EAAW5F,GAC7B1S,EAAQA,EAAMI,MAAM,CAAC,UAAWlB,EAAcwT,EAAQ,EAAG,WAAW,KAIjE1S,EAAMI,MAAM,CAAC,UAAWlB,EAAa,WAAYwe,IA6tC7CnW,CAAmBvH,EAAO7P,GACnC,IAAK,cACH,OAvvCa,SAAC6P,EAAO7P,GACzB,IAAMyO,EAAUoB,EAAM5N,IAAI,WACpB8M,EAAcP,GAAoBC,EAASzO,EAAO0O,UAExD,OAAOmB,EAAMI,MAAM,CAAC,UAAWlB,EAAa,WAAW,GAmvC5CoI,CAAWtH,EAAO7P,GAC3B,IAAK,gBACH,OA9tCe,SAAC6P,EAAO7P,GAC3B,OAAO6P,EAAMiD,IAAI,mBAAoB9S,EAAO0O,UA6tCjC2I,CAAaxH,EAAO7P,GAC7B,IAAK,yBACH,OA5tCsB,SAAC6P,EAAO7P,GAKlC,IAJA,IAAIyO,EAAUoB,EAAM5N,IAAI,WAChByM,EAAa1O,EAAb0O,SAEJiB,EAAiBN,GAAuBZ,EAASC,GAC5CiB,GAAgB,CACvB,IAAMK,EAAoBxB,GAAoBC,EAASkB,GACvDlB,EAAUA,EAAQwB,MAAM,CAACD,EAAmB,WAAW,GACvDL,EAAiBN,GAAuBZ,EAASkB,GAGnD,OAAOE,EAAMiD,IAAI,UAAWrE,GAitCjB+e,CAAoB3d,EAAO7P,GACpC,IAAK,qBACH,OAAOyX,GAAiB5H,EAAO7P,GACjC,IAAK,kBACH,OAtjCgB,SAAC6P,EAAO7P,GAAR,OAAmB6P,EAAMiD,IAAI,WAAY9S,EAAO4X,cAsjCzDD,CAAc9H,EAAO7P,GAC9B,IAAK,iBACH,OAtjCe,SAAC6P,EAAO7P,GAAR,OAAmB6P,EAAMiD,IAAI,WAAY,MAsjCjD+E,CAAahI,GACtB,IAAK,sBACH,OAtjCoB,SAACA,EAAO7P,GAChC,IAAMyO,EAAUoB,EAAM5N,IAAI,WACpB8M,EAAcP,GAAoBC,EAASzO,EAAO0O,UAElD+e,EAAelH,GAAevmB,EAAO+X,YAAalI,EAAM5N,IAAI,oBAIlE,OAFA4N,EAAQA,EAAMI,MAAM,CAAC,UAAWlB,EAAa,aAAc0e,GAEpDrF,GAAoCvY,EAAO7P,EAAO0O,UA8iC9CoJ,CAAkBjI,EAAO7P,GAClC,IAAK,4BACH,OA7iC0B,SAAC6P,EAAO7P,GACtC,IAAMyO,EAAUoB,EAAM5N,IAAI,WACpB8M,EAAcP,GAAoBC,EAASzO,EAAO0O,UAExD,OAAOmB,EAAMuC,SAAS,CAAC,UAAWrD,GAAc,SAAAH,GAAU,IAAA6b,EAEtDnF,GAA+BtlB,EAAOiY,mBADhC3B,EADgDmU,EAChDnU,cAAeI,EADiC+T,EACjC/T,kBAAmBoP,EADc2E,EACd3E,oBAG1C,OAAOlX,EACJkE,IAAI,iBAAkBgT,GACtBhT,IAAI,cAAeqR,GAAa2B,IAChChT,IAAI,gBAAiBwD,GACrBxD,IAAI,oBAAqB4D,KAiiCnBsB,CAAwBnI,EAAO7P,GACxC,IAAK,aACH,OA/hCY,SAAC6P,EAAO7P,GACxB,IAAMyO,EAAUoB,EAAM5N,IAAI,WACpB2M,EAASC,GAAaJ,EAASzO,EAAO0O,UACtCK,EAAcP,GAAoBC,EAASzO,EAAO0O,UAElD6R,EAAazR,GAAyBL,EAASzO,EAAO0O,UAEtD8b,EAAY5D,GAChB,GACAhY,EAAO3M,IAAI,gBACX4N,EAAM5N,IAAI,oBAOZ,OAJIjC,EAAO0O,WAAamB,EAAM5N,IAAI,qBAChC4N,EAAQA,EAAMiD,IAAI,kBAAmB,OAGhCjD,EAAMyD,OAAO,UAAW,SAAA7E,GAAO,OACpCA,EAAQoE,OAAO9D,EAAcwR,EAAWjW,KAAO,EAAGkgB,KA6gCzCtS,CAAUrI,EAAO7P,GAC1B,IAAK,6BACH,OA3gC0B,SAAC6P,EAAO7P,GACtC,IAAMyO,EAAUoB,EAAM5N,IAAI,WACpB2M,EAASC,GAAaJ,EAASzO,EAAO0O,UACtCK,EAAcP,GAAoBC,EAASzO,EAAO0O,UAClD6R,EAAazR,GAAyBL,EAASzO,EAAO0O,UAEtDgf,EAAcjf,EAAQxM,IAAI8M,EAAcwR,EAAWjW,KAAO,GAEhE,OAAKojB,GAAeA,EAAYzrB,IAAI,kBAAoB2M,EAAO3M,IAAI,gBAI5D4N,EAAMiD,IAAI,mBAAoB4a,EAAYzrB,IAAI,OAH5C4N,EAkgCEsI,CAAwBtI,EAAO7P,GACxC,IAAK,6BACH,OAAOqY,GAAwBxI,GACjC,IAAK,iCACH,OAAOyI,GAA4BzI,GACrC,IAAK,gBACH,OAn+Be,SAACA,EAAO7P,GAC3B,IAAIyO,EAAUoB,EAAM5N,IAAI,WAClB8M,EAAcP,GAAoBC,EAASzO,EAAO0O,UAGlDif,EAAqB,EADR7e,GAAyBL,EAASzO,EAAO0O,UAClBpE,KAEpCqF,EAAiBN,GAAuBZ,EAASzO,EAAO0O,UAgB9D,OAdAvE,IAAEK,MAAMmjB,GAAoBltB,QAAQ,WAClCgO,EAAUA,EAAQmd,OAAO7c,KAGvB/O,EAAO0O,WAAamB,EAAM5N,IAAI,qBAChC4N,EAAQA,EAAMiD,IAAI,kBAAmB,OAGvCjD,EAAQA,EAAMiD,IAAI,UAAWrE,GAEzBkB,IACFE,EAAQoY,GAA4BpY,EAAOF,IAGtCE,EA48BI0I,CAAa1I,EAAO7P,GAC7B,IAAK,iBACH,OA38Be,SAAC6P,EAAO7P,GAC3B,IAAIyO,EAAUoB,EAAM5N,IAAI,WAClB8M,EAAcP,GAAoBC,EAASzO,EAAO0O,UAElDkf,ETtU8B,SAACnf,EAASM,GAG9C,IAFA,IAAMiH,EAAevH,EAAQzF,MAAM,CAAC+F,EAAa,iBAExCe,EAAIf,EAAc,EAAGe,GAAK,IAAKA,EAAG,CACzC,IAAMlB,EAASH,EAAQxM,IAAI6N,GAE3B,GAAIlB,EAAO3M,IAAI,gBAAkB+T,EAC/B,OAAO,KAGT,GAAIpH,EAAO3M,IAAI,kBAAoB+T,EACjC,OAAOlG,EAIX,OAAO,KSuTsB+d,CAAuBpf,EAASM,GAC7D,GAA6B,OAAzB6e,EACF,OAAO/d,EAGT,IAAM0Q,EAAazR,GAAyBL,EAASzO,EAAO0O,UAM5D,OALAvE,IAAEK,MAAM,EAAI+V,EAAWjW,MAAM7J,QAAQ,WAEnCgO,GADAA,EAAUA,EAAQoE,OAAO+a,EAAsBnf,EAAQxM,IAAI8M,EAAcwR,EAAWjW,QAClEshB,OAAO7c,EAAcwR,EAAWjW,KAAO,KAGpDuF,EAAMiD,IAAI,UAAWrE,GA47BjB+J,CAAa3I,EAAO7P,GAC7B,IAAK,mBACH,OA37BiB,SAAC6P,EAAO7P,GAC7B,IAAIyO,EAAUoB,EAAM5N,IAAI,WAClB2M,EAASC,GAAaJ,EAASzO,EAAO0O,UACtCK,EAAcP,GAAoBC,EAASzO,EAAO0O,UAElD6R,EAAazR,GAAyBL,EAASzO,EAAO0O,UACtDof,EAAmB/e,EAAcwR,EAAWjW,KAAO,EACnDojB,EAAcjf,EAAQxM,IAAI6rB,GAChC,GAAIJ,EAAYzrB,IAAI,gBAAkB2M,EAAO3M,IAAI,gBAC/C,OAAO4N,EAGT,IAAMke,EAAwBjf,GAAyBL,EAASif,EAAYzrB,IAAI,OAShF,OARAkI,IAAEK,MAAM,EAAIujB,EAAsBzjB,MAAM7J,QAAQ,WAK9CgO,GAJAA,EAAUA,EAAQoE,OAChB9D,EACAN,EAAQxM,IAAI6rB,EAAmBC,EAAsBzjB,QAErCshB,OAAOkC,EAAmBC,EAAsBzjB,KAAO,KAGpEuF,EAAMiD,IAAI,UAAWrE,GAs6BjBgK,CAAe5I,EAAO7P,GAC/B,IAAK,mBACH,OAr6BiB,SAAC6P,EAAO7P,GAC7B,IAAMyO,EAAUoB,EAAM5N,IAAI,WACpB8M,EAAcP,GAAoBC,EAASzO,EAAO0O,UAElDsf,EAAyB3e,GAAuBZ,EAASzO,EAAO0O,UAStE,OAPAmB,EAAQA,EAAMuC,SAAS,CAAC,UAAWrD,EAAa,gBAAiB,SAAAiH,GAAY,OAC3ElM,KAAKC,IAAIiM,EAAe,EAAG,KAG7BnG,EAAQoY,GAA4BpY,EAAOme,GAC3Cne,EAAQuY,GAAoCvY,EAAO7P,EAAO0O,UA05B/CgK,CAAe7I,EAAO7P,GAC/B,IAAK,oBACH,OAv5BkB,SAAC6P,EAAO7P,GAC9B,IAAMyO,EAAUoB,EAAM5N,IAAI,WACpB8M,EAAcP,GAAoBC,EAASzO,EAAO0O,UAElDsf,EAAyB3e,GAAuBZ,EAASzO,EAAO0O,UAWtE,OATAmB,EAAQA,EAAMuC,SACZ,CAAC,UAAWrD,EAAa,gBACzB,SAAAiH,GAAY,OAAIA,EAAe,IAGjCnG,EAAQD,GAAiBC,EAAO7P,EAAO0O,UACvCmB,EAAQoY,GAA4BpY,EAAOme,GAC3Cne,EAAQuY,GAAoCvY,EAAO7P,EAAO0O,UA04B/CiK,CAAgB9I,EAAO7P,GAChC,IAAK,oBACH,OAv4BkB,SAAC6P,EAAO7P,GAC9B,IAAMyO,EAAUoB,EAAM5N,IAAI,WACpB2M,EAASC,GAAaJ,EAASzO,EAAO0O,UACtCK,EAAcP,GAAoBC,EAASzO,EAAO0O,UAElDsf,EAAyB3e,GAAuBZ,EAASzO,EAAO0O,UAEtE,GAAmC,IAA/BE,EAAO3M,IAAI,gBACb,OAAO4N,EAGT,IAAM0Q,EAAazR,GAAyBL,EAASzO,EAAO0O,UAiB5D,OAfAmB,EAAQA,EAAMuC,SACZ,CAAC,UAAWrD,EAAa,gBACzB,SAAAiH,GAAY,OAAIA,EAAe,IAGjCuK,EAAW9f,QAAQ,SAAC0J,EAAGoY,GACrB1S,EAAQA,EAAMuC,SACZ,CAAC,UAAWrD,EAAcwT,EAAQ,EAAG,gBACrC,SAAAvM,GAAY,OAAIA,EAAe,MAInCnG,EAAQoY,GAA4BpY,EAAOme,GAC3Cne,EAAQuY,GAAoCvY,EAAO7P,EAAO0O,UA62B/CkK,CAAgB/I,EAAO7P,GAChC,IAAK,qBACH,OA12BmB,SAAC6P,EAAO7P,GAC/B,IAAMyO,EAAUoB,EAAM5N,IAAI,WACpB8M,EAAcP,GAAoBC,EAASzO,EAAO0O,UAElDsf,EAAyB3e,GAAuBZ,EAASzO,EAAO0O,UAEhE6R,EAAazR,GAAyBL,EAASzO,EAAO0O,UAgB5D,OAdAmB,EAAQA,EAAMuC,SACZ,CAAC,UAAWrD,EAAa,gBACzB,SAAAiH,GAAY,OAAIA,EAAe,IAEjCuK,EAAW9f,QAAQ,SAAC0J,EAAGoY,GACrB1S,EAAQA,EAAMuC,SACZ,CAAC,UAAWrD,EAAcwT,EAAQ,EAAG,gBACrC,SAAAvM,GAAY,OAAIA,EAAe,MAInCnG,EAAQoY,GAA4BpY,EAAOme,GAC3Cne,EAAQuY,GAAoCvY,EAAO7P,EAAO0O,UAEnDkB,GAAiBC,EAAO7P,EAAO0O,UAo1B3BmK,CAAiBhJ,EAAO7P,GACjC,IAAK,QACH,OA70BO,SAAA6P,GAAK,OAAIA,EAAMyD,OAAO,cAAe,SAAA2a,GAAO,OAAKA,GAAW,GAAK,IA60BjElV,CAAKlJ,GACd,IAAK,uBACH,OAAOqH,GAAmBrH,GAC5B,IAAK,YACH,OAtyBW,SAACA,EAAO7P,GAAR,OAAmB6P,EAAMiD,IAAI,UAAW9S,EAAOwV,SAsyBnDuB,CAASlH,EAAO7P,GACzB,IAAK,eACH,OAz1Bc,SAAC6P,EAAO7P,GAC1B,OAAO6P,EAAMiD,IAAI,kBAAmB9S,EAAO0O,UAw1BhCoK,CAAYjJ,EAAO7P,GAC5B,IAAK,iBACH,OAv1BgB,SAAA6P,GAAK,OAAIA,EAAMiD,IAAI,kBAAmB,MAu1B/C8B,CAAc/E,GACvB,IAAK,6BACH,OA1yByB,SAACA,EAAO7P,GAAR,OAAmB6P,EAAMiD,IAAI,sBAAuB9S,EAAOwQ,QA0yB7E8G,CAAuBzH,EAAO7P,GACvC,IAAK,oBACH,OAAOgZ,GAAenJ,GACxB,IAAK,mBACH,OA/wBiB,SAACA,EAAO7P,GAC7B,IAAMkqB,EAAsBra,EAAM5N,IAAI,uBACtC,IAAKioB,EACH,OAAOra,EAGT,IAAM6b,EAAmBhb,GAA8Bb,EAAM5N,IAAI,WAAYioB,GAY7E,OAFAra,GARAA,EAAQA,EAAMyD,OAAO,UAAW,SAAA7E,GAAO,OACrCsD,GACEtD,EACAyb,EACA,SAAAjf,GAAQ,OAAI,SAAAkf,GAAI,OAAIA,EAAKyB,OAAO3gB,SAItB6H,IAAI,sBAAuB,MAElCmX,GAA6Cpa,EAAOqa,EAAqBwB,GA6vBrEzS,CAAepJ,GACxB,IAAK,uBACH,OAAOqJ,GAAkBrJ,GAC3B,IAAK,sBACH,OA1uBoB,SAACA,EAAO7P,GAChC,IAAMkqB,EAAsBra,EAAM5N,IAAI,uBACtC,IAAKioB,EACH,OAAOra,EAGT,IAAM6b,EAAmBhb,GAA8Bb,EAAM5N,IAAI,WAAYioB,GAa7E,OAFAra,GATAA,EAAQA,EAAMyD,OAAO,UAAW,SAAA7E,GAAO,OACrCsD,GACEtD,EACAyb,EACA,SAACG,EAAWC,GAAZ,OAAyB,SAAAH,GAAI,OAC3BA,EAAKrhB,IAAI,SAAAe,GAAG,OAAIA,EAAIyJ,OAAO,WAAY,SAAAiB,GAAQ,OAAIA,EAASqX,OAAOtB,aAI3DxX,IAAI,sBAAuB,MAElCmX,GAA6Cpa,EAAOqa,EAAqBwB,GAutBrEvS,CAAkBtJ,GAC3B,IAAK,sBACH,OAttBmB,SAAAA,GACvB,IAAMqa,EAAsBra,EAAM5N,IAAI,uBACtC,OAAKioB,GAILra,EAAQA,EAAMyD,OAAO,UAAW,SAAA7E,GAAO,OACrCsD,GACEtD,EACAyb,EACA,SAAAjf,GAAQ,OAAI,SAAAkf,GAAI,OACdlf,EAAW,IAAMkf,EAAK7f,KAClB6f,EACAA,EAAKtX,OAAO5H,EAAUkf,EAAKloB,IAAIgJ,EAAW,IAAI2gB,OAAO3gB,EAAW,QAInEgf,GAA6Cpa,EAAOqa,IAdlDra,EAmtBEuJ,CAAiBvJ,GAC1B,IAAK,oBACH,OApsBiB,SAACA,EAAO7P,GAC7B,IAAMkqB,EAAsBra,EAAM5N,IAAI,uBACtC,OAAKioB,GAILra,EAAQA,EAAMyD,OAAO,UAAW,SAAA7E,GAAO,OACrCsD,GACEtD,EACAyb,EACA,SAAAjf,GAAQ,OAAI,SAAAkf,GAAI,OACD,IAAblf,EAAiBkf,EAAOA,EAAKtX,OAAO5H,EAAW,EAAGkf,EAAKloB,IAAIgJ,IAAW2gB,OAAO3gB,EAAW,QAIvFgf,GAA6Cpa,EAAOqa,IAZlDra,EAisBEwJ,CAAexJ,GACxB,IAAK,yBACH,OAprBsB,SAACA,EAAO7P,GAClC,IAAMkqB,EAAsBra,EAAM5N,IAAI,uBACtC,OAAKioB,GAILra,EAAQA,EAAMyD,OAAO,UAAW,SAAA7E,GAAO,OACrCsD,GACEtD,EACAyb,EACA,SAACG,EAAW5f,GAAZ,OAA4B,SAAA0f,GAAI,OACd,IAAhB1f,EACI0f,EACAA,EAAKrhB,IAAI,SAAAe,GAAG,OACVA,EAAIyJ,OAAO,WAAY,SAAAiB,GAAQ,OACX,IAAlBA,EAASjK,KACLiK,EACAA,EACG1B,OAAOpI,EAAc,EAAG8J,EAAStS,IAAIwI,IACrCmhB,OAAOnhB,EAAc,YAMnCwf,GAA6Cpa,EAAOqa,IAtBlDra,EAirBEyJ,CAAoBzJ,GAC7B,IAAK,0BACH,OA1pBuB,SAACA,EAAO7P,GACnC,IAAMkqB,EAAsBra,EAAM5N,IAAI,uBACtC,OAAKioB,GAILra,EAAQA,EAAMyD,OAAO,UAAW,SAAA7E,GAAO,OACrCsD,GACEtD,EACAyb,EACA,SAACG,EAAW5f,GAAZ,OAA4B,SAAA0f,GAAI,OAC9B1f,EAAc,GAAK0f,EAAKnhB,MAAM,CAAC,EAAG,aAAasB,KAC3C6f,EACAA,EAAKrhB,IAAI,SAAAe,GAAG,OACVA,EAAIyJ,OAAO,WAAY,SAAAiB,GAAQ,OACX,IAAlBA,EAASjK,KACLiK,EACAA,EACG1B,OAAOpI,EAAa8J,EAAStS,IAAIwI,EAAc,IAC/CmhB,OAAOnhB,EAAc,YAMnCwf,GAA6Cpa,EAAOqa,IAtBlDra,EAupBE0J,CAAqB1J,GAC9B,IAAK,0BACH,OAhoBuB,SAACA,EAAO7P,GAiBnC,OAhBA6P,EAAQA,EAAMyD,OAAO,UAAW,SAAA7E,GAAO,OACrCsD,GACEtD,EACAzO,EAAOwQ,OACP,SAACvF,EAAUqf,GAAX,OAAwB,SAAAH,GAAI,OAC1BA,EAAK/X,SAAS,CAACnH,EAAU,WAAYqf,GAAW,SAAApgB,GAAI,OAClDA,EACG4I,IAAI,cAAe9S,EAAOyZ,UAC1B3G,IACC,WACAG,kBAAO6O,GAAsB9hB,EAAOyZ,SAAU,CAAE2I,gBAAgB,aAMrE6H,GAA6Cpa,EAAO7P,EAAOwQ,QA+mBvDgJ,CAAqB3J,EAAO7P,GACrC,IAAK,iBACH,OAAO0Z,GAAc7J,EAAO7P,GAC9B,IAAK,wBACH,OA/kBsB,SAAA6P,GAAK,OAAIA,EAAMiD,IAAI,iBAAkB,MA+kBpDgH,CAAoBjK,GAC7B,IAAK,yBACH,OAAOiL,GAAqBjL,EAAO7P,GACrC,IAAK,4BACH,OAhgBwB,SAAC6P,EAAO7P,GAAR,OAAmB6P,EAAMiD,IAAI,qBAAsB9S,EAAO0R,YAggB3E6F,CAAsB1H,EAAO7P,GACtC,IAAK,0BACH,OA7euB,SAAC6P,EAAO7P,GACnC,IAAMwrB,EAAqBxrB,EAAO0R,WAClC,OAAK8Z,GAIL3b,EAAQA,EAAMyD,OAAO,UAAW,SAAA7E,GAAO,OACrC4D,GACE5D,EACA+c,EACA,SAAAta,GAAS,OAAI,SAAAiC,GAAK,OAChBA,EAAMf,SAAS,CAAClB,GAAY,SAAAnF,GAAI,OAC9BA,EAAK+G,IAAI,YAAaG,kBAAO6O,GAAsB9hB,EAAOyZ,mBAK3D8R,GAA4C1b,EAAO2b,IAdjD3b,EA0eEkL,CAAqBlL,EAAO7P,GACrC,IAAK,6BACH,OA3d0B,SAAC6P,EAAO7P,GACtC,IAAMwrB,EAAqBxrB,EAAO0R,WAClC,OAAK8Z,GAIL3b,EAAQA,EAAMyD,OAAO,UAAW,SAAA7E,GAAO,OACrC4D,GACE5D,EACA+c,EACA,SAAAta,GAAS,OAAI,SAAAiC,GAAK,OAChBA,EAAMf,SAAS,CAAClB,GAAY,SAAAnF,GAAI,OAC9BA,EAAK+G,IAAI,WAAYG,kBAAOkR,GAAankB,EAAOyZ,mBAKjD8R,GAA4C1b,EAAO2b,IAdjD3b,EAwdEmL,CAAwBnL,EAAO7P,GACxC,IAAK,oBACH,OAAOib,GAAepL,GACxB,IAAK,gCACH,OAjb4B,SAACA,EAAO7P,GACxC,IAAMwrB,EAAqB3b,EAAM5N,IAAI,sBACrC,IAAKupB,EACH,OAAO3b,EAGT,IAIMmB,EAJcS,GAClB5B,EAAM5N,IAAI,WACVupB,GAEIxa,KAKN,OAJAA,EAAKA,EAAKrK,OAAS,GAAKqK,EAAKA,EAAKrK,OAAS,GAAK,EAEhDkJ,EAAQA,EAAMiD,IAAI,qBAAsBjD,EAAM7G,MAAM,CAAC,WAAWjF,OAAOiN,GAAMjN,OAAO,QAoazEmX,CAA0BrL,GACnC,IAAK,mBACH,OAAOuL,GAAevL,GACxB,IAAK,oBACH,OA9YiB,SAAAA,GACrB,IAAM2b,EAAqB3b,EAAM5N,IAAI,sBACrC,OAAKupB,GAIL3b,EAAQA,EAAMyD,OAAO,UAAW,SAAA7E,GAAO,OACrC4D,GACE5D,EACA+c,EACA,SAAAta,GAAS,OAAI,SAAAiC,GAAK,OACF,IAAdjC,EACIiC,EACAA,EAAMN,OAAO3B,EAAY,EAAGiC,EAAMlR,IAAIiP,IAAY0a,OAAO1a,EAAY,QAIxEqa,GAA4C1b,EAAO2b,IAdjD3b,EA2YEwL,CAAexL,GACxB,IAAK,sBACH,OA5XmB,SAAAA,GACvB,IAAM2b,EAAqB3b,EAAM5N,IAAI,sBACrC,OAAKupB,GAIL3b,EAAQA,EAAMyD,OAAO,UAAW,SAAA7E,GAAO,OACrC4D,GACE5D,EACA+c,EACA,SAAAta,GAAS,OAAI,SAAAiC,GAAK,OAChBjC,EAAY,IAAMiC,EAAM7I,KACpB6I,EACAA,EAAMN,OAAO3B,EAAWiC,EAAMlR,IAAIiP,EAAY,IAAI0a,OAAO1a,EAAY,QAIxEqa,GAA4C1b,EAAO2b,IAdjD3b,EAyXEyL,CAAiBzL,GAC1B,IAAK,sBACH,OA1WmB,SAAAA,GACvB,IAAM2b,EAAqB3b,EAAM5N,IAAI,sBACrC,OAAKupB,EAIe/Z,GAClB5B,EAAM5N,IAAI,WACVupB,GAGkC5Z,aACjC3P,IAAI,YACJ2O,OAAO,SAAA7H,GAAI,MAAyB,SAArBA,EAAK9G,IAAI,UACxBwO,KAAK,SAAA7E,GAAQ,OAAIA,EAAS3J,IAAI,SAASqI,KAAO,IAExCuF,EAEF4L,GAAoB5L,GAflBA,EAuWE0L,CAAiB1L,GAC1B,IAAK,uBACH,OAvVoB,SAAAA,GACxB,IAAM2b,EAAqB3b,EAAM5N,IAAI,sBACrC,IAAKupB,EACH,OAAO3b,EAGT,IAAMsB,EAAcM,GAClB5B,EAAM5N,IAAI,WACVupB,GAEIxa,EAAyCG,EAAzCH,KAAoB6a,EAAqB1a,EAAnCS,aACNhG,EAAWiE,EAAM7G,MAAM,CAAC,WAAWjF,OAAOiN,EAAK/B,MAAM,EAAG+B,EAAKrK,OAAS,KACtEunB,EAAuBld,EAAKA,EAAKrK,OAAS,GAAK,EAErD,GAAIunB,EAAuB,EACzB,OAAOre,EAGTA,EAAQA,EAAMyD,OAAO,UAAW,SAAA7E,GAAO,OACrC4D,GACE5D,EACA+c,EACA,SAAAta,GAAS,OAAI,SAAAiC,GAAK,OAAIA,EAAMyY,OAAO1a,QAIvC,IAAMid,EAA8B,CAAC,WAClCpqB,OAAOiN,EAAK/B,MAAM,EAAG+B,EAAKrK,OAAS,IACnC5C,OAAOmqB,GACPnqB,OAAO,YAEJqqB,EAAoBvC,EACvB5pB,IAAI,YACJ2O,OAAO,SAAA7H,GAAI,MAAyB,SAArBA,EAAK9G,IAAI,UAkB3B,OAhBA4pB,EAAmBA,EAAiBvY,OAAO,WAAY,SAAAiB,GAAQ,OAC7DA,EAAS3D,OAAO,SAAA7H,GAAI,MAAyB,SAArBA,EAAK9G,IAAI,YAGnC4N,EAAQA,EAAMuC,SAAS+b,EAA6B,SAAA5Z,GAAQ,OAC1D9B,GAAmC8B,EAAUsX,EAAkBjgB,KAGjEwiB,EAAkBtlB,IAAI,SAAA8C,GAAQ,OAC5BA,EAAS3J,IAAI,SAASxB,QAAQ,SAACsL,EAAMmF,GACnCrB,EAAQA,EAAMuC,SAAS+b,EAA6B,SAAA5Z,GAAQ,OAC1D9B,GAAmC8B,EAAUxI,EAAMH,SAKlD2f,GAA4C1b,EAAO2b,GAoS/ChQ,CAAkB3L,GAC3B,IAAK,yBACH,OAAO4L,GAAoB5L,EAAO7P,GACpC,IAAK,0BACH,OAhPuB,SAAA6P,GAC3B,IAAM2b,EAAqB3b,EAAM5N,IAAI,sBACrC,IAAKupB,EACH,OAAO3b,EAGT,IAAMsB,EAAcM,GAClB5B,EAAM5N,IAAI,WACVupB,GAEMxa,EAAyCG,EAAzCH,KAAoB6a,EAAqB1a,EAAnCS,aACRhG,EAAWiE,EAAM7G,MAAM,CAAC,WAAWjF,OAAOiN,EAAK/B,MAAM,EAAG+B,EAAKrK,OAAS,KACtEunB,EAAuBld,EAAKA,EAAKrK,OAAS,GAAK,EACrD,OAAIunB,EAAuB,EAClBre,GAWTA,GARAA,EAAQA,EAAMyD,OAAO,UAAW,SAAA7E,GAAO,OACrC4D,GACE5D,EACA+c,EACA,SAAAta,GAAS,OAAI,SAAAiC,GAAK,OAAkB,IAAdjC,EAAkBiC,EAAQA,EAAMyY,OAAO1a,SAInDkB,SACZ,CAAC,WACErO,OAAOiN,EAAK/B,MAAM,EAAG+B,EAAKrK,OAAS,IACnC5C,OAAOmqB,GACPnqB,OAAO,YACV,SAAAwQ,GAAQ,OAAI9B,GAAmC8B,EAAUsX,EAAkBjgB,KAGtE2f,GAA4C1b,EAAO2b,IA+M/C9P,CAAqB7L,GAC9B,IAAK,mBACH,OA9MgB,SAACA,EAAO7P,GAAR,OAAmB6P,EAAMiD,IAAI,aAAc9S,EAAOyU,YA8M3DD,CAAc3E,EAAO7P,GAC9B,IAAK,kBACH,OA9MgB,SAAC6P,EAAO7P,GAC5B,IAAMyO,EAAUoB,EAAM5N,IAAI,WACpB8M,EAAcP,GAAoBC,EAASzO,EAAO0O,UACxD,OAAqB,IAAjBK,EACKc,EAGFA,EAAMI,MAAM,CAAC,UAAWlB,EAAa,YAAa,QAAS/O,EAAOoW,MAuM9DuF,CAAc9L,EAAO7P,GAC9B,IAAK,eACH,OAtMc,SAAC6P,EAAO7P,GAC1B,IAAMquB,EAAmBxe,EAAM5N,IAAI,oBACnC,IAAKosB,EACH,OAAOxe,EAET,IAAMd,EAAcP,GAAoBqB,EAAM5N,IAAI,WAAYosB,GAE9D,OAAOxe,EAAMuC,SAAS,CAAC,UAAWrD,EAAa,YAAa,QAAS,SAAAqH,GAAI,OACvEA,EAAKkY,OAAOtuB,EAAO6b,UAAW,GAAGyS,OAAOtuB,EAAO8b,QAAS,EAAG1F,EAAKnU,IAAIjC,EAAO6b,cA8LlED,CAAY/L,EAAO7P,GAC5B,IAAK,wBACH,OA5LsB,SAAC6P,EAAO7P,GAClC,IAAM0O,EAAW1O,EAAO0O,SACxB,IAAKA,EACH,OAAOmB,EAET,IAAMd,EAAcP,GAAoBqB,EAAM5N,IAAI,WAAYyM,GAE9D,OAAOmB,EAAMuC,SAAS,CAAC,UAAWrD,EAAa,qBAAsB,SAAA2H,GAAiB,OACpFA,EACG4X,OAAOtuB,EAAO6b,UAAW,GACzByS,OAAOtuB,EAAO8b,QAAS,EAAGpF,EAAkBzU,IAAIjC,EAAO6b,cAkLjDE,CAAoBlM,EAAO7P,GACpC,IAAK,2BACH,OAAOgc,GAAsBnM,EAAO7P,GACtC,IAAK,iCACH,OAzJ8B,SAAC6P,EAAO7P,GAAW,IAC7C0O,EAA8C1O,EAA9C0O,SAAUyN,EAAoCnc,EAApCmc,kBAAmBF,EAAiBjc,EAAjBic,aAC/BlN,EAAcP,GAAoBqB,EAAM5N,IAAI,WAAYyM,GAE9D,OAAOmB,EAAMI,MACX,CAAC,UAAWlB,EAAa,gBAAiBoN,EAAmB,aAC7DF,GAmJSC,CAA4BrM,EAAO7P,GAC5C,IAAK,wBACH,OAjJqB,SAAC6P,EAAO7P,GACjC,IAAM+O,EAAcP,GAAoBqB,EAAM5N,IAAI,WAAYjC,EAAO0O,UAE/D6f,EAAkBtb,kBAAO,CAC7BC,GAAIH,KACJ9S,KAAMD,EAAOqc,aACbhX,UAAWmB,OAGb,OAAOqJ,EAAMuC,SAAS,CAAC,UAAWrD,EAAa,iBAAkB,SAAAuH,GAAa,OAC1EA,EAAgBA,EAAc/C,KAAKgb,GAAmBvb,gBAAK,CAACub,MAuIrDnS,CAAmBvM,EAAO7P,GACnC,IAAK,6BACH,OArIiC,SAAC6P,EAAO7P,GAC7C,IAAM+O,EAAcP,GAAoBqB,EAAM5N,IAAI,WAAYjC,EAAO0O,UAErE,OAAOmB,EAAMI,MAAM,CAAC,UAAWlB,EAAa,qBAAsB/O,EAAOuc,sBAkI9DD,CAAwBzM,EAAO7P,GACxC,IAAK,6BACH,OAjIyB,SAAC6P,EAAO7P,GAAR,OAAmB6P,EAAMiD,IAAI,sBAAuB9S,EAAOwc,SAiI7EpH,CAAuBvF,EAAO7P,GACvC,QACE,OAAO6P,IEh4Ce,CACxBe,OAAQ4d,wBAlCa,CACvB,aACA,gBACA,iBACA,mBACA,mBACA,oBACA,oBACA,qBACA,qBACA,oBACA,0BACA,QACA,oBACA,uBACA,sBACA,oBACA,yBACA,0BACA,oBACA,mBACA,oBACA,sBACA,sBACA,uBACA,yBACA,0BACA,mBAQEC,kBAAkB,IAEpB7U,QD0Ca,WAA+B,IAA9B/J,EAA8BnJ,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAtB,IAAI0G,OAAOpN,EAAW0G,UAAAC,OAAA,EAAAD,UAAA,QAAAE,EAC5C,OAAQ5G,EAAOC,MACb,IAAK,iCACH,OAlF6B,SAAA4P,GAKjC,OAJKA,EAAM5N,IAAI,sBACb4N,EAAQA,EAAMiD,IAAI,mBAAoB,IAAIE,UAGrCnD,EAAMyD,OAAO,mBAAoB,SAAA6L,GAAS,OAC/CA,EAAU5L,KACRN,kBAAO,CACLC,GAAIH,KACJe,YAAa,GACbI,OAAQ,GACRF,SAAU,GACVC,0BAA0B,EAC1BE,uBAAwB,CAAC,IACzBJ,YAAa,CAAC,IACdK,eAAe,EACfC,SAAU,QAkELyI,CAA2BjN,GACpC,IAAK,mCACH,OA9D+B,SAACA,EAAO7P,GAC3C,IAAM0uB,EAAgBpC,GAAsBzc,EAAM5N,IAAI,oBAAqBjC,EAAO2Z,YAElF,OAAO9J,EAAMI,MAAM,CAAC,mBAAoBye,GAAe3qB,OAAO/D,EAAOgd,WAAYhd,EAAOyZ,UA2D7EsD,CAA6BlN,EAAO7P,GAC7C,IAAK,yCACH,OA1DoC,SAAC6P,EAAO7P,GAChD,IAAM0uB,EAAgBpC,GAAsBzc,EAAM5N,IAAI,oBAAqBjC,EAAO2Z,YAElF,OAAO9J,EAAMuC,SAAS,CAAC,mBAAoBsc,EAAe,0BAA2B,SAAAC,GAAQ,OAC3FA,EAASpb,KAAK,MAsDL0J,CAAkCpN,EAAO7P,GAClD,IAAK,wCACH,OApDoC,SAAC6P,EAAO7P,GAChD,IAAM0uB,EAAgBpC,GAAsBzc,EAAM5N,IAAI,oBAAqBjC,EAAO2Z,YAElF,OAAO9J,EAAMuC,SAAS,CAAC,mBAAoBsc,EAAe,0BAA2B,SAAAC,GAAQ,OAC3FA,EAAS/C,OAAO5rB,EAAOmd,4BAgDdD,CAAkCrN,EAAO7P,GAClD,IAAK,+BACH,OA9C2B,SAAC6P,EAAO7P,GACvC,IAAM0uB,EAAgBpC,GAAsBzc,EAAM5N,IAAI,oBAAqBjC,EAAO2Z,YAElF,OAAO9J,EAAMuC,SAAS,CAAC,mBAAoBsc,EAAe,eAAgB,SAAA3a,GAAW,OACnFA,EAAYR,KAAK,MA0CR6J,CAAyBvN,EAAO7P,GACzC,IAAK,8BACH,OAxC2B,SAAC6P,EAAO7P,GACvC,IAAM0uB,EAAgBpC,GAAsBzc,EAAM5N,IAAI,oBAAqBjC,EAAO2Z,YAElF,OAAO9J,EAAMuC,SAAS,CAAC,mBAAoBsc,EAAe,eAAgB,SAAA3a,GAAW,OACnFA,EAAY6X,OAAO5rB,EAAOsd,mBAoCjBD,CAAyBxN,EAAO7P,GACzC,IAAK,kBACH,OAlCiB,SAAC6P,EAAO7P,GAC7B,IAAM0uB,EAAgBpC,GAAsBzc,EAAM5N,IAAI,oBAAqBjC,EAAO2Z,YAElF,OAAO9J,EAAMyD,OAAO,mBAAoB,SAAA6L,GAAS,OAAIA,EAAUyM,OAAO8C,KA+B3DnR,CAAe1N,EAAO7P,GAC/B,IAAK,2BACH,OAAOwd,GAAuB3N,EAAO7P,GACvC,IAAK,2BACH,OAxByB,SAAC6P,EAAO7P,GAAR,OAC7B6P,EAAMyD,OAAO,mBAAoB,SAAA6L,GAAS,OACxCA,EAAUmP,OAAOtuB,EAAO6b,UAAW,GAAGyS,OAAOtuB,EAAO8b,QAAS,EAAGqD,EAAUld,IAAIjC,EAAO6b,cAsB5E4B,CAAuB5N,EAAO7P,GACvC,QACE,OAAO6P,MGrGP+e,GAAmB3qB,OAAO4qB,sCAAwCC,IAEzDC,GAAA,SAAAhQ,GAAY,OACzBiQ,YACEC,GACAlQ,EACA6P,GAAiBM,YAAgBC,IAAOC,EAAuBC,GAAUC,OCV9DC,GAAA,YCDA,WACb,GAAK7R,GAAL,CAIA,IAAM8R,EAAc7R,aAAaE,QAAQ,eACpC2R,IAIL7R,aAAaC,QAAQ,qBAAsB4R,GAC3C7R,aAAa8R,WAAW,iBDTxBC,GEFa,WACb,GAAKhS,GAAL,CAIA,IAAMiS,EAA+BhS,aAAaE,QAAQ,gCACrD8R,IAILhS,aAAaC,QAAQ,mCAAoC+R,GACzDhS,aAAa8R,WAAW,kCFRxBG,IGiCaC,GAtCU,SAAAC,GACvB,IAAIC,EAAM5vB,OAAO6vB,OAAO,MAExB,MAAmB,kBAARF,EACFC,GAGTD,EAAMA,EAAIhlB,OAAOoD,QAAQ,YAAa,MAMtC4hB,EAAIllB,MAAM,KAAKnK,QAAQ,SAAUwvB,GAC/B,IAAIpnB,EAAQonB,EAAM/hB,QAAQ,MAAO,KAAKtD,MAAM,KAGxC+C,EAAM9E,EAAMqnB,QACZC,EAAMtnB,EAAMlC,OAAS,EAAIkC,EAAMI,KAAK,UAAOrC,EAE/C+G,EAAMyiB,mBAAmBziB,GAIzBwiB,OAAcvpB,IAARupB,EAAoB,KAAOC,mBAAmBD,QAEnCvpB,IAAbmpB,EAAIpiB,GACNoiB,EAAIpiB,GAAOwiB,EACFnJ,MAAMqJ,QAAQN,EAAIpiB,IAC3BoiB,EAAIpiB,GAAK4F,KAAK4c,GAEdJ,EAAIpiB,GAAO,CAACoiB,EAAIpiB,GAAMwiB,KAInBJ,GAzBEA,+BCKEnD,GAAU,kBAAM,SAACrrB,EAAUO,GACtC,OAAQA,IAAW2B,YAAYxB,IAAI,SAAU,IAAIhC,MAC/C,IAAK,UACHygB,GAAa,qBAAsB,MACnC,MACF,IAAK,eACH,IAAM4P,EAAQC,KAAK/sB,OAAOgtB,WACtBF,IACF5P,GAAa,yBAA0B,MACvC+P,OAAOC,SAASC,OAAOC,OAAON,GAC9BC,KAAK/sB,OAAOqtB,SAAS,IACrB5sB,OAAOqW,SAASwW,UAMtBpQ,GAAa,2BAA4B,MAEzCnf,EAAS,CAAEtB,KAAM,aACjBsB,EAASwD,KACTxD,EAASL,OAGE+rB,GAAwC,SACnDH,EACAC,EACAC,GAHmD,MAI/C,CACJ/sB,KAAM,6CACN6sB,mBACAC,UACAC,+BAGWI,GAAmC,SAAAD,GAAa,MAAK,CAChEltB,KAAM,wCACNktB,kBAGW4D,GAAsB,SAAA/f,GAAI,OAAI,SAACzP,EAAUO,GACpDP,EAASP,EAAkB,uBAE3BiD,OAAO4I,QAAQmkB,IAAI,uBAEJlvB,IAAW2B,YAAYxB,IAAI,UAEvC8uB,oBAAoB/f,GACpBsE,KAAK,SAAA7O,GAAsD,IAAnDomB,EAAmDpmB,EAAnDomB,QAASE,EAA0CtmB,EAA1CsmB,QAASC,EAAiCvmB,EAAjCumB,2BACzBzrB,EAAS0rB,GAAsCJ,EAASE,EAASC,IACjEzrB,EAASL,OAEVyC,MAAM,SAAAE,GACL,IAAMotB,EAAG,iDAAAltB,OAAoDF,EAAMqtB,OAA1D,KAET,GAAqB,MAAjBrtB,EAAMqtB,QAAmC,MAAjBrtB,EAAMqtB,OAAgB,CAChDjtB,OAAO4I,QAAQskB,KAAKF,GACpB,IACMG,EADU,IAAIC,WAAQ,CAAEC,SAAUC,kBAAyCC,cACzDC,qBACtBxtB,OAAOqW,SAASoX,OAASH,aAE3BttB,OAAOqW,SAAW8W,OAElBttB,MAAMmtB,GAGR1vB,EAASL,SAIFywB,GAA2B,kBAAM,SAACpwB,EAAUO,GACvDP,EAAS6rB,IAAiC,IAE1C,IAAM5pB,EAAS1B,IAAW2B,YAAYxB,IAAI,UACpCirB,EAAqCprB,IAAW2B,YAAYxB,IAChE,sCAEFuB,EACGouB,wBAAwB1E,EAAmCjrB,IAAI,+BAC/DqT,KAAK,SAAA/L,GAAsD,IAAnDsjB,EAAmDtjB,EAAnDsjB,QAASE,EAA0CxjB,EAA1CwjB,QAASC,EAAiCzjB,EAAjCyjB,2BACnB6E,EAAkB3E,EAAmCjrB,IAAI,WAAW8B,OAAO8oB,GACjFtrB,EACE0rB,GAAsC4E,EAAiB9E,EAASC,IAElEzrB,EAAS6rB,IAAiC,QAInC0E,GAAa,SAACC,EAAcxd,GACvC,OAAO,SAAChT,EAAUO,GAChB,IAAM0B,EAAS1B,IAAW2B,YAAYxB,IAAI,UAC1C,OAAQuB,EAAOvD,MACb,IAAK,UACHuD,EAAOya,WAAP,GAAAla,OAAqBguB,EAArB,gBAAiDxd,GACjD,MACF,IAAK,eACHwd,EAAeA,EAAaxqB,WAAW,KAAOwqB,EAAahO,OAAO,GAAKgO,EACvEvuB,EAAOwuB,cAAcD,EAAc,SAAAE,GAAQ,SAAAluB,OAAOkuB,EAAP,qBAOtCC,GAAe,SAAAlhB,GAC1B,OAAO,SAACzP,EAAUO,GAChBP,EAASP,EAAkB,wBAE3Bc,IACG2B,YAAYxB,IAAI,UAChBwd,gBAAgBzO,GAChBsE,KAAK,SAAAgS,GACJ/lB,EAASwV,IAAS,IAClBxV,EAASL,KACTK,EAASuwB,GAAW9gB,EAAMsW,IAC1B/lB,EAASiT,GAAcwC,sBAAW,IAAI/P,KAAQ,KAC9C1F,EAASW,GAAY8O,EAAMsW,IAC3B/lB,EAAS2V,QAEVvT,MAAM,SAAAma,GACL,GAAiB,MAAbA,EAAEoT,QAA+B,MAAbpT,EAAEoT,OAAgB,CACxC,IACME,EADU,IAAIC,WAAQ,CAAEC,SAAUC,kBAAyCC,cACzDC,qBACtBxtB,OAAOqW,SAASoX,OAASH,aAE3BttB,OAAOqW,SAAW8W,EAEpB7vB,EAASL,KACTK,EAASJ,GAAa,IACtBI,EAAS6T,GAAuB,uBC5IzB+c,GAAA,SAAA3C,GACb,IAAM4C,EAAgB,IAAIf,WAAQ,CAAE7B,cAAagC,cAI3Ca,EAA4B,SAAAxF,GAAO,OACvC5Z,kBACE4Z,EAAQ/jB,IAAI,SAAAwpB,GAAK,MAAK,CACpBpf,GAAIof,EAAMpf,GACVmL,KAAMiU,EAAMjU,KACZkU,YAA+B,WAAlBD,EAAM,QACnBthB,KAAMshB,EAAME,kBAmCZC,EAAa,SAACzhB,EAAMuD,GAAP,OACjB,IAAIme,QAAQ,SAACC,EAASC,GAAV,OACVR,EACGS,YAAY,CACX7hB,OACAuD,WACAue,KAAM,CACJC,OAAQ,aAEVC,YAAY,IAEb1d,KAAKqd,GACLhvB,MAAMivB,MAMPvd,EAA6B,SAAArE,GAAI,OACrC,IAAI0hB,QAAQ,SAACC,EAASC,GAAV,OACVR,EACGa,cAAc,CAAEjiB,SAChBsE,KAAK,SAAA4d,GACJ,IAAMC,EAAS,IAAIC,WACnBD,EAAOtW,iBAAiB,UAAW,kBACjC8V,EAAQ,CACNpe,SAAU4e,EAAO/hB,OACjBmE,eAAgB2d,EAASG,oBAG7BF,EAAOG,WAAWJ,EAASK,YAE5B5vB,MAAM,SAAAE,GACCA,EAAMA,OAAmD,yBAA1C/C,KAAKoe,MAAMrb,EAAMA,OAAOA,MAAM,SACjD+uB,EAAO,IAAIY,SAAS,KAAM,CAAEtC,OAAQ,OAEhCrtB,EAAMA,OAAmD,cAA1C/C,KAAKoe,MAAMrb,EAAMA,OAAOA,MAAM,SACjD+uB,SAoBV,MAAO,CACL3yB,KAAM,UACNwzB,WAtGiB,kBAAM,IAAIf,QAAQ,SAAAC,GAAO,OAAIA,GAAQ,MAuGtD5B,oBA3F0B,SAAA/f,GAAI,OAC9B,IAAI0hB,QAAQ,SAACC,EAASC,GACpBR,EACGsB,gBAAgB,CAAE1iB,SAClBsE,KAAK,SAAA4d,GAAQ,OACZP,EAAQ,CACN9F,QAASwF,EAA0Ba,EAASplB,SAC5Cif,QAASmG,EAASS,SAClB3G,2BAA4B5f,eAAI,CAC9BwmB,OAAQV,EAASU,aAItBjwB,MAAMivB,MA+EXhB,wBA5E8B,SAAA5E,GAC9B,IAAM4G,EAAS5G,EAA2B/qB,IAAI,UAC9C,OAAO,IAAIywB,QAAQ,SAACC,EAASC,GAAV,OACjBR,EAAcyB,wBAAwB,CAAED,WAAUte,KAAK,SAAA4d,GAAQ,OAC7DP,EAAQ,CACN9F,QAASwF,EAA0Ba,EAASplB,SAC5Cif,QAASmG,EAASS,SAClB3G,2BAA4B5f,eAAI,CAC9BwmB,OAAQV,EAASU,gBAqEzBje,WA/CiB8c,EAgDjBxU,WA/CiBwU,EAgDjBpd,6BACAoK,gBAvBsB,SAAAzO,GAAI,OAC1B,IAAI0hB,QAAQ,SAACC,EAASC,GAAV,OACVvd,EAA2BrE,GACxBsE,KAAK,SAAA7O,GAAA,IAAG8N,EAAH9N,EAAG8N,SAAH,OAAkBoe,EAAQpe,KAC/B5Q,MAAMivB,MAoBXlvB,WAjBiB,SAAAsN,GAAI,OACrB,IAAI0hB,QAAQ,SAACC,EAASC,GAAV,OACVR,EACG0B,YAAY,CAAE9iB,SACdsE,KAAKqd,GACLhvB,MAAM,SAAAE,GAAK,OAAI+uB,EAAqC,gBAA9B/uB,EAAMA,MAAMA,MAAM,QAA2BA,uCCnG7DkwB,GAAA,WACb,IA8BMC,EAAgB,WACpB,IAAIC,GAAW,EACXC,GAAY,EACVC,EAAqB,GAE3B,OAAO,WACL,OAAO,IAAIzB,QAAQ,SAACC,EAASC,GACvBqB,EACFtB,EAAQ1uB,OAAOssB,MAEXtsB,OAAOssB,OAAS2D,GAClBA,GAAY,EAxCpB,IAAIxB,QAAQ,SAACC,EAASC,GACpB3uB,OAAOssB,KAAK6D,KAAK,SAAU,WACzBnwB,OAAOssB,KAAK/sB,OACT6wB,KAAK,CACJC,OAAQ/C,GACRgD,cAAe,CAAC,gEAEjBjf,KALHnV,OAAAq0B,GAAA,EAAAr0B,CAAAs0B,GAAAC,EAAAC,KAKQ,SAAAC,IAAA,IAAAC,EAAAC,EAAA,OAAAL,GAAAC,EAAAK,KAAA,SAAAC,GAAA,cAAAA,EAAA7N,KAAA6N,EAAAj1B,MAAA,QACE80B,EAA+BlU,GAAkB,4BAE/CmU,EAAyBh0B,KAAKoe,MAAM2V,GAC1C5wB,OAAOssB,KAAK/sB,OAAOqtB,SAASiE,GAC5BnC,KAEoB1uB,OAAOwsB,OAAOC,SAASC,OAAOsE,gBAAgB,CAChEC,UAAW3D,GACX4D,MAAO,6CACPC,SAAU,SAAA5F,GACR9O,GAAa,2BAA4B,gBACzCA,GAAa,yBAA0B5f,KAAKC,UAAUyuB,IACtDmD,OAGQ0C,mBAAmB,CAAEC,OAAQ,YAhBvC,wBAAAN,EAAAO,SAAAX,WAkCuBtf,KAAK,WAC9B2e,GAAW,EACXE,EAAmB1zB,QAAQ,SAAA20B,GAAQ,OAAIA,EAASnxB,OAAOssB,QACvDoC,EAAQ1uB,OAAOssB,SAGjB4D,EAAmB5gB,KAAKof,MAlBZ,GA0BlB1uB,OAAOssB,KACTyD,IAGA/vB,OAAOuxB,4BAA8BxB,EAGvC,IAiBMyB,EAAW,SAACC,GAAsC,IAAzBC,EAAyBjvB,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAT,KACvCkvB,EAAkB,IAAIlD,QAAQ,SAACC,EAASC,GAC5CoB,IAAe1e,KAAK,SAAAib,GAClBA,EAAK/sB,OAAOqyB,MAAMC,MACfC,KAAK,CACJC,SAAU,GACVvX,OAAQ,oDACRwX,EAAC,IAAAlyB,OAAsB,KAAhB2xB,EAAqB,OAASA,EAApC,oCACDQ,UAAWP,IAEZrgB,KAAK,SAAA4d,GApBoB,IAAArG,EAqBxB8F,EAAQ,CACN9F,SAtBsBA,EAsBaqG,EAAS9hB,OAAO0kB,MArB7D7iB,kBACE4Z,EAAQ/jB,IAAI,SAAAwpB,GAAK,MAAK,CACpBpf,GAAIof,EAAMpf,GACVmL,KAAMiU,EAAMjU,KACZkU,YAAgC,uCAAnBD,EAAM6D,SACnBnlB,KAAI,IAAAjN,OAAMuuB,EAAMpf,SAiBV6Z,UAAWmG,EAAS9hB,OAAOukB,cAC3B3I,2BAA4B5f,eAAI,CAC9BgpB,mBAAoBV,EACpBC,cAAezC,EAAS9hB,OAAOukB,oBAIpChyB,MAAMivB,OAIPyD,EAAoB,IAAI3D,QAAQ,SAACC,EAASC,GAC1B,KAAhB8C,EACF/C,EAAQ,MAERqB,IACG1e,KAAK,SAAAib,GAAI,OACRA,EAAK/sB,OAAOqyB,MAAMC,MAAM7zB,IAAI,CAC1Bq0B,OAAQZ,EACRjX,OAAQ,cAGXnJ,KAAK,SAAA4d,GACCA,EAAS9hB,OAAOmlB,QAGnB5D,EAAQO,EAAS9hB,OAAOmlB,QAAQ,IAFhC5D,EAAQ,QAKXhvB,MAAMivB,KAIP4D,EAAsB,IAAI9D,QAAQ,SAACC,EAASC,GAC1C3uB,OAAOwyB,aACX9D,EAAQ1uB,OAAOwyB,cAEfzC,IACG1e,KAAK,SAAAib,GAAI,OACRA,EAAK/sB,OAAOqyB,MAAMC,MAAM7zB,IAAI,CAC1Bq0B,OAAQ,OACR7X,OAAQ,SAGXnJ,KAAK,SAAA4d,GACJjvB,OAAOwyB,aAAevD,EAAS9hB,OAAO8B,GACtCyf,EAAQO,EAAS9hB,OAAO8B,MAEzBvP,MAAMivB,KAIb,OAAO,IAAIF,QAAQ,SAACC,EAASC,GAC3BF,QAAQgE,IAAI,CAACd,EAAiBS,EAAmBG,IAAsBlhB,KACrE,SAAA/L,GAAuC,IAAAwE,EAAA5N,OAAAqJ,EAAA,EAAArJ,CAAAoJ,EAAA,GAArCsjB,EAAqC9e,EAAA,GAA5B4oB,EAA4B5oB,EAAA,GAC/B6oB,EAAoBD,IADW5oB,EAAA,GACiB,GAAK4oB,EAC3D9J,EAAQG,2BAA6BH,EAAQG,2BAA2Bla,IACtE,WACA8jB,GAEFjE,EAAQ9F,QAeVgK,EAAwB,SAACxY,EAAMsY,GAAP,OAC5B,IAAIjE,QAAQ,SAACC,EAASC,GACpBoB,IACG1e,KAAK,SAAAib,GAAI,OACRA,EAAK/sB,OAAOqyB,MAAMC,MAAMC,KAAK,CAC3BC,SAAU,EACVvX,OAAQ,YACRwX,EAAC,IAAAlyB,OAAM4yB,EAAN,iDAAA5yB,OAA8Dsa,EAA9D,SAGJ/I,KAAK,SAAA4d,GAAQ,OACZP,EAAQO,EAAS9hB,OAAO0kB,MAAMnvB,OAAS,EAAIusB,EAAS9hB,OAAO0kB,MAAM,GAAG5iB,GAAK,QAE1EvP,MAAMivB,MAGPjd,EAAa,SAAC2gB,EAAQ/hB,GAG1B,OAFA+hB,EAASA,EAAO/uB,WAAW,KAAO+uB,EAAOvS,OAAO,GAAKuS,EAE9CtC,IAAe1e,KAAK,SAAAib,GACzBiB,MAAK,oDAAAztB,OAAqDuyB,EAArD,qBAAgF,CACnFQ,OAAQ,QACRroB,QAAS,CACPsoB,cAAa,UAAAhzB,OAAYwsB,EAAKyG,KAAKxG,WAAWyG,eAEhDC,KAAM3iB,OAqENc,EAA6B,SAAAihB,GAAM,OACvC,IAAI5D,QAAQ,SAACC,EAASC,GACpBoB,IAAe1e,KAAK,SAAAib,GAClB+F,EAASA,EAAO/uB,WAAW,KAAO+uB,EAAOvS,OAAO,GAAKuS,EAErD,IAAM9W,EAAsB,IAAIkT,QAAQ,SAAAC,GACtCpC,EAAK/sB,OAAOqyB,MAAMC,MACf7zB,IAAI,CACHq0B,SACAa,IAAK,UAEN7hB,KAAK,SAAA4d,GAAQ,OAAIP,EAAQvC,mBAAmBgH,OAAOlE,EAASgE,UAC5DvzB,MAAM,SAAAE,GACDA,EAAMqzB,MAA0D,aAAlDp2B,KAAKoe,MAAMrb,EAAMqzB,MAAMrzB,MAAMwzB,OAAO,GAAGC,QACvD1E,QAKF2E,EAA0B,IAAI7E,QAAQ,SAAAC,GAC1CpC,EAAK/sB,OAAOqyB,MAAMC,MACf7zB,IAAI,CACHq0B,SACA7X,OAAQ,iBAETnJ,KAAK,SAAA4d,GACJP,EAAQO,EAAS9hB,OAAOomB,gBAEzB7zB,MAAM,SAAAE,GACDA,EAAMqzB,MAA0D,aAAlDp2B,KAAKoe,MAAMrb,EAAMqzB,MAAMrzB,MAAMwzB,OAAO,GAAGC,QACvD1E,QAKRF,QAAQgE,IAAI,CAAClX,EAAqB+X,IAA0BjiB,KAC1D,SAAAtH,GAAgC,IAAAgU,EAAA7hB,OAAAqJ,EAAA,EAAArJ,CAAA6N,EAAA,GAA9BuG,EAA8ByN,EAAA,GAApBzM,EAAoByM,EAAA,GAC9B2Q,EAAQ,CACNpe,WACAgB,0BAONkK,EAAkB,SAAA6W,GAAM,OAC5B,IAAI5D,QAAQ,SAACC,EAASC,GAAV,OACVvd,EAA2BihB,GACxBhhB,KAAK,SAAAmiB,GAAA,IAAGljB,EAAHkjB,EAAGljB,SAAH,OAAkBoe,EAAQpe,KAC/B5Q,MAAMivB,MAgCb,MAAO,CACL3yB,KAAM,eACNwzB,WA3RiB,kBACjB,IAAIf,QAAQ,SAACC,EAASC,GACpBoB,IAAe1e,KAAK,SAAAib,GAClBoC,EAAmC,OAA3BpC,EAAK/sB,OAAOgtB,iBAyRxBO,oBA5L0B,SAAA2E,GAAW,OACrCD,EAASC,EAAYnuB,WAAW,KAAOmuB,EAAY3R,OAAO,GAAK2R,IA4L/D9D,wBA1L8B,SAAA5E,GAC9B,IAAM0I,EAAc1I,EAA2B/qB,IAAI,sBAC7C0zB,EAAgB3I,EAA2B/qB,IAAI,iBACrD,OAAOwzB,EAASC,EAAaC,IAwL7BhgB,aACAsI,WAxJiB,SAACI,EAAMsY,EAAUpiB,GAClC,OAAO,IAAIme,QAAQ,SAACC,EAASC,GAC3BiE,EAAsBxY,EAAMsY,GACzBrhB,KAAK,SAAAghB,GAAM,OACRA,EACE3gB,EAAW2gB,EAAQ/hB,GAAUe,KAAKqd,GAAShvB,MAAMivB,GACjDoB,IAAe1e,KAAK,SAAAib,GAClBA,EAAK/sB,OAAOqyB,MAAMC,MACf9F,OAAO,CACN3R,OACAkY,QAASI,IAEVrhB,KAAK,SAAA4d,GAAQ,OAAIvd,EAAWud,EAAS9hB,OAAO8B,GAAIqB,KAChDe,KAAKqd,GACLhvB,MAAMivB,OAGhBjvB,MAAMivB,MAwIXZ,cApIoB,SAACsE,EAAQoB,GAC7B,OAAO,IAAIhF,QAAQ,SAACC,EAASC,GAC3BoB,IAAe1e,KAAK,SAAAib,GAClBA,EAAK/sB,OAAOqyB,MAAMC,MACf7zB,IAAI,CACHq0B,SACA7X,OAAQ,kBAETnJ,KAAK,SAAAqiB,GACJ,GAAKA,EAAYvmB,OAAOiN,KAEjB,CACL,IAAMuZ,EAAcF,EAAiBC,EAAYvmB,OAAOiN,MAClDkY,EAAUoB,EAAYvmB,OAAOmlB,QAAQ,GAC3CM,EAAsBe,EAAarB,GAASjhB,KAAK,SAAAuiB,GAC/C,IAAMC,EAAW,WACfvH,EAAK/sB,OAAOqyB,MAAMC,MACfiC,KAAK,CACJzB,SACAC,UACAlY,KAAMuZ,IAEPtiB,KAAK,SAAA0iB,GACJrF,MAEDhvB,MAAMivB,IAGLiF,EACJtH,EAAK/sB,OAAOqyB,MAAMC,MACflK,OAAO,CAAE0K,OAAQuB,IACjBviB,KAAKwiB,GACLn0B,MAAMivB,GAETkF,WAxBJlF,WA2HVvd,6BACAoK,kBACAC,+BAvCqC,SAACrB,EAAMsY,GAAP,OACrC,IAAIjE,QAAQ,SAACC,EAASC,GAAV,OACViE,EAAsBxY,EAAMsY,GAAUrhB,KAAK,SAAAghB,GAAM,OAAI7W,EAAgB6W,GAAQhhB,KAAKqd,QAsCpF3uB,0BAnCgC,SAACqa,EAAMsY,GAAP,OAChC,IAAIjE,QAAQ,SAACC,EAASC,GACpBoB,IAAe1e,KAAK,SAAAib,GAAI,OACtBA,EAAK/sB,OAAOqyB,MAAMC,MACfC,KAAK,CACJC,SAAU,EACVvX,OAAQ,YACRwX,EAAC,IAAAlyB,OAAM4yB,EAAN,iDAAA5yB,OAA8Dsa,EAA9D,OAEF/I,KAAK,SAAA2iB,GACAA,EAAa7mB,OAAO0kB,MAAMnvB,OAAS,EACrC4pB,EAAK/sB,OAAOqyB,MAAMC,MACflK,OAAO,CACN0K,OAAQ2B,EAAa7mB,OAAO0kB,MAAM,GAAG5iB,KAEtCoC,KAAKqd,GACLhvB,MAAMivB,GAETD,oGC3QCuF,WAzEO,WACpB,OACEC,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,4BACbF,EAAAzD,EAAA0D,cAAA,4BACAD,EAAAzD,EAAA0D,cAAA,2CACAD,EAAAzD,EAAA0D,cAAA,uNAKAD,EAAAzD,EAAA0D,cAAA,8LAIAD,EAAAzD,EAAA0D,cAAA,4CACAD,EAAAzD,EAAA0D,cAAA,wQAKAD,EAAAzD,EAAA0D,cAAA,sBACAD,EAAAzD,EAAA0D,cAAA,+HAIAD,EAAAzD,EAAA0D,cAAA,uQAKAD,EAAAzD,EAAA0D,cAAA,+HAIAD,EAAAzD,EAAA0D,cAAA,qBACAD,EAAAzD,EAAA0D,cAAA,sMAKAD,EAAAzD,EAAA0D,cAAA,mQAKAD,EAAAzD,EAAA0D,cAAA,sBACAD,EAAAzD,EAAA0D,cAAA,gUAMAD,EAAAzD,EAAA0D,cAAA,4CACAD,EAAAzD,EAAA0D,cAAA,uOAKAD,EAAAzD,EAAA0D,cAAA,gXAMAD,EAAAzD,EAAA0D,cAAA,+LAIAD,EAAAzD,EAAA0D,cAAA,qBACAD,EAAAzD,EAAA0D,cAAA,yHCxDAE,uBACJ,SAAAA,EAAYC,GAAO,IAAAC,EAAA,OAAAr4B,OAAAs4B,EAAA,EAAAt4B,CAAAu4B,KAAAJ,GACjBE,EAAAr4B,OAAAw4B,EAAA,EAAAx4B,CAAAu4B,KAAAv4B,OAAAy4B,EAAA,EAAAz4B,CAAAm4B,GAAAO,KAAAH,KAAMH,IAENpuB,IAAE2uB,QAAF34B,OAAA44B,EAAA,EAAA54B,CAAAq4B,GAAgB,CACd,uBACA,sBACA,2BACA,iCACA,kBACA,oBATeA,6EAiBjB,OADIE,KAAKH,MADPje,SAAYC,SAEE3P,MAAM,KAAK,yDAGC,IAAAouB,EAIxBN,KAAKH,MAFKhe,EAFcye,EAE1B1e,SAAYC,SAGd,GAAwB,iBALIye,EAG1BC,gBAGA,OAAOd,EAAAzD,EAAA0D,cAAA,YAGT,IAAIc,EAAgB3e,EAASwJ,OAAO,SAASpd,QAK7C,GAJIuyB,EAAclsB,SAAS,OACzBksB,EAAgBA,EAAcre,UAAU,EAAGqe,EAAcvyB,OAAS,IAG9C,KAAlBuyB,EACF,OAAOf,EAAAzD,EAAA0D,cAAA,YAEP,IAAMe,EAAYD,EAActuB,MAAM,KAChCwuB,EAAsBD,EAAUA,EAAUxyB,OAAS,GACnD0yB,EAAaF,EAAUlqB,MAAM,EAAGkqB,EAAUxyB,OAAS,GAAGsC,KAAK,KAEjE,OACEkvB,EAAAzD,EAAA0D,cAACkB,GAAA,EAAD,CAAMC,GAAE,SAAAx1B,OAAWs1B,GAAchB,UAAU,2BACzCF,EAAAzD,EAAA0D,cAAA,KAAGC,UAAU,wBACbF,EAAAzD,EAAA0D,cAAA,QAAMC,UAAU,2CAA2Ce,EAA3D,wDAMkB,IAKpBI,EAFAd,KAAKH,MADPje,SAAYC,SAGUwJ,OAAO,QAAQpd,QACnC6yB,EAASxsB,SAAS,OACpBwsB,EAAWA,EAAS3e,UAAU,EAAG2e,EAAS7yB,OAAS,IAGrD,IAAMwyB,EAAYK,EAAS5uB,MAAM,KAC3BsuB,EAAgBC,EAAUlqB,MAAM,EAAGkqB,EAAUxyB,OAAS,GAAGsC,KAAK,KAEpE,OACEkvB,EAAAzD,EAAA0D,cAACkB,GAAA,EAAD,CAAMC,GAAE,SAAAx1B,OAAWm1B,GAAiBb,UAAU,2BAC5CF,EAAAzD,EAAA0D,cAAA,KAAGC,UAAU,wBACbF,EAAAzD,EAAA0D,cAAA,QAAMC,UAAU,2CAAhB,sDAMJ,OACEF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,8BACbF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,mBAAmBoB,IAAKC,KAAMvC,IAAI,OAAOwC,MAAM,KAAKC,OAAO,OAC1EzB,EAAAzD,EAAA0D,cAAA,MAAIC,UAAU,wBAAd,iEAMJ,OACEF,EAAAzD,EAAA0D,cAACkB,GAAA,EAAD,CAAMC,GAAE,IAAOlB,UAAU,2BACvBF,EAAAzD,EAAA0D,cAAA,KAAGC,UAAU,wBACbF,EAAAzD,EAAA0D,cAAA,QAAMC,UAAU,2CAAhB,0DAMJ,OACEF,EAAAzD,EAAA0D,cAACkB,GAAA,EAAD,CAAMC,GAAE,IAAOlB,UAAU,2BACvBF,EAAAzD,EAAA0D,cAAA,KAAGC,UAAU,wBACbF,EAAAzD,EAAA0D,cAAA,QAAMC,UAAU,2CAAhB,kEAMJK,KAAKH,MAAMh2B,KAAKuC,yEAIhB,OACEqzB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,0BAA0BwB,QAASnB,KAAKoB,gCACrD3B,EAAAzD,EAAA0D,cAAA,KAAGC,UAAU,wBACbF,EAAAzD,EAAA0D,cAAA,QAAMC,UAAU,2CAAhB,wDAQJ,OAF4BK,KAAKH,MAAzBwB,iBAGN,IAAK,YAEL,IAAK,4BAEL,IAAK,2BAEL,IAAK,SACH,OAAOrB,KAAKsB,kCACd,IAAK,WACH,OAAO7B,EAAAzD,EAAA0D,cAAA,YAIX,OAAQM,KAAKuB,eACX,IAAK,GACH,OAAOvB,KAAKwB,aACd,IAAK,QACH,OAAOxB,KAAKyB,8BACd,IAAK,OACH,OAAOzB,KAAK0B,0BACd,IAAK,SACH,OAAO1B,KAAK2B,6BACd,IAAK,UACH,OAAO3B,KAAK4B,yBACd,QACE,OAAOnC,EAAAzD,EAAA0D,cAAA,mDAKX,IAAMmC,EAAyB,SAAA7wB,GAAI,OAAIyuB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,qBAAqB3uB,IAE3E,OAAQgvB,KAAKH,MAAMwB,iBACjB,IAAK,YACH,OAAOQ,EAAuB,aAChC,IAAK,WACH,OAAOA,EAAuB,YAChC,IAAK,4BACH,OAAOA,EAAuB,aAChC,IAAK,2BACH,OAAOA,EAAuB,WAChC,IAAK,SACH,OAAOA,EAAuB,UAIlC,OAAQ7B,KAAKuB,eACX,IAAK,SACH,OAAOM,EAAuB,UAChC,IAAK,UACH,OAAOA,EAAuB,WAIlC,OAAOA,EAAuB,mDAI9B7B,KAAKH,MAAMh2B,KAAKqC,cAAc,2DAI9B8zB,KAAKH,MAAMh2B,KAAKqC,cAAc,+DAI9B8zB,KAAKH,MAAMh2B,KAAKwC,4DAIZ2zB,KAAKH,MAAMiC,eACb9B,KAAKH,MAAMkC,KAAKA,iDAKlB/B,KAAKH,MAAMh2B,KAAKqC,cAAc,YAC9B8zB,KAAKH,MAAMh2B,KAAKqC,cAAc,kDAGhB,IAAA81B,EAEZhC,KAAKH,MADCoC,EADMD,EACNC,gBAAiBC,EADXF,EACWE,mBAAoBb,EAD/BW,EAC+BX,gBAAiB/oB,EADhD0pB,EACgD1pB,KAAMwpB,EADtDE,EACsDF,cAGpE,GAAMT,EACJ,OACE5B,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,sBAAsBwB,QAASnB,KAAKmC,0BAAnD,QAKF,IAAMC,EAAoBC,KAAW,wCAAyC,CAC5EC,uCAAwCR,IAGpCS,EAAwBF,KAAW,wCAAyC,CAChFG,sCAAuCN,IAGzC,OACEzC,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,wBACXsC,GAA0C,YAAvBjC,KAAKuB,eACxB9B,EAAAzD,EAAA0D,cAACkB,GAAA,EAAD,CAAMC,GAAG,YACPpB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,4BAA4B/X,MAAM,WAAjD,aAMFqa,GACAxC,EAAAzD,EAAA0D,cAAA,KAAG+C,KAAK,sCAAsCC,OAAO,SAASC,IAAI,uBAChElD,EAAAzD,EAAA0D,cAAA,KAAGC,UAAU,6CAIhBsC,IAAoBZ,KAAqB/oB,GACxCmnB,EAAAzD,EAAA0D,cAACkD,EAAA,SAAD,KACEnD,EAAAzD,EAAA0D,cAAA,KAAGC,UAAWyC,EAAmBjB,QAASnB,KAAK6C,gBAAiBjb,MAAM,SACtE6X,EAAAzD,EAAA0D,cAAA,KACEC,UAAU,mDACVwB,QAASnB,KAAK8C,gBACdlb,MAAM,UAKXqa,GACCxC,EAAAzD,EAAA0D,cAAA,KACEC,UAAW4C,EACXpB,QAASnB,KAAK+C,oBACdnb,MAAM,+CAShB,IAAM+X,EAAY0C,KAAW,aAAc,CACzCW,wBAAgD,KAAvBhD,KAAKuB,gBAGhC,OACE9B,EAAAzD,EAAA0D,cAAA,OAAKC,UAAWA,GACbK,KAAKiD,mBACLjD,KAAKkD,cACLlD,KAAKmD,wBAvQUC,kBA+RTC,gBAAWC,YAlBF,SAACnsB,EAAO0oB,GAC9B,MAAO,CACLoC,gBAAiB9qB,EAAMpM,YAAYxB,IAAI,mBACvC24B,mBAAoB/qB,EAAMtN,KAAKN,IAAI,sBACnC83B,gBAAiBlqB,EAAMtN,KAAKN,IAAI,iBAAkB+Q,mBAAQL,OAC1D3B,KAAMnB,EAAM9N,IAAIC,QAAQC,IAAI,QAC5Bu4B,cAAe3qB,EAAM9N,IAAIid,KAAKrY,OAAS,EACvCsyB,gBAAiBppB,EAAMpM,YAAYxB,IAAI,WAAa4N,EAAMpM,YAAYxB,IAAI,UAAUhC,OAI7D,SAAAsB,GACzB,MAAO,CACLgB,KAAM05B,YAAmBC,EAAa36B,GACtCk5B,KAAMwB,YAAmBE,iBAAa56B,KAIhBy6B,CAA6C1D,KC1SxD8D,WAAA,WAGb,OACEjE,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,qBACbF,EAAAzD,EAAA0D,cAAA,MAAIC,UAAU,oBAAd,WACAF,EAAAzD,EAAA0D,cAAA,wBAAAr0B,OALgB,wBAKhB,MACAo0B,EAAAzD,EAAA0D,cAAA,MAAIC,UAAU,mBAAd,+BACAF,EAAAzD,EAAA0D,cAAA,MAAIC,UAAU,mBAAd,yBACAF,EAAAzD,EAAA0D,cAAA,MAAIC,UAAU,mBAAd,qBAEEF,EAAAzD,EAAA0D,cAAA,WAFF,qBAMAD,EAAAzD,EAAA0D,cAACkB,GAAA,EAAD,CAAMC,GAAG,WACPpB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,yCAAf,gBAEFF,EAAAzD,EAAA0D,cAACkB,GAAA,EAAD,CAAMC,GAAG,YACPpB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,sBAAf,YAGFF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,iCAAf,+DAC+D,IAC7DF,EAAAzD,EAAA0D,cAAA,KAAG+C,KAAK,2BAA2BC,OAAO,SAASC,IAAI,uBAAvD,gBAEK,IAJP,qBAKqB,IACnBlD,EAAAzD,EAAA0D,cAAA,KACE+C,KAAK,oFACLC,OAAO,SACPC,IAAI,uBAHN,eAMK,IAZP,0BC0GSW,uBA1BS,SAACnsB,EAAO0oB,GAC9B,IAAMrL,EAAqCrd,EAAMpM,YAAYxB,IAC3D,sCAEF,MAAO,CACLg3B,gBAAiBppB,EAAMpM,YAAYxB,IAAI,UAAUhC,KACjD4sB,QAAWK,EACPA,EAAmCjrB,IAAI,WACvC,KACJ8qB,UACIG,GAAsCA,EAAmCjrB,IAAI,WACjFkrB,gBACID,GACFA,EAAmCjrB,IAAI,iBACzC+qB,6BACIE,GACFA,EAAmCjrB,IAAI,gCAIlB,SAAAV,GACzB,MAAO,CACLkC,YAAaw4B,YAAmBI,EAAoB96B,KAIzCy6B,CA1HK,SAAAv1B,GAQd,IAPJuK,EAOIvK,EAPJuK,KACA6b,EAMIpmB,EANJomB,QACAE,EAKItmB,EALJsmB,QACAI,EAII1mB,EAJJ0mB,cACA8L,EAGIxyB,EAHJwyB,gBACAx1B,EAEIgD,EAFJhD,YACAupB,EACIvmB,EADJumB,2BAEAsP,oBAAU,kBAAM74B,EAAYstB,oBAAoB/f,IAAO,CAACA,IAExD,IAgBMurB,EAA+B,KAATvrB,EAE5B,OACEmnB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,0BACQ,YAApBY,GACCd,EAAAzD,EAAA0D,cAAA,MAAIC,UAAU,wBAAd,cAAiDkE,EAAsB,IAAMvrB,GAG/EmnB,EAAAzD,EAAA0D,cAAA,MAAIC,UAAU,4BACVkE,GACApE,EAAAzD,EAAA0D,cAACkB,GAAA,EAAD,CAAMC,GAAE,SAAAx1B,OAxBe,WAC7B,OAAQk1B,GACN,IAAK,UACH,IAAME,EAAYnoB,EAAKpG,MAAM,KAC7B,OAAOuuB,EAAUlqB,MAAM,EAAGkqB,EAAUxyB,OAAS,GAAGsC,KAAK,KACvD,IAAK,eACH,OAAS+jB,EAA2B/qB,IAAI,YACpC,IAAM+qB,EAA2B/qB,IAAI,YACrC,KACN,QACE,OAAO,MAccu6B,KACjBrE,EAAAzD,EAAA0D,cAAA,MAAIC,UAAU,oCACZF,EAAAzD,EAAA0D,cAAA,KAAGC,UAAU,2DADf,SAMFxL,GAAW,IAAI/jB,IAAI,SAAA2zB,GACnB,IAAMlK,EAAckK,EAAKx6B,IAAI,eACvBy6B,EAAeD,EAAKx6B,IAAI,QAAQ+K,SAAS,gBACzC2vB,EAAYF,EAAKx6B,IAAI,QAAQ+K,SAAS,QACtC4vB,EAAsC,yBAArBH,EAAKx6B,IAAI,QAE1B46B,EAAY9B,KAAW,oCAAqC,CAChE+B,YAAavK,EACbwK,2CAA4CxK,EAC5CyK,WAAYzK,IAAgBmK,IAAiBE,EAC7CK,0CAA2CN,EAC3CO,UAAWR,EACXS,UAAWP,IAGb,OAAIH,EAAKx6B,IAAI,eAETk2B,EAAAzD,EAAA0D,cAACkB,GAAA,EAAD,CAAMC,GAAE,SAAAx1B,OAAW04B,EAAKx6B,IAAI,SAAW0L,IAAK8uB,EAAKx6B,IAAI,OACnDk2B,EAAAzD,EAAA0D,cAAA,MAAIC,UAAU,oCACZF,EAAAzD,EAAA0D,cAAA,KAAGC,UAAWwE,IADhB,IAC+BJ,EAAKx6B,IAAI,QADxC,MAOFk2B,EAAAzD,EAAA0D,cAACkB,GAAA,EAAD,CAAMC,GAAE,QAAAx1B,OAAU04B,EAAKx6B,IAAI,SAAW0L,IAAK8uB,EAAKx6B,IAAI,OAClDk2B,EAAAzD,EAAA0D,cAAA,MAAIC,UAAU,oCACZF,EAAAzD,EAAA0D,cAAA,KAAGC,UAAWwE,IADhB,IAC+BJ,EAAKx6B,IAAI,YAO/C8qB,IACEI,EACCgL,EAAAzD,EAAA0D,cAAA,MAAIC,UAAU,mDACZF,EAAAzD,EAAA0D,cAAA,KAAGC,UAAU,kCAGfF,EAAAzD,EAAA0D,cAAA,MACEC,UAAU,mFACVwB,QA3EgB,kBAAMp2B,EAAYkuB,6BAyEpC,+BC3FGyL,WAAA,SAAA32B,GAAiB,IAAd+V,EAAc/V,EAAd+V,QAAc6gB,EAC4BC,oBAAS,GADrCC,EAAAp9B,OAAAqJ,EAAA,EAAArJ,CAAAk9B,EAAA,GACvBG,EADuBD,EAAA,GACAE,EADAF,EAAA,GAAAG,EAEQJ,mBAAS9gB,GAFjBmhB,EAAAx9B,OAAAqJ,EAAA,EAAArJ,CAAAu9B,EAAA,GAEvBE,EAFuBD,EAAA,GAEVE,EAFUF,EAAA,GAI9BrB,oBAAU,WACF9f,IACJqhB,EAAerhB,GACfihB,GAAyB,KAE1B,CAACjhB,IAEJ,IASMshB,EAAc,kBAAML,GAAyB,IAEnD,IAAKD,EACH,OAAO,KAGT,IAAMO,EAAQ,CACZC,QAASC,kBAASzhB,EAAU,GAAM,EAAG,CAAE0hB,UAAW,OAGpD,OACE/F,EAAAzD,EAAA0D,cAAC+F,GAAA,OAAD,CAAQJ,MAAOA,EAAOK,OApBI,WACpB5hB,IAINihB,GAAyB,GACzBI,EAAe,SAeZ,SAAAE,GAAK,OACJ5F,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,oBAAoB0F,MAAOA,EAAOlE,QAASiE,GACvDF,0CCnCIS,uCAAA,SAAA53B,GAQT,IAAA63B,EAAA73B,EAPJ83B,uBACEC,EAMEF,EANFE,qBACAC,EAKEH,EALFG,iBACAC,EAIEJ,EAJFI,iBACAC,EAGEL,EAHFK,oBACAC,EAEEN,EAFFM,oBAGF,OACEzG,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,iCACbF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,4CAA4CwB,QAAS2E,GAClErG,EAAAzD,EAAA0D,cAAA,KAAGC,UAAU,6BAGfF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,0CAA0CwB,QAAS4E,GAChEtG,EAAAzD,EAAA0D,cAAA,KAAGC,UAAU,qDACbF,EAAAzD,EAAA0D,cAAA,KAAGC,UAAU,+FAGfF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,0CAA0CwB,QAAS6E,GAChEvG,EAAAzD,EAAA0D,cAAA,KAAGC,UAAU,sDACbF,EAAAzD,EAAA0D,cAAA,KAAGC,UAAU,+FAGfF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,0CAA0CwB,QAAS8E,GAChExG,EAAAzD,EAAA0D,cAAA,KAAGC,UAAU,qDACbF,EAAAzD,EAAA0D,cAAA,KAAGC,UAAU,wDAGfF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,0CAA0CwB,QAAS+E,GAChEzG,EAAAzD,EAAA0D,cAAA,KAAGC,UAAU,sDACbF,EAAAzD,EAAA0D,cAAA,KAAGC,UAAU,2DCtBAwG,eACnB,SAAAA,EAAYtG,GAAO,IAAAC,EAAA,OAAAr4B,OAAAs4B,EAAA,EAAAt4B,CAAAu4B,KAAAmG,GACjBrG,EAAAr4B,OAAAw4B,EAAA,EAAAx4B,CAAAu4B,KAAAv4B,OAAAy4B,EAAA,EAAAz4B,CAAA0+B,GAAAhG,KAAAH,KAAMH,IAENpuB,IAAE2uB,QAAF34B,OAAA44B,EAAA,EAAA54B,CAAAq4B,GAAgB,CACd,mBACA,qBACA,mBACA,wBACA,sBAGFA,EAAK3oB,MAAQ,CACXivB,cAAetG,EAAKuG,qBAAqBxG,EAAM5U,OAC/Cqb,kBAAkB,GAbHxG,kFAiBAyG,GAAW,IAAAC,EAGxBxG,KAAKH,MADPgG,uBAA0BY,EAFAD,EAEAC,uBAAwBjV,EAFxBgV,EAEwBhV,oBAAqBkV,EAF7CF,EAE6CE,gBAEjEN,EAAkBpG,KAAK7oB,MAAvBivB,cAEJG,EAAUV,uBAAuBa,kBAAoBA,GACnDN,EAAc5T,IAAIhB,IACpBiV,EAAuBjV,EAAqB4U,EAAc78B,IAAIioB,IAI9DwO,KAAKH,MAAM5U,QAAUsb,EAAUtb,OACjC+U,KAAK2G,SAAS,CAAEP,cAAepG,KAAKqG,qBAAqBrG,KAAKH,MAAM5U,sDAInDA,GACnB,OAAOvW,eACLuW,EACG1hB,IAAI,YACJ6G,IAAI,SAAAe,GAAG,OAAIA,EAAI5H,IAAI,YAAY6G,IAAI,SAAAoB,GAAI,MAAI,CAACA,EAAKjI,IAAI,MAAOiI,EAAKjI,IAAI,oBACrE+I,oDAIUwF,GAAQ,IAAA8uB,EAAA5G,KACvB,OAAO,kBAAM4G,EAAK/G,MAAMgG,uBAAuBgB,kBAAkB/uB,iDAG9C,IAAAgvB,EAAA9G,KACnBl3B,WAAW,WACJg+B,EAAK3vB,MAAMmvB,iBAGdQ,EAAKH,SAAS,CAAEL,kBAAkB,IAFlCQ,EAAKjH,MAAMgG,uBAAuBkB,uBAInC,4CAGYC,GAAO,IACdZ,EAAkBpG,KAAK7oB,MAAvBivB,cAEoB5U,EACxBwO,KAAKH,MADPgG,uBAA0BrU,oBAG5BwO,KAAK2G,SAAS,CACZP,cAAeA,EAAchsB,IAAIoX,EAAqBwV,EAAMtE,OAAOxtB,yDAOrE8qB,KAAK2G,SAAS,CAAEL,kBAAkB,IAHZ,IAKdF,EAAkBpG,KAAK7oB,MAAvBivB,cAEoB5U,EACxBwO,KAAKH,MADPgG,uBAA0BrU,oBAEtByV,EAAYb,EAAc78B,IAAIioB,GAE9B0V,EAAiBlH,KAAKmH,SAASC,eACrCpH,KAAK2G,SAAS,CACZP,cAAeA,EAAchsB,IAC3BoX,EACAyV,EAAU9kB,UAAU,EAAG+kB,GACrBz4B,KACAw4B,EAAU9kB,UAAU6d,KAAKmH,SAASE,cAAgBH,MAIxDlH,KAAKmH,SAASG,kDAGEH,GAChBnH,KAAKmH,SAAWA,mCAGT,IAAAI,EAAAvH,KAAAM,EAIHN,KAAKH,MAFP5U,EAFKqV,EAELrV,MAFKuc,EAAAlH,EAGLuF,uBAA0BrU,EAHrBgW,EAGqBhW,oBAAqBkV,EAH1Cc,EAG0Cd,gBAAiBe,EAH3DD,EAG2DC,qBAE1DrB,EAAkBpG,KAAK7oB,MAAvBivB,cAEFsB,EAAkBzc,EACrB1hB,IAAI,YACJwO,KAAK,SAAA5G,GAAG,OAAIA,EAAI5H,IAAI,YAAYwO,KAAK,SAAAvG,GAAI,OAAIA,EAAKjI,IAAI,QAAUioB,MAEnE,OACEiO,EAAAzD,EAAA0D,cAACkD,EAAA,SAAD,KACEnD,EAAAzD,EAAA0D,cAAA,SAAOC,UAAU,cACfF,EAAAzD,EAAA0D,cAAA,aACGzU,EAAM1hB,IAAI,YAAY6G,IAAI,SAAAe,GAAG,OAC5BsuB,EAAAzD,EAAA0D,cAAA,MAAIzqB,IAAK9D,EAAI5H,IAAI,OACd4H,EAAI5H,IAAI,YAAY6G,IAAI,SAAAoB,GACvB,IAAMm2B,EAAiBn2B,EAAKjI,IAAI,QAAUioB,EAEpCmO,EAAY0C,KAAW,mBAAoB,CAC/CuF,6BAA8BD,IAGhC,OACElI,EAAAzD,EAAA0D,cAAA,MACEC,UAAWA,EACX1qB,IAAKzD,EAAKjI,IAAI,MACd43B,QAASoG,EAAKM,iBAAiBr2B,EAAKjI,IAAI,QAEvCo+B,GAAkBjB,EACjBjH,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,8BACbF,EAAAzD,EAAA0D,cAAA,YACEoI,WAAS,EACTnI,UAAU,WACVlO,KAAK,IACLvc,MAAOkxB,EAAc78B,IAAIiI,EAAKjI,IAAI,OAClCw+B,OAAQR,EAAKS,mBACbC,SAAUV,EAAKW,iBACfC,IAAKZ,EAAKa,oBAEZ3I,EAAAzD,EAAA0D,cAAA,OACEC,UAAU,sCACVwB,QAASoG,EAAKc,uBAEd5I,EAAAzD,EAAA0D,cAAA,KAAGC,UAAU,sCAJf,qBAQAnuB,EAAKjI,IAAI,YAAYqI,KAAO,EAC9B6tB,EAAAzD,EAAA0D,cAAC4I,GAAD,CACEn4B,MAAOqB,EAAKjI,IAAI,YAChBs8B,uBAAwB0B,EAAK1H,MAAMgG,yBAGrC,cAUhBpG,EAAAzD,EAAA0D,cAAC6I,GAAA,cAAD,CAAU1T,SAAU6S,IAAoBD,GACtChI,EAAAzD,EAAA0D,cAACiG,GAAD,CAAmBE,uBAAwB7F,KAAKH,MAAMgG,kCAnKzBzC,iBCT1BoF,WAAoB,SAACC,EAAQC,EAAQC,GAChD,MAAO,CACLC,EAAGC,UAAUH,EAAOE,EAAIH,EAAOG,GAAKD,EAAsBF,EAAOG,EAAG,IACpEE,EAAGD,UAAUH,EAAOI,EAAIL,EAAOK,GAAKH,EAAsBF,EAAOK,EAAG,IACpEC,EAAGF,UAAUH,EAAOK,EAAIN,EAAOM,GAAKJ,EAAsBF,EAAOM,EAAG,IACpE/M,GAAI0M,EAAO1M,EAAIyM,EAAOzM,GAAK2M,EAAsBF,EAAOzM,KAI/CgN,GAAa,SAACJ,EAAGE,EAAGC,EAAG/M,GAClC,MAAO,CAAE4M,IAAGE,IAAGC,IAAG/M,MAGPiN,GAAa,SAAAC,GACxB,cAAA79B,OAAe69B,EAAKN,EAApB,MAAAv9B,OAA0B69B,EAAKJ,EAA/B,MAAAz9B,OAAqC69B,EAAKH,EAA1C,MAAA19B,OAAgD69B,EAAKlN,EAArD,MCZamN,WAAA,SAAAp7B,GAAwB,IAArBoJ,EAAqBpJ,EAArBoJ,MAAOgqB,EAAcpzB,EAAdozB,QACjBiI,EAAiBJ,GAAW,IAAK,IAAK,IAAK,GAC3CK,EAAeL,GAAW,GAAI,GAAI,IAAK,GAEvCM,EAAgB,CACpBC,YAAahE,kBACX,CACEzxB,QAAS,EACTE,QAAS,EACTD,UAAW,GACXoD,GACF,CAAEquB,UAAW,OAIjB,OACE/F,EAAAzD,EAAA0D,cAAC+F,GAAA,OAAD,CAAQJ,MAAOiE,GACZ,SAAAjE,GACC,IAAMmE,EAAkBP,GACtBT,GAAkBY,EAAgBC,EAAchE,EAAMkE,cAGxD,OACE9J,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,WAAWwB,QAASA,EAASkE,MAAO,CAAEmE,oBACnD/J,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,6BACF,YAAVxoB,GAAuBsoB,EAAAzD,EAAA0D,cAAA,KAAGC,UAAU,iBAC1B,YAAVxoB,GAAuBsoB,EAAAzD,EAAA0D,cAAA,KAAGC,UAAU,iBAC1B,cAAVxoB,GAAyBsoB,EAAAzD,EAAA0D,cAAA,KAAGC,UAAU,wBC9BtC8J,WAAA,SAAA17B,GAOT,IAAA63B,EAAA73B,EANJ83B,uBACE6D,EAKE9D,EALF8D,yBACAC,EAIE/D,EAJF+D,4BACAC,EAGEhE,EAHFgE,iBACAC,EAEEjE,EAFFiE,iBAGF,OACEpK,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,gCACbF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,2BACbF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,0CAA0CwB,QAASuI,GAChEjK,EAAAzD,EAAA0D,cAAA,KAAGC,UAAU,6BAGfF,EAAAzD,EAAA0D,cAAA,QAAMC,UAAU,kCAEhBF,EAAAzD,EAAA0D,cAAA,OACEC,UAAU,0CACVwB,QAASwI,GAETlK,EAAAzD,EAAA0D,cAAA,KAAGC,UAAU,uBAGfF,EAAAzD,EAAA0D,cAAA,QAAMC,UAAU,kCAEhBF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,0CAA0CwB,QAASyI,GAChEnK,EAAAzD,EAAA0D,cAAA,KAAGC,UAAU,uBAGfF,EAAAzD,EAAA0D,cAAA,QAAMC,UAAU,kCAEhBF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,0CAA0CwB,QAAS0I,GAChEpK,EAAAzD,EAAA0D,cAAA,KAAGC,UAAU,4BCrBFmK,eACnB,SAAAA,EAAYjK,GAAO,IAAAC,EAAA,OAAAr4B,OAAAs4B,EAAA,EAAAt4B,CAAAu4B,KAAA8J,GACjBhK,EAAAr4B,OAAAw4B,EAAA,EAAAx4B,CAAAu4B,KAAAv4B,OAAAy4B,EAAA,EAAAz4B,CAAAqiC,GAAA3J,KAAAH,KAAMH,IAENpuB,IAAE2uB,QAAF34B,OAAA44B,EAAA,EAAA54B,CAAAq4B,GAAgB,CACd,uBACA,sBACA,qBACA,wBACA,2BACA,iCACA,oCACA,sBAGFA,EAAK3oB,MAAQ,CACX4yB,gBAAiBjK,EAAKkK,0BAA0BnK,EAAMxvB,MACtD45B,mBAAoBnK,EAAKoK,6BAA6BrK,EAAMxvB,MAC5Di2B,kBAAkB,GAjBHxG,kFAqBAyG,GAAW,IAAAC,EASxBxG,KAAKH,MAPPgG,uBACEsE,EAHwB3D,EAGxB2D,uBACAC,EAJwB5D,EAIxB4D,0BACAC,EALwB7D,EAKxB6D,oBACAC,EANwB9D,EAMxB8D,uBACAxX,EAPwB0T,EAOxB1T,mBAPwByX,EAUoBvK,KAAK7oB,MAA7C4yB,EAVoBQ,EAUpBR,gBAAiBE,EAVGM,EAUHN,mBAErB1D,EAAUV,uBAAuBwE,sBAAwBA,GACvDN,EAAgBvX,IAAIM,IACtBqX,EAAuBrX,EAAoBiX,EAAgBxgC,IAAIupB,IAInE,IAAM0X,EAAyBjE,EAAUV,uBAAuB/S,mBAE9D0X,IAA2B1X,GAC3BuX,GACA9D,EAAUV,uBAAuBwE,qBAE7BN,EAAgBvX,IAAIgY,IACtBL,EAAuBK,EAAwBT,EAAgBxgC,IAAIihC,IAInEjE,EAAUV,uBAAuByE,yBAA2BA,GAC1DL,EAAmBzX,IAAIM,IACzBsX,EAA0BtX,EAAoBmX,EAAmB1gC,IAAIupB,IAKvE0X,IAA2B1X,GAC3BwX,GACA/D,EAAUV,uBAAuByE,wBAE7BL,EAAmBzX,IAAIgY,IACzBJ,EACEI,EACAP,EAAmB1gC,IAAIihC,IAKzBxK,KAAKH,MAAMxvB,OAASk2B,EAAUl2B,OAChC2vB,KAAK2G,SAAS,CAAEoD,gBAAiB/J,KAAKgK,0BAA0BhK,KAAKH,MAAMxvB,QAC3E2vB,KAAK2G,SAAS,CAAEsD,mBAAoBjK,KAAKkK,6BAA6BlK,KAAKH,MAAMxvB,2DAI3DA,GACxB,OAAOqE,eACLrE,EACG9G,IAAI,SACJ6G,IAAI,SAAAiD,GAAI,MAAI,CAACA,EAAK9J,IAAI,MAAOiH,GAA0B6C,EAAK9J,IAAI,uEAI1C8G,GAC3B,OAAOqE,eACLrE,EACG9G,IAAI,SACJ6G,IAAI,SAAAiD,GAAI,MAAI,CAACA,EAAK9J,IAAI,MAAOiH,GAA0B6C,EAAK9J,IAAI,8DAIlDsP,GAAQ,IAAA+tB,EAAA5G,KAC3B,OAAO,kBAAM4G,EAAK/G,MAAMgG,uBAAuB4E,iBAAiB5xB,gDAG9CA,GAAQ,IAAAiuB,EAAA9G,KAC1B,OAAO,kBAAM8G,EAAKjH,MAAMgG,uBAAuB6E,gBAAgB7xB,iDAG5C,IAAA0uB,EAAAvH,KACnBl3B,WAAW,WACJy+B,EAAKpwB,MAAMmvB,iBAGdiB,EAAKZ,SAAS,CAAEL,kBAAkB,IAFlCiB,EAAK1H,MAAMgG,uBAAuB8E,2BAInC,iDAGiB3D,GAAO,IACnB+C,EAAoB/J,KAAK7oB,MAAzB4yB,gBAEoBjX,EACxBkN,KAAKH,MADPgG,uBAA0B/S,mBAG5BkN,KAAK2G,SAAS,CACZoD,gBAAiBA,EAAgB3vB,IAAI0Y,EAAoBkU,EAAMtE,OAAOxtB,0DAIjD8xB,GAAO,IACtBiD,EAAuBjK,KAAK7oB,MAA5B8yB,mBAEoBnX,EACxBkN,KAAKH,MADPgG,uBAA0B/S,mBAG5BkN,KAAK2G,SAAS,CACZsD,mBAAoBA,EAAmB7vB,IAAI0Y,EAAoBkU,EAAMtE,OAAOxtB,kEAO9E8qB,KAAK2G,SAAS,CAAEL,kBAAkB,IAHH,IAKvByD,EAAoB/J,KAAK7oB,MAAzB4yB,gBAEoBjX,EACxBkN,KAAKH,MADPgG,uBAA0B/S,mBAEtB8X,EAAiBb,EAAgBxgC,IAAIupB,GAErCoU,EAAiBlH,KAAKmH,SAASC,eACrCpH,KAAK2G,SAAS,CACZoD,gBAAiBA,EAAgB3vB,IAC/B0Y,EACA8X,EAAezoB,UAAU,EAAG+kB,GAC1Bz4B,KACAm8B,EAAezoB,UAAU6d,KAAKmH,SAASE,cAAgBH,MAI7DlH,KAAKmH,SAASG,oEAIdtH,KAAK2G,SAAS,CAAEL,kBAAkB,IADA,IAG1B2D,EAAuBjK,KAAK7oB,MAA5B8yB,mBAEoBnX,EACxBkN,KAAKH,MADPgG,uBAA0B/S,mBAEtB+X,EAAoBZ,EAAmB1gC,IAAIupB,GAE3CoU,EAAiBlH,KAAKmH,SAASC,eACrCpH,KAAK2G,SAAS,CACZsD,mBAAoBA,EAAmB7vB,IACrC0Y,EACA+X,EAAkB1oB,UAAU,EAAG+kB,GAC7Bz4B,KACAo8B,EAAkB1oB,UAAU6d,KAAKmH,SAASE,cAAgBH,MAIhElH,KAAKmH,SAASG,kDAEEH,GAChBnH,KAAKmH,SAAWA,0CAGF,IAAA2D,EAAA9K,KAAAM,EASVN,KAAKH,MAPPxvB,EAFYiwB,EAEZjwB,KAFYm3B,EAAAlH,EAGZuF,uBACE/S,EAJU0U,EAIV1U,mBACAuX,EALU7C,EAKV6C,oBACAC,EANU9C,EAMV8C,uBACA7C,EAPUD,EAOVC,qBAPUsD,EAUkC/K,KAAK7oB,MAA7C4yB,EAVMgB,EAUNhB,gBAAiBE,EAVXc,EAUWd,mBAEzB,OAAO55B,EAAK9G,IAAI,SAAS6G,IAAI,SAAAiD,GAC3B,IAAM23B,EAAiB33B,EAAK9J,IAAI,QAAUupB,EACpCmY,EAAqB5I,KAAW,CACpC6I,qCAAsC73B,EAAK9J,IAAI,cAC/C4hC,gCAAiC93B,EAAK9J,IAAI,cAC1C6hC,4BAA6BJ,IAG/B,OACEvL,EAAAzD,EAAA0D,cAAA,MAAIzqB,IAAK5B,EAAK9J,IAAI,MAAO2L,MAAO7B,EAAK9J,IAAI,gBACvCk2B,EAAAzD,EAAA0D,cAAA,OAAKC,UAAWsL,EAAoB9J,QAAS2J,EAAKO,qBAAqBh4B,EAAK9J,IAAI,QAC7E8J,EAAK9J,IAAI,eACRk2B,EAAAzD,EAAA0D,cAACyJ,GAAD,CACEhI,QAAS2J,EAAKQ,oBAAoBj4B,EAAK9J,IAAI,OAC3C4N,MAAO9D,EAAK9J,IAAI,mBAGnByhC,GAAkBX,EACjB5K,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,mCACbF,EAAAzD,EAAA0D,cAAA,YACEoI,WAAS,EACTnI,UAAU,WACVlO,KAAK,IACL0W,IAAK2C,EAAK1C,kBACVlzB,MAAO60B,EAAgBxgC,IAAI8J,EAAK9J,IAAI,OACpCw+B,OAAQ+C,EAAK9C,mBACbC,SAAU6C,EAAKS,wBAEjB9L,EAAAzD,EAAA0D,cAAA,OACEC,UAAU,2CACVwB,QAAS2J,EAAKU,gCAEd/L,EAAAzD,EAAA0D,cAAA,KAAGC,UAAU,sCAJf,qBAQAoK,EAAgBxgC,IAAI8J,EAAK9J,IAAI,OAC/Bk2B,EAAAzD,EAAA0D,cAAC4I,GAAD,CACEn4B,MAAOkD,EAAK9J,IAAI,aAChBs8B,uBAAwBiF,EAAKjL,MAAMgG,yBAGrCpG,EAAAzD,EAAA0D,cAAA,qBAGJD,EAAAzD,EAAA0D,cAAC6I,GAAA,cAAD,CAAU1T,SAAUmW,IAAmBvD,GACrChI,EAAAzD,EAAA0D,cAAC+J,GAAD,CAAkB5D,uBAAwBiF,EAAKjL,MAAMgG,0BAEtDmF,GAAkBV,EACjB7K,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,iCACbF,EAAAzD,EAAA0D,cAAA,YACEoI,WAAS,EACTnI,UAAU,WACVlO,KAAK,IACL0W,IAAK2C,EAAK1C,kBACVlzB,MAAO+0B,EAAmB1gC,IAAI8J,EAAK9J,IAAI,OACvCw+B,OAAQ+C,EAAK9C,mBACbC,SAAU6C,EAAKW,2BAEjBhM,EAAAzD,EAAA0D,cAAA,OACEC,UAAU,yCACVwB,QAAS2J,EAAKY,mCAEdjM,EAAAzD,EAAA0D,cAAA,KAAGC,UAAU,sCAJf,qBASFF,EAAAzD,EAAA0D,cAAC4I,GAAD,CACEn4B,MAAOkD,EAAK9J,IAAI,YAChBs8B,uBAAwBiF,EAAKjL,MAAMgG,6DAS7C,OACEpG,EAAAzD,EAAA0D,cAACkD,EAAA,SAAD,KACG5C,KAAKH,MAAMxvB,KAAK9G,IAAI,aACnBk2B,EAAAzD,EAAA0D,cAAA,MAAIC,UAAU,sEACXK,KAAK2L,iBAGRlM,EAAAzD,EAAA0D,cAAA,MAAIC,UAAU,gCAAgCK,KAAK2L,yBAvRvBvI,iBCVvBwI,WAAA,SAAA79B,GAAkF,IAA/EsC,EAA+EtC,EAA/EsC,KAA+Eu1B,EAAA73B,EAAzE83B,uBAA0BgG,EAA+CjG,EAA/CiG,iBAAkBpE,EAA6B7B,EAA7B6B,qBAG5Dhd,EAAiBpa,EAAK9G,IAAI,kBAC1BohB,EAAkBta,EAAK9G,IAAI,mBAEjC,OACEk2B,EAAAzD,EAAA0D,cAAA,QAAMC,UAAU,oCAAoCwB,QANlC,kBAAOsG,OAAuB,EAASoE,EAAiBx7B,EAAK9G,IAAI,WAO9EkhB,GAAkB/d,GAAa+d,KAC/BE,GACD8U,EAAAzD,EAAA0D,cAACkD,EAAA,SAAD,KACG,KACAl2B,GAAaie,OCRT2d,GAAA,SAAAv6B,GAAuC,IAChD4xB,EADYxvB,EAAoCpC,EAApCoC,MAAO01B,EAA6B93B,EAA7B83B,uBAGvB,OACEpG,EAAAzD,EAAA0D,cAAA,YACGvvB,EAAMC,IAAI,SAAAC,GACT,OAAQA,EAAK9G,IAAI,SACf,IAAK,OACH,OAAO8G,EAAK9G,IAAI,YAClB,IAAK,OACH,IAAMqgB,EAAMvZ,EAAKC,MAAM,CAAC,WAAY,QAC9BsX,EAAQvX,EAAKC,MAAM,CAAC,WAAY,WAAasZ,EAEnD,OACE6V,EAAAzD,EAAA0D,cAAA,KAAGzqB,IAAK5E,EAAK9G,IAAI,MAAOk5B,KAAM7Y,EAAK8Y,OAAO,SAASC,IAAI,uBACpD/a,GAGP,IAAK,oBAMH,OALA+X,EAAY0C,KAAW,iCAAkC,CACvDyJ,2CAC2C,MAAzCjD,SAASx4B,EAAK9G,IAAI,cAAe,MAInCk2B,EAAAzD,EAAA0D,cAAA,QAAMzqB,IAAK5E,EAAK9G,IAAI,MAAOo2B,UAAWA,GAAtC,IACItvB,EAAK9G,IAAI,cADb,MAKJ,IAAK,kBAOH,OANAo2B,EAAY0C,KAAW,iCAAkC,CACvDyJ,2CACkC,KAAhCz7B,EAAKC,MAAM,CAAC,WAAY,KACxBD,EAAKC,MAAM,CAAC,WAAY,MAAQD,EAAKC,MAAM,CAAC,WAAY,MAI1DmvB,EAAAzD,EAAA0D,cAAA,QAAMzqB,IAAK5E,EAAK9G,IAAI,MAAOo2B,UAAWA,GAAtC,IACItvB,EAAKC,MAAM,CAAC,WAAY,IAD5B,IACkCD,EAAKC,MAAM,CAAC,WAAY,IAD1D,KAIJ,IAAK,QACH,OACEmvB,EAAAzD,EAAA0D,cAACqM,GAAD,CACE92B,IAAK5E,EAAK9G,IAAI,MACd0hB,MAAO5a,EACPw1B,uBAAwBA,IAG9B,IAAK,OACH,OACEpG,EAAAzD,EAAA0D,cAACsM,GAAD,CACE/2B,IAAK5E,EAAK9G,IAAI,MACd8G,KAAMA,EACNw1B,uBAAwBA,IAG9B,IAAK,gBAMH,OALAlG,EAAY0C,KACV,mCADoB,qCAAAh3B,OAEiBgF,EAAK9G,IAAI,gBAI9Ck2B,EAAAzD,EAAA0D,cAAA,QAAMzqB,IAAK5E,EAAK9G,IAAI,MAAOo2B,UAAWA,GACnCtvB,EAAK9G,IAAI,YAGhB,IAAK,YACH,OACEk2B,EAAAzD,EAAA0D,cAACkM,GAAD,CACE32B,IAAK5E,EAAK9G,IAAI,MACd8G,KAAMA,EACNw1B,uBAAwBA,IAG9B,QAEE,OADA1xB,QAAQhJ,MAAR,6CAAAE,OAA2DgF,EAAK9G,IAAI,UAC7D,QCzEb0iC,eACJ,SAAAA,EAAYpM,GAAO,IAAAC,EAAA,OAAAr4B,OAAAs4B,EAAA,EAAAt4B,CAAAu4B,KAAAiM,GACjBnM,EAAAr4B,OAAAw4B,EAAA,EAAAx4B,CAAAu4B,KAAAv4B,OAAAy4B,EAAA,EAAAz4B,CAAAwkC,GAAA9L,KAAAH,KAAMH,IAENpuB,IAAE2uB,QAAF34B,OAAA44B,EAAA,EAAA54B,CAAAq4B,GAAgB,CACd,YACA,qBACA,oBACA,mBACA,qBACA,oBACA,wBACA,kBACA,uBACA,0BAGFA,EAAK3oB,MAAQ,CACX+0B,WAAYpM,EAAKqM,kBAAkBtM,EAAM3pB,QACzCk2B,eAAgB,KAChB9F,kBAAkB,GAnBHxG,qFAwBbE,KAAKqM,cACPrM,KAAK2G,SAAS,CAAEyF,eAAgBpM,KAAKqM,aAAaC,0DAKpDtM,KAAKuM,iEAGYhG,GAAW,IAAAK,EAAA5G,KACpB9pB,EAAW8pB,KAAKH,MAAhB3pB,OAEJqwB,EAAUiG,aAAexM,KAAKH,MAAM2M,YACtCxM,KAAKH,MAAMx2B,IAAI+V,kBAAkBlJ,EAAO3M,IAAI,MAAOy2B,KAAK7oB,MAAM+0B,YAG5D3F,EAAUrwB,SAAW8pB,KAAKH,MAAM3pB,QAClC8pB,KAAK2G,SACH,CACEuF,WAAYlM,KAAKmM,kBAAkBnM,KAAKH,MAAM3pB,SAEhD,kBAAM0wB,EAAK2F,0DAKPE,GACRzM,KAAKqM,aAAeI,6CAGHC,GACjB1M,KAAK2M,UAAYD,4CAGDvF,GAChBnH,KAAKmH,SAAWA,4CAGAjxB,GAChB,IAAMsH,EAActH,EAAO5F,MAAM,CAAC,YAAa,gBACzCoN,EAAOxH,EAAO5F,MAAM,CAAC,YAAa,SAEpC47B,EAAah2B,EAAO5F,MAAM,CAAC,YAAa,aAU5C,OARMkN,IACJ0uB,EAAU,GAAA7gC,OAAMmS,EAAN,KAAAnS,OAAqB6gC,IAG3BxuB,GAAQA,EAAK9L,KAAO,IACxBs6B,EAAU,GAAA7gC,OAAM6gC,EAAN,MAAA7gC,OAAqBqS,EAAKnN,KAAK,KAA/B,MAGL27B,2CAGQlF,GAAO,IAAA1G,EAC8BN,KAAKH,MAAjD3pB,EADcoqB,EACdpqB,OAAQ02B,EADMtM,EACNsM,WAAYC,EADNvM,EACMuM,WAAY1L,EADlBb,EACkBa,QAElCA,EACJA,MAEIyL,GAAgB12B,EAAO3M,IAAI,YAAasjC,GAC1C7M,KAAKH,MAAMx2B,IAAIqV,mBAAmBxI,EAAO3M,IAAI,OAG/Cy2B,KAAKH,MAAMx2B,IAAIsV,aAAazI,EAAO3M,IAAI,gDAI3By9B,GAAO,IAAAhF,EAC+BhC,KAAKH,MAAjD3pB,EADa8rB,EACb9rB,OAAQ42B,EADK9K,EACL8K,uBAAwB3L,EADnBa,EACmBb,QAElCA,GACJA,IACA6F,EAAM+F,oBAEN/M,KAAKH,MAAMx2B,IAAIsV,aAAazI,EAAO3M,IAAI,OAEnCujC,GACF9M,KAAKH,MAAMx2B,IAAI0V,+DAKFioB,GAAO,IAAAF,EAAA9G,KAExBl3B,WAAW,WACJg+B,EAAK3vB,MAAMmvB,iBAGdQ,EAAKH,SAAS,CAAEL,kBAAkB,IAFlCQ,EAAKjH,MAAMx2B,IAAI8V,gBAIhB,+CAGa6nB,GAEhB,IAAMgG,EAAWhG,EAAMtE,OAAOxtB,MACxB+3B,EAAgBD,EAASA,EAAS/+B,OAAS,GAE/C+xB,KAAK7oB,MAAM+0B,aAAec,EAAS7qB,UAAU,EAAG6qB,EAAS/+B,OAAS,IAChD,OAAlBg/B,EAMFjN,KAAK2G,SAAS,CAAEuF,WAAYc,IAJ1BhN,KAAKH,MAAMx2B,IAAI8V,6DAOG6nB,GACpBA,EAAM+F,+DAGa30B,GACnB4nB,KAAKH,MAAMh2B,KAAKyC,cAAc,mBAAoB,CAAE8L,8DAGhC4uB,GAGpBhH,KAAK2G,SAAS,CAAEL,kBAAkB,IAHP,IAKnB4F,EAAelM,KAAK7oB,MAApB+0B,WACFhF,EAAiBlH,KAAKmH,SAASC,eACrCpH,KAAK2G,SAAS,CACZuF,WACEA,EAAW/pB,UAAU,EAAG+kB,GACxBz4B,KACAy9B,EAAW/pB,UAAU6d,KAAKmH,SAASE,cAAgBH,KAGvDlH,KAAKmH,SAASG,QAEdN,EAAM+F,mDAGC,IAAAG,EAQHlN,KAAKH,MANP3pB,EAFKg3B,EAELh3B,OACAi3B,EAHKD,EAGLC,MACAP,EAJKM,EAILN,WACAJ,EALKU,EAKLV,WACA/E,EANKyF,EAMLzF,qBACA2F,EAPKF,EAOLE,2BAEMhB,EAAmBpM,KAAK7oB,MAAxBi1B,eACF5uB,EAActH,EAAO5F,MAAM,CAAC,YAAa,gBAEzC+8B,EAAa,CACjBF,QACAG,UAAW,cAGb,OACE7N,EAAAzD,EAAA0D,cAAA,OACEC,UAAU,aACVwB,QAASnB,KAAKuN,iBACdpF,IAAKnI,KAAKwN,UACVnI,MAAO,CAAEpE,MAAOmM,EAA6B,GAAKhB,KAEhDI,GAAgBhvB,EAChBiiB,EAAAzD,EAAA0D,cAAA,QACEC,UAAW0C,KAAW,eAAD,iBAAAh3B,OAAkCmS,EAAYiwB,gBACnEtM,QAASnB,KAAK0N,iBAEblwB,GAGH,GAGDgvB,EACC/M,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,8BACbF,EAAAzD,EAAA0D,cAAA,YACEoI,WAAS,EACTnI,UAAU,WACVlO,KAAK,IACL0W,IAAKnI,KAAKoI,kBACVlzB,MAAO8qB,KAAK7oB,MAAM+0B,WAClBnE,OAAQ/H,KAAKgI,mBACbC,SAAUjI,KAAK2N,kBACfxM,QAASnB,KAAK4N,wBAEhBnO,EAAAzD,EAAA0D,cAAA,OACEC,UAAU,sCACVwB,QAASnB,KAAKqI,uBAEd5I,EAAAzD,EAAA0D,cAAA,KAAGC,UAAU,sCAJf,qBASFF,EAAAzD,EAAA0D,cAAA,WACED,EAAAzD,EAAA0D,cAAA,QAAM2F,MAAOgI,EAAYlF,IAAKnI,KAAK6N,oBACjCpO,EAAAzD,EAAA0D,cAAC4I,GAAD,CACEn4B,MAAO+F,EAAO5F,MAAM,CAAC,YAAa,UAClCu1B,uBAAwB,CACtBgG,iBAAkB7L,KAAK8N,qBACvBrG,2BAGFvxB,EAAO3M,IAAI,WAAaqjC,EAAa,MAAQ,IAGhD12B,EAAO5F,MAAM,CAAC,YAAa,SAASsB,KAAO,GAC1C6tB,EAAAzD,EAAA0D,cAAA,WACGxpB,EACE5F,MAAM,CAAC,YAAa,SACpBy9B,QACAC,SACA91B,OAAO,SAAAyF,GAAG,QAAMA,IAChBvN,IAAI,SAAAuN,GAAG,OACN8hB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,aAAa1qB,IAAK0I,GAC9BA,eA/OCylB,iBA4QTE,eAjBS,SAACnsB,EAAO0oB,GAC9B,MAAO,CACL2M,WACwC,UAAtCr1B,EAAM9N,IAAIC,QAAQC,IAAI,aACtB4N,EAAM9N,IAAIC,QAAQC,IAAI,sBAAwBs2B,EAAM3pB,OAAO3M,IAAI,MACjEujC,uBAAwB31B,EAAMtN,KAAKN,IAAI,0BACvCsjC,WAAY11B,EAAM9N,IAAIC,QAAQC,IAAI,sBAAwBs2B,EAAM3pB,OAAO3M,IAAI,QAIpD,SAAAV,GACzB,MAAO,CACLQ,IAAKk6B,YAAmB0K,EAAYplC,GACpCgB,KAAM05B,YAAmBC,EAAa36B,KAI3By6B,CAA6C2I,ICpRvCiC,8BACnB,SAAAA,EAAYrO,GAAO,IAAAC,EAAA,OAAAr4B,OAAAs4B,EAAA,EAAAt4B,CAAAu4B,KAAAkO,GACjBpO,EAAAr4B,OAAAw4B,EAAA,EAAAx4B,CAAAu4B,KAAAv4B,OAAAy4B,EAAA,EAAAz4B,CAAAymC,GAAA/N,KAAAH,KAAMH,IAENpuB,IAAE2uB,QAAF34B,OAAA44B,EAAA,EAAA54B,CAAAq4B,GAAgB,CAAC,yBAHAA,oFAMErc,GAAmB,IAAAmjB,EAAA5G,KACtC,OAAO,kBAAM4G,EAAK/G,MAAMsB,QAAQ1d,qCAGzB,IAAAqjB,EAAA9G,KACCpiB,EAAkBoiB,KAAKH,MAAvBjiB,cAER,OAA2B,IAAvBA,EAAchM,KACT,KAIP6tB,EAAAzD,EAAA0D,cAAA,WACG9hB,EAAcxN,IAAI,SAAC0N,EAAc+L,GAAf,OACjB4V,EAAAzD,EAAA0D,cAAA,OAAKzqB,IAAK6I,EAAavU,IAAI,MAAOo2B,UAAU,kCAC1CF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,uBAAuB7hB,EAAavU,IAAI,QAAvD,MACAk2B,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,2BAA2BwB,QAAS2F,EAAKgH,qBAAqBjkB,IAC1End,GAAaoR,EAAavU,IAAI,0BAxBF65B,kBCF5B+K,WAAA,SAAApgC,GAA2E,IAAxEiQ,EAAwEjQ,EAAxEiQ,kBAAmBypB,EAAqD15B,EAArD05B,qBAAsBoE,EAA+B99B,EAA/B89B,iBAAkBuC,EAAargC,EAAbqgC,OAAazJ,EACtCC,oBAAS,GAD6BC,EAAAp9B,OAAAqJ,EAAA,EAAArJ,CAAAk9B,EAAA,GACjF0J,EADiFxJ,EAAA,GAC9DyJ,EAD8DzJ,EAAA,GAKxF,OAAkC,IAA3B7mB,EAAkBpM,KAAa,KACpC6tB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,2BACbF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,0BAA0BwB,QAJhB,kBAAMmN,GAAsBD,KAIrD,eAEGA,EAAoB,MAAQ,KAG7BA,GACA5O,EAAAzD,EAAA0D,cAACkD,EAAA,SAAD,KACG5kB,EAAkB5N,IAAI,SAAA6N,GAAgB,OACrCwhB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,gCAAgC1qB,IAAKgJ,EAAiB1U,IAAI,OACvEk2B,EAAAzD,EAAA0D,cAAA,OACEC,UAAU,0BACVwB,QAASsG,EAAuB,KAAO2G,GAFzC,IAIInwB,EAAiB1U,IAAI,YAJzB,KAMAk2B,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,wBACbF,EAAAzD,EAAA0D,cAAC4I,GAAD,CACEn4B,MAAO8N,EAAiB1U,IAAI,UAAY,GACxCs8B,uBAAwB,CACtBgG,mBACApE,8BAOVhI,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,0BAA0BwB,QAASiN,GAAlD,aCrBJG,eACJ,SAAAA,EAAY1O,GAAO,IAAAC,EAAA,OAAAr4B,OAAAs4B,EAAA,EAAAt4B,CAAAu4B,KAAAuO,GACjBzO,EAAAr4B,OAAAw4B,EAAA,EAAAx4B,CAAAu4B,KAAAv4B,OAAAy4B,EAAA,EAAAz4B,CAAA8mC,GAAApO,KAAAH,KAAMH,IAENpuB,IAAE2uB,QAAF34B,OAAA44B,EAAA,EAAA54B,CAAAq4B,GAAgB,CACd,YACA,oBACA,0BACA,wBACA,0BACA,6BACA,2BACA,uBACA,uBACA,0BACA,0BACA,sBACA,uBACA,+BACA,8BACA,6BACA,kCACA,iCACA,gCACA,uBACA,uBACA,uBACA,wBACA,mCACA,2BAGFA,EAAK3oB,MAAQ,CACXq3B,iBAAkB1O,EAAK2O,wBAAwB5O,EAAM3pB,QACrDk2B,eAAgB,MAjCDtM,qFAsCbE,KAAKqM,cACPrM,KAAK2G,SAAS,CAAEyF,eAAgBpM,KAAKqM,aAAaC,0DAKpDtM,KAAKuM,iEAGYhG,GAAW,IAAAK,EAAA5G,KACpB9pB,EAAW8pB,KAAKH,MAAhB3pB,OAEJqwB,EAAUiG,aAAexM,KAAKH,MAAM2M,YACtCxM,KAAKH,MAAMx2B,IAAIiW,wBAAwBpJ,EAAO3M,IAAI,MAAOy2B,KAAK7oB,MAAMq3B,kBAGlEjI,EAAUrwB,SAAW8pB,KAAKH,MAAM3pB,QAClC8pB,KAAK2G,SACH,CACE6H,iBAAkBxO,KAAKyO,wBAAwBzO,KAAKH,MAAM3pB,SAE5D,kBAAM0wB,EAAK2F,wEAKOr2B,GACtB,IAAM0H,EAAgB1H,EAAO3M,IAAI,iBAC3ByU,EAAoB9H,EAAO3M,IAAI,qBAE/BmlC,EAAoB9wB,EACvBxN,IACC,SAAA0N,GAAY,SAAAzS,OACPyS,EAAavU,IAAI,QADV,MAAA8B,OACsBqB,GAAaoR,EAAavU,IAAI,iBAEjEgH,KAAK,KAEJo+B,EAAwB,GACxB3wB,EAAkBpM,KAAO,IAC3B+8B,GAAyB,iBACzBA,GAAyB3wB,EACtB5N,IACC,SAAA6N,GAAgB,UAAA5S,OACV4S,EAAiB1U,IAAI,YADX,MAAA8B,OAC2BmF,GACvCyN,EAAiB1U,IAAI,aAG1BgH,KAAK,MACRo+B,GAAyB,WAG3B,IAAIC,EAAkB,GAQtB,OAPMF,IACJE,GAAmBF,EAAoB,MAEnCC,IACJC,GAAmBD,EAAwB,MAE7CC,GAAmB14B,EAAO3M,IAAI,4DAId49B,GAChBnH,KAAKmH,SAAWA,oCAGRsF,GACRzM,KAAKqM,aAAeI,kDAGEzF,GACtBhH,KAAK2G,SAAS,CAAE6H,iBAAkBxH,EAAMtE,OAAOxtB,sDAG3B4C,GACpBkoB,KAAKH,MAAMx2B,IAAIuV,uBAAuB9G,qDAItCkoB,KAAKH,MAAMx2B,IAAI8V,kEAGUrH,EAAQiJ,GACjCif,KAAKH,MAAMx2B,IAAIyX,qBAAqBhJ,EAAQiJ,sDAI5Cif,KAAKH,MAAMx2B,IAAI4V,cAAc,wDAI7B+gB,KAAKH,MAAMx2B,IAAIiX,gEAIf0f,KAAKH,MAAMx2B,IAAIkX,mEAIfyf,KAAKH,MAAMx2B,IAAImX,sEAIfwf,KAAKH,MAAMx2B,IAAIoX,gEAGGzH,GAClBgnB,KAAKH,MAAMx2B,IAAI+Y,qBAAqBpJ,gDAGjBA,GACnBgnB,KAAKH,MAAMx2B,IAAIwV,sBAAsB7F,0DAIrCgnB,KAAKH,MAAMx2B,IAAI4V,cAAc,oEAI7B+gB,KAAKH,MAAMx2B,IAAI8V,kEAGUnG,EAAY+H,GACrCif,KAAKH,MAAMx2B,IAAIgZ,qBAAqBrJ,EAAY+H,6DAIhDif,KAAKH,MAAMx2B,IAAI4V,cAAc,0EAI7B+gB,KAAKH,MAAMx2B,IAAI8V,qEAGanG,EAAY+H,GACxCif,KAAKH,MAAMx2B,IAAIiZ,wBAAwBtJ,EAAY+H,kDAInDif,KAAKH,MAAMx2B,IAAIoZ,uEAIfud,KAAKH,MAAMx2B,IAAIqZ,8DAGItK,GACnB4nB,KAAKH,MAAMh2B,KAAKyC,cAAc,mBAAoB,CAAE8L,8DAGhCgN,GAAG,IAAA0hB,EAAA9G,KACvB5a,EAAEypB,iBADqB,IAGfL,EAAqBxO,KAAK7oB,MAA1Bq3B,iBACFtH,EAAiBlH,KAAKmH,SAASC,eAC/Bz6B,EAAY8B,KACZqgC,EAAe5H,EAAiBv6B,EAAUsB,OAC1C8gC,EACJP,EAAiBrsB,UAAU,EAAG+kB,GAC9Bv6B,EACA6hC,EAAiBrsB,UAAU6d,KAAKmH,SAASE,cAAgBH,GAC3DlH,KAAK2G,SAAS,CAAE6H,iBAAkBO,GAAW,WAC3CjI,EAAKK,SAAS6H,kBAAkBF,EAAcA,8DAIjB94B,GAAU,IAAAuxB,EAAAvH,KACzC,OAAO,SAAAvc,GAAiB,OACtB8jB,EAAK1H,MAAMh2B,KAAKyC,cAAc,mBAAoB,CAAE0J,WAAUyN,wEAGzC,IACfvN,EAAW8pB,KAAKH,MAAhB3pB,OACR8pB,KAAKH,MAAMh2B,KAAKyC,cAAc,uBAAwB,CAAE0J,SAAUE,EAAO3M,IAAI,yCAGtE,IAAAuhC,EAAA9K,KAAAM,EAYHN,KAAKH,MAVP3pB,EAFKoqB,EAELpqB,OACA+4B,EAHK3O,EAGL2O,UACAC,EAJK5O,EAIL4O,YACA1C,EALKlM,EAKLkM,WACAhb,EANK8O,EAML9O,oBACAkV,EAPKpG,EAOLoG,gBACAe,EARKnH,EAQLmH,qBACA3U,EATKwN,EASLxN,mBACAuX,EAVK/J,EAUL+J,oBACAC,EAXKhK,EAWLgK,uBAEM8B,EAAmBpM,KAAK7oB,MAAxBi1B,eAER,IAAKl2B,EAAO3M,IAAI,UACd,OAAOk2B,EAAAzD,EAAA0D,cAAA,YAGT,IAAMyP,EAAmBnP,KAAK7oB,MAAMq3B,iBAAiBjmB,MAAM,QACrD6mB,EAAYD,EAAmBA,EAAiB,GAAK,GACrDE,EAAeJ,EAAY,GAAK,GAChCK,EAAa,GAAKJ,EAExB,OACEzP,EAAAzD,EAAA0D,cAAA,OACEC,UAAU,uCACVwI,IAAKnI,KAAKwN,UACVnI,MAAO,CAAEpE,MAAOmL,EAAgBmD,WAAU,IAAAlkC,OAAMikC,EAAN,QAEzC9C,EACC/M,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,kCACbF,EAAAzD,EAAA0D,cAAA,YACEoI,WAAS,EACTnI,UAAU,WACVlO,KAAMrgB,KAAKo+B,IAAIH,EAAcrP,KAAK7oB,MAAMq3B,iBAAiBt8B,MAAM,MAAMjE,QACrEk6B,IAAKnI,KAAKoI,kBACVlzB,MAAO8qB,KAAK7oB,MAAMq3B,iBAClBvG,SAAUjI,KAAKyP,wBACfC,QAAS,SAAAtqB,GACP,IAAMsd,EAAStd,EAAEsd,OACjB55B,WAAW,WACT45B,EAAOiN,UAAYjN,EAAOkN,cACzB,IAELC,UAAW,SAAAzqB,GACT,IAAMsd,EAAStd,EAAEsd,OACjB,GAAIA,GAAoB,UAAVtd,EAAEnQ,IAAiB,CAC/BmQ,EAAEypB,iBACF,IAAMiB,EAAiBpN,EAAOxtB,MACxB66B,EAAgBrN,EAAO0E,eACvB4I,EAAaF,EAAe3tB,UAAU,EAAG4tB,GACzCE,EAAYH,EAAe3tB,UAAU4tB,GACrCG,EAAc,KAAOd,EACrBruB,EAAWivB,EAAaE,EAAcD,EAC5CvN,EAAOxtB,MAAQ6L,EACf2hB,EAAOsM,kBACLe,EAAgBG,EAAYjiC,OAC5B8hC,EAAgBG,EAAYjiC,QAEL,IAArBgiC,EAAUhiC,SACZy0B,EAAOiN,UAAYjN,EAAOkN,cAG5B9E,EAAKnE,SAAS,CAAE6H,iBAAkBztB,SAM1C0e,EAAAzD,EAAA0D,cAACkD,EAAA,SAAD,KACEnD,EAAAzD,EAAA0D,cAACyQ,GAAD,CACEvyB,cAAe1H,EAAO3M,IAAI,iBAC1B43B,QAASnB,KAAKoQ,iCAAiCl6B,EAAO3M,IAAI,SAE5Dk2B,EAAAzD,EAAA0D,cAACyO,GAAD,CACEnwB,kBAAmB9H,EAAO3M,IAAI,qBAC9BsiC,iBAAkB7L,KAAK8N,qBACvBrG,qBAAsBA,EACtB2G,OAAQpO,KAAKqQ,yBAEf5Q,EAAAzD,EAAA0D,cAAC4I,GAAD,CACEn4B,MAAO+F,EAAO3M,IAAI,eAClBs8B,uBAAwB,CACtBgB,kBAAmB7G,KAAKsQ,sBACxB9e,oBAAqBA,EACrBkV,gBAAiBA,EACjBK,oBAAqB/G,KAAKuQ,wBAC1B9J,uBAAwBzG,KAAKwQ,2BAC7B1K,qBAAsB9F,KAAKyQ,yBAC3B1K,iBAAkB/F,KAAK0Q,qBACvB1K,iBAAkBhG,KAAK2Q,qBACvB1K,oBAAqBjG,KAAK4Q,wBAC1B1K,oBAAqBlG,KAAK6Q,wBAC1BnG,gBAAiB1K,KAAKsL,oBACtBb,iBAAkBzK,KAAKqL,qBACvB3B,yBAA0B1J,KAAK8Q,6BAC/BnG,wBAAyB3K,KAAK+Q,4BAC9B5G,uBAAwBnK,KAAKgR,2BAC7BrH,4BAA6B3J,KAAKiR,gCAClCC,2BAA4BlR,KAAKmR,+BACjC/G,0BAA2BpK,KAAKoR,8BAChCxH,iBAAkB5J,KAAKqR,qBACvBxH,iBAAkB7J,KAAKsR,qBACvBxe,mBAAoBA,EACpBuX,oBAAqBA,EACrBC,uBAAwBA,EACxBuB,iBAAkB7L,KAAK8N,qBACvBrG,mCAnUYrE,iBAkWbE,eArBS,SAACnsB,EAAO0oB,GAC9B,MAAO,CACL2M,WACwC,gBAAtCr1B,EAAM9N,IAAIC,QAAQC,IAAI,aACtB4N,EAAM9N,IAAIC,QAAQC,IAAI,sBAAwBs2B,EAAM3pB,OAAO3M,IAAI,MACjEsjC,WAAY11B,EAAM9N,IAAIC,QAAQC,IAAI,sBAAwBs2B,EAAM3pB,OAAO3M,IAAI,MAC3EioB,oBAAqBra,EAAM9N,IAAIC,QAAQC,IAAI,uBAC3Cm9B,gBAAuD,UAAtCvvB,EAAM9N,IAAIC,QAAQC,IAAI,YACvCupB,mBAAoB3b,EAAM9N,IAAIC,QAAQC,IAAI,sBAC1C8gC,oBAA2D,eAAtClzB,EAAM9N,IAAIC,QAAQC,IAAI,YAC3C+gC,uBAA8D,kBAAtCnzB,EAAM9N,IAAIC,QAAQC,IAAI,cAIvB,SAAAV,GACzB,MAAO,CACLQ,IAAKk6B,YAAmB0K,EAAYplC,GACpCgB,KAAM05B,YAAmBC,EAAa36B,KAI3By6B,CAA6CiL,ICjXvCgD,0MAGI5R,EAAWwB,GAChC,OACE1B,EAAAzD,EAAA0D,cAAA,OAAKyB,QAASA,EAASxB,UAAU,oDAC/BF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,2CACfF,EAAAzD,EAAA0D,cAAA,KAAGC,UAAWA,sCAKX,IAAAW,EAELN,KAAKH,MADC2R,EADDlR,EACCkR,qBAAsBC,EADvBnR,EACuBmR,2BAA4BxC,EADnD3O,EACmD2O,UAAWS,EAD9DpP,EAC8DoP,QAASgC,EADvEpR,EACuEoR,UAG9E,OACEjS,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,kCACbF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,6BACZK,KAAK2R,uBAAuB,0BAA2BH,GAExD/R,EAAAzD,EAAA0D,cAAA,QAAMC,UAAU,oCAEfK,KAAK2R,uBAAuB,oBAAqBF,GAElDhS,EAAAzD,EAAA0D,cAAA,QAAMC,UAAU,oCAEfsP,EACGjP,KAAK2R,uBAAuB,sBAAuBD,GACnD1R,KAAK2R,uBAAuB,wBAAyBjC,YA7BnBtM,kBCkB1CwO,eAIJ,SAAAA,EAAY/R,GAAO,IAAAC,EAAA,OAAAr4B,OAAAs4B,EAAA,EAAAt4B,CAAAu4B,KAAA4R,IACjB9R,EAAAr4B,OAAAw4B,EAAA,EAAAx4B,CAAAu4B,KAAAv4B,OAAAy4B,EAAA,EAAAz4B,CAAAmqC,GAAAzR,KAAAH,KAAMH,KAJRgS,iCAAmC,GAGhB/R,EAFnBgS,8BAAgC,GAK9BrgC,IAAE2uB,QAAF34B,OAAA44B,EAAA,EAAA54B,CAAAq4B,GAAgB,CACd,YACA,kBACA,kBACA,gBACA,iBACA,kBACA,mBACA,iBACA,oBACA,oBACA,2BACA,iCACA,sBACA,cACA,gBACA,qBACA,aACA,sBACA,yBAGFA,EAAK3oB,MAAQ,CACX46B,kBAAkB,EAClBC,WAAY,KACZC,WAAY,KACZC,aAAc,KACd9F,eAAgB,KAChB+F,0BAA0B,EAC1BC,mBAAoB,MAhCLtS,mFAqCbE,KAAKqM,cACPrM,KAAK2G,SAAS,CAAEyF,eAAgBpM,KAAKqM,aAAaC,gDAI5CD,GACRrM,KAAKqM,aAAeA,EACpBrM,KAAKH,MAAMwS,MAAMhG,2CAGHrF,EAAOsL,EAAOC,GACxBvS,KAAKH,MAAM4H,sBAGXzH,KAAKH,MAAM2M,YAITxF,EAAMtE,OAAO8P,QAAQ,gBAI3BxS,KAAK2G,SAAS,CACZqL,WAAYM,EACZL,WAAYM,2CAIDD,EAAOC,GAAO,IAAAhI,EACQvK,KAAK7oB,MAAhC66B,EADmBzH,EACnByH,WAAYC,EADO1H,EACP0H,WACD,OAAfD,IAIChS,KAAK7oB,MAAM46B,kBACV3gC,KAAKqhC,IAAIH,EAAQN,IAAehS,KAAK8R,+BACvC9R,KAAK2G,SAAS,CAAEoL,kBAAkB,IAIlC3gC,KAAKqhC,IAAIF,EAAQN,IAAejS,KAAK6R,iCAAmC,EAC1E7R,KAAK2G,SAAS,CAAEqL,WAAY,OAE5BhS,KAAK2G,SAAS,CAAEuL,aAAcI,6CAIlB,IAAAvH,EACuB/K,KAAK7oB,MAAlC66B,EADMjH,EACNiH,WAAYE,EADNnH,EACMmH,aAEpB,GAAMF,GAAgBE,EAAc,CAClC,IAAMQ,EAAgBR,EAAeF,EAEjCU,GAAiB1S,KAAK6R,kCACxB7R,KAAKH,MAAMx2B,IAAI0V,iBAAiBihB,KAAKH,MAAM3pB,OAAO3M,IAAI,QAGnD,EAAImpC,GAAiB1S,KAAK6R,kCAC7B7R,KAAK2G,SAAS,CACZwL,0BAA0B,EAC1BC,mBAAoBpS,KAAKqM,aAAasG,eAK5C3S,KAAK2G,SAAS,CACZqL,WAAY,KACZE,aAAc,KACdH,kBAAkB,+CAKpB/R,KAAK2G,SAAS,CACZqL,WAAY,KACZE,aAAc,KACdH,kBAAkB,4CAIN/K,GACdhH,KAAK4S,gBAAgB5L,EAAOA,EAAM6L,QAAS7L,EAAM8L,iDAGnC9L,GACdhH,KAAK+S,eAAe/L,EAAM6L,QAAS7L,EAAM8L,iDAIzC9S,KAAKgT,yDAILhT,KAAKiT,4DAGUjM,GACfhH,KAAK4S,gBAAgB5L,EAAOA,EAAMkM,eAAe,GAAGL,QAAS7L,EAAMkM,eAAe,GAAGJ,iDAGvE9L,GACdhH,KAAK+S,eAAe/L,EAAMkM,eAAe,GAAGL,QAAS7L,EAAMkM,eAAe,GAAGJ,kDAI7E9S,KAAKgT,4DAILhT,KAAKiT,6DAGWjM,GAChB,IAAMmM,EAAYnM,EAAMtE,OAAOyQ,UAC/B,GAAIA,EAAUh4B,SAAS,WAAag4B,EAAUh4B,SAAS,kBAAmB,KAAAmlB,EAC7BN,KAAKH,MAAxC3pB,EADgEoqB,EAChEpqB,OAAQ02B,EADwDtM,EACxDsM,WAAYC,EAD4CvM,EAC5CuM,YAExBD,GAAgB12B,EAAO3M,IAAI,YAAasjC,GAC1C7M,KAAKH,MAAMx2B,IAAIqV,mBAAmBxI,EAAO3M,IAAI,OAG/Cy2B,KAAKH,MAAMx2B,IAAIsV,aAAazI,EAAO3M,IAAI,2DAKzCy2B,KAAKH,MAAMx2B,IAAI4V,cAAc,kEAI7B+gB,KAAKH,MAAMx2B,IAAIoV,WAAWuhB,KAAKH,MAAM3pB,OAAO3M,IAAI,OAChDy2B,KAAKH,MAAMx2B,IAAI4V,cAAc,6DAI7B+gB,KAAKH,MAAMh2B,KAAKyC,cAAc,qDAI9B0zB,KAAKH,MAAMx2B,IAAI+W,YAAY4f,KAAKH,MAAM3pB,OAAO3M,IAAI,+CAIjDy2B,KAAKH,MAAMx2B,IAAI6S,6DAIf8jB,KAAKH,MAAMx2B,IAAIqW,iBAAiBsgB,KAAKH,MAAM3pB,OAAO3M,IAAI,4CAIlDy2B,KAAK7oB,MAAMg7B,0BACbnS,KAAKH,MAAMx2B,IAAIwW,aAAamgB,KAAKH,MAAM3pB,OAAO3M,IAAI,+DAItBoa,GAAc,IACpCzN,EAAW8pB,KAAKH,MAAhB3pB,OAEFk9B,EAAoCl9B,EACvC3M,IAAI,gBAAiB,IACrB0M,UAAU,SAAA6H,GAAY,OAAIA,EAAavU,IAAI,UAAYoa,KAEf,IAAvCyvB,GACFpT,KAAKH,MAAMx2B,IAAIqa,mBAAmBxN,EAAO3M,IAAI,MAAOoa,GACpDqc,KAAKH,MAAMh2B,KAAKyC,cAAc,mBAAoB,CAChD0J,SAAUE,EAAO3M,IAAI,MACrBka,kBAAmBvN,EAAO3M,IAAI,iBAAiBqI,QAGjDouB,KAAKH,MAAMh2B,KAAKyC,cAAc,mBAAoB,CAChD0J,SAAUE,EAAO3M,IAAI,MACrBka,kBAAmB2vB,IAIvBpT,KAAKH,MAAMx2B,IAAIoV,WAAWvI,EAAO3M,IAAI,qDAIrCy2B,KAAKqT,gCAAgC,2DAIrCrT,KAAKqT,gCAAgC,8CAG9B,IAAAzM,EAAA5G,KAAAgC,EAUHhC,KAAKH,MARP3pB,EAFK8rB,EAEL9rB,OACAi3B,EAHKnL,EAGLmL,MACAP,EAJK5K,EAIL4K,WACAC,EALK7K,EAKL6K,WACAyG,EANKtR,EAMLsR,YACAC,EAPKvR,EAOLuR,cACAtE,EARKjN,EAQLiN,UACAxH,EATKzF,EASLyF,qBAGIyH,EAAgBqE,EAClBr9B,EAAO3M,IAAI,gBAAkBgqC,EAAchqC,IAAI,gBAAkB,EACjE2M,EAAO3M,IAAI,gBAdRiqC,EAiBLxT,KAAK7oB,MADC66B,EAhBDwB,EAgBCxB,WAAYE,EAhBbsB,EAgBatB,aAAcH,EAhB3ByB,EAgB2BzB,iBAAkBI,EAhB7CqB,EAgB6CrB,yBAA0B/F,EAhBvEoH,EAgBuEpH,eAExEmD,EACFyC,GAAgBE,GAAgBH,EAC9BG,EAAeF,EACfG,EACA5M,mBAAQ,EAAI6G,EAAgB,CAAE5G,UAAW,MACzCD,kBAAO,EAAG,CAAEC,UAAW,MAEvBH,EAAQ,CACZoO,YAAa,GAAKvE,EAClBK,aACAmE,aAAcvB,EAA2B5M,kBAAO,EAAG,CAAEC,UAAW,MAAS,GAGrE7F,EAAY0C,KAAW,SAAU,CACrCsR,mBAAoB9G,EACpB+G,mBAAoBzB,IAGtB,OACE1S,EAAAzD,EAAA0D,cAAC+F,GAAA,OAAD,CAAQJ,MAAOA,EAAOK,OAAQ1F,KAAK6T,YAChC,SAAAC,GACC,IAAMC,EAAiBD,EAAkBvE,WACnCyE,EAAwBD,GAAkBnN,EAAKiL,iCAC/CoC,GACH,EAAIF,GAAkBnN,EAAKiL,iCAExBqC,EAAgBlL,GAAW,IAAK,IAAK,IAAK,GAC1CmL,EAAqBnL,GAAW,EAAG,IAAK,EAAG,GAC3CoL,EAAsBpL,GAAW,IAAK,EAAG,EAAG,GAE5CqL,EAAgC,CACpCpT,MAAO6S,EAAkBvE,WACzB+E,sBAAuB/O,kBAAOyO,EAAwB,EAAI,EAAG,CAAExO,UAAW,OAEtE+O,EAAiC,CACrCtT,OAAQ,EAAI6S,EAAkBvE,WAC9B+E,sBAAuB/O,kBAAO0O,EAAyB,EAAI,EAAG,CAAEzO,UAAW,OAGvEgP,EAAgB,CACpBC,QAASV,EAAiB,GAAK,GAAK,QAEhCW,EAAiB,CACrBD,SAAU,EAAIV,EAAiB,GAAK,GAAK,QAGnCL,EAAiCI,EAAjCJ,aAAiBiB,EA1BLltC,OAAAC,EAAA,EAAAD,CA0BqBqsC,EA1BrB,kBAgCpB,OAJI3B,IACFwC,EAAYzT,OAAS0F,EAAKzvB,MAAMi7B,mBAAqBsB,GAIrDjU,EAAAzD,EAAA0D,cAAA,OACEC,UAAWA,EACX0F,MAAOsP,EACPxM,IAAKvB,EAAK4G,UACVrM,QAASyF,EAAKgO,kBACdC,YAAajO,EAAKkO,gBAClBC,YAAanO,EAAKoO,gBAClBC,UAAWrO,EAAKsO,cAChBC,WAAYvO,EAAKwO,eACjBC,aAAczO,EAAK0O,iBACnBC,YAAa3O,EAAK4O,gBAClBC,WAAY7O,EAAK8O,eACjBC,cAAe/O,EAAKgP,mBAEpBnW,EAAAzD,EAAA0D,cAAC+F,GAAA,OAAD,CAAQJ,MAAOgP,GACZ,SAAAwB,GACC,IAAMC,EAAY,CAChB7U,MAAO4U,EAAsB5U,MAC7BuI,gBAAiBP,GACfT,GACE0L,EACAC,EACA0B,EAAsBvB,yBAK5B,OACE7U,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,8BAA8B0F,MAAOyQ,GAClDrW,EAAAzD,EAAA0D,cAAA,KACEC,UAAU,+EACV0F,MAAOmP,OAMjB/U,EAAAzD,EAAA0D,cAAC+F,GAAA,OAAD,CAAQJ,MAAOkP,GACZ,SAAAwB,GACC,IAAMC,EAAa,CACjB/U,MAAO8U,EAAuB9U,MAC9BuI,gBAAiBP,GACfT,GACE0L,EACAE,EACA2B,EAAuBzB,yBAK7B,OACE7U,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,+BAA+B0F,MAAO2Q,GACnDvW,EAAAzD,EAAA0D,cAAA,KACEC,UAAU,gFACV0F,MAAOqP,OAOjBjV,EAAAzD,EAAA0D,cAAA,OAAK2F,MAAO,CAAEkK,YAAa,GAAIpC,SAASxN,UAAU,kBAC/B,UAAhB2T,EAA0B,SAAM,KAEnC7T,EAAAzD,EAAA0D,cAACuW,GAAD,CACE//B,OAAQA,EACRi3B,MAAOA,EACPP,WAAYA,EACZC,WAAYA,EACZpF,qBAAsBA,IAGxBhI,EAAAzD,EAAA0D,cAAC6I,GAAA,cAAD,CACE1T,SAAUgY,IAAepF,EACzByO,aAAc,CAAE1Q,UAAW,KAC3BH,MAAO,CAAE8Q,YAAa5B,EAA+BtT,QAErDxB,EAAAzD,EAAA0D,cAAC0W,GAAD,CACE5E,qBAAsB5K,EAAKyP,yBAC3B5E,2BAA4B7K,EAAK0P,+BACjCrH,UAAWA,EACXsH,YAAa3P,EAAK4P,oBAClB9G,QAAS9I,EAAK6P,YACd/E,UAAW9K,EAAK8P,cAChBC,eAAgB/P,EAAKgQ,mBACrBC,gBAAiBjQ,EAAKkQ,oBACtBC,iBAAkBnQ,EAAKoQ,wBAI3BvX,EAAAzD,EAAA0D,cAACuX,GAAD,CACE/gC,OAAQA,EACR+4B,UAAWA,EACXC,YAAaA,EACbzH,qBAAsBA,cAzYjBrE,iBAqaNE,eAlBS,SAACnsB,EAAO0oB,GAC9B,IAAM0T,EAAkBp8B,EAAM9N,IAAIC,QAAQC,IAAI,mBAC1C4M,GAAagB,EAAM9N,IAAIC,QAAQC,IAAI,WAAY4N,EAAM9N,IAAIC,QAAQC,IAAI,oBACrE,KAEJ,MAAO,CACL+pC,YAAan8B,EAAMtN,KAAKN,IAAI,eAC5BgqC,gBACAtE,YAAasE,GAAiBA,EAAchqC,IAAI,QAAUs2B,EAAM3pB,OAAO3M,IAAI,MAC3EijC,aAAcr1B,EAAM9N,IAAIC,QAAQC,IAAI,cAIb,SAAAV,GAAQ,MAAK,CACtCQ,IAAKk6B,YAAmB0K,EAAYplC,GACpCgB,KAAM05B,YAAmBC,EAAa36B,KAGzBy6B,CAA6CsO,IC/atDsF,eACJ,SAAAA,EAAYrX,GAAO,IAAAC,EAAA,OAAAr4B,OAAAs4B,EAAA,EAAAt4B,CAAAu4B,KAAAkX,IACjBpX,EAAAr4B,OAAAw4B,EAAA,EAAAx4B,CAAAu4B,KAAAv4B,OAAAy4B,EAAA,EAAAz4B,CAAAyvC,GAAA/W,KAAAH,KAAMH,KAEDsX,WAAa,GAElB1lC,IAAE2uB,QAAF34B,OAAA44B,EAAA,EAAA54B,CAAAq4B,GAAgB,CAAC,oBALAA,kFAQAyG,GACjB,GAAIA,EAAU5Q,mBAAqBqK,KAAKH,MAAMlK,iBAAkB,CAC9D,IAAMyhB,EAAoBpX,KAAKmX,WAAWnX,KAAKH,MAAMlK,kBACrD,GAAMyhB,EAAmB,CACvB,IAAMC,EAAoBD,EAAkBE,wBACtCC,EAAiBC,SAASC,gBAAgBC,cAE5CL,EAAkBM,IAAuB,GAAjBJ,GAAwBF,EAAkBO,OAAS,IAC7ER,EAAkBS,2DAMV7hC,GAAU,IAAA4wB,EAAA5G,KACxB,OAAO,SAAAyM,GAAG,OAAK7F,EAAKuQ,WAAWnhC,GAAYy2B,oCAGpC,IAAA3F,EAAA9G,KAAAM,EACsEN,KAAKH,MAA1E9pB,EADDuqB,EACCvqB,QAAS4f,EADV2K,EACU3K,iBAAkBmiB,EAD5BxX,EAC4BwX,gBAAiBrQ,EAD7CnH,EAC6CmH,qBAE9CsQ,EAAmBhiC,EACtB3F,IAAI,SAAA8F,GACH,MAAO,CACLA,SACA8hC,WAAW,EACXpL,aACI12B,EAAO3M,IAAI,mBACwB,IAArC2M,EAAO3M,IAAI,iBAAiBqI,MACa,IAAzCsE,EAAO3M,IAAI,qBAAqBqI,QAGrCqmC,UAgCH,GA9BAF,EAAiBhwC,QAAQ,SAACmwC,EAAmBruB,GAC3C,IAAMvM,EAAe46B,EAAkBhiC,OAAO3M,IAAI,gBAE7BwuC,EAClBxhC,MAAM,EAAGsT,GACT8I,MACC,SAAAwlB,GAAmB,OAAIA,EAAoBjiC,OAAO3M,IAAI,iBAAmB+T,MAG3E46B,EAAkBF,WAAY,GAIhC,IADA,IAAMI,EAAmBL,EAAiBxhC,MAAMsT,EAAQ,GAElDwuB,EAAuB,EAC3BA,EAAuBD,EAAiBnqC,SACtCoqC,EACF,CACA,IAAMC,EAAkBF,EAAiBC,GACzC,GAAIC,EAAgBpiC,OAAO3M,IAAI,iBAAmB+T,EAChD,MAGF46B,EAAkBtL,YAAa,EAE/B0L,EAAgBN,UACdE,EAAkBhiC,OAAO3M,IAAI,WAAa2uC,EAAkBF,aAI5DF,EAAiB,CACrB,IAAMS,EAAqBR,EAAiB9hC,UAC1C,SAAAiiC,GAAiB,OAAIA,EAAkBhiC,OAAO3M,IAAI,QAAUuuC,IAGtCC,EAAiBxhC,MAAM,EAAGgiC,GAClCxwC,QAAQ,SAAAmwC,GAAiB,OAAKA,EAAkBF,WAAY,IAE5E,IAAM/lB,EAAgBvb,GAA4BX,EAAS+hC,GAClCC,EAAiBxhC,MAAMgiC,EAAqBtmB,EAAgB,GACpElqB,QAAQ,SAAAmwC,GAAiB,OAAKA,EAAkBF,WAAY,IAG/E,IAAMQ,EAAe,CACnB,wBACA,wBACA,wBACA,uBACA,yBACA,yBACA,uBACA,0BAGIC,EAA4BV,EAAiB7/B,OACjD,SAAAggC,GAAiB,OAAIA,EAAkBF,YAGnCrY,EAAY0C,KAAW,wBAAyB,CACpDqW,mCAAoCZ,IAEtC,OACErY,EAAAzD,EAAA0D,cAAA,OAAKC,UAAWA,GACb8Y,EAA0BroC,IAAI,SAAC8nC,EAAmBruB,GACjD,IAAM3T,EAASgiC,EAAkBhiC,OAC3Bi3B,EAAQqL,GAActiC,EAAO3M,IAAI,gBAAkB,GAAKivC,EAAavqC,QAE3E,OACEwxB,EAAAzD,EAAA0D,cAACiZ,GAAD,CACE1jC,IAAKiB,EAAO3M,IAAI,MAChB2M,OAAQA,EACRi3B,MAAOA,EACPP,WAAYsL,EAAkBtL,WAC9BC,WAAY32B,EAAO3M,IAAI,QAAUosB,EACjC0c,MAAOvL,EAAK8R,gBAAgB1iC,EAAO3M,IAAI,OACvCk+B,qBAAsBA,cAtHXrE,iBA2IVE,eAZS,SAACnsB,EAAO0oB,GAC9B,MAAO,CACL9pB,QAASoB,EAAM9N,IAAIC,QAAQC,IAAI,WAC/BosB,iBAAkBxe,EAAM9N,IAAIC,QAAQC,IAAI,oBACxCuuC,gBAAiB3gC,EAAM9N,IAAIC,QAAQC,IAAI,qBAIhB,SAAAV,GACzB,MAAO,IAGMy6B,CAA6C4T,IChJvC2B,8BACnB,SAAAA,EAAYhZ,GAAO,IAAAC,EAAA,OAAAr4B,OAAAs4B,EAAA,EAAAt4B,CAAAu4B,KAAA6Y,GACjB/Y,EAAAr4B,OAAAw4B,EAAA,EAAAx4B,CAAAu4B,KAAAv4B,OAAAy4B,EAAA,EAAAz4B,CAAAoxC,GAAA1Y,KAAAH,KAAMH,IAENpuB,IAAE2uB,QAAF34B,OAAA44B,EAAA,EAAA54B,CAAAq4B,GAAgB,CAAC,gBAHAA,6EAML,IAAAQ,EACoBN,KAAKH,MAA7BsB,EADIb,EACJa,QADIb,EACKwY,YAMjB3X,qCAGO,IAAA4X,EAAA/W,EAYHhC,KAAKH,MAVPvkB,EAFK0mB,EAEL1mB,SACA09B,EAHKhX,EAGLgX,YACAF,EAJK9W,EAIL8W,WACAG,EALKjX,EAKLiX,oBACAz9B,EANKwmB,EAMLxmB,OACA09B,EAPKlX,EAOLkX,oBACA7T,EARKrD,EAQLqD,MACA8T,EATKnX,EASLmX,QACAC,EAVKpX,EAULoX,kBACA/G,EAXKrQ,EAWLqQ,MAGI1S,EAAY0C,KAChB,MACA,cACA,qBACA6W,GAAuB,IAJGH,EAAA,CAMxBM,KAAM79B,EACN89B,SAAU99B,GAPc/T,OAAAS,EAAA,EAAAT,CAAAsxC,EAAA,MAAA1tC,OAQjBiQ,IAAcE,GARG/T,OAAAS,EAAA,EAAAT,CAAAsxC,EASxB,sCAAuCC,GATfvxC,OAAAS,EAAA,EAAAT,CAAAsxC,EAUxB,gBAAiBD,GAVOrxC,OAAAS,EAAA,EAAAT,CAAAsxC,EAWxB,+BAAgCv9B,GAXRu9B,IAetBQ,EAAmBlX,KACvB,MACA,QAFiC,MAAAh3B,OAG3B2tC,GACN,+BACA,CACEQ,wCAAyCP,EACzCQ,UAAWL,IAIf,OACE3Z,EAAAzD,EAAA0D,cAAA,UACEC,UAAWA,EACXwB,QAASnB,KAAKoF,YACdC,MAAOA,EACPzd,MAAOuxB,EACPhR,IAAKkK,KAEF72B,GAAUA,IACVw9B,GAAevZ,EAAAzD,EAAA0D,cAAA,KAAGC,UAAW4Z,YAlEEnW,kBC0X3BE,eAtBS,SAACnsB,EAAO0oB,GAC9B,MAAO,CACL2M,aAAcr1B,EAAM9N,IAAIC,QAAQC,IAAI,YACpCosB,iBAAkBxe,EAAM9N,IAAIC,QAAQC,IAAI,oBACxCuT,QAAS3F,EAAM9N,IAAIC,QAAQC,IAAI,WAC/BmwC,wBAAyBviC,EAAM9N,IAAIC,QAAQC,IAAI,mBAC/CioB,oBAAqBra,EAAM9N,IAAIC,QAAQC,IAAI,uBAC3CupB,mBAAoB3b,EAAM9N,IAAIC,QAAQC,IAAI,sBAC1CsqB,iBAAkB1c,EAAM+J,QAAQ3X,IAAI,mBAAoB,IAAI+Q,SAC5DhC,KAAMnB,EAAM9N,IAAIC,QAAQC,IAAI,QAC5Bb,UAAWyO,EAAMtN,KAAKN,IAAI,eAIH,SAAAV,GACzB,MAAO,CACLQ,IAAKk6B,YAAmB0K,EAAYplC,GACpCqY,QAASqiB,YAAmBoW,EAAgB9wC,GAC5CgB,KAAM05B,YAAmBC,EAAa36B,KAI3By6B,CA/WM,SAAAv1B,GAYf,IAXJ1E,EAWI0E,EAXJ1E,IACAssB,EAUI5nB,EAVJ4nB,iBACA9rB,EASIkE,EATJlE,KACAV,EAQI4E,EARJ5E,WACA0qB,EAOI9lB,EAPJ8lB,iBACAvb,EAMIvK,EANJuK,KACAkZ,EAKIzjB,EALJyjB,oBACAsB,EAII/kB,EAJJ+kB,mBACA0Z,EAGIz+B,EAHJy+B,WACA9jC,EAEIqF,EAFJrF,UACAkxC,EACI7rC,EADJ6rC,yBACIjV,EAC4DC,oBAAS,GADrEC,EAAAp9B,OAAAqJ,EAAA,EAAArJ,CAAAk9B,EAAA,GACGkV,EADHhV,EAAA,GAC6BiV,EAD7BjV,EAAA,GAAAG,EAEgEJ,oBAAS,GAFzEK,EAAAx9B,OAAAqJ,EAAA,EAAArJ,CAAAu9B,EAAA,GAEG+U,EAFH9U,EAAA,GAE+B+U,EAF/B/U,EAAA,GAMJrB,oBAAU,WACRv6B,EAAIgX,QACH,IAEHujB,oBAAU,WAGR,OAFA4T,SAASyC,cAAc,QAAQ5U,MAAM6U,cAAgB,OAE9C,kBAAO1C,SAASyC,cAAc,QAAQ5U,MAAM6U,cAAgB,SAGrE,IAAMC,EAAkBC,iBAAO,MAEzBC,EAA8BC,kBAClC,kBAASH,EAAgBI,QAAUJ,EAAgBI,QAAQjD,wBAA0B,MACrF,CAAC6C,EAAgBI,UAGbC,EAAgB,kBAClB7kB,EACEtsB,EAAIyW,aAAa6V,GACfnE,EACFnoB,EAAIsX,iBACJtX,EAAIsZ,kBAEJ83B,EAAkB,kBACpB9kB,EACEtsB,EAAI0W,eAAe4V,GACjBnE,EACFnoB,EAAIqX,mBACJrX,EAAIuZ,oBAEJ83B,EAAkB,kBACpB/kB,EACEtsB,EAAI2W,eAAe2V,GACjBnE,EACFnoB,EAAIuX,sBACJvX,EAAIwZ,oBAEJ83B,EAAmB,kBACrBhlB,EACEtsB,EAAI4W,gBAAgB0V,GAClBnE,EACFnoB,EAAIwX,uBACJxX,EAAIyZ,qBAEJ83B,EAA6B,kBAC/BjlB,EAAmBtsB,EAAI6W,gBAAgByV,GAAoBtsB,EAAI0Z,uBAE7D83B,EAA8B,kBAChCllB,EAAmBtsB,EAAI8W,iBAAiBwV,GAAoBtsB,EAAI2Z,wBAW9D83B,EAA+B,iBACpB,WAAf3xC,EAHsCgY,GAKlC0S,EAAiB3b,OACf,SAAAyD,GAAQ,OACNA,EAASpS,IAAI,6BACboS,EACGpS,IAAI,0BACJ6G,IAAI,SAAA2qC,GAAa,OAChBA,EAAc3oC,OAAOvD,WAAW,KAC5BksC,EAAc3oC,OACd,IAAM2oC,EAAc3oC,SAEzBiC,UAAUiE,GAAQ,IAAIlG,WAK7B4oC,EAA6B,kBAAMlB,GAA6BD,IAEhEoB,EAA+B,WAC9BlB,GAAsE,IAAxCe,IAA+BlpC,KAOlEooC,GAA+BD,GAN7B3uC,MAAK,wGAiNT,OACEq0B,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,uCACZ6M,EACC/M,EAAAzD,EAAA0D,cAAA,UAAQC,UAAU,8BAA8BwB,QAnP9B,kBAAM93B,EAAI8V,iBAmP5B,QAIAsgB,EAAAzD,EAAA0D,cAACkD,EAAA,SAAD,KACEnD,EAAAzD,EAAA0D,cAACwb,GAAD,CACE5/B,SAAS,QACT09B,YAAY,WACZI,kBAAmB1wC,EACnBowC,WAAYc,EACZzY,QApOS,kBAAM93B,EAAI8S,QAqOnBkpB,MAAO,CAAEC,QAASuU,GAA4BE,EAA6B,EAAI,GAC/EZ,QAAQ,iBAjKY,WAC5B,IAAMgC,EAAuB,CAC3B7V,QAASyU,EAA6B,EAAI,GAEvCF,IACHsB,EAAqBC,UAAY,QAGnC,IAAIC,EAAgB,EACdhB,IACJgB,EACE9vC,OAAO+vC,OAAOra,MAAQ,GACrBoZ,EAA4BkB,EAAIlB,EAA4BpZ,MAAQ,IAGzE,IAAMua,EAAiB,CACrBH,cAAe9V,kBAAOsU,EAA2BwB,EAAgB,EAAG,CAAE7V,UAAW,MACjFiW,cAAelW,kBAAOsU,EAA2B,IAAM,EAAG,CAAErU,UAAW,MACvEkW,iBAAkBnW,kBAAOsU,EAA2B,GAAK,EAAG,CAAErU,UAAW,MACzEmW,mBAAoBpW,kBAAOsU,EAA2B,GAAK,EAAG,CAC5DrU,UAAW,MAEboW,oBAAqBrW,kBAAOsU,EAA2B,IAAM,EAAG,CAC9DrU,UAAW,OAIXqW,EAAiB,KACjBC,EAAe,iBACfC,EAAiB,mBACjBC,EAAiB,mBACjBC,EAAkB,oBAetB,OAdMzqB,GACJqqB,EAAiB,QACjBC,EAAe,cACfC,EAAiB,gBACjBC,EAAiB,mBACjBC,EAAkB,qBACPnpB,IACX+oB,EAAiB,OACjBC,EAAe,eACfC,EAAiB,iBACjBC,EAAiB,iBACjBC,EAAkB,mBAIlBxc,EAAAzD,EAAA0D,cAAC+F,GAAA,OAAD,CAAQJ,MAAOmW,GACZ,SAAAnW,GAAK,OACJ5F,EAAAzD,EAAA0D,cAAA,OACEC,UAAU,yCACV0F,MAAO,CAAE6W,KAAM7W,EAAMgW,gBAErB5b,EAAAzD,EAAA0D,cAACwb,GAAD,CACEhC,oBAAoB,8BACpB59B,SAAS,WACT09B,YAAa6C,EACb/C,YAAY,EACZ3X,QAASqZ,EACTnV,MAAK59B,OAAAQ,EAAA,EAAAR,CAAA,GAAO0zC,EAAP,CAA6BvD,OAAQvS,EAAMoW,gBAChDtC,QAAS2C,IAEXrc,EAAAzD,EAAA0D,cAACwb,GAAD,CACEhC,oBAAoB,8BACpB59B,SAAS,aACT09B,YAAa6C,EACb/C,YAAY,EACZ3X,QAASsZ,EACTpV,MAAK59B,OAAAQ,EAAA,EAAAR,CAAA,GAAO0zC,EAAP,CAA6BvD,OAAQvS,EAAMqW,mBAChDvC,QAAS4C,IAEXtc,EAAAzD,EAAA0D,cAACwb,GAAD,CACEhC,oBAAoB,8BACpB59B,SAAS,aACT09B,YAAa6C,EACb/C,YAAY,EACZ3X,QAASuZ,EACTrV,MAAK59B,OAAAQ,EAAA,EAAAR,CAAA,GACA0zC,EADA,CAEHvD,OAAQvS,EAAMqW,iBACdS,MAAO9W,EAAMsW,qBAEfxC,QAAS6C,IAEXvc,EAAAzD,EAAA0D,cAACwb,GAAD,CACEhC,oBAAoB,8BACpB59B,SAAS,cACT09B,YAAa6C,EACb/C,YAAY,EACZ3X,QAASwZ,EACTtV,MAAK59B,OAAAQ,EAAA,EAAAR,CAAA,GACA0zC,EADA,CAEHvD,OAAQvS,EAAMqW,iBACdQ,KAAM7W,EAAMsW,qBAEdxC,QAAS8C,KAETzqB,GACAiO,EAAAzD,EAAA0D,cAACkD,EAAA,SAAD,KACEnD,EAAAzD,EAAA0D,cAACwb,GAAD,CACEhC,oBAAoB,8BACpB59B,SAAS,eACT09B,YAAa6C,EACb/C,YAAY,EACZ3X,QAASyZ,EACTvV,MAAK59B,OAAAQ,EAAA,EAAAR,CAAA,GACA0zC,EADA,CAEHvD,OAAQvS,EAAMqW,iBACdS,MAAO9W,EAAMuW,sBAEfzC,QAAQ,6BAEV1Z,EAAAzD,EAAA0D,cAACwb,GAAD,CACEhC,oBAAoB,8BACpB59B,SAAS,gBACT09B,YAAa6C,EACb/C,YAAY,EACZ3X,QAAS0Z,EACTxV,MAAK59B,OAAAQ,EAAA,EAAAR,CAAA,GACA0zC,EADA,CAEHvD,OAAQvS,EAAMqW,iBACdQ,KAAM7W,EAAMuW,sBAEdzC,QAAQ,+BAKd1Z,EAAAzD,EAAA0D,cAACwb,GAAD,CACE5/B,SAAUu+B,EAA2B,QAAU,aAC/Cb,YAAa6C,EACb3C,oBAAoB,mCACpBJ,YAAY,EACZ3X,QAAS6Z,EACT3V,MAAO,CAAEC,QAASyU,EAA6B,EAAI,GACnDZ,QAASU,EAA2B,wBAA0B,wBAC9DxH,MAAO8H,OA4BViC,GAED3c,EAAAzD,EAAA0D,cAACwb,GAAD,CACE5/B,SAAS,eACT89B,kBAAmB1wC,EACnBowC,YAAY,EACZ3X,QA1BgB,kBAAMt3B,EAAKyC,cAAc,WA2BzC+4B,MAAO,CAAEC,QAASuU,GAA4BE,EAA6B,EAAI,GAC/EZ,QAAQ,gBAlOW,WAC3B,IAAMkD,EAA4BvB,IAE5BwB,EAAyB,CAC7BC,SAAU,WACVC,OAAQ,EACRN,KAAM,EACN5W,QAASuU,EAA2B,EAAI,GAErCE,IACHuC,EAAuBlB,UAAY,QAGrC,IAAMqB,EAAkB,CACtBnX,QAASuU,EAA2B,EAAI,EACxC0C,SAAU,WACVC,OAAQ,GAGJE,EAAgB,CACpB9E,OAAQrS,kBAAOwU,EAA6B,GAAK,EAAG,CAAEvU,UAAW,OAGnE,OACE/F,EAAAzD,EAAA0D,cAAC+F,GAAA,OAAD,CAAQJ,MAAOqX,GACZ,SAAArX,GAAK,OACJ5F,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,4CACbF,EAAAzD,EAAA0D,cAACwb,GAAD,CACE5/B,SAAUy+B,EAA6B,QAAU,UACjDjB,YAAY,EACZ3X,QAAS8Z,EACT5V,MAAOoX,EACPtD,QACEY,EAA6B,yBAA2B,2BAI3DsC,EAA0BjsC,IAAI,SAACuL,EAAUkO,GAAX,OAC7B4V,EAAAzD,EAAA0D,cAACwb,GAAD,CACEjmC,IAAK0G,EAASpS,IAAI,MAClBiS,OAAQG,EAASpS,IAAI,UACrB+R,SAAUK,EAASpS,IAAI,YACvBuvC,YAAY,EACZ3X,SAjFmBlgB,EAiFetF,EAASpS,IAAI,MAjFd,WAC7CywC,GAA8B,GAC9BnwC,EAAKyC,cAAc,UAAW,CAAE2U,iBAgFpBokB,MAAK59B,OAAAQ,EAAA,EAAAR,CAAA,GAAO60C,EAAP,CAA+B1E,OAAQvS,EAAMuS,QAAU/tB,EAAQ,KACpEsvB,QAAO,aAAA9tC,OAAesQ,EAASpS,IAAI,eAA5B,wBAnFY,IAAA0X,OA2QxB07B,OC7VIC,kBAAA,SAAA7uC,GAA6B,IAA1B8uC,EAA0B9uC,EAA1B8uC,UAAWC,EAAe/uC,EAAf+uC,SACrB5I,EAAgBlL,GAAW,IAAK,IAAK,IAAK,GAC1C+T,EAAe/T,GAAW,GAAI,GAAI,IAAK,GAEvCgU,EAAc,CAClBzT,YAAahE,kBAAOsX,EAAY,EAAI,EAAG,CAAErX,UAAW,OAGhDyX,EAAe,CACnB1N,WAAYhK,kBAAOsX,EAAY,GAAK,EAAG,CAAErX,UAAW,OAGtD,OACE/F,EAAAzD,EAAA0D,cAAC+F,GAAA,OAAD,CAAQJ,MAAO2X,GACZ,SAAA3X,GACC,IAAMmE,EAAkBP,GACtBT,GAAkB0L,EAAe6I,EAAc1X,EAAMkE,cAGvD,OACE9J,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,SAAS0F,MAAO,CAAEmE,mBAAmBrI,QAAS2b,GAC3Drd,EAAAzD,EAAA0D,cAAC+F,GAAA,OAAD,CAAQJ,MAAO4X,GACZ,SAAA5X,GAAK,OAAI5F,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,kBAAkB0F,MAAOA,WCtBjD6X,WAAA,SAAAnvC,GAAqD,IAAlDovC,EAAkDpvC,EAAlDovC,SAAUC,EAAwCrvC,EAAxCqvC,yBAA0BC,EAActvC,EAAdsvC,QAAc1Y,EAChCC,oBAAS,GADuBC,EAAAp9B,OAAAqJ,EAAA,EAAArJ,CAAAk9B,EAAA,GAC3D2Y,EAD2DzY,EAAA,GAChD0Y,EADgD1Y,EAAA,GAAAG,EAE5BJ,mBAAS,MAFmBK,EAAAx9B,OAAAqJ,EAAA,EAAArJ,CAAAu9B,EAAA,GAE3DwY,EAF2DvY,EAAA,GAE9CwY,EAF8CxY,EAAA,GAIlEyY,0BAAgB,WACdH,GAAa,IACZ,IAEH,IAAMI,EAAiBvD,mBACjBwD,EAAiBxD,mBAEjByD,EAAuBzD,mBAC7BsD,0BAAgB,WACdG,EAAqBtD,QAAUqD,EAAerD,QAAQ5H,eAExD,IAKMmL,EAA4B,SAAA9W,GAAK,OAAIA,EAAM+F,mBAE3CgR,EAAc,kBAAMR,GAAa,IAIjCjI,EAAmB,SAAAtO,GAAK,OAAK2W,EAAepD,QAAUvT,EAAMgX,cAAc,GAAGlL,SAE7E0C,EAAkB,SAAAxO,GACtB,IAAIA,EAAMtE,OAAOyQ,UAAUh4B,SAAS,eAApC,CAIA,IAAM8iC,EAAkBN,EAAepD,QAAUvT,EAAMgX,cAAc,GAAGlL,QAGtEmL,GACAL,EAAerD,QAAQ3K,aAAegO,EAAerD,QAAQ5K,WAC3DiO,EAAerD,QAAQ7C,aAEzB1Q,EAAM6H,iBACIoP,GAAwD,IAArCL,EAAerD,QAAQ5K,YACpD3I,EAAM6H,iBAEN4O,EAAezW,EAAMgX,cAAc,GAAGlL,QAAU6K,EAAepD,YAI7D2D,EAAyB,SAAAlX,GAAK,OAhClCuW,EAAaC,GAA8C,GAA/BK,EAAqBtD,cACjDkD,EAAe,OAiCjB7Z,oBAAU,WACR,OAAMga,EAAerD,SAKnBqD,EAAerD,QAAQp2B,iBAAiB,aAAcmxB,GACtDsI,EAAerD,QAAQp2B,iBAAiB,YAAaqxB,GACrDoI,EAAerD,QAAQp2B,iBAAiB,WAAY+5B,GACpDN,EAAerD,QAAQp2B,iBAAiB,cAAe+5B,GAEhD,WACLN,EAAerD,QAAQ4D,oBAAoB,aAAc7I,GACzDsI,EAAerD,QAAQ4D,oBAAoB,YAAa3I,GACxDoI,EAAerD,QAAQ4D,oBAAoB,WAAYD,GACvDN,EAAerD,QAAQ4D,oBAAoB,cAAeD,KAGrD,MAER,CAACN,EAAerD,QAASiD,IAE5B5Z,oBAAU,WAGR96B,WAAW,WACT80C,EAAerD,QAAQlV,MAAM6W,KAAO,IACpCpzC,WAAW,WACT80C,EAAerD,QAAQlV,MAAM6W,KAAO,QACnC,IACF,IACF,CAACiB,IAEJ,IAAMiB,EAAiB/b,KAAW,yBAA0B,CAC1Dgc,kCAAmCf,IAG/BgB,EAAa,CACjBC,QACEf,GACAjY,kBAAO+X,EAAY,EAAIO,EAAqBtD,SAAWhvC,OAAOizC,YAAa,CACzEhZ,UAAW,OAIjB,OACE/F,EAAAzD,EAAA0D,cAAC+F,GAAA,OAAD,CAAQJ,MAAOiZ,EAAY5Y,OAxED,kBAAQ4X,GAAeD,EAAUA,SAAY,IAyEpE,SAAAhY,GACC,IAAMyO,EAAoB,CACxB2K,UAAS,cAAApzC,OAAgBg6B,EAAMkZ,QAAtB,QAGX,OACE9e,EAAAzD,EAAA0D,cAAA,OAAKC,UAAWye,EAAgBjd,QAAWkc,EAAUU,EAAc,MACjEte,EAAAzD,EAAA0D,cAAA,OACEyB,QAAS2c,EACTne,UAAU,qCACVwI,IAAKyV,EACLvY,MAAOyO,GAEPrU,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,oBAEdyd,GACC3d,EAAAzD,EAAA0D,cAAA,UAAQC,UAAU,0CAA0CwB,QAAS4c,IAGtEZ,QC9GAuB,GAAA,SAAA3wC,GAA+C,IAA5C4N,EAA4C5N,EAA5C4N,SAAUgjC,EAAkC5wC,EAAlC4wC,UAAW5oC,EAAuBhI,EAAvBgI,QAASsnC,EAActvC,EAAdsvC,QAAcuB,EACVtE,kBAChD,kBAAMv4B,GAA4BpG,EAASpS,IAAI,cAC/C,CAACoS,EAASpS,IAAI,cAH4Cs1C,EAAAp3C,OAAAqJ,EAAA,EAAArJ,CAAAm3C,EAAA,GACrD38B,EADqD48B,EAAA,GAChC38B,EADgC28B,EAAA,GAMtDhtB,EAA0F,IAAvElW,EAASpS,IAAI,eAAe2O,OAAO,SAAAI,GAAI,OAAoB,IAAhBA,EAAKrK,SAAc2D,KACjFktC,EAAexE,kBACnB,kBAAM9iC,GAAezB,EAAS4F,EAASpS,IAAI,iBAC3C,CAACwM,EAAS4F,EAASpS,IAAI,iBATmCo7B,EAYlBC,mBAAS3iB,GAZS4iB,EAAAp9B,OAAAqJ,EAAA,EAAArJ,CAAAk9B,EAAA,GAYrDoa,EAZqDla,EAAA,GAYtCma,EAZsCna,EAAA,GAAAG,EAalBJ,mBAASjpB,EAASpS,IAAI,kBAbJ07B,EAAAx9B,OAAAqJ,EAAA,EAAArJ,CAAAu9B,EAAA,GAarDtpB,EAbqDupB,EAAA,GAatCga,EAbsCha,EAAA,GAetDkC,EAAWiT,iBAAO,MAExBxW,oBAAU,WACJuD,EAASoT,UACXpT,EAASoT,QAAQjT,QACU,OAAvBplB,IACFilB,EAASoT,QAAQnT,eAAiBllB,EAClCilB,EAASoT,QAAQlT,aAAenlB,KAGnC,CAACilB,IAQJ,OACE1H,EAAAzD,EAAA0D,cAACwd,GAAD,CAAQG,QAASA,GACf5d,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,wBACbF,EAAAzD,EAAA0D,cAACwb,GAAD,CACE1/B,OAAQG,EAASpS,IAAI,UACrB+R,SAAUK,EAASpS,IAAI,YACvBuvC,YAAY,EACZ3X,QAAS,aACTkE,MAAO,CAAE8Q,YAAa,MAGxB1W,EAAAzD,EAAA0D,cAAA,YAAO/jB,EAASpS,IAAI,iBAGtBk2B,EAAAzD,EAAA0D,cAAA,OACEC,UAAW0C,KAAW,4BAA6B,CACjD6c,uCAAwCrtB,KAGzCA,EAAmB,mBAAqBlW,EAASpS,IAAI,eAAegH,KAAK,QAGzEuuC,GAAgBjtB,EACjB4N,EAAAzD,EAAA0D,cAACkD,EAAA,SAAD,KACEnD,EAAAzD,EAAA0D,cAAA,YACEC,UAAU,kCACVlO,KAAK,IACLvc,MAAO6pC,EACP9W,SAhCmB,SAAAjB,GAAK,OAAIgY,EAAiBhY,EAAMtE,OAAOxtB,QAiC1DizB,IAAKhB,IAGP1H,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,kCACbF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,mCACbF,EAAAzD,EAAA0D,cAAA,QAAMC,UAAU,+BAAhB,YACAF,EAAAzD,EAAA0D,cAACkd,GAAD,CAAQC,UAAWnhC,EAAeohC,SArCZ,kBAAMmC,GAAkBvjC,OAwChD+jB,EAAAzD,EAAA0D,cAAA,UAAQC,UAAU,2BAA2BwB,QA5C5B,kBAAMwd,EAAUhjC,EAASpS,IAAI,MAAOw1C,EAAerjC,KA4CpE,aAMJ+jB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,+BAAf,6DAKFF,EAAAzD,EAAA0D,cAAA,aCtFSyf,WAAA,SAAApxC,GAAwD,IAArDgP,EAAqDhP,EAArDgP,qBAAsBqiC,EAA+BrxC,EAA/BqxC,OAAQC,EAAuBtxC,EAAvBsxC,OAAQC,EAAevxC,EAAfuxC,SACtD,OACE7f,EAAAzD,EAAA0D,cAACwd,GAAD,KACEzd,EAAAzD,EAAA0D,cAAA,MAAIC,UAAU,mCAAd,iBADF,+GAIEF,EAAAzD,EAAA0D,cAAA,WACAD,EAAAzD,EAAA0D,cAAA,WACAD,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,2CACZnxB,KAAWuO,EAAsB,gCAClC0iB,EAAAzD,EAAA0D,cAAA,WAFF,IAEU6f,gCAAqBxiC,GAF/B,SAIA0iB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,8CACbF,EAAAzD,EAAA0D,cAAA,UAAQC,UAAU,sCAAsCwB,QAASie,GAAjE,mCAGA3f,EAAAzD,EAAA0D,cAAA,UAAQC,UAAU,sCAAsCwB,QAASke,GAAjE,4BAGA5f,EAAAzD,EAAA0D,cAAA,UAAQC,UAAU,sCAAsCwB,QAASme,GAAjE,gBAIF7f,EAAAzD,EAAA0D,cAAA,cCrBe8f,uBACnB,SAAAA,EAAY3f,GAAO,IAAAC,EAAA,OAAAr4B,OAAAs4B,EAAA,EAAAt4B,CAAAu4B,KAAAwf,GACjB1f,EAAAr4B,OAAAw4B,EAAA,EAAAx4B,CAAAu4B,KAAAv4B,OAAAy4B,EAAA,EAAAz4B,CAAA+3C,GAAArf,KAAAH,KAAMH,IAENpuB,IAAE2uB,QAAF34B,OAAA44B,EAAA,EAAA54B,CAAAq4B,GAAgB,CAAC,kBAAmB,kBAAmB,oBAEvDA,EAAK3oB,MAAQ,CACXsoC,QAAS5f,EAAM4f,SANA3f,kFAUAyG,GACjB,IAAMmZ,EAAWnZ,EAAUrwB,OAAO5F,MAAM,CAAC,YAAa,SAChDqvC,EAAc3f,KAAKH,MAAM3pB,OAAO5F,MAAM,CAAC,YAAa,SACtDovC,EAAS9tC,OAAS+tC,EAAY/tC,KAAO,GAA4B,KAAvB+tC,EAAY1lC,QACpD+lB,KAAK4f,eACP5f,KAAK4f,cAActY,gDAKTuY,GAAU,IAAAjZ,EAAA5G,KACxB,OAAO,SAAAgH,GACL,IAAMtpB,EAAOkpB,EAAK/G,MAAM3pB,OAAO5F,MAAM,CAAC,YAAa,SACnDs2B,EAAK/G,MAAMoI,SAASvqB,EAAKtD,IAAIylC,EAAU7Y,EAAMtE,OAAOxtB,MAAMM,QAAQ,WAAY,+CAIlEqqC,GAAU,IAAA/Y,EAAA9G,KACxB,OAAO,WACL,IAAMtiB,EAAOopB,EAAKjH,MAAM3pB,OAAO5F,MAAM,CAAC,YAAa,SACnDw2B,EAAKjH,MAAMoI,SAASvqB,EAAKwV,OAAO2sB,+CAKlC,IAAMniC,EAAOsiB,KAAKH,MAAM3pB,OAAO5F,MAAM,CAAC,YAAa,SACnD0vB,KAAKH,MAAMoI,SAASvqB,EAAK7C,KAAK,oDAGTilC,GAAQ,IAAAvY,EAAAvH,KAC7B,OAAO,WACL,IAAMtiB,EAAO6pB,EAAK1H,MAAM3pB,OAAO5F,MAAM,CAAC,YAAa,SAC/CoN,EAAKrJ,SAASyrC,GAChBvY,EAAK1H,MAAMoI,SAASvqB,EAAKxF,OAAO,SAAAyF,GAAG,OAAIA,IAAQmiC,KAE/CvY,EAAK1H,MAAMoI,SAASvqB,EAAK7C,KAAKilC,sCAK3B,IAAAhV,EAAA9K,KAAAM,EACqBN,KAAKH,MAAzB3pB,EADDoqB,EACCpqB,OAAQmnC,EADT/c,EACS+c,QACRoC,EAAYzf,KAAK7oB,MAAjBsoC,QAEFM,EAAa7pC,EAAO5F,MAAM,CAAC,YAAa,SAE9C,OACEmvB,EAAAzD,EAAA0D,cAACwd,GAAD,CAAQG,QAASA,GACf5d,EAAAzD,EAAA0D,cAAA,MAAIC,UAAU,uBAAd,aAEqB,IAApBogB,EAAWnuC,KACV6tB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,mBAAf,qCAEEF,EAAAzD,EAAA0D,cAAA,WACAD,EAAAzD,EAAA0D,cAAA,WAHF,aAIYD,EAAAzD,EAAA0D,cAAA,KAAGC,UAAU,gBAJzB,gFAQAF,EAAAzD,EAAA0D,cAACsgB,GAAA,EAAD,CAAWC,YAAY,wBAAwB14C,KAAK,OACjD,SAAC24C,EAAUC,GAAX,OACC1gB,EAAAzD,EAAA0D,cAAA,MAAAj4B,OAAA24C,OAAA,CAAKzgB,UAAU,iBAAiBwI,IAAK+X,EAASG,UAAcH,EAASI,gBACnE7gB,EAAAzD,EAAA0D,cAACkD,EAAA,SAAD,KACGmd,EAAW3vC,IAAI,SAACuN,EAAKkM,GAAN,OACd4V,EAAAzD,EAAA0D,cAACsgB,GAAA,EAAD,CAAWO,YAAW,QAAAl1C,OAAUwe,GAASA,MAAOA,EAAO5U,IAAK4U,GACzD,SAACq2B,EAAUC,GAAX,OACC1gB,EAAAzD,EAAA0D,cAAA,MAAAj4B,OAAA24C,OAAA,CACEzgB,UAAW0C,KAAW,gBAAiB,CACrCme,0BAA2BL,EAASM,aAEtCtY,IAAK+X,EAASG,UACVH,EAASQ,gBAEbjhB,EAAAzD,EAAA0D,cAAA,SACEn4B,KAAK,OACLo4B,UAAU,qCACVzqB,MAAOyI,EACPsqB,SAAU6C,EAAK6V,gBAAgB92B,GAC/Bse,IAAK,SAAAyY,GAAS,OAAK9V,EAAK8U,cAAgBgB,KAE1CnhB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,oCACbF,EAAAzD,EAAA0D,cAAA,KACEC,UAAU,qBACVwB,QAAS2J,EAAK+V,gBAAgBh3B,KAEhC4V,EAAAzD,EAAA0D,cAAA,IAAAj4B,OAAA24C,OAAA,CACEzgB,UAAU,4DACNugB,EAASY,wBAQxBZ,EAASa,gBAOpBthB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,kCACbF,EAAAzD,EAAA0D,cAAA,UAAQC,UAAU,oCAAoCwB,QAASnB,KAAKghB,mBAGtEvhB,EAAAzD,EAAA0D,cAAA,MAAIC,UAAU,2BAEdF,EAAAzD,EAAA0D,cAAA,MAAIC,UAAU,sBAAd,YAEAF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,sBACZ8f,EACEvnC,OAAO,SAAAyF,GAAG,QAAMA,IAChBvN,IAAI,SAAAuN,GACH,IAAMgiB,EAAY0C,KAAW,gBAAiB,CAC5C4e,wBAAyBlB,EAAW1rC,SAASsJ,KAG/C,OACE8hB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAWA,EAAW1qB,IAAK0I,EAAKwjB,QAAS2J,EAAKoW,uBAAuBvjC,IACvEA,cAnI0BylB,kBCL9B+d,yBAAA,SAAApzC,GAA8D,IAA3DqzC,EAA2DrzC,EAA3DqzC,QAASC,EAAkDtzC,EAAlDszC,eAAgBC,EAAkCvzC,EAAlCuzC,kBAAmBC,EAAexzC,EAAfwzC,SACtDC,EAAoB,SAAAC,GAAU,OAAI,kBAAMF,EAASE,KAEjDC,EAAqBrf,KAAW,cAAe,CACnDsf,gCAAiCL,IAG7Bjc,EAAQ,CACZuc,oBAAqBN,EAAiB,UAAAj2C,OAAa+1C,EAAQnzC,OAArB,UAAsC,MAG9E,OACEwxB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAW+hB,EAAoBrc,MAAOA,GACxC+b,EAAQhxC,IAAI,SAAAqxC,GACX,IAAM9hB,EAAY0C,KAAW,mBAAoB,CAC/Cwf,6BAA8BJ,IAAeJ,IAG/C,OACE5hB,EAAAzD,EAAA0D,cAAA,OAAKzqB,IAAKwsC,EAAY9hB,UAAWA,EAAWwB,QAASqgB,EAAkBC,IACpEA,QCbQK,eACnB,SAAAA,EAAYjiB,GAAO,IAAAC,EAAA,OAAAr4B,OAAAs4B,EAAA,EAAAt4B,CAAAu4B,KAAA8hB,GACjBhiB,EAAAr4B,OAAAw4B,EAAA,EAAAx4B,CAAAu4B,KAAAv4B,OAAAy4B,EAAA,EAAAz4B,CAAAq6C,GAAA3hB,KAAAH,KAAMH,IAENpuB,IAAE2uB,QAAF34B,OAAA44B,EAAA,EAAA54B,CAAAq4B,GAAgB,CACd,qBACA,mBACA,oBACA,uBACA,2BACA,4BACA,2BACA,iBACA,oBACA,wBACA,yBACA,0BAfeA,oFAoBjBE,KAAKH,MAAMoI,SAASjI,KAAKH,MAAMlzB,UAAUiO,OAAO,WAAY,SAAA9N,GAAQ,OAAKA,8CAG1Dk6B,GAAO,IAAA1G,EACUN,KAAKH,MAA7BoI,EADc3H,EACd2H,SAAUt7B,EADI2zB,EACJ3zB,UADIo1C,EAG0BvzC,KAC9CW,KAAU63B,EAAMtE,OAAOxtB,OACvB,kBACAhD,MAAM,KANc8vC,EAAAv6C,OAAAqJ,EAAA,EAAArJ,CAAAs6C,EAAA,GAGfE,EAHeD,EAAA,GAGNE,EAHMF,EAAA,GAGIG,EAHJH,EAAA,GAGYI,EAHZJ,EAAA,GAOtB/Z,EACEt7B,EACGyN,IAAI,OAAQ6nC,GACZ7nC,IAAI,QAAS8nC,GACb9nC,IAAI,MAAO+nC,GACX/nC,IAAI,UAAWgoC,0CAIRC,GAAY,IAAAzb,EAAA5G,KACxB,OAAO,WAAM,IAAAsiB,EACqB1b,EAAK/G,MAA7BoI,EADGqa,EACHra,SAAUt7B,EADP21C,EACO31C,UADPoB,EAIM,UAAfs0C,EAAyB,CAAC,YAAa,eAAiB,CAAC,UAAW,aAJ3DxxC,EAAApJ,OAAAqJ,EAAA,EAAArJ,CAAAsG,EAAA,GAGJw0C,EAHI1xC,EAAA,GAGK2xC,EAHL3xC,EAAA,GAAA4xC,EAKYj0C,KAAW,IAAID,KAAQ,SAAS2D,MAAM,KALlDwwC,EAAAj7C,OAAAqJ,EAAA,EAAArJ,CAAAg7C,EAAA,GAKJE,EALID,EAAA,GAKEE,EALFF,EAAA,GAMXza,EAASt7B,EAAUyN,IAAImoC,EAASI,GAAMvoC,IAAIooC,EAAWI,8CAIxCP,GAAY,IAAAvb,EAAA9G,KAC3B,OAAO,WAAM,IAAA6iB,EACqB/b,EAAKjH,MAA7BoI,EADG4a,EACH5a,SAAUt7B,EADPk2C,EACOl2C,UADP0I,EAIM,UAAfgtC,EAAyB,CAAC,YAAa,eAAiB,CAAC,UAAW,aAJ3D/sC,EAAA7N,OAAAqJ,EAAA,EAAArJ,CAAA4N,EAAA,GAGJktC,EAHIjtC,EAAA,GAGKktC,EAHLltC,EAAA,GAKX2yB,EAASt7B,EAAUyN,IAAImoC,EAAS,MAAMnoC,IAAIooC,EAAW,iDAIxCH,GAAY,IAAA9a,EAAAvH,KAC3B,OAAO,SAAAgH,GAAS,IAAA8b,EACkBvb,EAAK1H,MAA7BoI,EADM6a,EACN7a,SAAUt7B,EADJm2C,EACIn2C,UADJ2c,EAIG,UAAf+4B,EAAyB,CAAC,YAAa,eAAiB,CAAC,UAAW,aAJxDtjB,EAAAt3B,OAAAqJ,EAAA,EAAArJ,CAAA6hB,EAAA,GAGPi5B,EAHOxjB,EAAA,GAGEyjB,EAHFzjB,EAAA,GAAAgkB,EAKO/b,EAAMtE,OAAOxtB,MAAMhD,MAAM,KALhC8wC,EAAAv7C,OAAAqJ,EAAA,EAAArJ,CAAAs7C,EAAA,GAKTJ,EALSK,EAAA,GAKHJ,EALGI,EAAA,GAMdL,EAAOA,EAAK9zC,WAAW,KAAO8zC,EAAKxgC,UAAU,GAAKwgC,EAClD1a,EAASt7B,EAAUyN,IAAImoC,EAASI,GAAMvoC,IAAIooC,EAAWI,iDAIrC,IAAA5gB,EACchC,KAAKH,OACrCoI,EAFkBjG,EACViG,UADUjG,EACAr1B,UACCyN,IAAI,eAAgB,KAAKA,IAAI,gBAAiB,GAAGA,IAAI,eAAgB,qDAGnE,IAAA8yB,EACWlN,KAAKH,OACrCoI,EAFqBiF,EACbjF,UADaiF,EACHvgC,UAENyN,IAAI,eAAgB,MAAMA,IAAI,gBAAiB,MAAMA,IAAI,eAAgB,wDAI9D6oC,GAAiB,IAAAC,EACRljB,KAAKH,OACrCoI,EAFwCib,EAChCjb,UADgCib,EACtBv2C,UACCyN,IAAI,eAAgB6oC,sDAGfjc,GAAO,IAAAmc,EACCnjB,KAAKH,OACrCoI,EAF+Bkb,EACvBlb,UADuBkb,EACbx2C,UACCyN,IAAI,gBAAiB4sB,EAAMtE,OAAOxtB,yDAG9BkuC,GAAiB,IAAAC,EACRrjB,KAAKH,OACrCoI,EAFwCob,EAChCpb,UADgCob,EACtB12C,UACCyN,IAAI,eAAgBgpC,6CAGxB,IAAAE,EACiBtjB,KAAKH,OACrCoI,EAFeqb,EACPrb,UADOqb,EACG32C,UACCyN,IAAI,YAAa,KAAKA,IAAI,aAAc,GAAGA,IAAI,YAAa,kDAG7D,IAAAmpC,EACcvjB,KAAKH,OACrCoI,EAFkBsb,EACVtb,UADUsb,EACA52C,UACCyN,IAAI,YAAa,MAAMA,IAAI,aAAc,MAAMA,IAAI,YAAa,qDAG/DopC,GAAc,IAAAC,EACFzjB,KAAKH,OACrCoI,EAFkCwb,EAC1Bxb,UAD0Bwb,EAChB92C,UACCyN,IAAI,YAAaopC,mDAGfxc,GAAO,IAAA0c,EACI1jB,KAAKH,OACrCoI,EAF4Byb,EACpBzb,UADoByb,EACV/2C,UACCyN,IAAI,aAAc4sB,EAAMtE,OAAOxtB,sDAG9ByuC,GAAc,IAAAC,EACF5jB,KAAKH,OACrCoI,EAFkC2b,EAC1B3b,UAD0B2b,EAChBj3C,UACCyN,IAAI,YAAaupC,4CAGtBE,EAAOC,EAASnB,EAAMC,GAAiC,IAAzBmB,IAAyB/1C,UAAAC,OAAA,QAAAC,IAAAF,UAAA,KAAAA,UAAA,GACrE,OACEyxB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,+EACbF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,iCAAiCkkB,GAChDpkB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,2BACVgjB,EACDljB,EAAAzD,EAAA0D,cAACkD,EAAA,SAAD,KACEnD,EAAAzD,EAAA0D,cAAA,SACEn4B,KAAK,OACLo4B,UAAU,+BACVzqB,MAAK,GAAA7J,OAAKs3C,EAAKzzC,SAAS,EAAG,KAAtB,KAAA7D,OAA8Bu3C,EAAO1zC,SAAS,EAAG,MACtD+4B,SAAUjI,KAAKgkB,iBAAiBF,KAEjCC,GACCtkB,EAAAzD,EAAA0D,cAAA,KACEC,UAAU,2EACVwB,QAASnB,KAAKikB,iBAAiBH,MAKrCrkB,EAAAzD,EAAA0D,cAAA,KACEC,UAAU,iEACVwB,QAASnB,KAAKkkB,cAAcJ,gDAQvB,IAAAK,EACuCnkB,KAAKH,MAAMlzB,UAAUE,OAAnEU,EADO42C,EACP52C,aAAcC,EADP22C,EACO32C,cAAeC,EADtB02C,EACsB12C,aAErC,OACEgyB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,qCACbF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,iCAAf,YACAF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,mEACVpyB,EACDkyB,EAAAzD,EAAA0D,cAACkD,EAAA,SAAD,KACEnD,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,yCACbF,EAAAzD,EAAA0D,cAACyhB,GAAD,CACEC,QAAS,CAAC,IAAK,KAAM,MACrBC,eAAgB9zC,GAAgB,IAChCg0C,SAAUvhB,KAAKokB,4BAGnB3kB,EAAAzD,EAAA0D,cAAA,SACEn4B,KAAK,SACLioC,IAAI,IACJ7P,UAAU,uCACVzqB,MAAO1H,GAAiB,EACxBy6B,SAAUjI,KAAKqkB,4BAEjB5kB,EAAAzD,EAAA0D,cAAA,WACED,EAAAzD,EAAA0D,cAACyhB,GAAD,CACEC,QAAS,QAAQlvC,MAAM,IACvBmvC,eAAgB5zC,GAAgB,IAChC8zC,SAAUvhB,KAAKskB,4BAGnB7kB,EAAAzD,EAAA0D,cAAA,KACEC,UAAU,2EACVwB,QAASnB,KAAKukB,wBAIlB9kB,EAAAzD,EAAA0D,cAAA,KACEC,UAAU,iEACVwB,QAASnB,KAAKwkB,4DAQZ,IAAAC,EACiCzkB,KAAKH,MAAMlzB,UAAUE,OAA1Da,EADI+2C,EACJ/2C,UAAWC,EADP82C,EACO92C,WAAYC,EADnB62C,EACmB72C,UAE/B,OACE6xB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,qCACbF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,iCAAf,SACAF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,2BACVjyB,EACD+xB,EAAAzD,EAAA0D,cAACkD,EAAA,SAAD,KACEnD,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,yCACbF,EAAAzD,EAAA0D,cAACyhB,GAAD,CACEC,QAAS,CAAC,IAAK,MACfC,eAAgB3zC,GAAa,IAC7B6zC,SAAUvhB,KAAK0kB,yBAGnBjlB,EAAAzD,EAAA0D,cAAA,SACEn4B,KAAK,SACLioC,IAAI,IACJ7P,UAAU,uCACVzqB,MAAOvH,GAAc,EACrBs6B,SAAUjI,KAAK2kB,yBAEjBllB,EAAAzD,EAAA0D,cAAA,WACED,EAAAzD,EAAA0D,cAACyhB,GAAD,CACEC,QAAS,QAAQlvC,MAAM,IACvBmvC,eAAgBzzC,GAAa,IAC7B2zC,SAAUvhB,KAAK4kB,yBAGnBnlB,EAAAzD,EAAA0D,cAAA,KACEC,UAAU,2EACVwB,QAASnB,KAAK6kB,qBAIlBplB,EAAAzD,EAAA0D,cAAA,KACEC,UAAU,iEACVwB,QAASnB,KAAK8kB,oDAQjB,IACCn4C,EAAcqzB,KAAKH,MAAnBlzB,UADDC,EAGLD,EAAUE,OADJC,EAFDF,EAECE,SAAUC,EAFXH,EAEWG,KAAMC,EAFjBJ,EAEiBI,MAAOC,EAFxBL,EAEwBK,IAAKE,EAF7BP,EAE6BO,UAAWC,EAFxCR,EAEwCQ,YAAaC,EAFrDT,EAEqDS,QAASC,EAF9DV,EAE8DU,UAGrE,OACEmyB,EAAAzD,EAAA0D,cAAA,WACED,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,4BAA4BjzB,GAAaC,IAExD8yB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,gDACbF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,+EACbF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,iCAAf,UACAF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,2BACbF,EAAAzD,EAAA0D,cAACkd,GAAD,CAAQC,UAAW/vC,EAAUgwC,SAAU9c,KAAK+kB,uBAIhDtlB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,+EACbF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,iCAAf,QACAF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,2BACbF,EAAAzD,EAAA0D,cAAA,SACEn4B,KAAK,OACLo4B,UAAU,+BACVsI,SAAUjI,KAAKglB,iBACf9vC,MAAK,GAAA7J,OAAK0B,EAAL,KAAA1B,OAAa2B,EAAb,KAAA3B,OAAsB4B,OAKhC+yB,KAAKilB,gBAAgB,aAAc,QAAS93C,EAAWC,GAAcC,KACnEF,GAAa6yB,KAAKilB,gBAAgB,WAAY,MAAO53C,EAASC,IAGlE0yB,KAAKklB,iBACLllB,KAAKmlB,sBA1R+B/hB,iBCFxBgiB,eACnB,SAAAA,EAAYvlB,GAAO,IAAAC,EAAA,OAAAr4B,OAAAs4B,EAAA,EAAAt4B,CAAAu4B,KAAAolB,GACjBtlB,EAAAr4B,OAAAw4B,EAAA,EAAAx4B,CAAAu4B,KAAAv4B,OAAAy4B,EAAA,EAAAz4B,CAAA29C,GAAAjlB,KAAAH,KAAMH,IAENpuB,IAAE2uB,QAAF34B,OAAA44B,EAAA,EAAA54B,CAAAq4B,GAAgB,CAAC,wBAAyB,6BAHzBA,4EAMN7qB,GAAK,IAAA2xB,EAAA5G,KAChB,OAAO,SAAAzc,GAAY,OAAIqjB,EAAK/G,MAAMoI,SAASrB,EAAK/G,MAAMlzB,UAAUyN,IAAInF,EAAKsO,qDAGnD,IACd5W,EAAcqzB,KAAKH,MAAnBlzB,UADco1C,EAEcvzC,KAAW,IAAID,KAAQ,kBAAkB2D,MAAM,KAF7D8vC,EAAAv6C,OAAAqJ,EAAA,EAAArJ,CAAAs6C,EAAA,GAEfh1C,EAFei1C,EAAA,GAETh1C,EAFSg1C,EAAA,GAEF/0C,EAFE+0C,EAAA,GAEG90C,EAFH80C,EAAA,GAGtBhiB,KAAKH,MAAMoI,SACTt7B,EAAUyN,IACR,kBACA1F,eAAI,CACF3H,OACAC,QACAC,MACAC,UACAJ,SAAUH,EAAU2D,MAAM,CAAC,iBAAkB,oEAOnD0vB,KAAKH,MAAMoI,SAASjI,KAAKH,MAAMlzB,UAAUyN,IAAI,kBAAmB,wCAGzD,IAAAkmB,EAC6CN,KAAKH,MAAjDlzB,EADD2zB,EACC3zB,UAAW0wC,EADZ/c,EACY+c,QAASgI,EADrB/kB,EACqB+kB,oBAE5B,OACE5lB,EAAAzD,EAAA0D,cAACwd,GAAD,CAAQG,QAASA,GACf5d,EAAAzD,EAAA0D,cAAA,MAAIC,UAAU,2BAAd,kBAEAF,EAAAzD,EAAA0D,cAAC4lB,GAAD,CACE34C,UAAWA,EAAUpD,IAAI,kBACzB0+B,SAAUjI,KAAKulB,aAAa,qBAG5BF,IACG14C,EAAUpD,IAAI,mBACfk2B,EAAAzD,EAAA0D,cAACkD,EAAA,SAAD,KACEnD,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,+BACbF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,6CADjB,KAGEF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,8CAGjBF,EAAAzD,EAAA0D,cAAC4lB,GAAD,CACE34C,UAAWA,EAAUpD,IAAI,mBACzB0+B,SAAUjI,KAAKulB,aAAa,qBAG9B9lB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,sCACbF,EAAAzD,EAAA0D,cAAA,UACEC,UAAU,uCACVwB,QAASnB,KAAKwlB,0BAFhB,0BASJ/lB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,sCACbF,EAAAzD,EAAA0D,cAAA,UACEC,UAAU,uCACVwB,QAASnB,KAAKylB,uBAFhB,uBASNhmB,EAAAzD,EAAA0D,cAAA,mBA9E0C0D,iBCI7BsiB,uBACnB,SAAAA,EAAY7lB,GAAO,IAAAC,EAAA,OAAAr4B,OAAAs4B,EAAA,EAAAt4B,CAAAu4B,KAAA0lB,GACjB5lB,EAAAr4B,OAAAw4B,EAAA,EAAAx4B,CAAAu4B,KAAAv4B,OAAAy4B,EAAA,EAAAz4B,CAAAi+C,GAAAvlB,KAAAH,KAAMH,IAENpuB,IAAE2uB,QAAF34B,OAAA44B,EAAA,EAAA54B,CAAAq4B,GAAgB,CAAC,qBAHAA,kFAMAyG,GACjB,IAAMof,EAAYpf,EAAUvoB,kBACtB4nC,EAAe5lB,KAAKH,MAAM7hB,kBAC5B2nC,EAAU/zC,OAASg0C,EAAah0C,KAAO,GAA6C,KAAxCg0C,EAAa3rC,OAAO1Q,IAAI,aAClEy2B,KAAK4f,eACP5f,KAAK4f,cAActY,qDAKJue,GAAoB,IAAAjf,EAAA5G,KACvC,OAAO,SAAAgH,GACL,IAAMtT,EAAwBkT,EAAK/G,MAAM7hB,kBAAkB/H,UACzD,SAAAgI,GAAgB,OAAIA,EAAiB1U,IAAI,QAAUs8C,IAErDjf,EAAK/G,MAAMoI,SACTrB,EAAK/G,MAAM7hB,kBAAkBzG,MAAM,CAACmc,EAAuB,YAAasT,EAAMtE,OAAOxtB,mDAKzE2wC,GAAoB,IAAA/e,EAAA9G,KACpC,OAAO,SAAAgH,GAAS,IAAA6b,EAC0B/b,EAAKjH,MAArC7hB,EADM6kC,EACN7kC,kBAAmBiqB,EADb4a,EACa5a,SAErBvU,EAAwB1V,EAAkB/H,UAC9C,SAAAgI,GAAgB,OAAIA,EAAiB1U,IAAI,QAAUs8C,IAErD5d,EACEjqB,EAAkBzG,MAChB,CAACmc,EAAuB,SACxBnZ,kBAAO6O,GAAsB4d,EAAMtE,OAAOxtB,oDAMjC2wC,GAAoB,IAAAte,EAAAvH,KACnC,OAAO,kBACLuH,EAAK1H,MAAMoI,SACTV,EAAK1H,MAAM7hB,kBAAkB9F,OAC3B,SAAA+F,GAAgB,OAAIA,EAAiB1U,IAAI,QAAUs8C,iDAMzD7lB,KAAKH,MAAMoI,SACTjI,KAAKH,MAAM7hB,kBAAkBnD,KAC3BN,kBAAO,CACL2D,SAAU,GACVhJ,MAAO,GACPsF,GAAIH,0CAMH,IAAAywB,EAAA9K,KAAAM,EACgCN,KAAKH,MAApCwd,EADD/c,EACC+c,QAASr/B,EADVsiB,EACUtiB,kBAEjB,OACEyhB,EAAAzD,EAAA0D,cAACwd,GAAD,CAAQG,QAASA,GACf5d,EAAAzD,EAAA0D,cAAA,MAAIC,UAAU,uBAAd,sBAE4B,IAA3B3hB,EAAkBpM,KACjB6tB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,oBAAf,4CAEEF,EAAAzD,EAAA0D,cAAA,WACAD,EAAAzD,EAAA0D,cAAA,WAHF,aAIYD,EAAAzD,EAAA0D,cAAA,KAAGC,UAAU,gBAJzB,6BAOAF,EAAAzD,EAAA0D,cAACsgB,GAAA,EAAD,CAAWC,YAAY,iCAAiC14C,KAAK,iBAC1D,SAAC24C,EAAUC,GAAX,OACC1gB,EAAAzD,EAAA0D,cAAA,MAAAj4B,OAAA24C,OAAA,CACEzgB,UAAU,wCACVwI,IAAK+X,EAASG,UACVH,EAASI,gBAEb7gB,EAAAzD,EAAA0D,cAACkD,EAAA,SAAD,KACG5kB,EAAkB5N,IAAI,SAAC6N,EAAkB4L,GAAnB,OACrB4V,EAAAzD,EAAA0D,cAACsgB,GAAA,EAAD,CACEO,YAAW,uBAAAl1C,OAAyBwe,GACpCA,MAAOA,EACP5U,IAAKgJ,EAAiB1U,IAAI,OAEzB,SAAC22C,EAAUC,GAAX,OACC1gB,EAAAzD,EAAA0D,cAAA,MAAAj4B,OAAA24C,OAAA,CACEzgB,UAAW0C,KAAW,uCAAwC,CAC5DyjB,iDAAkD3F,EAASM,aAE7DtY,IAAK+X,EAASG,UACVH,EAASQ,gBAEbjhB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,8BACbF,EAAAzD,EAAA0D,cAAA,SACEn4B,KAAK,OACLo4B,UAAU,sCACVzqB,MAAO+I,EAAiB1U,IAAI,YAC5B0+B,SAAU6C,EAAKib,qBAAqB9nC,EAAiB1U,IAAI,OACzD4+B,IAAK,SAAAyY,GAAS,OAAK9V,EAAK8U,cAAgBgB,KAE1CnhB,EAAAzD,EAAA0D,cAAA,SACEn4B,KAAK,OACLo4B,UAAU,sCACVzqB,MAAO1E,GAA0ByN,EAAiB1U,IAAI,UACtD0+B,SAAU6C,EAAKkb,kBAAkB/nC,EAAiB1U,IAAI,UAG1Dk2B,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,qCACbF,EAAAzD,EAAA0D,cAAA,KACEC,UAAU,qBACVwB,QAAS2J,EAAKmb,iBAAiBhoC,EAAiB1U,IAAI,SAEtDk2B,EAAAzD,EAAA0D,cAAA,IAAAj4B,OAAA24C,OAAA,CACEzgB,UAAU,6DACNugB,EAASY,wBAQxBZ,EAASa,gBAOpBthB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,2CACbF,EAAAzD,EAAA0D,cAAA,UAAQC,UAAU,oCAAoCwB,QAASnB,KAAKkmB,4BA5IzB9iB,kBCYhC+iB,4MACDnwC,GAAU,IAAA8pB,EAAAE,KAC1B,OAAO,kBAAMF,EAAKD,MAAMumB,cAAcpwC,qCAG/B,IAAA4wB,EAAA5G,KAAAM,EASHN,KAAKH,MAPPxwB,EAFKixB,EAELjxB,KACA0G,EAHKuqB,EAGLvqB,QACAiF,EAJKslB,EAILtlB,gBACAqrC,EALK/lB,EAKL+lB,gBACAC,EANKhmB,EAMLgmB,wBACAC,EAPKjmB,EAOLimB,gCACAC,EARKlmB,EAQLkmB,+BAGIC,EAAYC,sBAAWr3C,GACvBs3C,EAAUC,oBAASv3C,GAEnBw3C,EAA0B9wC,EAC7B+X,QAAQ,SAAA5X,GA2DP,OA1D6BA,EAAO3M,IAAI,iBAAiB2O,OAAO,SAAA4F,GAC9D,IAAMnR,EAAYmR,EAAavU,IAAI,aACnC,IAAKoD,EAAUpD,IAAI,YACjB,OAAO,EAGT,IAAMu9C,EAAmB/3C,GAAiBpC,GAI1C,KAFIuJ,EAAO5F,MAAM,CAAC,YAAa,iBpDglBH,SAAC0K,EAAiBC,GAAlB,OACpCF,GAAyBC,EAAiBC,GAAS1R,IAAI,qBAAqB8K,SAAS4G,GoDhlB3E8rC,CAAuB/rC,EAAiB9E,EAAO5F,MAAM,CAAC,YAAa,iBAEnE,OAAO,EAGT,GAAiC,aAA7BwN,EAAavU,IAAI,QAAwB,CAC3C,GAAIy9C,mBAAQ33C,GAAO,CACjB,GAAI6gB,oBAAS42B,EAAkB,IAAIv4C,MACjC,OAAO,EAFQ,IAAAR,EAKiBpB,EAAUpD,IAAI,aAC5C,CAACoD,EAAUpD,IAAI,cAAeoD,EAAUpD,IAAI,cAC5C,CAACg9C,EAAiCC,GAPrB31C,EAAApJ,OAAAqJ,EAAA,EAAArJ,CAAAsG,EAAA,GASXk5C,ExD+ByB,SAAC53C,EAAMC,EAAUC,GAAjB,MAC1C,CACCC,EAAG03C,oBAAS73C,EAAMC,GAClBI,EAAGy3C,mBAAQ93C,EAAMC,GACjBM,EAAGw3C,oBAAS/3C,EAAMC,GAClBQ,EAAGu3C,qBAAUh4C,EAAMC,GACnBU,EAAGs3C,oBAASj4C,EAAMC,IAClBC,GwDtC6Bg4C,CACjBT,EAVej2C,EAAA,GAAAA,EAAA,IAcjB,OAAOmM,mBAAQ3N,EAAM43C,IAAeO,mBAAQn4C,EAAM43C,GAElD,OAAOQ,yBAAcX,EAAkBL,EAAWE,GAE/C,GAAiC,cAA7B7oC,EAAavU,IAAI,QAAyB,CACnD,IAAI09C,EAAaH,EACjB,GAAMn6C,EAAUpD,IAAI,aAAc,CAChC,IAAMm+C,EAAkBxxC,EACrB3M,IAAI,qBACJwO,KAAK,SAAAkG,GAAgB,MAAyC,gBAArCA,EAAiB1U,IAAI,cACd,OAA/BoD,EAAUpD,IAAI,cAA0Bm+C,IAC1CT,EAAa73C,GACX03C,EACAn6C,EAAUpD,IAAI,cACdoD,EAAUpD,IAAI,eAKpB,SAAIy9C,mBAAQ33C,KAAS2N,mBAAQ3N,EAAM43C,KAI5BQ,yBAAcR,EAAYR,EAAWE,GAE5C,OAAO,IAIiBv2C,IAAI,SAAA0N,GAAY,MAAI,CAACA,EAAc5H,OAEhEyxC,OAAO,SAAAtyC,GAA4B,IAAAC,EAAA7N,OAAAqJ,EAAA,EAAArJ,CAAA4N,EAAA,GAA1ByI,EAA0BxI,EAAA,GAAAsyC,GAAAtyC,EAAA,GACiCwI,EAChEvU,IAAI,aACJsD,QAFKM,EAD0By6C,EAC1Bz6C,UAIR,MAAO,CAAGA,EAAY,EAAI,EAAGA,EALKy6C,EACfx6C,YADew6C,EACFv6C,QADEu6C,EACOt6C,UADPs6C,EACkB56C,MADlB46C,EACyB36C,OAO/D,OACEwyB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,yBACbF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,qBACZqnB,mBAAQ33C,IAASowB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,gCACjCF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,+BAA+BnxB,KAAWa,EAAM,SAC/DowB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,2BAA2BnxB,KAAWa,EAAM,mBAG7DowB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,iCACZknB,EAAwBz2C,IAAI,SAAAkZ,GAA4B,IAAAyV,EAAAt3B,OAAAqJ,EAAA,EAAArJ,CAAA6hB,EAAA,GAA1BxL,EAA0BihB,EAAA,GAAZ7oB,EAAY6oB,EAAA,GACjD+nB,EAAmB/3C,GAAiB+O,EAAavU,IAAI,cACrDs+C,IAAmB3xC,EAAO5F,MAAM,CAAC,YAAa,gBAE9Cw3C,EAAgBzlB,KAAW,mCAAoC,CACnE0lB,4CACEF,GAAkBG,kBAAOlB,KAG7B,OACErnB,EAAAzD,EAAA0D,cAAA,OAAKzqB,IAAK6I,EAAavU,IAAI,MAAOo2B,UAAU,gCAC1CF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,+CACbF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,oCAAoC7hB,EAAavU,IAAI,SACpEk2B,EAAAzD,EAAA0D,cAAA,OAAKC,UAAWmoB,EAAe3mB,QAASmlB,GACjB,aAApBD,EACG73C,KAAWs4C,EAAkB,SADhC,GAAAz7C,OAEMk0C,gCAAqBuH,GAF3B,UAIEhpC,EAAaxN,MAAM,CAAC,YAAa,eAClCmvB,EAAAzD,EAAA0D,cAACkD,EAAA,SAAD,KACEnD,EAAAzD,EAAA0D,cAAA,WACClxB,KAAWs4C,EAAkB,YAKtCrnB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,wCACbF,EAAAzD,EAAA0D,cAACuW,GAAD,CACE//B,OAAQA,EACRi3B,MAAM,QACNP,YAAY,EACZC,YAAY,EACZpF,sBAAoB,EACpB2F,4BAA0B,EAC1BjM,QAASyF,EAAKgO,kBAAkB1+B,EAAO3M,IAAI,sBApIxB65B,kBCDjC6kB,eACJ,SAAAA,EAAYpoB,GAAO,IAAAC,EAAA,OAAAr4B,OAAAs4B,EAAA,EAAAt4B,CAAAu4B,KAAAioB,GACjBnoB,EAAAr4B,OAAAw4B,EAAA,EAAAx4B,CAAAu4B,KAAAv4B,OAAAy4B,EAAA,EAAAz4B,CAAAwgD,GAAA9nB,KAAAH,KAAMH,IAENpuB,IAAE2uB,QAAF34B,OAAA44B,EAAA,EAAA54B,CAAAq4B,GAAgB,CACd,4BACA,sBACA,0BACA,oBACA,gCAGFA,EAAK3oB,MAAQ,CACX+wC,aAAc,IAAI35C,KAClB45C,cAAe,OACf9B,gBAAiB,YAdFvmB,yFAkBOqoB,GACxBnoB,KAAK2G,SAAS,CAAEwhB,gEAGI,IAAA5d,EACoBvK,KAAK7oB,MAArC+wC,EADY3d,EACZ2d,aAER,OAHoB3d,EACE4d,eAGpB,IAAK,MACHnoB,KAAK2G,SAAS,CAAEuhB,aAAcv4C,mBAAQu4C,EAAc,KACpD,MACF,IAAK,OACHloB,KAAK2G,SAAS,CAAEuhB,aAAcr4C,oBAASq4C,EAAc,KACrD,MACF,IAAK,QACHloB,KAAK2G,SAAS,CAAEuhB,aAAcn4C,qBAAUm4C,EAAc,KACtD,MACF,QACE,MAAO,8CAIKlyC,GAChBgqB,KAAKH,MAAMwd,UACXrd,KAAKH,MAAMx2B,IAAIyV,2BAA2B9I,qDAGlB,IAAA+0B,EACgB/K,KAAK7oB,MAArC+wC,EADgBnd,EAChBmd,aAER,OAHwBnd,EACFod,eAGpB,IAAK,MACHnoB,KAAK2G,SAAS,CAAEuhB,aAAcf,mBAAQe,EAAc,KACpD,MACF,IAAK,OACHloB,KAAK2G,SAAS,CAAEuhB,aAAcd,oBAASc,EAAc,KACrD,MACF,IAAK,QACHloB,KAAK2G,SAAS,CAAEuhB,aAAcb,qBAAUa,EAAc,KACtD,MACF,QACE,MAAO,0DAIiB,IACpB7B,EAAoBrmB,KAAK7oB,MAAzBkvC,gBAERrmB,KAAK2G,SAAS,CACZ0f,gBAAqC,aAApBA,EAAiC,WAAa,gEAIxC,IAAA7S,EACexT,KAAK7oB,MAArC+wC,EADiB1U,EACjB0U,aAER,OAHyB1U,EACH2U,eAGpB,IAAK,MACH,OAAO35C,KAAW05C,EAAc,WAClC,IAAK,OACH,IAAME,EAAYC,uBAAYH,GACxBI,EAAUz4C,oBAASu4C,EAAW,GACpC,SAAA/8C,OAAUmD,KAAW45C,EAAW,UAAhC,OAAA/8C,OAA+CmD,KAC7C85C,EACA,UAFF,OAAAj9C,OAGOmD,KAAW45C,EAAW,KAH7B,KAIF,IAAK,QACH,OAAO55C,KAAW05C,EAAc,QAClC,QACE,MAAO,qCAIJ,IAAAthB,EAAA5G,KAAAM,EAOHN,KAAKH,MALPwd,EAFK/c,EAEL+c,QACAtnC,EAHKuqB,EAGLvqB,QACAiF,EAJKslB,EAILtlB,gBACAurC,EALKjmB,EAKLimB,gCACAC,EANKlmB,EAMLkmB,+BANK+B,EAQkDvoB,KAAK7oB,MAAtDgxC,EARDI,EAQCJ,cAAeD,EARhBK,EAQgBL,aAAc7B,EAR9BkC,EAQ8BlC,gBAEjCmC,EAAQ,GACZ,OAAQL,GACN,IAAK,MACHK,EAAQ,CAACN,GACT,MACF,IAAK,OACH,IAAME,EAAYC,uBAAYH,GAC9BM,EAAQ/2C,IAAEiZ,MAAM,GAAGta,IAAI,SAAAq4C,GAAS,OAAI94C,mBAAQy4C,EAAWK,KACvD,MACF,IAAK,QACH,IAAMC,EAAaC,wBAAaT,GAChCM,EAAQ/2C,IAAEiZ,MAAMk+B,0BAAeV,IAAe93C,IAAI,SAAAq4C,GAAS,OACzD94C,mBAAQ+4C,EAAYD,KAM1B,OACEhpB,EAAAzD,EAAA0D,cAACwd,GAAD,CAAQG,QAASA,GACf5d,EAAAzD,EAAA0D,cAAA,MAAIC,UAAU,iBAAd,UAEAF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,yBACbF,EAAAzD,EAAA0D,cAACyhB,GAAD,CACEC,QAAS,CAAC,MAAO,OAAQ,SACzBC,eAAgB8G,EAChB5G,SAAUvhB,KAAK6oB,0BACfvH,mBAAiB,KAIrB7hB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,sCACbF,EAAAzD,EAAA0D,cAAA,KAAGC,UAAU,4BAA4BwB,QAASnB,KAAK8oB,0BACvDrpB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,4BAA4BK,KAAK+oB,4BAChDtpB,EAAAzD,EAAA0D,cAAA,KAAGC,UAAU,6BAA6BwB,QAASnB,KAAKgpB,uBAG1DvpB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,0BACZ6oB,EAAMp4C,IAAI,SAAAf,GAAI,OACbowB,EAAAzD,EAAA0D,cAACupB,GAAD,CACEh0C,IAAKzG,KAAWa,GAChBA,KAAMA,EACN0G,QAASA,EACTqwC,cAAexf,EAAKgO,kBACpB55B,gBAAiBA,EACjBqrC,gBAAiBA,EACjBC,wBAAyB1f,EAAKsiB,4BAC9B3C,gCAAiCA,EACjCC,+BAAgCA,OAKtC/mB,EAAAzD,EAAA0D,cAAA,mBA3JkB0D,iBA2KXE,eAVS,SAAAnsB,GAAK,MAAK,CAChC6D,gBAAiB7D,EAAM9N,IAAIC,QAAQC,IAAI,mBACvCg9C,gCAAiCpvC,EAAMtN,KAAKN,IAAI,oCAAsC,EACtFi9C,+BAAgCrvC,EAAMtN,KAAKN,IAAI,mCAAqC,MAG3D,SAAAV,GAAQ,MAAK,CACtCQ,IAAKk6B,YAAmB0K,EAAYplC,KAGvBy6B,CAA6C2kB,ICrMtDkB,GAAmB,CACvB,CAAC,qBAAsB,0BAA2B,UAClD,CAAC,yBAA0B,8BAA+B,UAC1D,CAAC,uBAAwB,qBAAsB,OAC/C,CAAC,qBAAsB,cAAe,UACtC,CAAC,aAAc,YAAa,UAC5B,CAAC,mBAAoB,kBAAmB,UACxC,CAAC,iBAAkB,eAAgB,iBACnC,CAAC,aAAc,YAAa,cAC5B,CAAC,gBAAiB,eAAgB,aAClC,CAAC,iBAAkB,eAAgB,kBACnC,CAAC,mBAAoB,iBAAkB,kBACvC,CAAC,mBAAoB,iBAAkB,kBACvC,CAAC,oBAAqB,kBAAmB,kBACzC,CAAC,OAAQ,OAAQ,iBAGNC,GAA4B,SAAAC,GAAiB,OACxDF,GAAiB/4C,IAAI,SAAArC,GAAA,IAAA8C,EAAApJ,OAAAqJ,EAAA,EAAArJ,CAAAsG,EAAA,GAAEu7C,EAAFz4C,EAAA,GAA+B04C,GAA/B14C,EAAA,GAAAA,EAAA,UAA4C,CAC/Dy4C,EACAD,EAAkB9/C,IAAI+/C,EAAaC,OCcjCC,eACJ,SAAAA,EAAY3pB,GAAO,IAAAC,EAAA,OAAAr4B,OAAAs4B,EAAA,EAAAt4B,CAAAu4B,KAAAwpB,GACjB1pB,EAAAr4B,OAAAw4B,EAAA,EAAAx4B,CAAAu4B,KAAAv4B,OAAAy4B,EAAA,EAAAz4B,CAAA+hD,GAAArpB,KAAAH,KAAMH,IAENpuB,IAAE2uB,QAAF34B,OAAA44B,EAAA,EAAA54B,CAAAq4B,GAAgB,CACd,sCACA,0CACA,iCACA,0BACA,wBACA,8BACA,2BACA,wBACA,2BACA,2BACA,6BACA,6BACA,8BACA,mBACA,qBACA,gBACA,mBACA,6BACA,6BACA,+BACA,mBACA,kCAGFA,EAAK3oB,MAAQ,CACXsyC,kBAAkB,GA7BH3pB,mFAiCC,IAAAQ,EACuBN,KAAKH,MAAtC12B,EADUm3B,EACVn3B,WAAYmP,EADFgoB,EACEhoB,KAAMoxC,EADRppB,EACQopB,WAEpBvgD,GACJ62B,KAAKH,MAAMh2B,KAAKX,eAAeC,GAEZ,cAAfA,GACF62B,KAAKH,MAAMh2B,KAAK4B,uBAAsB,GAGxC3C,WAAW,kBAAO0uC,SAASyC,cAAc,QAAQtK,UAAY,GAAI,IACtDr3B,GAAQA,IAASoxC,GAC5B1pB,KAAKH,MAAM90B,YAAYyuB,aAAalhB,kDAKf0nB,KAAKH,MAApB12B,WAGN62B,KAAKH,MAAMh2B,KAAKF,mBAEhBq2B,KAAKH,MAAMx2B,IAAIO,kEAIE,IAAAo4B,EACiBhC,KAAKH,MAAjC9pB,EADWisB,EACXjsB,QADWisB,EACF1gB,gBACSvL,GAAWA,EAAQnE,KAAO,GAClDouB,KAAKH,MAAMx2B,IAAIgY,iEAIDlW,GAChBhD,GAAG,OAAQ,QAAS,QAAS,4BAA6BgD,GAE1D60B,KAAK2G,SAAS,CAAE8iB,kBAAkB,kEAIlCzpB,KAAKH,MAAMx2B,IAAIsW,4FAIfqgB,KAAKH,MAAMx2B,IAAIuW,uFAGgB,IACvB+V,EAAqBqK,KAAKH,MAA1BlK,iBAEJA,GACFqK,KAAKH,MAAMx2B,IAAIqV,mBAAmBiX,qDAKpCqK,KAAKH,MAAMx2B,IAAI0V,mEAIfihB,KAAKH,MAAMx2B,IAAI4V,cAAc,+DAI7B+gB,KAAKH,MAAMx2B,IAAIoV,WAAWuhB,KAAKH,MAAMlK,kBACrCqK,KAAKH,MAAMx2B,IAAI4V,cAAc,kEAI7B+gB,KAAKH,MAAMx2B,IAAI8V,eACf6gB,KAAK2pB,UAAUriB,wDAIftH,KAAKH,MAAMx2B,IAAIqW,iBAAiBsgB,KAAKH,MAAMlK,qEAGlB,IACjBA,EAAqBqK,KAAKH,MAA1BlK,iBAERqK,KAAKH,MAAMx2B,IAAIoW,wBAAwBkW,GACvCqK,KAAKH,MAAMx2B,IAAIwW,aAAa8V,sDAI5BqK,KAAKH,MAAMx2B,IAAIyW,aAAakgB,KAAKH,MAAMlK,uEAIvCqK,KAAKH,MAAMx2B,IAAI0W,eAAeigB,KAAKH,MAAMlK,uEAIzCqK,KAAKH,MAAMx2B,IAAI2W,eAAeggB,KAAKH,MAAMlK,wEAIzCqK,KAAKH,MAAMx2B,IAAI4W,gBAAgB+f,KAAKH,MAAMlK,6DAI1CqK,KAAKH,MAAMkC,KAAKA,kDAGC4nB,GACjB3pB,KAAK2pB,UAAYA,EACb3pB,KAAK2pB,WACP3pB,KAAK2pB,UAAUriB,8CAILrmB,EAAYjP,EAAS0J,GACjCskB,KAAKH,MAAMx2B,IAAI2X,cAAcC,EAAYjP,EAAS0J,8CAIlDskB,KAAKH,MAAMh2B,KAAK4C,kEAIhBuzB,KAAKH,MAAMx2B,IAAI8S,KAAK,CAAEE,YAAa,SACnC2jB,KAAKH,MAAMh2B,KAAK4C,kEAIhBuzB,KAAKH,MAAMx2B,IAAI8S,KAAK,CAAEE,YAAa,SACnC2jB,KAAKH,MAAMh2B,KAAK4C,oEAIhBuzB,KAAKH,MAAMh2B,KAAK4C,sDAGDm9C,GACf5pB,KAAKH,MAAMx2B,IAAI4Z,cAAc+c,KAAKH,MAAMlK,iBAAkBi0B,yDAG9B/lC,GAC5Bmc,KAAKH,MAAMx2B,IAAIua,wBACboc,KAAKH,MAAMgqB,gBAAgBtgD,IAAI,YAC/Bsa,iDAIkBimC,GAAW,IAAAljB,EAAA5G,KAC/B,OAAM8pB,EAAUvgD,IAAI,eACX,SAAAga,GAAY,OACjBqjB,EAAK/G,MAAMx2B,IAAIia,sBAAsBwmC,EAAUvgD,IAAI,eAAgBga,IAE9D,SAAAA,GAAY,OACjBqjB,EAAK/G,MAAMx2B,IAAIma,4BACbsmC,EAAUvgD,IAAI,YACdugD,EAAUvgD,IAAI,qBACdga,EAAaha,IAAI,gEAKL,IAAA2jC,EAEhBlN,KAAKH,MADCkqB,EADU7c,EACV6c,gBAAiBF,EADP3c,EACO2c,gBAAiBh2B,EADxBqZ,EACwBrZ,iBAAkB9d,EAD1Cm3B,EAC0Cn3B,QAASi0C,EADnD9c,EACmD8c,eAGrE,OAAQD,GACN,IAAK,oBACH,OACEtqB,EAAAzD,EAAA0D,cAACyf,GAAD,CACEpiC,qBAAsB8sC,EAAgBtgD,IAAI,wBAC1C61C,OAAQpf,KAAKiqB,2BACb5K,OAAQrf,KAAKkqB,2BACb5K,SAAUtf,KAAKmqB,+BAGrB,IAAK,UACH,OACE1qB,EAAAzD,EAAA0D,cAACgf,GAAD,CACE/iC,SAAUkY,EAAiB/c,KACzB,SAAA6E,GAAQ,OAAIA,EAASpS,IAAI,QAAUsgD,EAAgBtgD,IAAI,gBAEzDwM,QAASA,EACT4oC,UAAW3e,KAAKoqB,cAChB/M,QAASrd,KAAKqqB,mBAGpB,IAAK,cACH,OAASL,EACPvqB,EAAAzD,EAAA0D,cAAC4qB,GAAD,CACEp0C,OAAQ8zC,EACRvK,QAAS8K,sBACPx0C,EAAQ+X,QAAQ,SAAA5X,GAAM,OAAIA,EAAO5F,MAAM,CAAC,YAAa,YACrDk6C,OACFnN,QAASrd,KAAKqqB,iBACdpiB,SAAUjI,KAAKyqB,mBAEf,KACN,IAAK,mBACH,IAAIC,EAAmB,KAavB,OAXEA,EADEb,EAAgBtgD,IAAI,evD4WD,SAACwM,EAASqC,GAAV,OAC7BrC,EACG3F,IACC,SAAA8F,GAAM,OACJ4E,GAAkC5E,EAAO5F,MAAM,CAAC,YAAa,UAAW8H,IACxE0C,GAAkC5E,EAAO3M,IAAI,eAAgB6O,IAC7DlC,EACG3M,IAAI,qBACJ6G,IAAI,SAAA6N,GAAgB,OACnBnD,GAAkCmD,EAAiB1U,IAAI,SAAU6O,KAElEF,OAAO,SAAAQ,GAAM,QAAMA,IACnBf,UAENb,KAAK,SAAA4B,GAAM,QAAMA,IuDzXOiyC,CAAgB50C,EAAS8zC,EAAgBtgD,IAAI,gBAE7CgR,kBAAO,CACxBkQ,eAAgBtU,GAAaJ,EAAS8zC,EAAgBtgD,IAAI,aAAa+G,MAAM,CAC3E,gBACAu5C,EAAgBtgD,IAAI,qBACpB,gBAMJk2B,EAAAzD,EAAA0D,cAACkrB,GAAD,CACEj+C,UAAW+9C,EACXrF,qBAAsBwE,EAAgBtgD,IAAI,eAC1C8zC,QAASrd,KAAKqqB,iBACdpiB,SAAUjI,KAAK6qB,sBAAsBhB,KAI3C,IAAK,uBACH,OACEpqB,EAAAzD,EAAA0D,cAACorB,GAAD,CACEzN,QAASrd,KAAKqqB,iBACdpiB,SAAUjI,KAAK+qB,8BACf/sC,kBAAmB7H,GAAaJ,EAAS8zC,EAAgBtgD,IAAI,aAAaA,IACxE,uBAIR,IAAK,SACH,OAAOk2B,EAAAzD,EAAA0D,cAACsrB,GAAD,CAAa3N,QAASrd,KAAKqqB,iBAAkBt0C,QAASA,IAC/D,QACE,OAAO,uCAIJ,IAAAmtC,EAaHljB,KAAKH,MAXP9pB,EAFKmtC,EAELntC,QACAk1C,EAHK/H,EAGL+H,4BACArR,EAJKsJ,EAILtJ,yBACAnS,EALKyb,EAKLzb,qBACA3qB,EANKomC,EAMLpmC,QACAouC,EAPKhI,EAOLgI,oBACA5yC,EARK4qC,EAQL5qC,KACAnP,EATK+5C,EASL/5C,WACAkgD,EAVKnG,EAULmG,kBACA7c,EAXK0W,EAWL1W,WACA2e,EAZKjI,EAYLiI,oBAGF,IAAK7yC,IAASnP,EACZ,OAAOs2B,EAAAzD,EAAA0D,cAAC0rB,GAAA,EAAD,CAAUvqB,GAAG,WAGtB,GAAIb,KAAK7oB,MAAMsyC,iBACb,OACEhqB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,2BAAf,6BAEEF,EAAAzD,EAAA0D,cAAA,WACAD,EAAAzD,EAAA0D,cAAA,WAHF,oHAK6B,IAC3BD,EAAAzD,EAAA0D,cAAA,KACE+C,KAAK,iDACLC,OAAO,SACPC,IAAI,uBAHN,mBAMK,IAZP,2CAkBJ,GAAMwoB,EACJ,OAAO1rB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,2BAA2BwrB,GAGnD,IAAKp1C,EACH,OAAO0pB,EAAAzD,EAAA0D,cAAA,YAGT,IAAM2rB,EAAS55C,IAAE0U,UDtUuB,SAAAkjC,GAAiB,OAC3DF,GAAiB/4C,IAAI,SAAAiF,GAAA,IAAAC,EAAA7N,OAAAqJ,EAAA,EAAArJ,CAAA4N,EAAA,GAAEi0C,EAAFh0C,EAAA,GAAeg2C,EAAfh2C,EAAA,GAA8Bi0C,EAA9Bj0C,EAAA,SAA2C,CAC9Dg2C,EACAjC,EAAkB9/C,IAAI+/C,EAAaC,MCmURgC,CAA6BlC,IAIlDmC,EACJ,SAAC9uB,GAAD,IAAW+uB,EAAXz9C,UAAAC,OAAA,QAAAC,IAAAF,UAAA,IAAAA,UAAA,UACA,SAAAg5B,GACMykB,GAAoBjf,GAIpBif,GAAoB,CAAC,WAAY,SAASp3C,SAASmjC,SAASkU,cAAcC,YAI9E3kB,EAAM6H,iBACNnS,EAASsK,MAGP4kB,EAAW,CACfjsC,wBAAyB6rC,EACvBxrB,KAAK6rB,qCAEPjsC,4BAA6B4rC,EAC3BxrB,KAAK8rB,yCAEPptC,mBAAoB8sC,EAClBxrB,KAAK+rB,gCACL,GAEFC,YAAaR,EAAgCxrB,KAAKisB,yBAClDC,UAAWV,EAAgCxrB,KAAKmsB,uBAChDC,gBAAiBZ,EAAgCxrB,KAAKqsB,6BACtDltC,aAAcqsC,EAAgCxrB,KAAKssB,0BACnD9sC,UAAWgsC,EAAgCxrB,KAAKusB,uBAChD1sC,aAAc2rC,EAAgCxrB,KAAKwsB,0BAA0B,GAC7E1sC,aAAc0rC,EAAgCxrB,KAAKysB,0BACnD1sC,eAAgByrC,EAAgCxrB,KAAK0sB,4BACrD1sC,eAAgBwrC,EAAgCxrB,KAAK2sB,4BACrD1sC,gBAAiBurC,EAAgCxrB,KAAK4sB,6BACtD7qB,KAAMypB,EAAgCxrB,KAAK6sB,mBAG7C,OACEptB,EAAAzD,EAAA0D,cAACotB,GAAA,QAAD,CAASzB,OAAQA,EAAQO,SAAUA,GACjCnsB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,qBAAqBotB,SAAS,KAAK5kB,IAAKnI,KAAKgtB,oBACxC,IAAjBj3C,EAAQnE,KACP6tB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,mCACbF,EAAAzD,EAAA0D,cAAA,iCAEGwrB,EACDzrB,EAAAzD,EAAA0D,cAACkD,EAAA,SAAD,KAAWsoB,GAEXzrB,EAAAzD,EAAA0D,cAACkD,EAAA,SAAD,0CACqC,IACnCnD,EAAAzD,EAAA0D,cAAA,KACE+C,KAAK,iDACLC,OAAO,SACPC,IAAI,uBAHN,mBAMK,IARP,0CAcJlD,EAAAzD,EAAA0D,cAACutB,GAAD,CAAYxlB,qBAAsBA,IAGnC3qB,IAAYmuC,GACXxrB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,mBAAf,qBAGA8H,GACAhI,EAAAzD,EAAA0D,cAACwtB,GAAD,CACEtT,yBAA0BA,EAC1BzwC,WAAYA,IAIf62B,KAAKmtB,6BA5YM/pB,iBAkbPE,eA/BS,SAACnsB,EAAO0oB,GAC9B,IAAM9pB,EAAUoB,EAAM9N,IAAIC,QAAQC,IAAI,WAChCosB,EAAmBxe,EAAM9N,IAAIC,QAAQC,IAAI,oBACzC6jD,EAAcj2C,EAAMtN,KAAKN,IAAI,eAEnC,MAAO,CACLwM,UACA4f,mBACA7Y,QAAS3F,EAAM9N,IAAIC,QAAQC,IAAI,WAC/BmgD,WAAYvyC,EAAM9N,IAAIC,QAAQC,IAAI,QAClCygD,eAAgBj0C,GAAWA,EAAQe,KAAK,SAAAZ,GAAM,OAAIA,EAAO3M,IAAI,QAAUosB,IACvE0zB,kBAAmBlyC,EAAMtN,KAAKN,IAAI,qBAClCijC,aAAcr1B,EAAM9N,IAAIC,QAAQC,IAAI,YACpCwgD,gBAAmBqD,EAAcA,EAAY7jD,IAAI,QAAU,KAC3DsgD,gBAAmBuD,EAAcA,EAAY7jD,IAAI,QAAU,KAC3DsqB,iBAAkB1c,EAAM+J,QAAQ3X,IAAI,oBAAoB8B,OAAO8V,IAC/DG,eAAgBnK,EAAM9N,IAAIC,QAAQC,IAAI,kBACtC4hD,oBAAqBh0C,EAAM9N,IAAIC,QAAQC,IAAI,yBAIpB,SAAAV,GACzB,MAAO,CACLgB,KAAM05B,YAAmBC,EAAa36B,GACtCkC,YAAaw4B,YAAmBI,EAAoB96B,GACpDQ,IAAKk6B,YAAmB0K,EAAYplC,GACpCk5B,KAAMwB,YAAmBE,iBAAa56B,GACtCqY,QAASqiB,YAAmBoW,EAAgB9wC,KAIjCy6B,CAA6CkmB,IC1N7CnmB,wBAAWC,YArBF,SAACnsB,EAAO0oB,GAC9B,MAAO,CACLwtB,SAAUl2C,EAAMtN,KAAKN,IAAI,aAAe,UACxC+pC,YAAan8B,EAAMtN,KAAKN,IAAI,gBAAkB,UAC9CujC,uBAAwB31B,EAAMtN,KAAKN,IAAI,0BACvCg9C,gCAAiCpvC,EAAMtN,KAAKN,IAAI,oCAAsC,EACtFi9C,+BAAgCrvC,EAAMtN,KAAKN,IAAI,mCAAqC,IACpF+jD,iCAAkCn2C,EAAMtN,KAAKN,IAAI,oCACjDkB,eAAgB0M,EAAMtN,KAAKN,IAAI,kBAC/BoB,6BAA8BwM,EAAMtN,KAAKN,IAAI,gCAC7C24B,mBAAoB/qB,EAAMtN,KAAKN,IAAI,wBAIZ,SAAAV,GACzB,MAAO,CACLkC,YAAaw4B,YAAmBI,EAAoB96B,GACpDgB,KAAM05B,YAAmBC,EAAa36B,KAIhBy6B,CA3OT,SAAAv1B,GAYX,IAXJs/C,EAWIt/C,EAXJs/C,SACA/Z,EAUIvlC,EAVJulC,YACAxG,EASI/+B,EATJ++B,uBACAwgB,EAQIv/C,EARJu/C,iCACA7iD,EAOIsD,EAPJtD,eACAE,EAMIoD,EANJpD,6BACA47C,EAKIx4C,EALJw4C,gCACAC,EAIIz4C,EAJJy4C,+BACAtkB,EAGIn0B,EAHJm0B,mBACAn3B,EAEIgD,EAFJhD,YACAlB,EACIkE,EADJlE,KAoCA,OACE41B,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,sBACbF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,qBACbF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,iBAAf,cALc,yBAShBF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,qBACbF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,iBAAf,aACAF,EAAAzD,EAAA0D,cAACyhB,GAAD,CACEC,QAAS,CAAC,UAAW,SACrBC,eAAgBgM,EAChB9L,SAvCqB,SAAAx3C,GAAW,OAAIF,EAAKC,YAAYC,OA2CzD01B,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,qBACbF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,iBAAf,gBACAF,EAAAzD,EAAA0D,cAACyhB,GAAD,CACEC,QAAS,CAAC,UAAW,SACrBC,eAAgB/N,EAChBiO,SA9CwB,SAAAt3C,GAAc,OAAIJ,EAAKG,eAAeC,OAkDlEw1B,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,qBACbF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,iBAAf,6BACAF,EAAAzD,EAAA0D,cAACkd,GAAD,CAAQC,UAAW/P,EAAwBgQ,SAlDN,kBACzCjzC,EAAKK,2BAA2B4iC,OAoD9BrN,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,qBACbF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,iBAAf,YAEEF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,8BAAf,uFAIFF,EAAAzD,EAAA0D,cAACkd,GAAD,CAAQC,UAAWpyC,EAAgBqyC,SAnDN,kBAAMjzC,EAAKW,mBAAmBC,OAsD7Dg1B,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,qBACbF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,iBAAf,uCAEEF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,8BAAf,6LAMFF,EAAAzD,EAAA0D,cAACkd,GAAD,CACEC,UAAWlyC,EACXmyC,SA/DwC,kBAC9CjzC,EAAKa,iCAAiCC,OAkEpC80B,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,qBACbF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,iBAAf,iCAEEF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,8BAAf,iIAKFF,EAAAzD,EAAA0D,cAACkd,GAAD,CACEC,UAAWyQ,EACXxQ,SA1E6C,kBACnDjzC,EAAKe,qCAAqC0iD,OA6ExC7tB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,iDACbF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,iBAAf,mCAEAF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,sCACbF,EAAAzD,EAAA0D,cAAA,SACEn4B,KAAK,SACLioC,IAAI,IACJ7P,UAAU,6CACVzqB,MAAOqxC,EACPte,SAlG0C,SAAAjB,GAAK,OACvDn9B,EAAKS,mCAAmC08B,EAAMtE,OAAOxtB,UAoG/CuqB,EAAAzD,EAAA0D,cAACyhB,GAAD,CACEC,QAAS,QAAQlvC,MAAM,IACvBmvC,eAAgBmF,EAChBjF,SArGyC,SAAAoC,GAAY,OAC7D95C,EAAKO,kCAAkCu5C,QAwGrClkB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,8BACbF,EAAAzD,EAAA0D,cAAA,UAAQC,UAAU,mBAAmBwB,QAtHP,kBAAMt3B,EAAKqC,cAAc,8BAsHvD,qBAGAuzB,EAAAzD,EAAA0D,cAAA,UAAQC,UAAU,mBAAmBwB,QA3HN,kBAAMt3B,EAAKqC,cAAc,+BA2HxD,sBAIAuzB,EAAAzD,EAAA0D,cAAA,MAAIC,UAAU,8BAEdF,EAAAzD,EAAA0D,cAAA,UAAQC,UAAU,mBAAmBwB,QAxGd,kBAAMt3B,EAAKqC,cAAc,eAwGhD,YAEGg2B,GACCzC,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,6BACbF,EAAAzD,EAAA0D,cAAA,KAAGC,UAAU,kBAInBF,EAAAzD,EAAA0D,cAAA,UAAQC,UAAU,mBAAmBwB,QA9GnB,kBAAMt3B,EAAKqC,cAAc,YA8G3C,QAGAuzB,EAAAzD,EAAA0D,cAAA,UAAQC,UAAU,oBAChBF,EAAAzD,EAAA0D,cAAA,KACE+C,KAAK,sCACLC,OAAO,SACPC,IAAI,sBACJ0C,MAAO,CAAE8H,MAAO,UAJlB,eAMc1N,EAAAzD,EAAA0D,cAAA,KAAGC,UAAU,qCAI7BF,EAAAzD,EAAA0D,cAAA,MAAIC,UAAU,8BAEdF,EAAAzD,EAAA0D,cAAA,UAAQC,UAAU,oBAChBF,EAAAzD,EAAA0D,cAAA,KACE+C,KAAK,2BACLC,OAAO,SACPC,IAAI,sBACJ0C,MAAO,CAAE8H,MAAO,UAJlB,gBAMe1N,EAAAzD,EAAA0D,cAAA,KAAGC,UAAU,qCAI9BF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,6BAAf,4EAC4E,IAD5E,yDAE6C,IAC3CF,EAAAzD,EAAA0D,cAAA,KACE+C,KAAK,oFACLC,OAAO,SACPC,IAAI,uBAHN,eAMK,IATP,wDAaAlD,EAAAzD,EAAA0D,cAAA,UAAQC,UAAU,oBAChBF,EAAAzD,EAAA0D,cAAA,KACE+C,KAAK,kCACLC,OAAO,SACPC,IAAI,sBACJ0C,MAAO,CAAE8H,MAAO,UAJlB,WAMU1N,EAAAzD,EAAA0D,cAAA,KAAGC,UAAU,qCAIzBF,EAAAzD,EAAA0D,cAAA,MAAIC,UAAU,8BAEdF,EAAAzD,EAAA0D,cAAA,UAAQC,UAAU,mBAAmBwB,QAjMhB,kBACzB51B,OAAOgiD,QAAQ,sCAAwCxiD,EAAYmpB,eAAY,IAgM3E,kBCtNas5B,uBACnB,SAAAA,EAAY3tB,GAAO,IAAAC,EAAA,OAAAr4B,OAAAs4B,EAAA,EAAAt4B,CAAAu4B,KAAAwtB,GACjB1tB,EAAAr4B,OAAAw4B,EAAA,EAAAx4B,CAAAu4B,KAAAv4B,OAAAy4B,EAAA,EAAAz4B,CAAA+lD,GAAArtB,KAAAH,KAAMH,IAENpuB,IAAE2uB,QAAF34B,OAAA44B,EAAA,EAAA54B,CAAAq4B,GAAgB,CAAC,oBAAqB,mBAEtCA,EAAK3oB,MAAQ,CACXs2C,YAAY,GANG3tB,mFAUC,IAAA8G,EAAA5G,KAClBA,KAAK0tB,WAAWvpC,iBAAiB,OAAQ,kBAAMyiB,EAAKD,SAAS,CAAE8mB,YAAY,kDAI3EztB,KAAK2G,SAAS,CAAE8mB,YAAY,IAC5BjW,SAASrzB,iBAAiB,WAAY6b,KAAK2tB,uDAG9B3mB,GACbhH,KAAK2G,SAAS,CAAE8mB,YAAY,IAC5BjW,SAAS2G,oBAAoB,WAAYne,KAAK2tB,gBAE9C,IAAI14C,EAAM,KAwBV,GAtBEA,EADE+xB,EAAM4mB,KAAK/+C,WAAW,OAClBm4B,EAAM4mB,KAAKviC,OAAO,GAAGoiB,cAClBzG,EAAM4mB,KAAK/+C,WAAW,SACzBm4B,EAAM4mB,KAAKviC,OAAO,GAElB,CACJwiC,MAAO,IACPC,MAAO,IACPC,UAAW,YACXC,MAAO,QACPC,OAAQ,SACRC,IAAK,MACLC,YAAa,IACbC,aAAc,IACdC,UAAW,IACXC,MAAO,IACPC,UAAW,KACXC,MAAO,IACPC,OAAQ,IACRC,MAAO,KACP1nB,EAAM4mB,MAGV,CAIA,IAOMe,EAPY,CAChB,CAAC,UAAW,QACZ,CAAC,SAAU,OACX,CAAC,UAAW,QACZ,CAAC,WAAY,UAIZz2C,OAAO,SAAAnK,GAAA,IAAA8C,EAAApJ,OAAAqJ,EAAA,EAAArJ,CAAAsG,EAAA,GAAE6gD,EAAF/9C,EAAA,GAAAA,EAAA,UAAmBm2B,EAAM4nB,KAChCx+C,IAAI,SAAAiF,GAAA,IAAAC,EAAA7N,OAAAqJ,EAAA,EAAArJ,CAAA4N,EAAA,GAAAC,EAAA,UAAAA,EAAA,KACJ/E,KAAK,KACFs+C,EAAU,GAAAxjD,OAAMsjD,GAANtjD,OAAuBsjD,EAAe,IAAM,IAA5CtjD,OAAiD4J,GAEjE+qB,KAAKH,MAAMivB,gBAAgB9uB,KAAKH,MAAMla,KAAMkpC,gDAG1BtF,GAClB,IAAKA,EACH,MAAO,GAmBT,MAhBqB,CACnB,CAAC,OAAQ,KACT,CAAC,MAAO,UACR,CAAC,SAAU,UACX,CAAC,UAAW,UACZ,CAAC,OAAQ,UACT,CAAC,QAAS,UACV,CAAC,YAAa,UACd,CAAC,SAAU,UACX,CAAC,QAAS,UACV,CAAC,OAAQ,UACT,CAAC,QAAS,UACV,CAAC,KAAM,UACP,CAAC,OAAQ,WAGS/6B,OAClB,SAACugC,EAADzlC,GAAA,IAAAyV,EAAAt3B,OAAAqJ,EAAA,EAAArJ,CAAA6hB,EAAA,GAAkB3D,EAAlBoZ,EAAA,GAAwBiwB,EAAxBjwB,EAAA,UAAoCgwB,EAAev5C,QAAQC,OAAM,GAAApK,OAAIsa,EAAJ,SAAiBqpC,IAClFzF,oCAIK,IAAAziB,EAAA9G,KAAAM,EACmBN,KAAKH,MAAvBla,EADD2a,EACC3a,KAAM4jC,EADPjpB,EACOipB,QACNkE,EAAeztB,KAAK7oB,MAApBs2C,WAEFwB,EAAsB5sB,KAAW,4CAA6C,CAClF6sB,uDAAwDzB,IAG1D,OACEhuB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,+BACbF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,8CAA8Cha,GAC7D8Z,EAAAzD,EAAA0D,cAAA,OACEC,UAAWsvB,EACX9tB,QAASnB,KAAKmvB,kBACdpC,SAAS,KACT5kB,IAAK,SAAAsE,GAAG,OAAK3F,EAAK4mB,WAAajhB,IAE9BghB,EAAa,MAAQztB,KAAKovB,oBAAoB7F,YAhHhBnmB,kBCiD1BC,wBAAWC,YAZF,SAACnsB,EAAO0oB,GAC9B,MAAO,CACLwpB,kBAAmBlyC,EAAMtN,KAAKN,IAAI,sBAAwBmL,mBAInC,SAAA7L,GACzB,MAAO,CACLgB,KAAM05B,YAAmBC,EAAa36B,KAIhBy6B,CAxCM,SAAAv1B,GAAiC,IAA9Bs7C,EAA8Bt7C,EAA9Bs7C,kBAAmBx/C,EAAWkE,EAAXlE,KAC9CwlD,EAAsB,SAAC/F,EAAauF,GACxC,IAAMS,EAAsBlG,GAA0BC,GAAmBnxC,OACvE,SAAArH,GAAA,IAAAwE,EAAA5N,OAAAqJ,EAAA,EAAArJ,CAAAoJ,EAAA,UAAAwE,EAAA,GAAAA,EAAA,KAA8Bw5C,IAC9B,GAEIS,EACJlkD,MAAK,uCAAAC,OAAwCikD,EAAoB,GAA5D,MAIPzlD,EAAKgC,oBAAoBy9C,EAAauF,IAGxC,OACEpvB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,uCACZypB,GAA0BC,GAAmBj5C,IAAI,SAAAkF,GAAA,IAAAgU,EAAA7hB,OAAAqJ,EAAA,EAAArJ,CAAA6N,EAAA,GAAEqQ,EAAF2D,EAAA,GAAQigC,EAARjgC,EAAA,UAChDmW,EAAAzD,EAAA0D,cAAC6vB,GAAD,CACEt6C,IAAK0Q,EACLA,KAAMA,EACN4jC,QAASA,EACTuF,gBAAiBO,WCzBZG,kBAAA,SAAAzhD,GAUT,IATJ4N,EASI5N,EATJ4N,SACAkO,EAQI9b,EARJ8b,MACA4lC,EAOI1hD,EAPJ0hD,kBACAC,EAMI3hD,EANJ2hD,oCACAC,EAKI5hD,EALJ4hD,oCACAC,EAII7hD,EAJJ6hD,2BACAC,EAGI9hD,EAHJ8hD,2BACAC,EAEI/hD,EAFJ+hD,iBACAvvB,EACIxyB,EADJwyB,gBACIoE,EACkCC,qBAAWjpB,EAASpS,IAAI,gBAD1Ds7B,EAAAp9B,OAAAqJ,EAAA,EAAArJ,CAAAk9B,EAAA,GACGorB,EADHlrB,EAAA,GACgBmrB,EADhBnrB,EAAA,GAEEorB,EAAuB,kBAAMD,GAAgBD,IAE7CG,EAAc,SAAAC,GAAS,OAAI,SAAAnpB,GAAK,OACpCyoB,EAAkB9zC,EAASpS,IAAI,MAAO,CAAC4mD,GAAYnpB,EAAMtE,OAAOxtB,SAE5Dk7C,EAAkC,kBACtCX,EACE9zC,EAASpS,IAAI,MACb,CAAC,6BACAoS,EAASpS,IAAI,8BAGZ8mD,EAAgB,kBACpBZ,EAAkB9zC,EAASpS,IAAI,MAAO,CAAC,kBAAmBoS,EAASpS,IAAI,mBAEnE+mD,EAAkC,WACtCZ,EAAoC/zC,EAASpS,IAAI,QAG7CgnD,EAAkC,SAAA1mC,GAAK,OAAI,kBAC/C8lC,EAAoCh0C,EAASpS,IAAI,MAAOsgB,KAEpD2mC,EAAkC,SAAA/rC,GAAwB,OAAI,SAAAuiB,GAAK,OACvEyoB,EACE9zC,EAASpS,IAAI,MACb,CAAC,yBAA0Bkb,GAC3BuiB,EAAMtE,OAAOxtB,SAGXu7C,EAAyB,kBAAMb,EAA2Bj0C,EAASpS,IAAI,QAEvEmnD,EAAyB,SAAA9rC,GAAe,OAAI,kBAChDirC,EAA2Bl0C,EAASpS,IAAI,MAAOqb,KAE3C+rC,EAAyB,SAAA/rC,GAAe,OAAI,SAAAoiB,GAAK,OACrDyoB,EAAkB9zC,EAASpS,IAAI,MAAO,CAAC,cAAeqb,GAAkBoiB,EAAMtE,OAAOxtB,SAEjF07C,EAAoB,WAEtBrlD,OAAOgiD,QAAP,wCAAAliD,OAC0CsQ,EAASpS,IAAI,eADvD,iBAIAumD,EAAiBn0C,EAASpS,IAAI,QA6O5BsnD,EAAiBxuB,KACrB,qEACA,CACEyuB,sDAAuDf,IAI3D,OACEtwB,EAAAzD,EAAA0D,cAACsgB,GAAA,EAAD,CAAWO,YAAW,qBAAAl1C,OAAuBsQ,EAASpS,IAAI,OAASsgB,MAAOA,GACvE,SAACq2B,EAAUC,GAAX,OACC1gB,EAAAzD,EAAA0D,cAAA,MAAAj4B,OAAA24C,OAAA,CACEzgB,UAAW0C,KAAW,6BAA8B,CAClD0uB,uCAAwC5Q,EAASM,aAEnDtY,IAAK+X,EAASG,UACVH,EAASQ,gBAEbjhB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,qCAAqCwB,QAAS8uB,GAC3DxwB,EAAAzD,EAAA0D,cAAA,KAAGC,UAAWkxB,IACdpxB,EAAAzD,EAAA0D,cAACwb,GAAD,CACE5/B,SAAUK,EAASpS,IAAI,YACvBiS,OAAQG,EAASpS,IAAI,UACrB43B,QAAS,aACTkE,MAAO,CAAE8Q,YAAa,MAExB1W,EAAAzD,EAAA0D,cAAA,QAAMC,UAAU,6CACbhkB,EAASpS,IAAI,gBAEhBk2B,EAAAzD,EAAA0D,cAAA,IAAAj4B,OAAA24C,OAAA,CACEzgB,UAAU,qEACNugB,EAASY,mBAIjBrhB,EAAAzD,EAAA0D,cAAC6I,GAAA,cAAD,CAAU1T,UAAWk7B,EAAa7Z,aAAc,CAAE1Q,UAAW,MAC3D/F,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,uCA5QM,SAAAhkB,GAAQ,OACrC8jB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,qCACbF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,2BACbF,EAAAzD,EAAA0D,cAAA,2BACAD,EAAAzD,EAAA0D,cAAA,SACEn4B,KAAK,OACLo4B,UAAU,YACVzqB,MAAOyG,EAASpS,IAAI,cAAe,IACnC0+B,SAAUioB,EAAY,mBAqQjBc,CAAuBr1C,GA/PZ,SAAAA,GAAQ,OAC9B8jB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,qCACbF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,2BACbF,EAAAzD,EAAA0D,cAAA,sBACAD,EAAAzD,EAAA0D,cAAA,SACEn4B,KAAK,OACLo4B,UAAU,+CACVsxB,UAAU,IACV/7C,MAAOyG,EAASpS,IAAI,SAAU,IAC9B0+B,SAAUioB,EAAY,UACtBgB,eAAe,UAInBzxB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,yCACbF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,qCACfF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,+BAAf,MACAF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,sCAGjBF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,2BACbF,EAAAzD,EAAA0D,cAAA,yBACAD,EAAAzD,EAAA0D,cAAA,SACEn4B,KAAK,OACLo4B,UAAU,YACVzqB,MAAOyG,EAASpS,IAAI,YACpB0+B,SAAUioB,EAAY,YACtBgB,eAAe,OACfC,YAAY,UAIhB1xB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,+BAAf,2KAEgF,IAC9EF,EAAAzD,EAAA0D,cAAA,KACE+C,KAAK,yDACLC,OAAO,SACPC,IAAI,uBAHN,QAHF,MAgOSyuB,CAAgBz1C,GAjNK,SAAAA,GAAQ,OACxC8jB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,qCACbF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,2BACbF,EAAAzD,EAAA0D,cAAA,0CACAD,EAAAzD,EAAA0D,cAACkd,GAAD,CACEC,UAAWlhC,EAASpS,IAAI,4BACxBuzC,SAAUsT,KAId3wB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,+BAAf,+FAEuB,YAApBY,GACCd,EAAAzD,EAAA0D,cAACkD,EAAA,SAAD,KACG,IADH,kEAEkE,IAChEnD,EAAAzD,EAAA0D,cAAA,8BAGiB,iBAApBa,GACCd,EAAAzD,EAAA0D,cAACkD,EAAA,SAAD,KACG,IADH,sGAGiB,IACfnD,EAAAzD,EAAA0D,cAAA,qBAEG,aANL,OAaJD,EAAAzD,EAAA0D,cAAC6I,GAAA,cAAD,CACE1T,UAAWlZ,EAASpS,IAAI,4BACxB2sC,aAAc,CAAE1Q,UAAW,MAE3B/F,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,8BACZhkB,EAASpS,IAAI,0BAA0B6G,IAAI,SAACihD,EAAaxnC,GAAd,OAC1C4V,EAAAzD,EAAA0D,cAAA,OAAKzqB,IAAG,yBAAA5J,OAA2Bwe,GAAS8V,UAAU,6BACpDF,EAAAzD,EAAA0D,cAAA,SACEn4B,KAAK,OACLw5C,YAAY,sBACZphB,UAAU,kCACVzqB,MAAOm8C,EACPppB,SAAUuoB,EAAgC3mC,KAE5C4V,EAAAzD,EAAA0D,cAAA,UACEC,UAAU,mDACVwB,QAASovB,EAAgC1mC,SAMjD4V,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,4CACbF,EAAAzD,EAAA0D,cAAA,UACEC,UAAU,6CACVwB,QAASmvB,OAwJNgB,CAA0B31C,GAjJb,SAAAA,GAAQ,OAChC8jB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,qCACbF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,0BAA0B0F,MAAO,CAAEksB,UAAW,IAC3D9xB,EAAAzD,EAAA0D,cAAA,2BAGFD,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,+BAAf,wGAKAF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,8BACZhkB,EAASpS,IAAI,eAAe6G,IAAI,SAACqH,EAAYoS,GAAb,OAC/B4V,EAAAzD,EAAA0D,cAAA,OAAKzqB,IAAG,eAAA5J,OAAiBwe,GAAS8V,UAAU,6BAC1CF,EAAAzD,EAAA0D,cAAA,SACEn4B,KAAK,OACLw5C,YAAY,cACZphB,UAAU,kCACVzqB,MAAOuC,EACPwwB,SAAU0oB,EAAuB9mC,KAEnC4V,EAAAzD,EAAA0D,cAAA,UACEC,UAAU,mDACVwB,QAASuvB,EAAuB7mC,SAMxC4V,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,4CACbF,EAAAzD,EAAA0D,cAAA,UACEC,UAAU,6CACVwB,QAASsvB,MAkHJe,CAAkB71C,GA5GJ,SAAAA,GAAQ,OACjC8jB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,qCACbF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,2BACbF,EAAAzD,EAAA0D,cAAA,uBACAD,EAAAzD,EAAA0D,cAACkd,GAAD,CAAQC,UAAWlhC,EAASpS,IAAI,iBAAkBuzC,SAAUuT,KAG9D5wB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,+BAAf,6HAsGS8xB,CAAmB91C,GA/FJ,SAAAA,GAAQ,OAClC8jB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,qCACbF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,0BAA0B0F,MAAO,CAAEksB,UAAW,IAC3D9xB,EAAAzD,EAAA0D,cAAA,wBAGFD,EAAAzD,EAAA0D,cAAA,YACEC,UAAU,6BACVlO,KAAK,IACLvc,MAAOyG,EAASpS,IAAI,YACpB0+B,SAAUioB,EAAY,cAGxBzwB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,+BAAf,+HAGEF,EAAAzD,EAAA0D,cAAA,UACED,EAAAzD,EAAA0D,cAAA,UACED,EAAAzD,EAAA0D,cAAA,kBADF,6BAGAD,EAAAzD,EAAA0D,cAAA,UACED,EAAAzD,EAAA0D,cAAA,kBADF,4BAGAD,EAAAzD,EAAA0D,cAAA,UACED,EAAAzD,EAAA0D,cAAA,kBADF,qCAGAD,EAAAzD,EAAA0D,cAAA,UACED,EAAAzD,EAAA0D,cAAA,kBADF,qCAGAD,EAAAzD,EAAA0D,cAAA,UACED,EAAAzD,EAAA0D,cAAA,kBADF,8CAGAD,EAAAzD,EAAA0D,cAAA,UACED,EAAAzD,EAAA0D,cAAA,gBAAQ,qBADV,qDACwF,IACtFD,EAAAzD,EAAA0D,cAAA,KAAG+C,KAAK,wEAAR,mBAEK,IAJP,wBAgEKivB,CAAoB/1C,GAnD/B8jB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,+EACbF,EAAAzD,EAAA0D,cAAA,UACEC,UAAU,mDACVwB,QAASyvB,GAFX,2BCpMSttB,eAbS,SAACnsB,EAAO0oB,GAC9B,MAAO,CACLhM,iBAAkB1c,EAAM+J,QAAQ3X,IAAI,mBAAoB,IAAI+Q,SAC5DimB,gBAAiBppB,EAAMpM,YAAYxB,IAAI,UAAUhC,OAI1B,SAAAsB,GACzB,MAAO,CACLqY,QAASqiB,YAAmBoW,EAAgB9wC,KAIjCy6B,CArFgB,SAAAv1B,GAAoD,IAAjD8lB,EAAiD9lB,EAAjD8lB,iBAAkB0M,EAA+BxyB,EAA/BwyB,gBAAiBrf,EAAcnT,EAAdmT,QAG7DywC,EAAwB,SAAC1wC,EAAYqD,EAAWvD,GAAxB,OAC5BG,EAAQmD,6BAA6BpD,EAAYqD,EAAWvD,IAExD6wC,EAA0C,SAAA3wC,GAAU,OACxDC,EAAQqD,kCAAkCtD,IAEtC4wC,EAA0C,SAAC5wC,EAAYwD,GAAb,OAC9CvD,EAAQsD,kCAAkCvD,EAAYwD,IAElDqtC,EAAiC,SAAA7wC,GAAU,OAAIC,EAAQwD,yBAAyBzD,IAEhF8wC,EAAiC,SAAC9wC,EAAY2D,GAAb,OACrC1D,EAAQyD,yBAAyB1D,EAAY2D,IAEzCotC,EAAuB,SAAA/wC,GAAU,OAAIC,EAAQ2D,eAAe5D,IAE5DgxC,EAAwB,SAAC9uC,EAAWC,GAAZ,OAC5BlC,EAAQ6D,uBAAuB5B,EAAWC,IAE5C,OACEqc,EAAAzD,EAAA0D,cAAA,WACED,EAAAzD,EAAA0D,cAACsgB,GAAA,EAAD,CAAWC,YAAY,qCAAqC14C,KAAK,oBAC9D,SAAC24C,EAAUC,GAAX,OACC1gB,EAAAzD,EAAA0D,cAAA,MAAAj4B,OAAA24C,OAAA,CACEzgB,UAAU,8BACVwI,IAAK+X,EAASG,UACVH,EAASI,gBAEc,IAA1BzsB,EAAiBjiB,KAChB6tB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,gCAAf,2EAC2E,IACzEF,EAAAzD,EAAA0D,cAAA,KAAGC,UAAU,gBAFf,WAGEF,EAAAzD,EAAA0D,cAAA,WACAD,EAAAzD,EAAA0D,cAAA,WAJF,wHASAD,EAAAzD,EAAA0D,cAACkD,EAAA,SAAD,KACG/O,EAAiBzjB,IAAI,SAACuL,EAAUkO,GAAX,OACpB4V,EAAAzD,EAAA0D,cAAC8vB,GAAD,CACEv6C,IAAK0G,EAASpS,IAAI,MAClBsgB,MAAOA,EACPlO,SAAUA,EACV4kB,gBAAiBA,EACjBkvB,kBAAmBkC,EACnBjC,oCAAqCkC,EACrCjC,oCAAqCkC,EACrCjC,2BAA4BkC,EAC5BjC,2BAA4BkC,EAC5BjC,iBAAkBkC,EAClBE,UAAWD,MAId/R,EAASa,gBAOpBthB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,yCACbF,EAAAzD,EAAA0D,cAAA,UAAQC,UAAU,oCAAoCwB,QAjE1B,kBAAMjgB,EAAQkD,uFCA7B+tC,eACnB,SAAAA,EAAYtyB,GAAO,IAAAC,EAAA,OAAAr4B,OAAAs4B,EAAA,EAAAt4B,CAAAu4B,KAAAmyB,GACjBryB,EAAAr4B,OAAAw4B,EAAA,EAAAx4B,CAAAu4B,KAAAv4B,OAAAy4B,EAAA,EAAAz4B,CAAA0qD,GAAAhyB,KAAAH,KAAMH,IAENpuB,IAAE2uB,QAAF34B,OAAA44B,EAAA,EAAA54B,CAAAq4B,GAAgB,CAAC,qBAAsB,2BAHtBA,oFAOjB9X,GAAa,2BAA4B,WAEzC,IACM0Q,EADU,IAAIC,WAAQ,CAAEC,SAAUC,kBAAyCC,cACzDC,qBACtBxtB,OAAOqW,SAASoX,OAASH,aAE3BttB,OAAOqW,SAAW8W,mDAIlB,IACEb,KAAK6D,KAAK,SAAU,WAClBnwB,OAAOssB,KAAK/sB,OACT6wB,KAAK,CACJC,OAAQ/C,GACRgD,cAAe,CAAC,gEAEjBjf,KALHnV,OAAAq0B,GAAA,EAAAr0B,CAAAs0B,GAAAC,EAAAC,KAKQ,SAAAC,IAAA,OAAAH,GAAAC,EAAAK,KAAA,SAAAC,GAAA,cAAAA,EAAA7N,KAAA6N,EAAAj1B,MAAA,OACgB0wB,OAAOC,SAASC,OAAOsE,gBAAgB,CACzDC,UAAW3D,GACX4D,MAAO,6CACPC,SAAU,SAAA5F,GACR9O,GAAa,2BAA4B,gBACzCA,GAAa,yBAA0B5f,KAAKC,UAAUyuB,IACtDvrB,OAAOqW,SAASwW,YAGRuE,mBAAmB,CAAEC,OAAQ,YAVrC,wBAAAN,EAAAO,SAAAX,SAaV,MAAO/wB,GAIP,YAHAC,MAAK,+HAQP,OACEq0B,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,kCACbF,EAAAzD,EAAA0D,cAAA,KAAGC,UAAU,mCAAb,+GAKAF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,yBAAyBwB,QAASnB,KAAKoyB,oBACpD3yB,EAAAzD,EAAA0D,cAAA,OAAKqB,IAAKsxB,KAAa5zB,IAAI,eAAekB,UAAU,kBAGtDF,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,yBAAyBwB,QAASnB,KAAKsyB,wBACpD7yB,EAAAzD,EAAA0D,cAAA,OAAKqB,IAAKwxB,KAAiB9zB,IAAI,oBAAoBkB,UAAU,+BA3DxByD,iBCgBzCovB,eACJ,SAAAA,EAAY3yB,GAAO,IAAAC,EAAA,OAAAr4B,OAAAs4B,EAAA,EAAAt4B,CAAAu4B,KAAAwyB,GACjB1yB,EAAAr4B,OAAAw4B,EAAA,EAAAx4B,CAAAu4B,KAAAv4B,OAAAy4B,EAAA,EAAAz4B,CAAA+qD,GAAAryB,KAAAH,KAAMH,IAENpuB,IAAE2uB,QAAF34B,OAAA44B,EAAA,EAAA54B,CAAAq4B,GAAgB,CAAC,sBAAuB,mBAAoB,oBAAqB,eAHhEA,mFAMC,IAAAQ,EACmCN,KAAKH,MAAlD4yB,EADUnyB,EACVmyB,wBAAyBxwB,EADf3B,EACe2B,gBAG3BywB,EADgB/jC,GAAQ,yxOACSre,MAAM,CAAC,UAAW,EAAG,YAAa,aAEvE2xB,GACEwwB,GACFC,IAAqBD,GAErBzyB,KAAKH,MAAMh2B,KAAK4B,uBAAsB,GAExCu0B,KAAKH,MAAMh2B,KAAK8B,2BAA2B+mD,gDAI3C1yB,KAAK2yB,0BACApnD,OAAOqnD,eAAiB,kBAAM,GAC9BrnD,OAAOqnD,oBAAiB1kD,iDAI7B3C,OAAOqnD,oBAAiB1kD,gDAIxB,OACEuxB,EAAAzD,EAAA0D,cAACmzB,GAAD,CACE1pD,WAAW,YACX8hD,6BAA6B,EAC7BxjB,sBAAsB,EACtBmS,0BAA0B,EAC1BsR,oBACE,8MAON,OACEzrB,EAAAzD,EAAA0D,cAACmzB,GAAD,CACE1pD,WAAW,SACX8hD,6BAA6B,EAC7B6H,2BAA2B,EAC3BlZ,0BAA0B,EAC1BsR,oBACE,6MAUL,IAAA6H,EAAAhlD,EAHDwa,MACEyqC,OAAU16C,YAEX,IAAAy6C,EAFkB,GAElBA,EAKD,OAJMz6C,IACJA,EAAO,IAAMA,GAGRmnB,EAAAzD,EAAA0D,cAACuzB,GAAD,CAAa36C,KAAMA,0CAOzB,IAFWA,EAEXzH,EAHD0X,MACEyqC,OAAU16C,KAOZ,OAJMA,IACJA,EAAO,IAAMA,GAIbmnB,EAAAzD,EAAA0D,cAACmzB,GAAD,CACEv6C,KAAMA,EACN2yC,6BAA6B,EAC7B6H,2BAA2B,EAC3BlZ,0BAA0B,sDAM9B,OAAO5Z,KAAKH,MAAMje,SAASC,SAAShT,WAAW,WAAamxB,KAAKH,MAAM/iB,yCAGhE,IAAAklB,EAQHhC,KAAKH,MANPoC,EAFKD,EAELC,gBACA15B,EAHKy5B,EAGLz5B,eACA8kD,EAJKrrB,EAILqrB,SACAhsB,EALKW,EAKLX,gBACA/f,EANK0gB,EAML1gB,eACYO,EAPPmgB,EAOLpgB,SAAYC,SAGRqxC,IAAuB5xC,GAAF,QAAAjW,OAA4BiW,EAAe/X,IAAI,gBACpE4pD,EAA8BD,GAAsBA,IAAuBrxC,EAE3E8d,EAAY0C,KAAW,kBAAmB,CAC9C+wB,8BAA4C,UAAb/F,IAGjC,OACE5tB,EAAAzD,EAAA0D,cAAA,OAAKC,UAAWA,GACdF,EAAAzD,EAAA0D,cAAC2zB,GAAD,MAEA5zB,EAAAzD,EAAA0D,cAACgF,GAAD,CAAkB5gB,QAASvb,IAE3Bk3B,EAAAzD,EAAA0D,cAAC4zB,GAAA,EAAD,CACEC,KAAMvzB,KAAK2yB,0BACX7uC,QAAS,iBAAM,2EAGI,cAApBud,EACCrB,KAAKwzB,sBACHvxB,EACF,CAAC,4BAA6B,WAAY,2BAA4B,UAAU5tB,SAC9EgtB,GAEA5B,EAAAzD,EAAA0D,cAACkD,EAAA,SAAD,KACuB,aAApBvB,GAAkC5B,EAAAzD,EAAA0D,cAAC+zB,GAAD,MACd,8BAApBpyB,GAAmD5B,EAAAzD,EAAA0D,cAACg0B,GAAD,MAC/B,6BAApBryB,GAAkD5B,EAAAzD,EAAA0D,cAACi0B,GAAD,MAC9B,WAApBtyB,GAAgCrB,KAAK4zB,oBAGxCn0B,EAAAzD,EAAA0D,cAACm0B,GAAA,EAAD,KACGV,GAA+B1zB,EAAAzD,EAAA0D,cAAC0rB,GAAA,EAAD,CAAUvqB,GAAIqyB,IAC9CzzB,EAAAzD,EAAA0D,cAACo0B,GAAA,EAAD,CAAOx7C,KAAK,kBAAkBy7C,OAAK,EAACC,UAAWx0B,KAC/CC,EAAAzD,EAAA0D,cAACo0B,GAAA,EAAD,CAAOx7C,KAAK,eAAe27C,OAAQj0B,KAAKk0B,aACxCz0B,EAAAzD,EAAA0D,cAACo0B,GAAA,EAAD,CAAOx7C,KAAK,gBAAgB27C,OAAQj0B,KAAKm0B,oBACzC10B,EAAAzD,EAAA0D,cAAC0rB,GAAA,EAAD,CAAUvqB,GAAG,oBAIjBpB,EAAAzD,EAAA0D,cAACm0B,GAAA,EAAD,KACEp0B,EAAAzD,EAAA0D,cAACo0B,GAAA,EAAD,CAAOx7C,KAAK,kBAAkBy7C,OAAK,EAACC,UAAWx0B,KAC/CC,EAAAzD,EAAA0D,cAACo0B,GAAA,EAAD,CAAOx7C,KAAK,UAAUy7C,OAAO,EAAME,OAAQj0B,KAAK4zB,mBAChDn0B,EAAAzD,EAAA0D,cAACo0B,GAAA,EAAD,CAAOx7C,KAAK,WAAWy7C,OAAO,EAAMC,UAAW7B,KAC/C1yB,EAAAzD,EAAA0D,cAACo0B,GAAA,EAAD,CAAOx7C,KAAK,IAAIy7C,OAAO,EAAMC,UAAWtwB,KACxCjE,EAAAzD,EAAA0D,cAAC0rB,GAAA,EAAD,CAAUvqB,GAAG,eAtJLuC,iBAkLLC,gBAAWC,YApBF,SAACnsB,EAAO0oB,GAC9B,MAAO,CACLt3B,eAAgB4O,EAAMtN,KAAKN,IAAI,kBAC/B04B,gBAAiB9qB,EAAMpM,YAAYxB,IAAI,mBACvC8jD,SAAUl2C,EAAMtN,KAAKN,IAAI,YACzBkpD,wBAAyBt7C,EAAMtN,KAAKN,IAAI,2BACxC83B,gBAAiBlqB,EAAMtN,KAAKN,IAAI,iBAAkB+Q,mBAAQL,OAC1DqH,eAAgBnK,EAAM9N,IAAIC,QAAQC,IAAI,kBACtCuT,QAAS3F,EAAM9N,IAAIC,QAAQC,IAAI,aAIR,SAAAV,GACzB,MAAO,CACLkC,YAAaw4B,YAAmBI,EAAoB96B,GACpDQ,IAAKk6B,YAAmB0K,EAAYplC,GACpCgB,KAAM05B,YAAmBC,EAAa36B,KAIhBy6B,CAA6CkvB,KClLlD4B,eACnB,SAAAA,EAAYv0B,GAAO,IAAAC,EAAAr4B,OAAAs4B,EAAA,EAAAt4B,CAAAu4B,KAAAo0B,GACjBt0B,EAAAr4B,OAAAw4B,EAAA,EAAAx4B,CAAAu4B,KAAAv4B,OAAAy4B,EAAA,EAAAz4B,CAAA2sD,GAAAj0B,KAAAH,KAAMH,IAENw0B,KAEA,IAAMhuC,EAAeD,KAErB7a,OAAO+oD,YAAc/oD,OAAOqW,SAAS2yC,KAAKpyC,UAAU,GACpD,IAAMqyC,EAAer9B,GAAiB5rB,OAAOqW,SAAS2yC,MAChDE,EAA2BxsC,GAAkB,4BAA4B,GAC3End,EAAS,KAEb,GAAM2pD,EACJ,OAAQA,GACN,IAAK,UACH,IAAMC,EAAqBF,EAAaj2B,aACxC,GAAIm2B,EACF5pD,EAAS6pD,GAA+BD,GACxCruC,EAAatb,YAAc2J,eAAI,CAC7ButB,iBAAiB,EACjBn3B,WAEFkd,GAAa,qBAAsB0sC,GACnCnpD,OAAOqW,SAAS2yC,KAAO,OAClB,CACL,IAAMK,EAA8B3sC,GAAkB,sBAAsB,GACtE2sC,IACJ9pD,EAAS6pD,GAA+BC,GACxCvuC,EAAatb,YAAc2J,eAAI,CAC7ButB,iBAAiB,EACjBn3B,YAIN,MACF,IAAK,eACHA,EAAS+pD,KACTxuC,EAAatb,YAAc2J,eAAI,CAC7ButB,iBAAiB,EACjBn3B,WAOR,IAAMgqD,EAAsB39B,GAAiB5rB,OAAOqW,SAASmzC,QACrDC,EAAqDF,EAArDE,YAAaC,EAAwCH,EAAxCG,oBAAqBzzC,EAAmBszC,EAAnBtzC,eAC1C,GAAMwzC,GAAiBC,EAAqB,CAC1C,IAAMC,EAAcF,EAAYnmD,WAAW,KAAOmmD,EAA9B,IAAA3pD,OAAgD2pD,GAC9DvzC,EAAyB/M,eAC7BjN,OAAO2N,QAAQ0/C,GACZ1kD,IAAI,SAAArC,GAAkB,IAAA8C,EAAApJ,OAAAqJ,EAAA,EAAArJ,CAAAsG,EAAA,GAAhBkH,EAAgBpE,EAAA,GAAXqE,EAAWrE,EAAA,GAErB,OAAIoE,EAAIpG,WADuB,oBAEtB,CAACoG,EAAIkN,UAFiB,mBAEgBlU,QAASiH,GAGjD,OAERgD,OAAO,SAAA7E,GAAI,QAAMA,KAEtBgT,EAAahd,IAAIC,QAAU+c,EAAahd,IAAIC,QAAQ8Q,IAClD,iBACA1F,eAAI,CACFwgD,cACAD,sBACAzzC,iBACAC,4BApEW,OAyEjBqe,EAAK14B,MAAQ+tD,GAAM9uC,GACnByZ,EAAK14B,MAAMguD,UAAUhuC,GAAmB0Y,EAAK14B,QAEvC0D,EACJA,EAAOiwB,aAAane,KAAK,SAAAme,GACnBA,EACFlU,GAA2BiZ,EAAK14B,MAAMyB,SAAUi3B,EAAK14B,MAAMgC,UAE3D02B,EAAK14B,MAAMyB,SAASqrB,QAIlB4L,EAAK14B,MAAMgC,WAAWC,IAAIC,QAAQC,IAAI,mBAC1Cu2B,EAAK14B,MAAMyB,SACTF,EAA6B,2DAE3B,MAMR8I,IAAE2uB,QAAF34B,OAAA44B,EAAA,EAAA54B,CAAAq4B,GAAgB,CAAC,kBA/FAA,6EAkGLpnB,GACPA,EAAO28C,cAIQ,qBAAhB38C,EAAOnR,KACTy4B,KAAK54B,MAAMyB,SAASkc,GAAuBrM,EAAO48C,OAAOzrC,MAAOnR,EAAO28C,YAAYxrC,QAC1D,QAAhBnR,EAAOnR,KAChBy4B,KAAK54B,MAAMyB,SAASqa,GAAYxK,EAAO48C,OAAOzrC,MAAOnR,EAAO28C,YAAYxrC,QAC/C,kBAAhBnR,EAAOnR,MAChBy4B,KAAK54B,MAAMyB,SAASwa,GAAoB3K,EAAO48C,OAAOzrC,MAAOnR,EAAO28C,YAAYxrC,0CAKlF,OACE4V,EAAAzD,EAAA0D,cAACsgB,GAAA,EAAD,CAAiBuV,UAAWv1B,KAAKgT,eAC/BvT,EAAAzD,EAAA0D,cAAC81B,GAAA,EAAD,CAAQC,SAAU58B,YAChB4G,EAAAzD,EAAA0D,cAACg2B,EAAA,EAAD,CAAUtuD,MAAO44B,KAAK54B,OACpBq4B,EAAAzD,EAAA0D,cAAA,OAAKC,UAAU,OACbF,EAAAzD,EAAA0D,cAACi2B,GAAD,iBAvHmBvyB,iBCrBbwyB,QACW,cAA7BrqD,OAAOqW,SAASi0C,UAEe,UAA7BtqD,OAAOqW,SAASi0C,UAEhBtqD,OAAOqW,SAASi0C,SAASttC,MAAM,2DA4F7B,kBAAmB5Z,WACrBA,UAAUmnD,cAAcC,MAAMn5C,KAAK,SAAAo5C,GACjCA,EAAaC,eCtGnBC,IAASjC,OAAOx0B,EAAAzD,EAAA0D,cAACy2B,GAAD,MAAS3e,SAAS4e,eAAe","file":"static/js/main.f7a3a9f8.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/org-web.b087bbb4.svg\";","module.exports = __webpack_public_path__ + \"static/media/dropbox.44db08f0.svg\";","module.exports = __webpack_public_path__ + \"static/media/google_drive.f5fd3e02.png\";","/* global ga */\n\nexport default store => next => action => {\n  let { type, ...payload } = action;\n\n  const eventFieldsToRedact = {\n    SET_CURRENT_FILE_BROWSER_DIRECTORY_LISTING: ['directoryListing'],\n    AUTHENTICATE: ['dropboxAccessToken'],\n    DISPLAY_FILE: ['contents'],\n  };\n\n  if (!!eventFieldsToRedact[type]) {\n    eventFieldsToRedact[type].forEach(field => {\n      payload = { ...payload, [field]: '--REDACTED--' };\n    });\n  }\n\n  ga('send', 'event', 'action', type, JSON.stringify(payload));\n\n  return next(action);\n};\n","import { displayFile, stopDisplayingFile } from './org';\r\n\r\nimport raw from 'raw.macro';\r\n\r\nexport const setLoadingMessage = loadingMessage => ({\r\n  type: 'SET_LOADING_MESSAGE',\r\n  loadingMessage,\r\n});\r\n\r\nexport const hideLoadingMessage = () => ({\r\n  type: 'HIDE_LOADING_MESSAGE',\r\n});\r\n\r\nexport const setIsLoading = isLoading => ({\r\n  type: 'SET_IS_LOADING',\r\n  isLoading,\r\n});\r\n\r\nexport const setDisappearingLoadingMessage = (loadingMessage, delay) => dispatch => {\r\n  dispatch(setLoadingMessage(loadingMessage));\r\n  setTimeout(() => dispatch(hideLoadingMessage()), delay);\r\n};\r\n\r\nexport const setLastViewedFile = (lastViewedPath, lastViewedContents) => ({\r\n  type: 'SET_LAST_VIEWED_FILE',\r\n  lastViewedPath,\r\n  lastViewedContents,\r\n});\r\n\r\nexport const loadStaticFile = staticFile => {\r\n  return (dispatch, getState) => {\r\n    dispatch(\r\n      setLastViewedFile(getState().org.present.get('path'), getState().org.present.get('contents'))\r\n    );\r\n\r\n    const fileContents = {\r\n      changelog: raw('../../changelog.org'),\r\n      sample: raw('../../sample.org'),\r\n    }[staticFile];\r\n\r\n    dispatch(displayFile(null, fileContents));\r\n  };\r\n};\r\n\r\nexport const unloadStaticFile = () => {\r\n  return (dispatch, getState) => {\r\n    dispatch(stopDisplayingFile());\r\n\r\n    if (!!getState().base.get('lastViewedPath')) {\r\n      dispatch(\r\n        displayFile(\r\n          getState().base.get('lastViewedPath'),\r\n          getState().base.get('lastViewedContents')\r\n        )\r\n      );\r\n    }\r\n  };\r\n};\r\n\r\nexport const setFontSize = newFontSize => ({\r\n  type: 'SET_FONT_SIZE',\r\n  newFontSize,\r\n});\r\n\r\nexport const setBulletStyle = newBulletStyle => ({\r\n  type: 'SET_BULLET_STYLE',\r\n  newBulletStyle,\r\n});\r\n\r\nexport const setShouldTapTodoToAdvance = newShouldTapTodoToAdvance => ({\r\n  type: 'SET_SHOULD_TAP_TODO_TO_ADVANCE',\r\n  newShouldTapTodoToAdvance,\r\n});\r\n\r\nexport const setAgendaDefaultDeadlineDelayUnit = newAgendaDefaultDeadlineDelayUnit => ({\r\n  type: 'SET_AGENDA_DEFAULT_DEADLINE_DELAY_UNIT',\r\n  newAgendaDefaultDeadlineDelayUnit,\r\n});\r\n\r\nexport const setAgendaDefaultDeadlineDelayValue = newAgendaDefaultDeadlineDelayValue => ({\r\n  type: 'SET_AGENDA_DEFAULT_DEADLINE_DELAY_VALUE',\r\n  newAgendaDefaultDeadlineDelayValue,\r\n});\r\n\r\nexport const setShouldLiveSync = shouldLiveSync => ({\r\n  type: 'SET_SHOULD_LIVE_SYNC',\r\n  shouldLiveSync,\r\n});\r\n\r\nexport const setShouldSyncOnBecomingVisibile = shouldSyncOnBecomingVisibile => ({\r\n  type: 'SET_SHOULD_SYNC_ON_BECOMING_VISIBLE',\r\n  shouldSyncOnBecomingVisibile,\r\n});\r\n\r\nexport const setShouldStoreSettingsInSyncBackend = newShouldStoreSettingsInSyncBackend => {\r\n  return (dispatch, getState) => {\r\n    dispatch({\r\n      type: 'SET_SHOULD_STORE_SETTINGS_IN_SYNC_BACKEND',\r\n      newShouldStoreSettingsInSyncBackend,\r\n    });\r\n\r\n    if (!newShouldStoreSettingsInSyncBackend) {\r\n      const client = getState().syncBackend.get('client');\r\n      switch (client.type) {\r\n        case 'Dropbox':\r\n          client\r\n            .deleteFile('/.org-web-config.json')\r\n            .catch((doesFileNotExist, error) =>\r\n              doesFileNotExist\r\n                ? null\r\n                : alert(\r\n                    `There was an error trying to delete the .org-web-config.json file: ${error}`\r\n                  )\r\n            );\r\n          break;\r\n        case 'Google Drive':\r\n          client.deleteFileByNameAndParent('.org-web-config.json', 'root');\r\n          break;\r\n        default:\r\n      }\r\n\r\n      window.previousSettingsFileContents = null;\r\n    }\r\n  };\r\n};\r\n\r\nexport const setHasUnseenChangelog = newHasUnseenChangelog => ({\r\n  type: 'SET_HAS_UNSEEN_CHANGELOG',\r\n  newHasUnseenChangelog,\r\n});\r\n\r\nexport const setLastSeenChangelogHeader = newLastSeenChangelogHeader => ({\r\n  type: 'SET_LAST_SEEN_CHANGELOG_HEADER',\r\n  newLastSeenChangelogHeader,\r\n});\r\n\r\nexport const setCustomKeybinding = (keybindingName, keybinding) => ({\r\n  type: 'SET_CUSTOM_KEYBINDING',\r\n  keybindingName,\r\n  keybinding,\r\n});\r\n\r\nexport const restoreBaseSettings = newSettings => ({\r\n  type: 'RESTORE_BASE_SETTINGS',\r\n  newSettings,\r\n});\r\n\r\nexport const pushModalPage = modalPage => ({\r\n  type: 'PUSH_MODAL_PAGE',\r\n  modalPage,\r\n});\r\n\r\nexport const popModalPage = () => ({\r\n  type: 'POP_MODAL_PAGE',\r\n});\r\n\r\nexport const clearModalStack = () => ({\r\n  type: 'CLEAR_MODAL_STACK',\r\n});\r\n\r\nexport const activatePopup = (popupType, data) => ({\r\n  type: 'ACTIVATE_POPUP',\r\n  popupType,\r\n  data,\r\n});\r\n\r\nexport const closePopup = () => ({\r\n  type: 'CLOSE_POPUP',\r\n});\r\n","import formatDate from 'date-fns/format';\nimport koLocale from 'date-fns/locale/ko';\nimport parseDate from 'date-fns/parse';\nimport {\n  addHours,\n  addDays,\n  addWeeks,\n  addMonths,\n  addYears,\n  subHours,\n  subDays,\n  subWeeks,\n  subMonths,\n  subYears,\n  isBefore,\n} from 'date-fns';\n\nexport const renderAsText = timestamp => {\n  const {\n    isActive,\n    year,\n    month,\n    day,\n    dayName,\n    startHour,\n    startMinute,\n    endHour,\n    endMinute,\n    repeaterType,\n    repeaterValue,\n    repeaterUnit,\n    delayType,\n    delayValue,\n    delayUnit,\n  } = timestamp.toJS();\n\n  let timestampText = '';\n  timestampText += isActive ? '<' : '[';\n  timestampText += `${year}-${month}-${day}`;\n  timestampText += !!dayName ? ` ${dayName}` : '';\n  timestampText += !!startHour ? ` ${startHour}:${startMinute}` : '';\n  timestampText += !!endHour ? `-${endHour}:${endMinute}` : '';\n  timestampText += !!repeaterType ? ` ${repeaterType}${repeaterValue}${repeaterUnit}` : '';\n  timestampText += !!delayType ? ` ${delayType}${delayValue}${delayUnit}` : '';\n  timestampText += isActive ? '>' : ']';\n\n  return timestampText;\n};\n\nexport const getCurrentTimestamp = ({ isActive = true, withStartTime = false } = {}) => {\n  const time = new Date();\n\n  const timestamp = {\n    isActive,\n    year: formatDate(time, 'YYYY'),\n    month: formatDate(time, 'MM'),\n    day: formatDate(time, 'DD'),\n    dayName: formatDate(time, 'ddd'),\n    startHour: null,\n    startMinute: null,\n    endHour: null,\n    endMinute: null,\n    repeaterType: null,\n    repeaterValue: null,\n    repeaterUnit: null,\n    delayType: null,\n    delayValue: null,\n    delayUnit: null,\n  };\n\n  if (withStartTime) {\n    timestamp.startHour = formatDate(time, 'HH');\n    timestamp.startMinute = formatDate(time, 'mm');\n  }\n\n  return timestamp;\n};\n\nexport const getCurrentTimestampAsText = () =>\n  `[${formatDate(new Date(), 'YYYY-MM-DD ddd', {\n    locale: navigator.language.startsWith('ko') ? koLocale : undefined,\n  })}]`;\n\nexport const dateForTimestamp = timestamp => {\n  const { year, month, day, startHour, startMinute } = timestamp.toJS();\n\n  let timestampString = `${year}-${month}-${day}`;\n  if (!!startHour && !!startMinute) {\n    timestampString += ` ${startHour.padStart(2, '0')}:${startMinute}`;\n  }\n\n  return parseDate(timestampString);\n};\n\nexport const addTimestampUnitToDate = (date, numUnits, timestampUnit) =>\n  ({\n    h: addHours(date, numUnits),\n    d: addDays(date, numUnits),\n    w: addWeeks(date, numUnits),\n    m: addMonths(date, numUnits),\n    y: addYears(date, numUnits),\n  }[timestampUnit]);\n\nexport const subtractTimestampUnitFromDate = (date, numUnits, timestampUnit) =>\n  ({\n    h: subHours(date, numUnits),\n    d: subDays(date, numUnits),\n    w: subWeeks(date, numUnits),\n    m: subMonths(date, numUnits),\n    y: subYears(date, numUnits),\n  }[timestampUnit]);\n\nexport const applyRepeater = (timestamp, currentDate) => {\n  if (!timestamp.get('repeaterType')) {\n    return timestamp;\n  }\n\n  let newDate = null;\n  switch (timestamp.get('repeaterType')) {\n    case '+':\n      newDate = addTimestampUnitToDate(\n        dateForTimestamp(timestamp),\n        timestamp.get('repeaterValue'),\n        timestamp.get('repeaterUnit')\n      );\n      break;\n    case '++':\n      newDate = addTimestampUnitToDate(\n        dateForTimestamp(timestamp),\n        timestamp.get('repeaterValue'),\n        timestamp.get('repeaterUnit')\n      );\n      while (isBefore(newDate, currentDate)) {\n        newDate = addTimestampUnitToDate(\n          newDate,\n          timestamp.get('repeaterValue'),\n          timestamp.get('repeaterUnit')\n        );\n      }\n      break;\n    case '.+':\n      newDate = addTimestampUnitToDate(\n        new Date(),\n        timestamp.get('repeaterValue'),\n        timestamp.get('repeaterUnit')\n      );\n      break;\n    default:\n      console.error(`Unrecognized timestamp repeater type: ${timestamp.get('repeaterType')}`);\n      return timestamp;\n  }\n\n  timestamp = timestamp\n    .set('day', formatDate(newDate, 'DD'))\n    .set('dayName', formatDate(newDate, 'ddd'))\n    .set('month', formatDate(newDate, 'MM'))\n    .set('year', formatDate(newDate, 'YYYY'));\n\n  if (timestamp.get('startHour') !== undefined && timestamp.get('startHour') !== null) {\n    timestamp = timestamp\n      .set('startHour', formatDate(newDate, 'HH'))\n      .set('startMinute', formatDate(newDate, 'mm'));\n  }\n\n  return timestamp;\n};\n","import _ from 'lodash';\nimport { fromJS } from 'immutable';\n\nimport { renderAsText } from './timestamps';\n\nconst linkPartToRawText = linkPart => {\n  if (!!linkPart.getIn(['contents', 'title'])) {\n    return `[[${linkPart.getIn(['contents', 'uri'])}][${linkPart.getIn(['contents', 'title'])}]]`;\n  } else {\n    return `[[${linkPart.getIn(['contents', 'uri'])}]]`;\n  }\n};\n\nconst formattedAttributedStringText = parts => {\n  return parts\n    .map(part => {\n      switch (part.get('type')) {\n        case 'text':\n          return part.get('contents');\n        case 'link':\n          if (part.getIn(['contents', 'title'])) {\n            return part.getIn(['contents', 'title']);\n          } else {\n            return part.getIn(['contents', 'uri']);\n          }\n        case 'table':\n          return '';\n        default:\n          return '';\n      }\n    })\n    .join('');\n};\n\nconst tablePartToRawText = tablePart => {\n  const rowHeights = tablePart\n    .get('contents')\n    .map(row =>\n      Math.max(\n        ...row.get('contents').map(cell => (_.countBy(cell.get('rawContents'))['\\n'] || 0) + 1)\n      )\n    )\n    .toJS();\n\n  const numColumns = tablePart.getIn(['contents', 0, 'contents']).size;\n  const columnWidths = _.times(numColumns).map(columnIndex =>\n    Math.max(\n      ...tablePart.get('contents').map(row => {\n        const content = row.getIn(['contents', columnIndex, 'contents']);\n        const formattedText = formattedAttributedStringText(content);\n        const lineLengths = formattedText.split('\\n').map(line => line.trim().length);\n        return Math.max(...lineLengths);\n      })\n    )\n  );\n\n  const rowStrings = _.dropRight(\n    _.flatten(\n      tablePart\n        .get('contents')\n        .map((row, rowIndex) => {\n          const rowHeight = rowHeights[rowIndex];\n\n          const contentRows = _.times(rowHeight)\n            .map(lineIndex =>\n              row\n                .get('contents')\n                .map((cell, columnIndex) => {\n                  const content = cell.get('contents');\n                  const formattedText = formattedAttributedStringText(content);\n                  const formattedLineLengths = formattedText\n                    .split('\\n')\n                    .map(line => line.trim().length);\n                  const line = (cell.get('rawContents').split('\\n')[lineIndex] || '').trim();\n\n                  const padCount = columnWidths[columnIndex] - formattedLineLengths[lineIndex];\n\n                  return line + ' '.repeat(padCount);\n                })\n                .toJS()\n                .join(' | ')\n            )\n            .map(contentRow => `| ${contentRow} |`);\n\n          const separator =\n            '|' + columnWidths.map(columnWidth => '-'.repeat(columnWidth + 2)).join('+') + '|';\n\n          return contentRows.concat(separator);\n        })\n        .toJS()\n    )\n  );\n\n  return rowStrings.join('\\n');\n};\n\nconst listPartToRawText = listPart => {\n  const bulletCharacter = listPart.get('bulletCharacter');\n\n  let previousNumber = 0;\n  return listPart\n    .get('items')\n    .map(item => {\n      const optionalLeadingSpace = !listPart.get('isOrdered') && bulletCharacter === '*' ? ' ' : '';\n\n      const titleText = attributedStringToRawText(item.get('titleLine'));\n\n      const contentText = attributedStringToRawText(item.get('contents'));\n      const indentedContentText = contentText\n        .split('\\n')\n        .map(line => (!!line.trim() ? `${optionalLeadingSpace}  ${line}` : ''))\n        .join('\\n');\n\n      let listItemText = null;\n      if (listPart.get('isOrdered')) {\n        let number = ++previousNumber;\n        let forceNumber = item.get('forceNumber');\n        if (!!forceNumber) {\n          number = forceNumber;\n          previousNumber = number;\n        }\n\n        listItemText = `${number}${listPart.get('numberTerminatorCharacter')}`;\n\n        if (!!forceNumber) {\n          listItemText += ` [@${forceNumber}]`;\n        }\n\n        if (item.get('isCheckbox')) {\n          const stateCharacter = {\n            checked: 'X',\n            unchecked: ' ',\n            partial: '-',\n          }[item.get('checkboxState')];\n\n          listItemText += ` [${stateCharacter}]`;\n        }\n\n        listItemText += ` ${titleText}`;\n      } else {\n        listItemText = `${optionalLeadingSpace}${bulletCharacter}`;\n\n        if (item.get('isCheckbox')) {\n          const stateCharacter = {\n            checked: 'X',\n            unchecked: ' ',\n            partial: '-',\n          }[item.get('checkboxState')];\n\n          listItemText += ` [${stateCharacter}]`;\n        }\n\n        listItemText += ` ${titleText}`;\n      }\n\n      if (!!contentText) {\n        listItemText += `\\n${indentedContentText}`;\n      }\n\n      return listItemText;\n    })\n    .join('\\n');\n};\n\nconst timestampPartToRawText = part => {\n  let text = renderAsText(part.get('firstTimestamp'));\n  if (part.get('secondTimestamp')) {\n    text += `--${renderAsText(part.get('secondTimestamp'))}`;\n  }\n\n  return text;\n};\n\nexport const attributedStringToRawText = parts => {\n  if (!parts) {\n    return '';\n  }\n\n  const prevParts = parts.unshift(null);\n\n  return parts\n    .zip(prevParts)\n    .map(([part, prevPart]) => {\n      let text = '';\n      switch (part.get('type')) {\n        case 'text':\n          text = part.get('contents');\n          break;\n        case 'link':\n          text = linkPartToRawText(part);\n          break;\n        case 'fraction-cookie':\n          text = `[${part.getIn(['fraction', 0]) || ''}/${part.getIn(['fraction', 1]) || ''}]`;\n          break;\n        case 'percentage-cookie':\n          text = `[${part.get('percentage') || ''}%]`;\n          break;\n        case 'table':\n          text = tablePartToRawText(part);\n          break;\n        case 'list':\n          text = listPartToRawText(part);\n          break;\n        case 'timestamp':\n          text = timestampPartToRawText(part);\n          break;\n        default:\n          console.error(\n            `Unknown attributed string part type in attributedStringToRawText: ${part.get('type')}`\n          );\n      }\n\n      let optionalNewlinePrefix = '';\n      if (!!prevPart) {\n        if (['list', 'table'].includes(prevPart.get('type'))) {\n          optionalNewlinePrefix = '\\n';\n        } else if (\n          part.get('type') === 'list' &&\n          prevPart.get('type') === 'text' &&\n          !prevPart.get('contents').endsWith('\\n')\n        ) {\n          optionalNewlinePrefix = '\\n';\n        }\n      }\n      return optionalNewlinePrefix + text;\n    })\n    .join('');\n};\n\nexport default (headers, todoKeywordSets, fileConfigLines, linesBeforeHeadings) => {\n  let configContent = '';\n\n  if (fileConfigLines.size > 0) {\n    configContent = fileConfigLines.join('\\n') + '\\n';\n  }\n\n  if (!todoKeywordSets.get(0).get('default')) {\n    configContent =\n      configContent +\n      todoKeywordSets\n        .map(todoKeywordSet => {\n          return todoKeywordSet.get('configLine');\n        })\n        .join('\\n') +\n      '\\n';\n  }\n\n  if (linesBeforeHeadings.size > 0) {\n    configContent = configContent + linesBeforeHeadings.join('\\n');\n  }\n\n  // TODO: maybe this adds empty lines?\n  if (configContent.length > 0) {\n    configContent = configContent + '\\n';\n  }\n\n  const headerContent = headers\n    .toJS()\n    .map(header => {\n      let contents = '';\n      contents += '*'.repeat(header.nestingLevel);\n\n      if (header.titleLine.todoKeyword) {\n        contents += ` ${header.titleLine.todoKeyword}`;\n      }\n      contents += ` ${header.titleLine.rawTitle}`;\n\n      if (header.titleLine.tags.length > 0) {\n        contents += ` :${header.titleLine.tags.filter(tag => !!tag).join(':')}:`;\n      }\n\n      if (header.planningItems.length > 0) {\n        const planningItemsContent = header.planningItems\n          .map(\n            planningItem => `${planningItem.type}: ${renderAsText(fromJS(planningItem.timestamp))}`\n          )\n          .join(' ')\n          .trimRight();\n        contents += `\\n  ${planningItemsContent}`;\n      }\n\n      if (header.propertyListItems.length > 0) {\n        contents += '\\n:PROPERTIES:';\n        header.propertyListItems.forEach(propertyListItem => {\n          contents += `\\n:${propertyListItem.property}: ${attributedStringToRawText(\n            fromJS(propertyListItem.value)\n          )}`;\n        });\n        contents += '\\n:END:\\n';\n      }\n\n      if (header.description) {\n        if (!header.rawDescription.startsWith('\\n') && header.rawDescription.length !== 0) {\n          contents += '\\n';\n        }\n        contents += header.rawDescription;\n      }\n\n      return contents;\n    })\n    .join('\\n');\n\n  return configContent + headerContent;\n};\n","import { Map } from 'immutable';\nimport formatDate from 'date-fns/format';\nimport _ from 'lodash';\n\nexport default (templateString, customVariables = Map()) => {\n  if (!templateString) {\n    return ['', null];\n  }\n\n  const substitutions = {\n    '%t': `<${formatDate(new Date(), 'YYYY-MM-DD ddd')}>`,\n    '%T': `<${formatDate(new Date(), 'YYYY-MM-DD ddd HH:mm')}>`,\n    '%u': `[${formatDate(new Date(), 'YYYY-MM-DD ddd')}]`,\n    '%U': `[${formatDate(new Date(), 'YYYY-MM-DD ddd HH:mm')}]`,\n  };\n\n  customVariables.entrySeq().forEach(([key, value]) => {\n    substitutions[`%${key}`] = value;\n  });\n\n  let substitutedString = templateString;\n  _.entries(substitutions).forEach(\n    ([formatString, value]) =>\n      (substitutedString = substitutedString.replace(RegExp(formatString, 'g'), value))\n  );\n\n  const cursorIndex = substitutedString.includes('%?') ? substitutedString.indexOf('%?') : null;\n  substitutedString = substitutedString.replace(/%\\?/, '');\n\n  return [substitutedString, cursorIndex];\n};\n","export default (() => {\n  let nextId = 1;\n  return () => nextId++;\n})();\n","import generateId from './id_generator';\n\nimport { List, fromJS } from 'immutable';\n\nexport const indexOfHeaderWithId = (headers, headerId) => {\n  return headers.findIndex(header => header.get('id') === headerId);\n};\n\nexport const headerWithId = (headers, headerId) => {\n  return headers.get(indexOfHeaderWithId(headers, headerId));\n};\n\nexport const subheadersOfHeaderWithId = (headers, headerId) => {\n  const header = headerWithId(headers, headerId);\n  const headerIndex = indexOfHeaderWithId(headers, headerId);\n\n  const afterHeaders = headers.slice(headerIndex + 1);\n  const nextSiblingHeaderIndex = afterHeaders.findIndex(siblingHeader => {\n    return siblingHeader.get('nestingLevel') <= header.get('nestingLevel');\n  });\n\n  if (nextSiblingHeaderIndex === -1) {\n    return afterHeaders;\n  } else {\n    return afterHeaders.slice(0, nextSiblingHeaderIndex);\n  }\n};\n\nexport const numSubheadersOfHeaderWithId = (headers, headerId) =>\n  subheadersOfHeaderWithId(headers, headerId).size;\n\nexport const directParentIdOfHeaderWithId = (headers, headerId) => {\n  const header = headerWithId(headers, headerId);\n  const headerIndex = indexOfHeaderWithId(headers, headerId);\n\n  for (let i = headerIndex - 1; i >= 0; --i) {\n    const previousHeader = headers.get(i);\n\n    if (previousHeader.get('nestingLevel') === header.get('nestingLevel') - 1) {\n      return previousHeader.get('id');\n    }\n\n    if (previousHeader.get('nestingLevel') < header.get('nestingLevel')) {\n      return null;\n    }\n  }\n\n  return null;\n};\n\nexport const parentIdOfHeaderWithId = (headers, headerId) => {\n  const header = headerWithId(headers, headerId);\n  const headerIndex = indexOfHeaderWithId(headers, headerId);\n\n  const previousHeaders = headers.slice(0, headerIndex).reverse();\n  const parentHeader = previousHeaders.find(\n    previousHeader => previousHeader.get('nestingLevel') < header.get('nestingLevel')\n  );\n\n  if (!parentHeader) {\n    return null;\n  }\n\n  return parentHeader.get('id');\n};\n\nexport const indexOfPreviousSibling = (headers, headerIndex) => {\n  const nestingLevel = headers.getIn([headerIndex, 'nestingLevel']);\n\n  for (let i = headerIndex - 1; i >= 0; --i) {\n    const header = headers.get(i);\n\n    if (header.get('nestingLevel') < nestingLevel) {\n      return null;\n    }\n\n    if (header.get('nestingLevel') === nestingLevel) {\n      return i;\n    }\n  }\n\n  return null;\n};\n\nconst isHeaderVisible = (headers, headerId) => {\n  const parentHeaderId = parentIdOfHeaderWithId(headers, headerId);\n  if (!parentHeaderId) {\n    return true;\n  }\n\n  const parentHeader = headerWithId(headers, parentHeaderId);\n  return parentHeader.get('opened') && isHeaderVisible(headers, parentHeader.get('id'));\n};\n\nexport const nextVisibleHeaderAfterIndex = (headers, headerIndex) => {\n  const followingHeaders = headers.slice(headerIndex + 1);\n  return followingHeaders.find(header => isHeaderVisible(headers, header.get('id')));\n};\n\nexport const previousVisibleHeaderAfterIndex = (headers, headerIndex) => {\n  const previousHeaders = headers.slice(0, headerIndex).reverse();\n  return previousHeaders.find(header => isHeaderVisible(headers, header.get('id')));\n};\n\nexport const openDirectParent = (state, headerId) => {\n  const parentHeaderId = directParentIdOfHeaderWithId(state.get('headers'), headerId);\n  if (parentHeaderId !== null) {\n    const parentHeaderIndex = indexOfHeaderWithId(state.get('headers'), parentHeaderId);\n    state = state.setIn(['headers', parentHeaderIndex, 'opened'], true);\n  }\n\n  return state;\n};\n\nexport const getOpenHeaderPaths = headers => {\n  let openedHeaders = [];\n  for (let i = 0; i < headers.size; ++i) {\n    const header = headers.get(i);\n    if (!header.get('opened')) {\n      continue;\n    }\n\n    const title = header.getIn(['titleLine', 'rawTitle']);\n\n    const subheaders = subheadersOfHeaderWithId(headers, header.get('id'));\n    const openSubheaderPaths = getOpenHeaderPaths(subheaders);\n\n    if (openSubheaderPaths.length > 0) {\n      openSubheaderPaths.forEach(openedSubheaderPath => {\n        openedHeaders.push([title].concat(openedSubheaderPath));\n      });\n    } else {\n      openedHeaders.push([title]);\n    }\n\n    i += subheaders.size;\n  }\n\n  return openedHeaders;\n};\n\nexport const headerWithPath = (headers, headerPath) => {\n  if (headerPath.size === 0) {\n    return null;\n  }\n\n  const firstHeader = headers.find(\n    header =>\n      parentIdOfHeaderWithId(headers, header.get('id')) === null &&\n      header.getIn(['titleLine', 'rawTitle']).trim() === headerPath.first().trim()\n  );\n  if (!firstHeader) {\n    return null;\n  }\n\n  if (headerPath.size === 1) {\n    return firstHeader;\n  }\n\n  const subheaders = subheadersOfHeaderWithId(headers, firstHeader.get('id'));\n  return headerWithPath(subheaders, headerPath.skip(1));\n};\n\nexport const openHeaderWithPath = (headers, headerPath, maxNestingLevel = 1) => {\n  if (headerPath.size === 0) {\n    return headers;\n  }\n\n  const firstTitle = headerPath.first();\n  const headerIndex = headers.findIndex(header => {\n    const rawTitle = header.getIn(['titleLine', 'rawTitle']);\n    const nestingLevel = header.get('nestingLevel');\n    return rawTitle === firstTitle && nestingLevel <= maxNestingLevel;\n  });\n  if (headerIndex === -1) {\n    return headers;\n  }\n\n  headers = headers.update(headerIndex, header => header.set('opened', true));\n\n  let subheaders = subheadersOfHeaderWithId(headers, headers.getIn([headerIndex, 'id']));\n  subheaders = openHeaderWithPath(subheaders, headerPath.rest(), maxNestingLevel + 1);\n\n  headers = headers\n    .take(headerIndex + 1)\n    .concat(subheaders)\n    .concat(headers.takeLast(headers.size - (headerIndex + 1 + subheaders.size)));\n\n  return headers;\n};\n\nconst tablePartContainsCellId = (tablePart, cellId) =>\n  tablePart\n    .get('contents')\n    .some(row => row.get('contents').some(cell => cell.get('id') === cellId));\n\nconst doesAttributedStringContainTableCellId = (parts, cellId) =>\n  parts\n    .filter(part => ['table', 'list'].includes(part.get('type')))\n    .some(part =>\n      part.get('type') === 'table'\n        ? tablePartContainsCellId(part, cellId)\n        : part\n            .get('items')\n            .some(item => doesAttributedStringContainTableCellId(item.get('contents'), cellId))\n    );\n\nexport const headerThatContainsTableCellId = (headers, cellId) =>\n  headers.find(header => doesAttributedStringContainTableCellId(header.get('description'), cellId));\n\nexport const pathAndPartOfTimestampItemWithIdInAttributedString = (parts, timestampId) =>\n  parts\n    .map((part, partIndex) => {\n      if (part.get('type') === 'timestamp' && part.get('id') === timestampId) {\n        return {\n          path: [partIndex],\n          timestampPart: part,\n        };\n      } else if (part.get('type') === 'list') {\n        return part\n          .get('items')\n          .map((item, itemIndex) => {\n            let pathAndPart = pathAndPartOfTimestampItemWithIdInAttributedString(\n              item.get('contents'),\n              timestampId\n            );\n            if (!!pathAndPart) {\n              const { path, timestampPart } = pathAndPart;\n              return {\n                path: [partIndex, 'items', itemIndex, 'contents'].concat(path),\n                timestampPart,\n              };\n            } else {\n              let pathAndPart = pathAndPartOfTimestampItemWithIdInAttributedString(\n                item.get('titleLine'),\n                timestampId\n              );\n              if (!!pathAndPart) {\n                const { path, timestampPart } = pathAndPart;\n                return {\n                  path: [partIndex, 'items', itemIndex, 'titleLine'].concat(path),\n                  timestampPart,\n                };\n              } else {\n                return null;\n              }\n            }\n          })\n          .filter(result => !!result)\n          .first();\n      } else if (part.get('type') === 'table') {\n        return part\n          .get('contents')\n          .map((row, rowIndex) => {\n            return row\n              .get('contents')\n              .map((cell, cellIndex) => {\n                const pathAndPart = pathAndPartOfTimestampItemWithIdInAttributedString(\n                  cell.get('contents'),\n                  timestampId\n                );\n                if (!!pathAndPart) {\n                  const { path, timestampPart } = pathAndPart;\n                  return {\n                    path: [\n                      partIndex,\n                      'contents',\n                      rowIndex,\n                      'contents',\n                      cellIndex,\n                      'contents',\n                    ].concat(path),\n                    timestampPart,\n                  };\n                } else {\n                  return null;\n                }\n              })\n              .filter(result => !!result)\n              .first();\n          })\n          .filter(result => !!result)\n          .first();\n      } else {\n        return null;\n      }\n    })\n    .filter(result => !!result)\n    .first();\n\nconst listPartContainsItemId = (listPart, itemId) =>\n  listPart.get('items').some(item => item.get('id') === itemId);\n\nexport const headerThatContainsListItemId = (headers, listItemId) => {\n  const pathAndPart = pathAndPartOfListItemWithIdInHeaders(headers, listItemId);\n  const headerIndex = pathAndPart.path[0];\n  return headers.get(headerIndex);\n};\n\nexport const pathAndPartOfListItemWithIdInAttributedString = (parts, listItemId) =>\n  parts\n    .map((part, partIndex) => {\n      if (part.get('type') === 'list') {\n        return part\n          .get('items')\n          .map((item, itemIndex) => {\n            if (item.get('id') === listItemId) {\n              return {\n                path: [partIndex, 'items', itemIndex],\n                listItemPart: item,\n              };\n            } else {\n              const pathAndPart = pathAndPartOfListItemWithIdInAttributedString(\n                item.get('contents'),\n                listItemId\n              );\n              if (!!pathAndPart) {\n                const { path, listItemPart } = pathAndPart;\n                return {\n                  path: [partIndex, 'items', itemIndex, 'contents'].concat(path),\n                  listItemPart,\n                };\n              } else {\n                return null;\n              }\n            }\n          })\n          .filter(result => !!result)\n          .first();\n      } else {\n        return null;\n      }\n    })\n    .filter(result => !!result)\n    .first();\n\nexport const pathAndPartOfTableContainingCellIdInAttributedString = (parts, cellId) =>\n  parts\n    .map((part, partIndex) => {\n      if (part.get('type') === 'table') {\n        if (tablePartContainsCellId(part, cellId)) {\n          return { path: [partIndex], tablePart: part };\n        } else {\n          return null;\n        }\n      } else if (part.get('type') === 'list') {\n        return part\n          .get('items')\n          .map((item, itemIndex) => {\n            const pathAndPart = pathAndPartOfTableContainingCellIdInAttributedString(\n              item.get('contents'),\n              cellId\n            );\n            if (!!pathAndPart) {\n              const { path, tablePart } = pathAndPart;\n              return {\n                path: [partIndex, 'items', itemIndex, 'contents'].concat(path),\n                tablePart,\n              };\n            } else {\n              return null;\n            }\n          })\n          .filter(result => !!result)\n          .first();\n      } else {\n        return null;\n      }\n    })\n    .filter(result => !!result)\n    .first();\n\nexport const pathAndPartOfListContainingItemIdInHeaders = (headers, itemId) =>\n  headers\n    .map((header, headerIndex) => {\n      const pathAndPart = pathAndPartOfListContainingItemIdInAttributedString(\n        header.get('description'),\n        itemId\n      );\n      if (!pathAndPart) {\n        return null;\n      }\n\n      const { path, listPart } = pathAndPart;\n      return {\n        path: [headerIndex, 'description'].concat(path),\n        listPart,\n      };\n    })\n    .filter(result => !!result)\n    .first();\n\nexport const pathAndPartOfListContainingItemIdInAttributedString = (parts, itemId) =>\n  parts\n    .map((part, partIndex) => {\n      if (part.get('type') === 'list') {\n        if (listPartContainsItemId(part, itemId)) {\n          return { path: [partIndex], listPart: part };\n        } else {\n          return part\n            .get('items')\n            .map((item, itemIndex) => {\n              const pathAndPart = pathAndPartOfListContainingItemIdInAttributedString(\n                item.get('contents'),\n                itemId\n              );\n              if (!!pathAndPart) {\n                const { path, listPart } = pathAndPart;\n                return {\n                  path: [partIndex, 'items', itemIndex, 'contents'].concat(path),\n                  listPart,\n                };\n              } else {\n                return null;\n              }\n            })\n            .filter(result => !!result)\n            .first();\n        }\n      } else {\n        return null;\n      }\n    })\n    .filter(result => !!result)\n    .first();\n\nexport const pathAndPartOfTimestampItemWithIdInHeaders = (headers, timestampId) =>\n  headers\n    .map((header, headerIndex) => {\n      let pathAndPart = pathAndPartOfTimestampItemWithIdInAttributedString(\n        header.getIn(['titleLine', 'title']),\n        timestampId\n      );\n      if (!!pathAndPart) {\n        const { path, timestampPart } = pathAndPart;\n        return {\n          path: [headerIndex, 'titleLine', 'title'].concat(path),\n          timestampPart,\n        };\n      }\n\n      pathAndPart = pathAndPartOfTimestampItemWithIdInAttributedString(\n        header.get('description'),\n        timestampId\n      );\n      if (!!pathAndPart) {\n        const { path, timestampPart } = pathAndPart;\n        return {\n          path: [headerIndex, 'description'].concat(path),\n          timestampPart,\n        };\n      }\n\n      pathAndPart = header\n        .get('propertyListItems')\n        .map((propertyListItem, propertyListItemIndex) => {\n          if (!propertyListItem.get('value')) {\n            return null;\n          }\n\n          const plistPathAndPart = pathAndPartOfTimestampItemWithIdInAttributedString(\n            propertyListItem.get('value'),\n            timestampId\n          );\n          if (!!plistPathAndPart) {\n            const { path, timestampPart } = plistPathAndPart;\n            return {\n              path: [headerIndex, 'propertyListItems', propertyListItemIndex, 'value'].concat(path),\n              timestampPart,\n            };\n          }\n\n          return null;\n        })\n        .filter(result => !!result)\n        .first();\n      if (!!pathAndPart) {\n        return pathAndPart;\n      }\n\n      return null;\n    })\n    .filter(result => !!result)\n    .first();\n\nexport const pathAndPartOfListItemWithIdInHeaders = (headers, listItemId) =>\n  headers\n    .map((header, headerIndex) => {\n      const pathAndPart = pathAndPartOfListItemWithIdInAttributedString(\n        header.get('description'),\n        listItemId\n      );\n      if (!pathAndPart) {\n        return null;\n      }\n\n      const { path, listItemPart } = pathAndPart;\n      return {\n        path: [headerIndex, 'description'].concat(path),\n        listItemPart,\n      };\n    })\n    .filter(result => !!result)\n    .first();\n\nexport const pathAndPartOfTableContainingCellIdInHeaders = (headers, cellId) =>\n  headers\n    .map((header, headerIndex) => {\n      const pathAndPart = pathAndPartOfTableContainingCellIdInAttributedString(\n        header.get('description'),\n        cellId\n      );\n      if (!pathAndPart) {\n        return null;\n      }\n\n      const { path, tablePart } = pathAndPart;\n      return {\n        path: [headerIndex, 'description'].concat(path),\n        tablePart,\n      };\n    })\n    .filter(result => !!result)\n    .first();\n\nexport const updateTableContainingCellId = (headers, cellId, updaterCallbackGenerator) => {\n  const { path, tablePart } = pathAndPartOfTableContainingCellIdInHeaders(headers, cellId);\n\n  const rowIndexContainingCellId = tablePart\n    .get('contents')\n    .findIndex(row => row.get('contents').some(cell => cell.get('id') === cellId));\n  const columnIndexContainingCellId = tablePart\n    .getIn(['contents', rowIndexContainingCellId, 'contents'])\n    .findIndex(cell => cell.get('id') === cellId);\n\n  return headers.updateIn(\n    path.concat(['contents']),\n    updaterCallbackGenerator(rowIndexContainingCellId, columnIndexContainingCellId)\n  );\n};\n\nexport const newEmptyTableRowLikeRows = rows =>\n  rows\n    .get(0)\n    .set('id', generateId())\n    .update('contents', contents =>\n      contents.map(cell =>\n        cell.set('id', generateId()).set('contents', new List()).set('rawContents', '')\n      )\n    );\n\nexport const newEmptyTableCell = () =>\n  fromJS({\n    id: generateId(),\n    contents: [],\n    rawContents: '',\n  });\n\nexport const newListPart = () =>\n  fromJS({\n    type: 'list',\n    id: generateId(),\n    items: [],\n    bulletCharacter: '-',\n    numberTerminatorCharacter: null,\n    isOrdered: false,\n  });\n\nexport const newListPartLikePart = part => part.set('id', generateId()).set('items', new List());\n\nexport const newListItem = () =>\n  fromJS({\n    id: generateId(),\n    titleLine: [],\n    contents: [],\n    forceNumber: null,\n    isCheckbox: false,\n  });\n\nexport const parentListItemWithIdInHeaders = (headers, listItemId) => {\n  const pathAndPart = pathAndPartOfListItemWithIdInHeaders(headers, listItemId);\n  let { path } = pathAndPart;\n  return headers.getIn(path.slice(0, path.length - 4));\n};\n\nexport const updateListContainingListItemId = (headers, listItemId, updaterCallbackGenerator) => {\n  const { path, listPart } = pathAndPartOfListContainingItemIdInHeaders(headers, listItemId);\n\n  const itemIndexContainingId = listPart\n    .get('items')\n    .findIndex(item => item.get('id') === listItemId);\n\n  return headers.updateIn(path.concat(['items']), updaterCallbackGenerator(itemIndexContainingId));\n};\n\nexport const updateContentsWithListItemAddition = (parts, listItem, listPart = null) => {\n  if (parts.size === 0 || parts.last().get('type') !== 'list') {\n    const insertIdx = parts.size;\n    if (!!listPart) {\n      parts = parts.insert(insertIdx, newListPartLikePart(listPart));\n    } else {\n      parts = parts.insert(insertIdx, newListPart());\n    }\n  }\n\n  return parts.map(part => {\n    switch (part.get('type')) {\n      case 'list':\n        return part.update('items', items => items.push(listItem));\n      default:\n        return part;\n    }\n  });\n};\n\nexport const timestampWithIdInAttributedString = (parts, timestampId) => {\n  if (!parts) {\n    return null;\n  }\n\n  const pathAndPart = pathAndPartOfTimestampItemWithIdInAttributedString(parts, timestampId);\n  if (!!pathAndPart) {\n    return pathAndPart.timestampPart;\n  } else {\n    return null;\n  }\n};\n\nexport const timestampWithId = (headers, timestampId) =>\n  headers\n    .map(\n      header =>\n        timestampWithIdInAttributedString(header.getIn(['titleLine', 'title']), timestampId) ||\n        timestampWithIdInAttributedString(header.get('description'), timestampId) ||\n        header\n          .get('propertyListItems')\n          .map(propertyListItem =>\n            timestampWithIdInAttributedString(propertyListItem.get('value'), timestampId)\n          )\n          .filter(result => !!result)\n          .first()\n    )\n    .find(result => !!result);\n\nexport const todoKeywordSetForKeyword = (todoKeywordSets, keyword) =>\n  todoKeywordSets.find(keywordSet => keywordSet.get('keywords').contains(keyword)) ||\n  todoKeywordSets.first();\n\nexport const isTodoKeywordCompleted = (todoKeywordSets, keyword) =>\n  todoKeywordSetForKeyword(todoKeywordSets, keyword).get('completedKeywords').includes(keyword);\n","import generateId from './id_generator';\n\nimport { fromJS } from 'immutable';\n\nexport default fromJS([\n  {\n    description: 'Groceries',\n    headerPaths: ['Capture', 'Groceries'],\n    iconName: 'lemon',\n    id: generateId(),\n    isAvailableInAllOrgFiles: false,\n    letter: '',\n    orgFilesWhereAvailable: [],\n    shouldPrepend: false,\n    template: '* TODO %?',\n    isSample: true,\n  },\n  {\n    description: 'Deeply nested header',\n    headerPaths: ['Capture', 'Deeply', 'Nested', 'Headers', 'Work', 'Too!'],\n    iconName: 'fighter-jet',\n    id: generateId(),\n    isAvailableInAllOrgFiles: false,\n    letter: '',\n    orgFilesWhereAvailable: [],\n    shouldPrepend: true,\n    template: '* You can insert timestamps too! %T %?',\n    isSample: true,\n  },\n]);\n","import { ActionTypes } from 'redux-linear-undo';\nimport {\n  setLoadingMessage,\n  hideLoadingMessage,\n  setIsLoading,\n  setDisappearingLoadingMessage,\n  activatePopup,\n  closePopup,\n} from './base';\nimport exportOrg from '../lib/export_org';\nimport substituteTemplateVariables from '../lib/capture_template_substitution';\nimport { headerWithPath } from '../lib/org_utils';\n\nimport sampleCaptureTemplates from '../lib/sample_capture_templates';\n\nimport { isAfter, addSeconds } from 'date-fns';\nimport parseDate from 'date-fns/parse';\n\nexport const displayFile = (path, contents) => ({\n  type: 'DISPLAY_FILE',\n  path,\n  contents,\n});\n\nexport const setLastSyncAt = lastSyncAt => ({\n  type: 'SET_LAST_SYNC_AT',\n  lastSyncAt,\n});\n\nexport const stopDisplayingFile = () => {\n  return (dispatch, getState) => {\n    dispatch({ type: 'STOP_DISPLAYING_FILE' });\n    dispatch({ type: ActionTypes.CLEAR_HISTORY });\n    dispatch(unfocusHeader());\n    dispatch(closePopup());\n    dispatch(setLastSyncAt(null));\n  };\n};\n\nexport const sync =\n  ({\n    forceAction = null,\n    successMessage = 'Changes pushed',\n    shouldSuppressMessages = false,\n  } = {}) =>\n  (dispatch, getState) => {\n    const client = getState().syncBackend.get('client');\n    const path = getState().org.present.get('path');\n    if (path === null) {\n      return;\n    }\n\n    if (!shouldSuppressMessages) {\n      dispatch(setLoadingMessage('Syncing...'));\n    }\n    dispatch(setIsLoading(true));\n    dispatch(setOrgFileErrorMessage(null));\n\n    client\n      .getFileContentsAndMetadata(path)\n      .then(({ contents, lastModifiedAt }) => {\n        const isDirty = getState().org.present.get('isDirty');\n        const lastServerModifiedAt = parseDate(lastModifiedAt);\n        const lastSyncAt = getState().org.present.get('lastSyncAt');\n\n        if (isAfter(lastSyncAt, lastServerModifiedAt) || forceAction === 'push') {\n          if (isDirty) {\n            client\n              .updateFile(\n                path,\n                exportOrg(\n                  getState().org.present.get('headers'),\n                  getState().org.present.get('todoKeywordSets'),\n                  getState().org.present.get('fileConfigLines'),\n                  getState().org.present.get('linesBeforeHeadings')\n                )\n              )\n              .then(() => {\n                if (!shouldSuppressMessages) {\n                  dispatch(setDisappearingLoadingMessage(successMessage, 2000));\n                }\n                dispatch(setIsLoading(false));\n                dispatch(setDirty(false));\n                dispatch(setLastSyncAt(addSeconds(new Date(), 5)));\n              })\n              .catch(error => {\n                alert(`There was an error pushing the file: ${error.toString()}`);\n                dispatch(hideLoadingMessage());\n                dispatch(setIsLoading(false));\n              });\n          } else {\n            if (!shouldSuppressMessages) {\n              dispatch(setDisappearingLoadingMessage('Nothing to sync', 2000));\n            }\n            dispatch(setIsLoading(false));\n          }\n        } else {\n          if (isDirty && forceAction !== 'pull') {\n            dispatch(hideLoadingMessage());\n            dispatch(setIsLoading(false));\n            dispatch(activatePopup('sync-confirmation', { lastServerModifiedAt }));\n          } else {\n            dispatch(displayFile(path, contents));\n            dispatch(applyOpennessState());\n            dispatch(setDirty(false));\n            dispatch(setLastSyncAt(addSeconds(new Date(), 5)));\n            if (!shouldSuppressMessages) {\n              dispatch(setDisappearingLoadingMessage('Latest version pulled', 2000));\n            }\n            dispatch(setIsLoading(false));\n          }\n        }\n      })\n      .catch(() => {\n        dispatch(hideLoadingMessage());\n        dispatch(setIsLoading(false));\n        dispatch(setOrgFileErrorMessage('File not found'));\n      });\n  };\n\nexport const openHeader = headerId => ({\n  type: 'OPEN_HEADER',\n  headerId,\n});\n\nexport const toggleHeaderOpened = headerId => ({\n  type: 'TOGGLE_HEADER_OPENED',\n  headerId,\n});\n\nexport const selectHeader = headerId => dispatch => {\n  dispatch({ type: 'SELECT_HEADER', headerId });\n\n  if (!!headerId) {\n    dispatch(setSelectedTableCellId(null));\n    dispatch(setSelectedListItemId(null));\n  }\n};\n\nexport const selectHeaderAndOpenParents = headerId => dispatch => {\n  dispatch(selectHeader(headerId));\n  dispatch({ type: 'OPEN_PARENTS_OF_HEADER', headerId });\n};\n\nexport const advanceTodoState = (headerId = null) => ({\n  type: 'ADVANCE_TODO_STATE',\n  headerId,\n  dirtying: true,\n});\n\nexport const enterEditMode = editModeType => ({\n  type: 'ENTER_EDIT_MODE',\n  editModeType,\n});\n\nexport const exitEditMode = () => ({\n  type: 'EXIT_EDIT_MODE',\n});\n\nexport const updateHeaderTitle = (headerId, newRawTitle) => ({\n  type: 'UPDATE_HEADER_TITLE',\n  headerId,\n  newRawTitle,\n  dirtying: true,\n});\n\nexport const updateHeaderDescription = (headerId, newRawDescription) => ({\n  type: 'UPDATE_HEADER_DESCRIPTION',\n  headerId,\n  newRawDescription,\n  dirtying: true,\n});\n\nexport const addHeader = headerId => ({\n  type: 'ADD_HEADER',\n  headerId,\n  dirtying: true,\n});\n\nexport const selectNextSiblingHeader = headerId => ({\n  type: 'SELECT_NEXT_SIBLING_HEADER',\n  headerId,\n});\n\nexport const addHeaderAndEdit = headerId => dispatch => {\n  dispatch(addHeader(headerId));\n  dispatch(selectNextSiblingHeader(headerId));\n  dispatch(enterEditMode('title'));\n};\n\nexport const selectNextVisibleHeader = headerId => ({\n  type: 'SELECT_NEXT_VISIBLE_HEADER',\n  headerId,\n});\n\nexport const selectPreviousVisibleHeader = headerId => ({\n  type: 'SELECT_PREVIOUS_VISIBLE_HEADER',\n  headerId,\n});\n\nexport const removeHeader = headerId => ({\n  type: 'REMOVE_HEADER',\n  headerId,\n  dirtying: true,\n});\n\nexport const moveHeaderUp = headerId => ({\n  type: 'MOVE_HEADER_UP',\n  headerId,\n  dirtying: true,\n});\n\nexport const moveHeaderDown = headerId => ({\n  type: 'MOVE_HEADER_DOWN',\n  headerId,\n  dirtying: true,\n});\n\nexport const moveHeaderLeft = headerId => ({\n  type: 'MOVE_HEADER_LEFT',\n  headerId,\n  dirtying: true,\n});\n\nexport const moveHeaderRight = headerId => ({\n  type: 'MOVE_HEADER_RIGHT',\n  headerId,\n  dirtying: true,\n});\n\nexport const moveSubtreeLeft = headerId => ({\n  type: 'MOVE_SUBTREE_LEFT',\n  headerId,\n  dirtying: true,\n});\n\nexport const moveSubtreeRight = headerId => ({\n  type: 'MOVE_SUBTREE_RIGHT',\n  headerId,\n  dirtying: true,\n});\n\nexport const focusHeader = headerId => ({\n  type: 'FOCUS_HEADER',\n  headerId,\n});\n\nexport const unfocusHeader = () => ({\n  type: 'UNFOCUS_HEADER',\n});\n\nexport const noOp = () => ({\n  type: 'NO_OP',\n});\n\nexport const applyOpennessState = () => ({\n  type: 'APPLY_OPENNESS_STATE',\n});\n\nexport const setDirty = isDirty => ({\n  type: 'SET_DIRTY',\n  isDirty,\n});\n\nexport const setSelectedTableCellId = cellId => dispatch => {\n  dispatch({ type: 'SET_SELECTED_TABLE_CELL_ID', cellId });\n\n  if (!!cellId) {\n    dispatch(selectHeader(null));\n    dispatch(setSelectedListItemId(null));\n  }\n};\n\nexport const addNewTableRow = () => ({\n  type: 'ADD_NEW_TABLE_ROW',\n  dirtying: true,\n});\n\nexport const removeTableRow = () => ({\n  type: 'REMOVE_TABLE_ROW',\n  dirtying: true,\n});\n\nexport const addNewTableColumn = () => ({\n  type: 'ADD_NEW_TABLE_COLUMN',\n  dirtying: true,\n});\n\nexport const removeTableColumn = () => ({\n  type: 'REMOVE_TABLE_COLUMN',\n  dirtying: true,\n});\n\nexport const moveTableRowDown = () => ({\n  type: 'MOVE_TABLE_ROW_DOWN',\n  dirtying: true,\n});\n\nexport const moveTableRowUp = () => ({\n  type: 'MOVE_TABLE_ROW_UP',\n  dirtying: true,\n});\n\nexport const moveTableColumnLeft = () => ({\n  type: 'MOVE_TABLE_COLUMN_LEFT',\n  dirtying: true,\n});\n\nexport const moveTableColumnRight = () => ({\n  type: 'MOVE_TABLE_COLUMN_RIGHT',\n  dirtying: true,\n});\n\nexport const updateTableCellValue = (cellId, newValue) => ({\n  type: 'UPDATE_TABLE_CELL_VALUE',\n  cellId,\n  newValue,\n  dirtying: true,\n});\n\nexport const insertCapture = (templateId, content, shouldPrepend) => (dispatch, getState) => {\n  dispatch(closePopup());\n\n  const template = getState()\n    .capture.get('captureTemplates')\n    .concat(sampleCaptureTemplates)\n    .find(template => template.get('id') === templateId);\n  dispatch({ type: 'INSERT_CAPTURE', template, content, shouldPrepend, dirtying: true });\n};\n\nexport const clearPendingCapture = () => ({\n  type: 'CLEAR_PENDING_CAPTURE',\n});\n\nexport const insertPendingCapture = () => (dispatch, getState) => {\n  const pendingCapture = getState().org.present.get('pendingCapture');\n  const templateName = pendingCapture.get('captureTemplateName');\n  const captureContent = pendingCapture.get('captureContent');\n  const customCaptureVariables = pendingCapture.get('customCaptureVariables');\n\n  dispatch(clearPendingCapture());\n  window.history.pushState({}, '', window.location.pathname);\n\n  const template = getState()\n    .capture.get('captureTemplates')\n    .filter(\n      template =>\n        template.get('isAvailableInAllOrgFiles') ||\n        template.get('orgFilesWhereAvailable').includes(getState().org.present.get('path'))\n    )\n    .find(template => template.get('description').trim() === templateName.trim());\n  if (!template) {\n    dispatch(\n      setDisappearingLoadingMessage(\n        `Capture failed: \"${templateName}\" template not found or not available in this file`,\n        8000\n      )\n    );\n    return;\n  }\n\n  const targetHeader = headerWithPath(\n    getState().org.present.get('headers'),\n    template.get('headerPaths')\n  );\n  if (!targetHeader) {\n    dispatch(\n      setDisappearingLoadingMessage(\n        `Capture failed: \"${template.get('description')}\" header path invalid in this file`,\n        8000\n      )\n    );\n    return;\n  }\n\n  const [substitutedTemplate, initialCursorIndex] = substituteTemplateVariables(\n    template.get('template'),\n    customCaptureVariables\n  );\n\n  const content = !!initialCursorIndex\n    ? `${substitutedTemplate.substring(\n        0,\n        initialCursorIndex\n      )}${captureContent}${substitutedTemplate.substring(initialCursorIndex)}`\n    : `${substitutedTemplate}${captureContent}`;\n\n  dispatch(insertCapture(template.get('id'), content, template.get('shouldPrepend')));\n  dispatch(sync({ successMessage: 'Item captured' }));\n};\n\nexport const advanceCheckboxState = listItemId => ({\n  type: 'ADVANCE_CHECKBOX_STATE',\n  listItemId,\n  dirtying: true,\n});\n\nexport const setSelectedListItemId = listItemId => dispatch => {\n  dispatch({ type: 'SET_SELECTED_LIST_ITEM_ID', listItemId });\n\n  if (!!listItemId) {\n    dispatch(selectHeader(null));\n    dispatch(setSelectedTableCellId(null));\n  }\n};\n\nexport const updateListTitleValue = (listItemId, newValue) => ({\n  type: 'UPDATE_LIST_TITLE_VALUE',\n  listItemId,\n  newValue,\n  dirtying: true,\n});\n\nexport const updateListContentsValue = (listItemId, newValue) => ({\n  type: 'UPDATE_LIST_CONTENTS_VALUE',\n  listItemId,\n  newValue,\n  dirtying: true,\n});\n\nexport const addNewListItem = () => ({\n  type: 'ADD_NEW_LIST_ITEM',\n  dirtying: true,\n});\n\nexport const selectNextSiblingListItem = () => ({\n  type: 'SELECT_NEXT_SIBLING_LIST_ITEM',\n});\n\nexport const addNewListItemAndEdit = () => dispatch => {\n  dispatch(addNewListItem());\n  dispatch(selectNextSiblingListItem());\n  dispatch(enterEditMode('list-title'));\n};\n\nexport const removeListItem = () => ({\n  type: 'REMOVE_LIST_ITEM',\n  dirtying: true,\n});\n\nexport const moveListItemUp = () => ({\n  type: 'MOVE_LIST_ITEM_UP',\n  dirtying: true,\n});\n\nexport const moveListItemDown = () => ({\n  type: 'MOVE_LIST_ITEM_DOWN',\n  dirtying: true,\n});\n\nexport const moveListItemLeft = () => ({\n  type: 'MOVE_LIST_ITEM_LEFT',\n  dirtying: true,\n});\n\nexport const moveListItemRight = () => ({\n  type: 'MOVE_LIST_ITEM_RIGHT',\n  dirtying: true,\n});\n\nexport const moveListSubtreeLeft = () => ({\n  type: 'MOVE_LIST_SUBTREE_LEFT',\n  dirtying: true,\n});\n\nexport const moveListSubtreeRight = () => ({\n  type: 'MOVE_LIST_SUBTREE_RIGHT',\n  dirtying: true,\n});\n\nexport const setHeaderTags = (headerId, tags) => ({\n  type: 'SET_HEADER_TAGS',\n  headerId,\n  tags,\n  dirtying: true,\n});\n\nexport const reorderTags = (fromIndex, toIndex) => ({\n  type: 'REORDER_TAGS',\n  fromIndex,\n  toIndex,\n  dirtying: true,\n});\n\nexport const reorderPropertyList = (fromIndex, toIndex) => (dispatch, getState) =>\n  dispatch({\n    type: 'REORDER_PROPERTY_LIST',\n    fromIndex,\n    toIndex,\n    headerId: getState().base.getIn(['activePopup', 'data', 'headerId']),\n    dirtying: true,\n  });\n\nexport const updateTimestampWithId = (timestampId, newTimestamp) => ({\n  type: 'UPDATE_TIMESTAMP_WITH_ID',\n  timestampId,\n  newTimestamp,\n  dirtying: true,\n});\n\nexport const updatePlanningItemTimestamp = (headerId, planningItemIndex, newTimestamp) => ({\n  type: 'UPDATE_PLANNING_ITEM_TIMESTAMP',\n  headerId,\n  planningItemIndex,\n  newTimestamp,\n  dirtying: true,\n});\n\nexport const addNewPlanningItem = (headerId, planningType) => ({\n  type: 'ADD_NEW_PLANNING_ITEM',\n  headerId,\n  planningType,\n  dirtying: true,\n});\n\nexport const updatePropertyListItems = (headerId, newPropertyListItems) => ({\n  type: 'UPDATE_PROPERTY_LIST_ITEMS',\n  headerId,\n  newPropertyListItems,\n  dirtying: true,\n});\n\nexport const setOrgFileErrorMessage = message => ({\n  type: 'SET_ORG_FILE_ERROR_MESSAGE',\n  message,\n});\n","import { sync } from '../actions/org';\n\nexport default store => next => action => {\n  if (action.dirtying && store.getState().base.get('shouldLiveSync')) {\n    store.dispatch(sync({ shouldSuppressMessages: true }));\n  }\n\n  return next(action);\n};\n","import { sync } from '../actions/org';\r\nimport { debounce } from 'lodash';\r\n\r\nconst dispatchSync = store => store.dispatch(sync({ shouldSuppressMessages: true }));\r\n\r\n// The 'visibilitychange' event might get triggered in some browsers many times for one 'real'\r\n// event of the browser becoming visible to the user. Debouncing through lodash ensures that\r\n// it is called at maximum once every second.\r\nvar debouncedDispatchSync = debounce(dispatchSync, 1000);\r\n\r\nexport default store => next => action => {\r\n  window.addEventListener('visibilitychange', () => {\r\n    if (store.getState().base.get('shouldSyncOnBecomingVisibile')) {\r\n      debouncedDispatchSync(store);\r\n    }\r\n  });\r\n\r\n  return next(action);\r\n};\r\n","export const addNewEmptyCaptureTemplate = () => ({\n  type: 'ADD_NEW_EMPTY_CAPTURE_TEMPLATE',\n});\n\nexport const updateTemplateFieldPathValue = (templateId, fieldPath, newValue) => ({\n  type: 'UPDATE_TEMPLATE_FIELD_PATH_VALUE',\n  templateId,\n  fieldPath,\n  newValue,\n});\n\nexport const addNewTemplateOrgFileAvailability = templateId => ({\n  type: 'ADD_NEW_TEMPLATE_ORG_FILE_AVAILABILITY',\n  templateId,\n});\n\nexport const removeTemplateOrgFileAvailability = (templateId, orgFileAvailabilityIndex) => ({\n  type: 'REMOVE_TEMPLATE_ORG_FILE_AVAILABILITY',\n  templateId,\n  orgFileAvailabilityIndex,\n});\n\nexport const addNewTemplateHeaderPath = templateId => ({\n  type: 'ADD_NEW_TEMPLATE_HEADER_PATH',\n  templateId,\n});\n\nexport const removeTemplateHeaderPath = (templateId, headerPathIndex) => ({\n  type: 'REMOVE_TEMPLATE_HEADER_PATH',\n  templateId,\n  headerPathIndex,\n});\n\nexport const deleteTemplate = templateId => ({\n  type: 'DELETE_TEMPLATE',\n  templateId,\n});\n\nexport const restoreCaptureSettings = newSettings => ({\n  type: 'RESTORE_CAPTURE_SETTINGS',\n  newSettings,\n});\n\nexport const reorderCaptureTemplate = (fromIndex, toIndex) => ({\n  type: 'REORDER_CAPTURE_TEMPLATE',\n  fromIndex,\n  toIndex,\n});\n","import { Map, List, fromJS } from 'immutable';\nimport _ from 'lodash';\n\nimport { getOpenHeaderPaths } from '../lib/org_utils';\n\nimport { restoreBaseSettings } from '../actions/base';\nimport { restoreCaptureSettings } from '../actions/capture';\n\nimport generateId from '../lib/id_generator';\n\nexport const isLocalStorageAvailable = () => {\n  try {\n    localStorage.setItem('test', 'test');\n    return localStorage.getItem('test') === 'test';\n  } catch (e) {\n    return false;\n  }\n};\n\nconst debouncedPushConfigToSyncBackend = _.debounce(\n  (syncBackendClient, contents) => {\n    switch (syncBackendClient.type) {\n      case 'Dropbox':\n        syncBackendClient\n          .createFile('/.org-web-config.json', contents)\n          .catch(error =>\n            alert(`There was an error trying to push settings to your sync backend: ${error}`)\n          );\n        break;\n      case 'Google Drive':\n        syncBackendClient\n          .createFile('.org-web-config.json', 'root', contents)\n          .catch(error =>\n            alert(`There was an error trying to push settings to your sync backend: ${error}`)\n          );\n        break;\n      default:\n    }\n  },\n  1000,\n  { maxWait: 3000 }\n);\n\nexport const persistableFields = [\n  {\n    category: 'base',\n    name: 'fontSize',\n    type: 'nullable',\n    shouldStoreInConfig: true,\n  },\n  {\n    category: 'base',\n    name: 'bulletStyle',\n    type: 'nullable',\n    shouldStoreInConfig: true,\n  },\n  {\n    category: 'base',\n    name: 'shouldTapTodoToAdvance',\n    type: 'boolean',\n    shouldStoreInConfig: true,\n  },\n\n  {\n    category: 'base',\n    name: 'agendaDefaultDeadlineDelayUnit',\n    type: 'nullable',\n    shouldStoreInConfig: true,\n  },\n  {\n    category: 'base',\n    name: 'agendaDefaultDeadlineDelayValue',\n    type: 'nullable',\n    shouldStoreInConfig: true,\n  },\n\n  {\n    category: 'base',\n    name: 'shouldStoreSettingsInSyncBackend',\n    type: 'boolean',\n    shouldStoreInConfig: true,\n  },\n  {\n    category: 'base',\n    name: 'lastSeenChangelogHeader',\n    type: 'nullable',\n    shouldStoreInConfig: true,\n  },\n  {\n    category: 'base',\n    name: 'customKeybindings',\n    type: 'json',\n    shouldStoreInConfig: true,\n  },\n  {\n    category: 'base',\n    name: 'shouldLiveSync',\n    type: 'boolean',\n    shouldStoreInConfig: false,\n  },\n  {\n    category: 'base',\n    name: 'shouldSyncOnBecomingVisibile',\n    type: 'boolean',\n    shouldStoreInConfig: true,\n  },\n  {\n    category: 'capture',\n    name: 'captureTemplates',\n    type: 'json',\n    shouldStoreInConfig: true,\n    default: new List(),\n  },\n];\n\nexport const readOpennessState = () => {\n  const opennessStateJSONString = localStorage.getItem('headerOpenness');\n  return !!opennessStateJSONString ? JSON.parse(opennessStateJSONString) : null;\n};\n\nconst getFieldsToPersist = (state, fields) =>\n  fields\n    .filter(field => !field.depreacted)\n    .filter(field => field.category === 'org')\n    .map(field => field.name)\n    .map(field => [field, state.org.present.get(field)])\n    .concat(\n      persistableFields\n        .filter(field => field.category !== 'org')\n        .map(field =>\n          field.type === 'json'\n            ? [\n                field.name,\n                JSON.stringify(state[field.category].get(field.name) || field.default || {}),\n              ]\n            : [field.name, state[field.category].get(field.name)]\n        )\n    );\n\nconst getConfigFileContents = fieldsToPersist =>\n  JSON.stringify(\n    _.fromPairs(\n      fieldsToPersist.filter(([name, _value]) => !['lastSeenChangelogHeader'].includes(name))\n    ),\n    null,\n    2\n  );\n\nexport const applyCategorySettingsFromConfig = (state, config, category) => {\n  persistableFields\n    .filter(field => field.category === category)\n    .filter(field => field.shouldStoreInConfig)\n    .filter(\n      field =>\n        // I accidentally included this field in some config files, so I need to forever\n        // filter it out here. Whoops...\n        field.name !== 'lastSeenChangelogHeader'\n    )\n    .forEach(field => {\n      field.type === 'json'\n        ? (state = state.set(field.name, fromJS(JSON.parse(config[field.name]))))\n        : (state = state.set(field.name, config[field.name]));\n    });\n\n  return state;\n};\n\nexport const applyCaptureSettingsFromConfig = (state, config) => {\n  const captureTemplates = fromJS(JSON.parse(config.captureTemplates)).map(template =>\n    template.set('id', generateId())\n  );\n\n  return state.set('captureTemplates', captureTemplates);\n};\n\nexport const readInitialState = () => {\n  if (!isLocalStorageAvailable()) {\n    return undefined;\n  }\n\n  let initialState = {\n    syncBackend: Map(),\n    org: {\n      past: [],\n      present: Map(),\n      future: [],\n    },\n    base: Map(),\n    capture: Map(),\n  };\n\n  persistableFields.forEach(field => {\n    let value = localStorage.getItem(field.name);\n\n    if (field.type === 'nullable') {\n      if (value === 'null') {\n        value = null;\n      }\n    } else if (field.type === 'boolean') {\n      value = value === 'true';\n    } else if (field.type === 'json') {\n      if (!value) {\n        value = field.default || new Map();\n      } else {\n        value = fromJS(JSON.parse(value));\n      }\n    }\n\n    if (field.category === 'org') {\n      initialState[field.category].present = initialState[field.category].present.set(\n        field.name,\n        value\n      );\n    } else {\n      initialState[field.category] = initialState[field.category].set(field.name, value);\n    }\n  });\n\n  // Assign new ids to the capture templates.\n  if (initialState.capture.get('captureTemplates')) {\n    initialState.capture = initialState.capture.update('captureTemplates', templates =>\n      templates.map(template => template.set('id', generateId()))\n    );\n  }\n\n  const opennessState = readOpennessState();\n  if (!!opennessState) {\n    initialState.org.present = initialState.org.present.set('opennessState', fromJS(opennessState));\n  }\n\n  // Cache the config file contents locally so we don't overwrite on initial page load.\n  window.previousSettingsFileContents = getConfigFileContents(\n    getFieldsToPersist(initialState, persistableFields)\n  );\n\n  return initialState;\n};\n\nexport const loadSettingsFromConfigFile = (dispatch, getState) => {\n  const syncBackendClient = getState().syncBackend.get('client');\n  if (!syncBackendClient) {\n    return;\n  }\n\n  let fileContentsPromise = null;\n  switch (syncBackendClient.type) {\n    case 'Dropbox':\n      fileContentsPromise = syncBackendClient.getFileContents('/.org-web-config.json');\n      break;\n    case 'Google Drive':\n      fileContentsPromise = syncBackendClient.getFileContentsByNameAndParent(\n        '.org-web-config.json',\n        'root'\n      );\n      break;\n    default:\n  }\n\n  fileContentsPromise\n    .then(configFileContents => {\n      try {\n        const config = JSON.parse(configFileContents);\n        dispatch(restoreBaseSettings(config));\n        dispatch(restoreCaptureSettings(config));\n      } catch (_error) {\n        // Something went wrong parsing the config file, but we don't care, we'll just\n        // overwrite it with a good local copy.\n      }\n    })\n    .catch(() => {});\n};\n\nexport const subscribeToChanges = store => {\n  if (!isLocalStorageAvailable()) {\n    return () => {};\n  } else {\n    return () => {\n      const state = store.getState();\n\n      const fieldsToPersist = getFieldsToPersist(state, persistableFields);\n\n      fieldsToPersist.forEach(([name, value]) => localStorage.setItem(name, value));\n\n      if (state.base.get('shouldStoreSettingsInSyncBackend')) {\n        const settingsFileContents = getConfigFileContents(fieldsToPersist);\n\n        if (window.previousSettingsFileContents !== settingsFileContents) {\n          debouncedPushConfigToSyncBackend(state.syncBackend.get('client'), settingsFileContents);\n        }\n\n        window.previousSettingsFileContents = settingsFileContents;\n      }\n\n      const currentFilePath = state.org.present.get('path');\n      if (!!currentFilePath && state.org.present.get('headers')) {\n        const openHeaderPaths = getOpenHeaderPaths(state.org.present.get('headers'));\n\n        let opennessState = {};\n        const opennessStateJSONString = localStorage.getItem('headerOpenness');\n        if (opennessStateJSONString) {\n          opennessState = JSON.parse(opennessStateJSONString);\n        }\n\n        opennessState[currentFilePath] = openHeaderPaths;\n        localStorage.setItem('headerOpenness', JSON.stringify(opennessState));\n      }\n    };\n  }\n};\n\nexport const persistField = (field, value) => {\n  if (!isLocalStorageAvailable()) {\n    return;\n  } else {\n    localStorage.setItem(field, value);\n  }\n};\n\nexport const getPersistedField = (field, nullable = false) => {\n  if (!isLocalStorageAvailable()) {\n    return null;\n  } else {\n    const value = localStorage.getItem(field);\n    if (nullable) {\n      return value === 'null' ? null : value;\n    } else {\n      return value;\n    }\n  }\n};\n","import { Map, List, fromJS } from 'immutable';\n\nimport { applyCategorySettingsFromConfig } from '../util/settings_persister';\n\nconst setLoadingMessage = (state, action) => state.set('loadingMessage', action.loadingMessage);\n\nconst hideLoadingMessage = (state, action) => state.set('loadingMessage', null);\n\nconst setFontSize = (state, action) => state.set('fontSize', action.newFontSize);\n\nconst setBulletStyle = (state, action) => state.set('bulletStyle', action.newBulletStyle);\n\nconst setShouldTapTodoToAdvance = (state, action) =>\n  state.set('shouldTapTodoToAdvance', action.newShouldTapTodoToAdvance);\n\nconst setAgendaDefaultDeadlineDelayUnit = (state, action) =>\n  state.set('agendaDefaultDeadlineDelayUnit', action.newAgendaDefaultDeadlineDelayUnit);\n\nconst setAgendaDefaultDeadlineDelayValue = (state, action) =>\n  state.set('agendaDefaultDeadlineDelayValue', action.newAgendaDefaultDeadlineDelayValue);\n\nconst setShouldStoreSettingsInSyncBackend = (state, action) =>\n  state.set('shouldStoreSettingsInSyncBackend', action.newShouldStoreSettingsInSyncBackend);\n\nconst setShouldLiveSync = (state, action) => state.set('shouldLiveSync', action.shouldLiveSync);\n\nconst setShouldSyncOnBecomingVisibile = (state, action) =>\n  state.set('shouldSyncOnBecomingVisibile', action.shouldSyncOnBecomingVisibile);\n\nconst setHasUnseenChangelog = (state, action) =>\n  state.set('hasUnseenChangelog', action.newHasUnseenChangelog);\n\nconst setLastSeenChangelogHeader = (state, action) =>\n  state.set('lastSeenChangelogHeader', action.newLastSeenChangelogHeader);\n\nconst setLastViewedFile = (state, action) =>\n  state\n    .set('lastViewedPath', action.lastViewedPath)\n    .set('lastViewedContents', action.lastViewedContents);\n\nconst setCustomKeybinding = (state, action) => {\n  if (!state.get('customKeybindings')) {\n    state = state.set('customKeybindings', new Map());\n  }\n\n  return state.setIn(['customKeybindings', action.keybindingName], action.keybinding);\n};\n\nconst restoreBaseSettings = (state, action) => {\n  if (!action.newSettings) {\n    return state;\n  }\n\n  return applyCategorySettingsFromConfig(state, action.newSettings, 'base');\n};\n\nconst pushModalPage = (state, action) =>\n  state.update('modalPageStack', stack =>\n    !!stack ? stack.push(action.modalPage) : List([action.modalPage])\n  );\n\nconst popModalPage = state =>\n  state.update('modalPageStack', stack => (!!stack ? stack.pop() : stack));\n\nconst clearModalStack = state => state.set('modalPageStack', List());\n\nconst activatePopup = (state, action) =>\n  state.set(\n    'activePopup',\n    fromJS({\n      type: action.popupType,\n      data: action.data,\n    })\n  );\n\nconst closePopup = state => state.set('activePopup', null);\n\nconst setIsLoading = (state, action) => state.set('isLoading', action.isLoading);\n\nexport default (state = new Map(), action) => {\n  switch (action.type) {\n    case 'SET_LOADING_MESSAGE':\n      return setLoadingMessage(state, action);\n    case 'HIDE_LOADING_MESSAGE':\n      return hideLoadingMessage(state, action);\n    case 'SET_FONT_SIZE':\n      return setFontSize(state, action);\n    case 'SET_BULLET_STYLE':\n      return setBulletStyle(state, action);\n    case 'SET_SHOULD_TAP_TODO_TO_ADVANCE':\n      return setShouldTapTodoToAdvance(state, action);\n    case 'SET_AGENDA_DEFAULT_DEADLINE_DELAY_UNIT':\n      return setAgendaDefaultDeadlineDelayUnit(state, action);\n    case 'SET_AGENDA_DEFAULT_DEADLINE_DELAY_VALUE':\n      return setAgendaDefaultDeadlineDelayValue(state, action);\n    case 'SET_SHOULD_STORE_SETTINGS_IN_SYNC_BACKEND':\n      return setShouldStoreSettingsInSyncBackend(state, action);\n    case 'SET_SHOULD_LIVE_SYNC':\n      return setShouldLiveSync(state, action);\n    case 'SET_SHOULD_SYNC_ON_BECOMING_VISIBLE':\n      return setShouldSyncOnBecomingVisibile(state, action);\n    case 'SET_HAS_UNSEEN_CHANGELOG':\n      return setHasUnseenChangelog(state, action);\n    case 'SET_LAST_SEEN_CHANGELOG_HEADER':\n      return setLastSeenChangelogHeader(state, action);\n    case 'SET_LAST_VIEWED_FILE':\n      return setLastViewedFile(state, action);\n    case 'SET_CUSTOM_KEYBINDING':\n      return setCustomKeybinding(state, action);\n    case 'RESTORE_BASE_SETTINGS':\n      return restoreBaseSettings(state, action);\n    case 'PUSH_MODAL_PAGE':\n      return pushModalPage(state, action);\n    case 'POP_MODAL_PAGE':\n      return popModalPage(state, action);\n    case 'CLEAR_MODAL_STACK':\n      return clearModalStack(state, action);\n    case 'ACTIVATE_POPUP':\n      return activatePopup(state, action);\n    case 'CLOSE_POPUP':\n      return closePopup(state, action);\n    case 'SET_IS_LOADING':\n      return setIsLoading(state, action);\n    default:\n      return state;\n  }\n};\n","import generateId from './id_generator';\n\nimport { fromJS, List } from 'immutable';\nimport _ from 'lodash';\n\n// Yeah, this thing is pretty wild. I use https://www.debuggex.com/ to edit it, then paste the results in here.\n// But fixing this mess is on my todo list...\nconst markupAndCookieRegex =\n  /(\\[\\[([^\\]]*)\\]\\]|\\[\\[([^\\]]*)\\]\\[([^\\]]*)\\]\\])|(\\[((\\d*%)|(\\d*\\/\\d*))\\])|(([\\s({'\"]?)([*/~=_+])([^\\s,'](.*)[^\\s,'])\\11([\\s\\-.,:!?'\")}]?))|(([<[])(\\d{4})-(\\d{2})-(\\d{2})(?: ([^0-9]{1,9}))?(?: ([012]?\\d:[0-5]\\d))?(?:-([012]?\\d:[0-5]\\d))?(?: ((?:\\+)|(?:\\+\\+)|(?:\\.\\+)|(?:-)|(?:--))(\\d+)(h|d|w|m|y))?(?: ((?:\\+)|(?:\\+\\+)|(?:\\.\\+)|(?:-)|(?:--))(\\d+)(h|d|w|m|y))?[>\\]](?:--([<[])(\\d{4})-(\\d{2})-(\\d{2})(?: ([^0-9]{1,9}))?(?: ([012]?\\d:[0-5]\\d))?(?:-([012]?\\d:[0-5]\\d))?(?: ((?:\\+)|(?:\\+\\+)|(?:\\.\\+)|(?:-)|(?:--))(\\d+)(h|d|w|m|y))?(?: ((?:\\+)|(?:\\+\\+)|(?:\\.\\+)|(?:-)|(?:--))(\\d+)(h|d|w|m|y))?[>\\]])?)/g;\nconst timestampRegex =\n  /([<[])(\\d{4})-(\\d{2})-(\\d{2})(?: ([^0-9]{1,9}))?(?: ([012]?\\d:[0-5]\\d))?(?:-([012]?\\d:[0-5]\\d))?(?: ((?:\\+)|(?:\\+\\+)|(?:\\.\\+)|(?:-)|(?:--))(\\d+)(h|d|w|m|y))?(?: ((?:\\+)|(?:\\+\\+)|(?:\\.\\+)|(?:-)|(?:--))(\\d+)(h|d|w|m|y))?[>\\]]/;\n\nconst timestampFromRegexMatch = (match, partIndices) => {\n  const [\n    typeBracket,\n    year,\n    month,\n    day,\n    dayName,\n    timeStart,\n    timeEnd,\n    firstDelayRepeatType,\n    firstDelayRepeatValue,\n    firstDelayRepeatUnit,\n    secondDelayRepeatType,\n    secondDelayRepeatValue,\n    secondDelayRepeatUnit,\n  ] = partIndices.map(partIndex => match[partIndex]);\n\n  if (!year) {\n    return null;\n  }\n\n  const [startHour, startMinute] = !!timeStart ? timeStart.split(':') : [];\n  const [endHour, endMinute] = !!timeEnd ? timeEnd.split(':') : [];\n\n  let repeaterType, repeaterValue, repeaterUnit;\n  let delayType, delayValue, delayUnit;\n\n  if (['+', '++', '.+'].includes(firstDelayRepeatType)) {\n    repeaterType = firstDelayRepeatType;\n    repeaterValue = firstDelayRepeatValue;\n    repeaterUnit = firstDelayRepeatUnit;\n  } else if (['-', '--'].includes(firstDelayRepeatType)) {\n    delayType = firstDelayRepeatType;\n    delayValue = firstDelayRepeatValue;\n    delayUnit = firstDelayRepeatUnit;\n  }\n  if (['+', '++', '.+'].includes(secondDelayRepeatType)) {\n    repeaterType = secondDelayRepeatType;\n    repeaterValue = secondDelayRepeatValue;\n    repeaterUnit = secondDelayRepeatUnit;\n  } else if (['-', '--'].includes(secondDelayRepeatType)) {\n    delayType = secondDelayRepeatType;\n    delayValue = secondDelayRepeatValue;\n    delayUnit = secondDelayRepeatUnit;\n  }\n\n  return {\n    isActive: typeBracket === '<',\n    year,\n    month,\n    day,\n    dayName,\n    startHour,\n    startMinute,\n    endHour,\n    endMinute,\n    repeaterType,\n    repeaterValue,\n    repeaterUnit,\n    delayType,\n    delayValue,\n    delayUnit,\n  };\n};\n\nexport const parseMarkupAndCookies = (\n  rawText,\n  { shouldAppendNewline = false, excludeCookies = true } = {}\n) => {\n  const matches = [];\n  let match = markupAndCookieRegex.exec(rawText);\n  while (match) {\n    if (!!match[2]) {\n      matches.push({\n        type: 'link',\n        rawText: match[0],\n        uri: match[2],\n        index: match.index,\n      });\n    } else if (!!match[3] && !!match[4]) {\n      matches.push({\n        type: 'link',\n        rawText: match[0],\n        uri: match[3],\n        title: match[4],\n        index: match.index,\n      });\n    } else if (!!match[7]) {\n      const percentCookieMatch = match[7].match(/(\\d*)%/);\n      matches.push({\n        type: 'percentage-cookie',\n        rawText: match[0],\n        percentage: percentCookieMatch[1],\n        index: match.index,\n      });\n    } else if (!!match[8]) {\n      const fractionCookieMatch = match[8].match(/(\\d*)\\/(\\d*)/);\n      matches.push({\n        type: 'fraction-cookie',\n        rawText: match[0],\n        fraction: [fractionCookieMatch[1], fractionCookieMatch[2]],\n        index: match.index,\n      });\n    } else if (!!match[11]) {\n      const markupType = {\n        '~': 'inline-code',\n        '*': 'bold',\n        '/': 'italic',\n        '+': 'strikethrough',\n        _: 'underline',\n        '=': 'verbatim',\n      }[match[11]];\n\n      const markupPrefixLength = match[10].length;\n\n      matches.push({\n        type: 'inline-markup',\n        rawText: match[0].substring(markupPrefixLength, match[12].length + 2 + markupPrefixLength),\n        index: match.index + markupPrefixLength,\n        content: match[12],\n        markupType,\n      });\n    } else if (!!match[15]) {\n      const firstTimestamp = timestampFromRegexMatch(match, _.range(16, 29));\n      const secondTimestamp = timestampFromRegexMatch(match, _.range(29, 42));\n\n      matches.push({\n        type: 'timestamp',\n        rawText: match[0],\n        index: match.index,\n        firstTimestamp,\n        secondTimestamp,\n      });\n    }\n    match = markupAndCookieRegex.exec(rawText);\n  }\n\n  const lineParts = [];\n  let startIndex = 0;\n  matches.forEach(match => {\n    let index = match.index;\n\n    if (index !== startIndex) {\n      const text = rawText.substring(startIndex, index);\n      lineParts.push({\n        type: 'text',\n        contents: text,\n      });\n    }\n\n    if (match.type === 'link') {\n      const linkPart = {\n        id: generateId(),\n        type: 'link',\n        contents: {\n          uri: match.uri,\n        },\n      };\n      if (match.title) {\n        linkPart.contents.title = match.title;\n      }\n      lineParts.push(linkPart);\n    } else if (match.type === 'percentage-cookie') {\n      lineParts.push({\n        id: generateId(),\n        type: 'percentage-cookie',\n        percentage: match.percentage,\n      });\n    } else if (match.type === 'fraction-cookie') {\n      lineParts.push({\n        id: generateId(),\n        type: 'fraction-cookie',\n        fraction: match.fraction,\n      });\n    } else if (match.type === 'inline-markup') {\n      lineParts.push({\n        id: generateId(),\n        type: 'inline-markup',\n        content: match.content,\n        markupType: match.markupType,\n      });\n    } else if (match.type === 'timestamp') {\n      lineParts.push({\n        id: generateId(),\n        type: 'timestamp',\n        firstTimestamp: match.firstTimestamp,\n        secondTimestamp: match.secondTimestamp,\n      });\n    }\n\n    startIndex = match.index + match.rawText.length;\n  });\n\n  if (startIndex !== rawText.length || shouldAppendNewline) {\n    const trailingText =\n      rawText.substring(startIndex, rawText.length) + (shouldAppendNewline ? '\\n' : '');\n    lineParts.push({\n      type: 'text',\n      contents: trailingText,\n    });\n  }\n\n  return lineParts;\n};\n\nconst parseTable = tableLines => {\n  const table = {\n    id: generateId(),\n    type: 'table',\n    contents: [[]],\n    columnProperties: [],\n  };\n\n  tableLines\n    .map(line => line.trim())\n    .forEach(line => {\n      if (line.startsWith('|-')) {\n        table.contents.push([]);\n      } else {\n        const lastRow = _.last(table.contents);\n        const lineCells = line.substr(1, line.length - 2).split('|');\n\n        if (lastRow.length === 0) {\n          lineCells.forEach(cell => lastRow.push(cell));\n        } else {\n          lineCells.forEach((cellContents, cellIndex) => {\n            lastRow[cellIndex] += `\\n${cellContents}`;\n          });\n        }\n      }\n    });\n\n  // Parse the contents of each cell.\n  table.contents = table.contents.map(row => ({\n    id: generateId(),\n    contents: row.map(rawContents => ({\n      id: generateId(),\n      contents: parseMarkupAndCookies(rawContents, { excludeCookies: true }),\n      rawContents,\n    })),\n  }));\n\n  // We sometimes end up with an extra, empty row - remove it if so.\n  if (_.last(table.contents).contents.length === 0) {\n    table.contents = table.contents.slice(0, table.contents.length - 1);\n  }\n\n  // Make sure each row has the same number of columns.\n  const maxNumColumns = Math.max(...table.contents.map(row => row.contents.length));\n  table.contents.forEach(row => {\n    if (row.contents.length < maxNumColumns) {\n      _.times(maxNumColumns - row.contents.length, () => {\n        row.contents.push({\n          id: generateId(),\n          contents: [],\n          rawContents: '',\n        });\n      });\n    }\n  });\n\n  return table;\n};\n\nexport const parseRawText = (rawText, { excludeContentElements = false } = {}) => {\n  const lines = rawText.split('\\n');\n\n  const LIST_HEADER_REGEX = /^\\s*([-+*]|(\\d+(\\.|\\)))) (.*)/;\n\n  let currentListHeaderNestingLevel = null;\n  const rawLineParts = _.flatten(\n    lines.map((line, lineIndex) => {\n      const numLeadingSpaces = line.match(/^( *)/)[0].length;\n\n      if (\n        currentListHeaderNestingLevel !== null &&\n        (numLeadingSpaces > currentListHeaderNestingLevel || !line.trim())\n      ) {\n        return [\n          {\n            type: 'raw-list-content',\n            line,\n          },\n        ];\n      } else {\n        currentListHeaderNestingLevel = null;\n\n        if (!!line.match(LIST_HEADER_REGEX) && !excludeContentElements) {\n          currentListHeaderNestingLevel = numLeadingSpaces;\n\n          return [\n            {\n              type: 'raw-list-header',\n              line,\n            },\n          ];\n        } else if (line.trim().startsWith('|') && !excludeContentElements) {\n          return [\n            {\n              type: 'raw-table',\n              line,\n            },\n          ];\n        } else {\n          return parseMarkupAndCookies(line, {\n            shouldAppendNewline: lineIndex !== lines.length - 1,\n            excludeCookies: true,\n          });\n        }\n      }\n    })\n  );\n\n  const processedLineParts = [];\n  for (let partIndex = 0; partIndex < rawLineParts.length; ++partIndex) {\n    const linePart = rawLineParts[partIndex];\n    if (linePart.type === 'raw-table') {\n      const tableLines = _.takeWhile(\n        rawLineParts.slice(partIndex),\n        part => part.type === 'raw-table'\n      ).map(part => part.line);\n\n      processedLineParts.push(parseTable(tableLines));\n\n      partIndex += tableLines.length - 1;\n    } else if (linePart.type === 'raw-list-header') {\n      const numLeadingSpaces = linePart.line.match(/^( *)/)[0].length;\n      const contentLines = _.takeWhile(\n        rawLineParts.slice(partIndex + 1),\n        part => part.type === 'raw-list-content'\n      )\n        .map(part => part.line)\n        .map(line =>\n          line.startsWith(' '.repeat(numLeadingSpaces + 2))\n            ? line.substr(numLeadingSpaces + 2)\n            : line.substr(numLeadingSpaces + 1)\n        );\n      if (contentLines[contentLines.length - 1] === '') {\n        contentLines[contentLines.length - 1] = ' ';\n      }\n      const contents = parseRawText(contentLines.join('\\n')).toJS();\n\n      partIndex += contentLines.length;\n\n      const isOrdered = !!linePart.line.match(/^\\s*\\d+[.)]/);\n\n      // Remove the leading -, +, *, or number characters.\n      let line = linePart.line.match(LIST_HEADER_REGEX)[4];\n\n      let forceNumber = null;\n      if (line.match(/^\\s*\\[@\\d+\\]/)) {\n        forceNumber = line.match(/^\\s*\\[@(\\d+)\\]/)[1];\n        line = line.replace(/^\\s*\\[@\\d+\\]\\s*/, '');\n      }\n\n      let checkboxState = null;\n      const isCheckbox = !!line.match(/^\\s*\\[[ X-]\\]/);\n      if (isCheckbox) {\n        const stateCharacter = line.match(/^\\s*\\[([ X-])\\]/)[1];\n        checkboxState = {\n          ' ': 'unchecked',\n          X: 'checked',\n          '-': 'partial',\n        }[stateCharacter];\n\n        line = line.replace(/^\\s*\\[[ X-]\\]\\s*/, '');\n      }\n\n      const newListItem = {\n        id: generateId(),\n        titleLine: parseMarkupAndCookies(line),\n        contents,\n        forceNumber,\n        isCheckbox,\n        checkboxState,\n      };\n\n      const lastIndex = processedLineParts.length - 1;\n      if (lastIndex >= 0 && processedLineParts[lastIndex].type === 'list') {\n        processedLineParts[lastIndex].items.push(newListItem);\n      } else {\n        processedLineParts.push({\n          type: 'list',\n          id: generateId(),\n          items: [newListItem],\n          bulletCharacter: linePart.line.trim()[0],\n          numberTerminatorCharacter: isOrdered ? linePart.line.match(/\\s*\\d+([.)])/)[1] : null,\n          isOrdered,\n        });\n      }\n    } else {\n      processedLineParts.push(linePart);\n    }\n  }\n\n  return fromJS(processedLineParts);\n};\n\nexport const _parsePlanningItems = rawText => {\n  const singlePlanningItemRegex = concatRegexes(/(DEADLINE|SCHEDULED|CLOSED):\\s*/, timestampRegex);\n  const optionalSinglePlanningItemRegex = RegExp(\n    '(' +\n      singlePlanningItemRegex\n        .toString()\n        .substring(1, singlePlanningItemRegex.toString().length - 1) +\n      ')?'\n  );\n\n  const planningRegex = concatRegexes(\n    /^\\s*/,\n    optionalSinglePlanningItemRegex,\n    /\\s*/,\n    optionalSinglePlanningItemRegex,\n    /\\s*/,\n    optionalSinglePlanningItemRegex,\n    /\\s*/\n  );\n  const planningMatch = rawText.match(planningRegex);\n\n  const planningItems = fromJS(\n    [2, 17, 32]\n      .map(planningTypeIndex => {\n        const type = planningMatch[planningTypeIndex];\n        if (!type) {\n          return null;\n        }\n\n        const timestamp = timestampFromRegexMatch(\n          planningMatch,\n          _.range(planningTypeIndex + 1, planningTypeIndex + 1 + 13)\n        );\n\n        return { type, timestamp, id: generateId() };\n      })\n      .filter(item => !!item)\n  );\n\n  if (planningItems.size > 0) {\n    // The `rawText` can look like:\n    // `SCHEDULED: <2019-07-30 Tue>\n    //   - indented list\n    //      - Foo`\n    // For the remaining description, filter the planning item out\n    const remainingDescriptionWithoutPlanningItem = rawText\n      .split('\\n')\n      .filter(line => {\n        return !line.includes(planningMatch[0].trim());\n      })\n      .join('\\n');\n    return { planningItems, strippedDescription: remainingDescriptionWithoutPlanningItem };\n  } else {\n    return { planningItems: fromJS([]), strippedDescription: rawText };\n  }\n};\n\nconst parsePropertyList = rawText => {\n  const lines = rawText.split('\\n');\n  const propertiesLineIndex = lines.findIndex(line => line.trim() === ':PROPERTIES:');\n  const endLineIndex = lines.findIndex(line => line.trim() === ':END:');\n\n  if (\n    propertiesLineIndex === -1 ||\n    endLineIndex === -1 ||\n    !rawText.trim().startsWith(':PROPERTIES:')\n  ) {\n    return {\n      propertyListItems: List(),\n      strippedDescription: rawText,\n    };\n  }\n\n  const propertyListItems = fromJS(\n    lines\n      .slice(propertiesLineIndex + 1, endLineIndex)\n      .map(line => {\n        const match = line.match(/:([^\\s]*):(?: (.*))?/);\n        if (!match) {\n          return null;\n        }\n\n        const value = !!match[2] ? parseMarkupAndCookies(match[2]) : null;\n\n        return {\n          property: match[1],\n          value,\n          id: generateId(),\n        };\n      })\n      .filter(result => !!result)\n  );\n\n  return {\n    propertyListItems,\n    strippedDescription: lines.slice(endLineIndex + 1).join('\\n'),\n  };\n};\n\nexport const parseDescriptionPrefixElements = rawText => {\n  const planningItemsParse = _parsePlanningItems(rawText);\n  const propertyListParse = parsePropertyList(planningItemsParse.strippedDescription);\n\n  return {\n    planningItems: planningItemsParse.planningItems,\n    propertyListItems: propertyListParse.propertyListItems,\n    strippedDescription: propertyListParse.strippedDescription,\n  };\n};\n\nconst defaultKeywordSets = fromJS([\n  {\n    keywords: ['TODO', 'DONE'],\n    completedKeywords: ['DONE'],\n    default: true,\n  },\n]);\n\nexport const parseTitleLine = (titleLine, todoKeywordSets) => {\n  const allKeywords = todoKeywordSets.flatMap(todoKeywordSet => {\n    return todoKeywordSet.get('keywords');\n  });\n  const todoKeyword = allKeywords.filter(keyword => titleLine.startsWith(keyword + ' ')).first();\n  let rawTitle = titleLine;\n  if (todoKeyword) {\n    rawTitle = rawTitle.substr(todoKeyword.length + 1);\n  }\n\n  // Check for tags.\n  let tags = [];\n  if (rawTitle.trimRight().endsWith(':')) {\n    const titleParts = rawTitle.trimRight().split(' ');\n    const possibleTags = titleParts[titleParts.length - 1];\n    if (/^:[^\\s]+:$/.test(possibleTags)) {\n      rawTitle = rawTitle.substr(0, rawTitle.length - possibleTags.length);\n      tags = possibleTags.split(':').filter(tag => tag !== '');\n    }\n  }\n\n  const title = parseMarkupAndCookies(rawTitle);\n\n  return fromJS({ title, rawTitle, todoKeyword, tags });\n};\n\nexport const newHeaderWithTitle = (line, nestingLevel, todoKeywordSets) => {\n  if (todoKeywordSets.size === 0) {\n    todoKeywordSets = defaultKeywordSets;\n  }\n\n  const titleLine = parseTitleLine(line, todoKeywordSets);\n  return fromJS({\n    titleLine,\n    rawDescription: '',\n    description: [],\n    opened: false,\n    id: generateId(),\n    nestingLevel,\n    planningItems: [],\n    propertyListItems: [],\n  });\n};\n\nconst concatRegexes = (...regexes) =>\n  regexes.reduce((prev, curr) =>\n    RegExp(\n      prev.toString().substring(1, prev.toString().length - 1) +\n        curr.toString().substring(1, curr.toString().length - 1)\n    )\n  );\n\nexport const newHeaderFromText = (rawText, todoKeywordSets) => {\n  const titleLine = rawText.split('\\n')[0].replace(/^\\**\\s*/, '');\n  const description = rawText.split('\\n').slice(1).join('\\n');\n\n  const { planningItems, propertyListItems, strippedDescription } =\n    parseDescriptionPrefixElements(description);\n\n  return newHeaderWithTitle(titleLine, 1, todoKeywordSets)\n    .set('rawDescription', strippedDescription)\n    .set('description', parseRawText(strippedDescription))\n    .set('planningItems', planningItems)\n    .set('propertyListItems', propertyListItems);\n};\n\nexport const parseOrg = fileContents => {\n  let headers = new List();\n  const lines = fileContents.split('\\n');\n\n  let todoKeywordSets = new List();\n  let fileConfigLines = new List();\n  let linesBeforeHeadings = new List();\n\n  lines.forEach(line => {\n    if (line.startsWith('*')) {\n      let nestingLevel = line.indexOf(' ');\n      if (nestingLevel === -1) {\n        nestingLevel = line.length;\n      }\n      const title = line.substr(nestingLevel + 1);\n      headers = headers.push(newHeaderWithTitle(title, nestingLevel, todoKeywordSets));\n    } else {\n      if (headers.size === 0) {\n        if (line.startsWith('#+TODO: ') || line.startsWith('#+TYP_TODO: ')) {\n          const keywordsString = line.substr(line.indexOf(':') + 2);\n          const keywordTokens = keywordsString.split(/\\s/);\n          const keywords = keywordTokens.filter(keyword => keyword !== '|');\n\n          const pipeIndex = keywordTokens.indexOf('|');\n          const completedKeywords = pipeIndex >= 0 ? keywords.slice(pipeIndex) : [];\n\n          todoKeywordSets = todoKeywordSets.push(\n            fromJS({\n              keywords,\n              completedKeywords,\n              configLine: line,\n              default: false,\n            })\n          );\n        } else if (line.startsWith('#+')) {\n          fileConfigLines = fileConfigLines.push(line);\n        } else {\n          linesBeforeHeadings = linesBeforeHeadings.push(line);\n        }\n      } else {\n        headers = headers.updateIn([headers.size - 1, 'rawDescription'], rawDescription =>\n          rawDescription.length === 0 ? line : rawDescription + '\\n' + line\n        );\n      }\n    }\n  });\n\n  if (todoKeywordSets.size === 0) {\n    todoKeywordSets = defaultKeywordSets;\n  }\n\n  headers = headers.map(header => {\n    const { planningItems, propertyListItems, strippedDescription } =\n      parseDescriptionPrefixElements(header.get('rawDescription'));\n\n    return header\n      .set('rawDescription', strippedDescription)\n      .set('description', parseRawText(strippedDescription))\n      .set('planningItems', planningItems)\n      .set('propertyListItems', propertyListItems);\n  });\n\n  return fromJS({\n    headers,\n    todoKeywordSets,\n    fileConfigLines,\n    linesBeforeHeadings,\n  });\n};\n","import { Map, List, fromJS } from 'immutable';\r\nimport _ from 'lodash';\r\n\r\nimport {\r\n  parseOrg,\r\n  parseTitleLine,\r\n  parseRawText,\r\n  parseDescriptionPrefixElements,\r\n  parseMarkupAndCookies,\r\n  newHeaderWithTitle,\r\n  newHeaderFromText,\r\n} from '../lib/parse_org';\r\nimport { attributedStringToRawText } from '../lib/export_org';\r\nimport {\r\n  indexOfHeaderWithId,\r\n  headerWithId,\r\n  parentIdOfHeaderWithId,\r\n  subheadersOfHeaderWithId,\r\n  numSubheadersOfHeaderWithId,\r\n  indexOfPreviousSibling,\r\n  openDirectParent,\r\n  openHeaderWithPath,\r\n  nextVisibleHeaderAfterIndex,\r\n  previousVisibleHeaderAfterIndex,\r\n  updateTableContainingCellId,\r\n  newEmptyTableRowLikeRows,\r\n  newEmptyTableCell,\r\n  headerThatContainsTableCellId,\r\n  headerWithPath,\r\n  pathAndPartOfListItemWithIdInHeaders,\r\n  pathAndPartOfTimestampItemWithIdInHeaders,\r\n  todoKeywordSetForKeyword,\r\n  newListItem,\r\n  parentListItemWithIdInHeaders,\r\n  updateListContainingListItemId,\r\n  headerThatContainsListItemId,\r\n  updateContentsWithListItemAddition,\r\n} from '../lib/org_utils';\r\nimport { getCurrentTimestamp, applyRepeater, renderAsText } from '../lib/timestamps';\r\nimport generateId from '../lib/id_generator';\r\n\r\nconst displayFile = (state, action) => {\r\n  const parsedFile = parseOrg(action.contents);\r\n\r\n  return state\r\n    .set('path', action.path)\r\n    .set('contents', action.contents)\r\n    .set('headers', parsedFile.get('headers'))\r\n    .set('todoKeywordSets', parsedFile.get('todoKeywordSets'))\r\n    .set('fileConfigLines', parsedFile.get('fileConfigLines'))\r\n    .set('linesBeforeHeadings', parsedFile.get('linesBeforeHeadings'));\r\n};\r\n\r\nconst stopDisplayingFile = state =>\r\n  state\r\n    .set('path', null)\r\n    .set('contents', null)\r\n    .set('headers', null)\r\n    .set('todoKeywordSets', null)\r\n    .set('fileConfigLines', null)\r\n    .set('linesBeforeHeadings', null);\r\n\r\nconst openHeader = (state, action) => {\r\n  const headers = state.get('headers');\r\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\r\n\r\n  return state.setIn(['headers', headerIndex, 'opened'], true);\r\n};\r\n\r\nconst toggleHeaderOpened = (state, action) => {\r\n  const headers = state.get('headers');\r\n\r\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\r\n  const isOpened = headerWithId(headers, action.headerId).get('opened');\r\n\r\n  if (isOpened && state.get('focusedHeaderId') === action.headerId) {\r\n    return state;\r\n  }\r\n\r\n  if (isOpened) {\r\n    const subheaders = subheadersOfHeaderWithId(headers, action.headerId);\r\n    subheaders.forEach((subheader, index) => {\r\n      state = state.setIn(['headers', headerIndex + index + 1, 'opened'], false);\r\n    });\r\n  }\r\n\r\n  return state.setIn(['headers', headerIndex, 'opened'], !isOpened);\r\n};\r\n\r\nconst selectHeader = (state, action) => {\r\n  return state.set('selectedHeaderId', action.headerId);\r\n};\r\n\r\nconst openParentsOfHeader = (state, action) => {\r\n  let headers = state.get('headers');\r\n  const { headerId } = action;\r\n\r\n  let parentHeaderId = parentIdOfHeaderWithId(headers, headerId);\r\n  while (!!parentHeaderId) {\r\n    const parentHeaderIndex = indexOfHeaderWithId(headers, parentHeaderId);\r\n    headers = headers.setIn([parentHeaderIndex, 'opened'], true);\r\n    parentHeaderId = parentIdOfHeaderWithId(headers, parentHeaderId);\r\n  }\r\n\r\n  return state.set('headers', headers);\r\n};\r\n\r\nconst updateCookiesInAttributedStringWithChildCompletionStates = (parts, completionStates) => {\r\n  const doneCount = completionStates.filter(isDone => isDone).length;\r\n  const totalCount = completionStates.length;\r\n\r\n  return parts.map(part => {\r\n    switch (part.get('type')) {\r\n      case 'fraction-cookie':\r\n        return part.set('fraction', List([doneCount, totalCount]));\r\n      case 'percentage-cookie':\r\n        return part.set('percentage', Math.floor((doneCount / totalCount) * 100));\r\n      default:\r\n        return part;\r\n    }\r\n  });\r\n};\r\n\r\nconst updateCookiesOfHeaderWithId = (state, headerId) => {\r\n  const headers = state.get('headers');\r\n  const headerIndex = indexOfHeaderWithId(headers, headerId);\r\n  const subheaders = subheadersOfHeaderWithId(headers, headerId);\r\n\r\n  const directChildren = [];\r\n  for (let i = 0; i < subheaders.size; ++i) {\r\n    const subheader = subheaders.get(i);\r\n    directChildren.push(subheader);\r\n\r\n    const subheaderSubheaders = subheadersOfHeaderWithId(headers, subheader.get('id'));\r\n    i += subheaderSubheaders.size;\r\n  }\r\n\r\n  let completionStates = directChildren\r\n    .map(header => header.getIn(['titleLine', 'todoKeyword']))\r\n    .filter(todoKeyword => !!todoKeyword)\r\n    .map(todoKeyword =>\r\n      todoKeywordSetForKeyword(state.get('todoKeywordSets'), todoKeyword)\r\n        .get('completedKeywords')\r\n        .contains(todoKeyword)\r\n    );\r\n\r\n  // If there are no headers with possible completion states, check for plain lists instead.\r\n  if (completionStates.length === 0) {\r\n    completionStates = headers\r\n      .get(headerIndex)\r\n      .get('description')\r\n      .filter(part => part.get('type') === 'list')\r\n      .flatMap(listPart => listPart.get('items'))\r\n      .filter(item => item.get('isCheckbox'))\r\n      .map(item => item.get('checkboxState') === 'checked')\r\n      .toJS();\r\n  }\r\n\r\n  return state\r\n    .updateIn(['headers', headerIndex, 'titleLine', 'title'], title =>\r\n      updateCookiesInAttributedStringWithChildCompletionStates(title, completionStates)\r\n    )\r\n    .updateIn(['headers', headerIndex, 'titleLine'], titleLine =>\r\n      titleLine.set('rawTitle', attributedStringToRawText(titleLine.get('title')))\r\n    );\r\n};\r\n\r\nconst updateCookiesOfParentOfHeaderWithId = (state, headerId) => {\r\n  const parentHeaderId = parentIdOfHeaderWithId(state.get('headers'), headerId);\r\n  if (!parentHeaderId) {\r\n    return state;\r\n  }\r\n\r\n  return updateCookiesOfHeaderWithId(state, parentHeaderId);\r\n};\r\n\r\nconst advanceTodoState = (state, action) => {\r\n  const headerId = action.headerId || state.get('selectedHeaderId');\r\n  if (!headerId) {\r\n    return state;\r\n  }\r\n\r\n  const headers = state.get('headers');\r\n  const header = headerWithId(headers, headerId);\r\n  const headerIndex = indexOfHeaderWithId(headers, headerId);\r\n\r\n  const currentTodoState = header.getIn(['titleLine', 'todoKeyword']);\r\n  const currentTodoSet = todoKeywordSetForKeyword(state.get('todoKeywordSets'), currentTodoState);\r\n\r\n  const currentStateIndex = currentTodoSet.get('keywords').indexOf(currentTodoState);\r\n  const newStateIndex = currentStateIndex + 1;\r\n  const newTodoState = currentTodoSet.get('keywords').get(newStateIndex) || '';\r\n\r\n  const indexedPlanningItemsWithRepeaters = header\r\n    .get('planningItems')\r\n    .map((planningItem, index) => [planningItem, index])\r\n    .filter(([planningItem, index]) => !!planningItem.getIn(['timestamp', 'repeaterType']));\r\n\r\n  if (\r\n    currentTodoSet.get('completedKeywords').includes(newTodoState) &&\r\n    indexedPlanningItemsWithRepeaters.size > 0\r\n  ) {\r\n    indexedPlanningItemsWithRepeaters.forEach(([planningItem, planningItemIndex]) => {\r\n      state = state.setIn(\r\n        ['headers', headerIndex, 'planningItems', planningItemIndex, 'timestamp'],\r\n        applyRepeater(planningItem.get('timestamp'), new Date())\r\n      );\r\n    });\r\n\r\n    state = state.setIn(\r\n      ['headers', headerIndex, 'titleLine', 'todoKeyword'],\r\n      currentTodoSet.get('keywords').first()\r\n    );\r\n\r\n    const lastRepeatTimestamp = getCurrentTimestamp({ isActive: false, withStartTime: true });\r\n    const newLastRepeatValue = [\r\n      {\r\n        type: 'timestamp',\r\n        id: generateId(),\r\n        firstTimestamp: lastRepeatTimestamp,\r\n        secondTimestamp: null,\r\n      },\r\n    ];\r\n    state = state.updateIn(['headers', headerIndex, 'propertyListItems'], propertyListItems =>\r\n      propertyListItems.some(item => item.get('property') === 'LAST_REPEAT')\r\n        ? propertyListItems.map(item =>\r\n            item.get('property') === 'LAST_REPEAT'\r\n              ? item.set('value', fromJS(newLastRepeatValue))\r\n              : item\r\n          )\r\n        : propertyListItems.push(\r\n            fromJS({\r\n              property: 'LAST_REPEAT',\r\n              value: newLastRepeatValue,\r\n              id: generateId(),\r\n            })\r\n          )\r\n    );\r\n\r\n    state = state.updateIn(['headers', headerIndex], header => {\r\n      let rawDescription = header.get('rawDescription');\r\n      if (rawDescription.startsWith('\\n')) {\r\n        rawDescription = rawDescription.slice(1);\r\n      }\r\n\r\n      rawDescription =\r\n        `\\n- State \"${newTodoState}\"       from \"${currentTodoState}\"       ${renderAsText(\r\n          fromJS(lastRepeatTimestamp)\r\n        )}\\n` + rawDescription;\r\n\r\n      return header\r\n        .set('rawDescription', rawDescription)\r\n        .set('description', parseRawText(rawDescription));\r\n    });\r\n  } else {\r\n    state = state.setIn(['headers', headerIndex, 'titleLine', 'todoKeyword'], newTodoState);\r\n  }\r\n\r\n  state = updateCookiesOfParentOfHeaderWithId(state, headerId);\r\n\r\n  return state;\r\n};\r\n\r\nconst enterEditMode = (state, action) => state.set('editMode', action.editModeType);\r\n\r\nconst exitEditMode = (state, action) => state.set('editMode', null);\r\n\r\nconst updateHeaderTitle = (state, action) => {\r\n  const headers = state.get('headers');\r\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\r\n\r\n  const newTitleLine = parseTitleLine(action.newRawTitle, state.get('todoKeywordSets'));\r\n\r\n  state = state.setIn(['headers', headerIndex, 'titleLine'], newTitleLine);\r\n\r\n  return updateCookiesOfParentOfHeaderWithId(state, action.headerId);\r\n};\r\n\r\nconst updateHeaderDescription = (state, action) => {\r\n  const headers = state.get('headers');\r\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\r\n\r\n  return state.updateIn(['headers', headerIndex], header => {\r\n    const { planningItems, propertyListItems, strippedDescription } =\r\n      parseDescriptionPrefixElements(action.newRawDescription);\r\n\r\n    return header\r\n      .set('rawDescription', strippedDescription)\r\n      .set('description', parseRawText(strippedDescription))\r\n      .set('planningItems', planningItems)\r\n      .set('propertyListItems', propertyListItems);\r\n  });\r\n};\r\n\r\nconst addHeader = (state, action) => {\r\n  const headers = state.get('headers');\r\n  const header = headerWithId(headers, action.headerId);\r\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\r\n\r\n  const subheaders = subheadersOfHeaderWithId(headers, action.headerId);\r\n\r\n  const newHeader = newHeaderWithTitle(\r\n    '',\r\n    header.get('nestingLevel'),\r\n    state.get('todoKeywordSets')\r\n  );\r\n\r\n  if (action.headerId === state.get('focusedHeaderId')) {\r\n    state = state.set('focusedHeaderId', null);\r\n  }\r\n\r\n  return state.update('headers', headers =>\r\n    headers.insert(headerIndex + subheaders.size + 1, newHeader)\r\n  );\r\n};\r\n\r\nconst selectNextSiblingHeader = (state, action) => {\r\n  const headers = state.get('headers');\r\n  const header = headerWithId(headers, action.headerId);\r\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\r\n  const subheaders = subheadersOfHeaderWithId(headers, action.headerId);\r\n\r\n  const nextSibling = headers.get(headerIndex + subheaders.size + 1);\r\n\r\n  if (!nextSibling || nextSibling.get('nestingLevel') !== header.get('nestingLevel')) {\r\n    return state;\r\n  }\r\n\r\n  return state.set('selectedHeaderId', nextSibling.get('id'));\r\n};\r\n\r\nconst selectNextVisibleHeader = (state, action) => {\r\n  const headers = state.get('headers');\r\n\r\n  if (state.get('selectedHeaderId') === undefined) {\r\n    return state.set('selectedHeaderId', headers.getIn([0, 'id']));\r\n  }\r\n\r\n  const headerIndex = indexOfHeaderWithId(headers, state.get('selectedHeaderId'));\r\n\r\n  const nextVisibleHeader = nextVisibleHeaderAfterIndex(headers, headerIndex);\r\n\r\n  if (!nextVisibleHeader) {\r\n    return state;\r\n  }\r\n\r\n  return state.set('selectedHeaderId', nextVisibleHeader.get('id'));\r\n};\r\n\r\nconst selectPreviousVisibleHeader = (state, action) => {\r\n  const headers = state.get('headers');\r\n  const headerIndex = indexOfHeaderWithId(headers, state.get('selectedHeaderId'));\r\n\r\n  const previousVisibleHeader = previousVisibleHeaderAfterIndex(headers, headerIndex);\r\n\r\n  if (!previousVisibleHeader) {\r\n    return state;\r\n  }\r\n\r\n  return state.set('selectedHeaderId', previousVisibleHeader.get('id'));\r\n};\r\n\r\nconst removeHeader = (state, action) => {\r\n  let headers = state.get('headers');\r\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\r\n\r\n  const subheaders = subheadersOfHeaderWithId(headers, action.headerId);\r\n  const numHeadersToRemove = 1 + subheaders.size;\r\n\r\n  const parentHeaderId = parentIdOfHeaderWithId(headers, action.headerId);\r\n\r\n  _.times(numHeadersToRemove).forEach(() => {\r\n    headers = headers.delete(headerIndex);\r\n  });\r\n\r\n  if (action.headerId === state.get('focusedHeaderId')) {\r\n    state = state.set('focusedHeaderId', null);\r\n  }\r\n\r\n  state = state.set('headers', headers);\r\n\r\n  if (parentHeaderId) {\r\n    state = updateCookiesOfHeaderWithId(state, parentHeaderId);\r\n  }\r\n\r\n  return state;\r\n};\r\n\r\nconst moveHeaderUp = (state, action) => {\r\n  let headers = state.get('headers');\r\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\r\n\r\n  const previousSiblingIndex = indexOfPreviousSibling(headers, headerIndex);\r\n  if (previousSiblingIndex === null) {\r\n    return state;\r\n  }\r\n\r\n  const subheaders = subheadersOfHeaderWithId(headers, action.headerId);\r\n  _.times(1 + subheaders.size).forEach(() => {\r\n    headers = headers.insert(previousSiblingIndex, headers.get(headerIndex + subheaders.size));\r\n    headers = headers.delete(headerIndex + subheaders.size + 1);\r\n  });\r\n\r\n  return state.set('headers', headers);\r\n};\r\n\r\nconst moveHeaderDown = (state, action) => {\r\n  let headers = state.get('headers');\r\n  const header = headerWithId(headers, action.headerId);\r\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\r\n\r\n  const subheaders = subheadersOfHeaderWithId(headers, action.headerId);\r\n  const nextSiblingIndex = headerIndex + subheaders.size + 1;\r\n  const nextSibling = headers.get(nextSiblingIndex);\r\n  if (nextSibling.get('nestingLevel') < header.get('nestingLevel')) {\r\n    return state;\r\n  }\r\n\r\n  const nextSiblingSubheaders = subheadersOfHeaderWithId(headers, nextSibling.get('id'));\r\n  _.times(1 + nextSiblingSubheaders.size).forEach(() => {\r\n    headers = headers.insert(\r\n      headerIndex,\r\n      headers.get(nextSiblingIndex + nextSiblingSubheaders.size)\r\n    );\r\n    headers = headers.delete(nextSiblingIndex + nextSiblingSubheaders.size + 1);\r\n  });\r\n\r\n  return state.set('headers', headers);\r\n};\r\n\r\nconst moveHeaderLeft = (state, action) => {\r\n  const headers = state.get('headers');\r\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\r\n\r\n  const previousParentHeaderId = parentIdOfHeaderWithId(headers, action.headerId);\r\n\r\n  state = state.updateIn(['headers', headerIndex, 'nestingLevel'], nestingLevel =>\r\n    Math.max(nestingLevel - 1, 1)\r\n  );\r\n\r\n  state = updateCookiesOfHeaderWithId(state, previousParentHeaderId);\r\n  state = updateCookiesOfParentOfHeaderWithId(state, action.headerId);\r\n\r\n  return state;\r\n};\r\n\r\nconst moveHeaderRight = (state, action) => {\r\n  const headers = state.get('headers');\r\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\r\n\r\n  const previousParentHeaderId = parentIdOfHeaderWithId(headers, action.headerId);\r\n\r\n  state = state.updateIn(\r\n    ['headers', headerIndex, 'nestingLevel'],\r\n    nestingLevel => nestingLevel + 1\r\n  );\r\n\r\n  state = openDirectParent(state, action.headerId);\r\n  state = updateCookiesOfHeaderWithId(state, previousParentHeaderId);\r\n  state = updateCookiesOfParentOfHeaderWithId(state, action.headerId);\r\n\r\n  return state;\r\n};\r\n\r\nconst moveSubtreeLeft = (state, action) => {\r\n  const headers = state.get('headers');\r\n  const header = headerWithId(headers, action.headerId);\r\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\r\n\r\n  const previousParentHeaderId = parentIdOfHeaderWithId(headers, action.headerId);\r\n\r\n  if (header.get('nestingLevel') === 1) {\r\n    return state;\r\n  }\r\n\r\n  const subheaders = subheadersOfHeaderWithId(headers, action.headerId);\r\n\r\n  state = state.updateIn(\r\n    ['headers', headerIndex, 'nestingLevel'],\r\n    nestingLevel => nestingLevel - 1\r\n  );\r\n\r\n  subheaders.forEach((_, index) => {\r\n    state = state.updateIn(\r\n      ['headers', headerIndex + index + 1, 'nestingLevel'],\r\n      nestingLevel => nestingLevel - 1\r\n    );\r\n  });\r\n\r\n  state = updateCookiesOfHeaderWithId(state, previousParentHeaderId);\r\n  state = updateCookiesOfParentOfHeaderWithId(state, action.headerId);\r\n\r\n  return state;\r\n};\r\n\r\nconst moveSubtreeRight = (state, action) => {\r\n  const headers = state.get('headers');\r\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\r\n\r\n  const previousParentHeaderId = parentIdOfHeaderWithId(headers, action.headerId);\r\n\r\n  const subheaders = subheadersOfHeaderWithId(headers, action.headerId);\r\n\r\n  state = state.updateIn(\r\n    ['headers', headerIndex, 'nestingLevel'],\r\n    nestingLevel => nestingLevel + 1\r\n  );\r\n  subheaders.forEach((_, index) => {\r\n    state = state.updateIn(\r\n      ['headers', headerIndex + index + 1, 'nestingLevel'],\r\n      nestingLevel => nestingLevel + 1\r\n    );\r\n  });\r\n\r\n  state = updateCookiesOfHeaderWithId(state, previousParentHeaderId);\r\n  state = updateCookiesOfParentOfHeaderWithId(state, action.headerId);\r\n\r\n  return openDirectParent(state, action.headerId);\r\n};\r\n\r\nconst focusHeader = (state, action) => {\r\n  return state.set('focusedHeaderId', action.headerId);\r\n};\r\n\r\nconst unfocusHeader = state => state.set('focusedHeaderId', null);\r\n\r\nconst noOp = state => state.update('noOpCounter', counter => (counter || 0) + 1);\r\n\r\nconst applyOpennessState = (state, action) => {\r\n  const opennessState = state.get('opennessState');\r\n  if (!opennessState) {\r\n    return state;\r\n  }\r\n\r\n  const fileOpennessState = opennessState.get(state.get('path'));\r\n  if (!fileOpennessState || fileOpennessState.size === 0) {\r\n    return state;\r\n  }\r\n\r\n  const MEMO_TITLE = 'memo';\r\n\r\n  let headers = state.get('headers');\r\n\r\n  const prevMemoHeader = headers.findLast(header => {\r\n    const rawTitle = header.getIn(['titleLine', 'rawTitle']);\r\n    return rawTitle === MEMO_TITLE;\r\n  });\r\n  const prevOpened = prevMemoHeader ? prevMemoHeader.get('opened') : false;\r\n\r\n  fileOpennessState.forEach(openHeaderPath => {\r\n    headers = openHeaderWithPath(headers, openHeaderPath);\r\n  });\r\n\r\n  const nextMemoHeader = headers.findLast(header => {\r\n    const rawTitle = header.getIn(['titleLine', 'rawTitle']);\r\n    return rawTitle === MEMO_TITLE;\r\n  });\r\n  const nextOpened = nextMemoHeader ? nextMemoHeader.get('opened') : false;\r\n\r\n  state = state.set('headers', headers);\r\n  if (prevOpened === false && nextOpened === true) {\r\n    const headerId = nextMemoHeader.get('id');\r\n    state = state.set('selectedHeaderId', headerId);\r\n    state = state.set('focusedHeaderId', headerId);\r\n  }\r\n\r\n  return state;\r\n};\r\n\r\nconst setDirty = (state, action) => state.set('isDirty', action.isDirty);\r\n\r\nconst setSelectedTableCellId = (state, action) => state.set('selectedTableCellId', action.cellId);\r\n\r\nconst updateDescriptionOfHeaderContainingTableCell = (state, cellId, header = null) => {\r\n  const headers = state.get('headers');\r\n  if (!header) {\r\n    header = headerThatContainsTableCellId(headers, cellId);\r\n  }\r\n  const headerIndex = indexOfHeaderWithId(headers, header.get('id'));\r\n\r\n  return state.updateIn(['headers', headerIndex], header =>\r\n    header.set('rawDescription', attributedStringToRawText(header.get('description')))\r\n  );\r\n};\r\n\r\nconst addNewTableRow = (state, action) => {\r\n  const selectedTableCellId = state.get('selectedTableCellId');\r\n  if (!selectedTableCellId) {\r\n    return state;\r\n  }\r\n\r\n  state = state.update('headers', headers =>\r\n    updateTableContainingCellId(\r\n      headers,\r\n      selectedTableCellId,\r\n      rowIndex => rows => rows.insert(rowIndex + 1, newEmptyTableRowLikeRows(rows))\r\n    )\r\n  );\r\n\r\n  return updateDescriptionOfHeaderContainingTableCell(state, selectedTableCellId);\r\n};\r\n\r\nconst removeTableRow = (state, action) => {\r\n  const selectedTableCellId = state.get('selectedTableCellId');\r\n  if (!selectedTableCellId) {\r\n    return state;\r\n  }\r\n\r\n  const containingHeader = headerThatContainsTableCellId(state.get('headers'), selectedTableCellId);\r\n\r\n  state = state.update('headers', headers =>\r\n    updateTableContainingCellId(\r\n      headers,\r\n      selectedTableCellId,\r\n      rowIndex => rows => rows.delete(rowIndex)\r\n    )\r\n  );\r\n\r\n  state = state.set('selectedTableCellId', null);\r\n\r\n  return updateDescriptionOfHeaderContainingTableCell(state, selectedTableCellId, containingHeader);\r\n};\r\n\r\nconst addNewTableColumn = (state, action) => {\r\n  const selectedTableCellId = state.get('selectedTableCellId');\r\n  if (!selectedTableCellId) {\r\n    return state;\r\n  }\r\n\r\n  state = state.update('headers', headers =>\r\n    updateTableContainingCellId(\r\n      headers,\r\n      selectedTableCellId,\r\n      (_rowIndex, colIndex) => rows =>\r\n        rows.map(row =>\r\n          row.update('contents', contents => contents.insert(colIndex + 1, newEmptyTableCell()))\r\n        )\r\n    )\r\n  );\r\n\r\n  return updateDescriptionOfHeaderContainingTableCell(state, selectedTableCellId);\r\n};\r\n\r\nconst removeTableColumn = (state, action) => {\r\n  const selectedTableCellId = state.get('selectedTableCellId');\r\n  if (!selectedTableCellId) {\r\n    return state;\r\n  }\r\n\r\n  const containingHeader = headerThatContainsTableCellId(state.get('headers'), selectedTableCellId);\r\n\r\n  state = state.update('headers', headers =>\r\n    updateTableContainingCellId(\r\n      headers,\r\n      selectedTableCellId,\r\n      (_rowIndex, colIndex) => rows =>\r\n        rows.map(row => row.update('contents', contents => contents.delete(colIndex)))\r\n    )\r\n  );\r\n\r\n  state = state.set('selectedTableCellId', null);\r\n\r\n  return updateDescriptionOfHeaderContainingTableCell(state, selectedTableCellId, containingHeader);\r\n};\r\n\r\nconst moveTableRowDown = state => {\r\n  const selectedTableCellId = state.get('selectedTableCellId');\r\n  if (!selectedTableCellId) {\r\n    return state;\r\n  }\r\n\r\n  state = state.update('headers', headers =>\r\n    updateTableContainingCellId(\r\n      headers,\r\n      selectedTableCellId,\r\n      rowIndex => rows =>\r\n        rowIndex + 1 === rows.size\r\n          ? rows\r\n          : rows.insert(rowIndex, rows.get(rowIndex + 1)).delete(rowIndex + 2)\r\n    )\r\n  );\r\n\r\n  return updateDescriptionOfHeaderContainingTableCell(state, selectedTableCellId);\r\n};\r\n\r\nconst moveTableRowUp = (state, action) => {\r\n  const selectedTableCellId = state.get('selectedTableCellId');\r\n  if (!selectedTableCellId) {\r\n    return state;\r\n  }\r\n\r\n  state = state.update('headers', headers =>\r\n    updateTableContainingCellId(\r\n      headers,\r\n      selectedTableCellId,\r\n      rowIndex => rows =>\r\n        rowIndex === 0 ? rows : rows.insert(rowIndex - 1, rows.get(rowIndex)).delete(rowIndex + 1)\r\n    )\r\n  );\r\n\r\n  return updateDescriptionOfHeaderContainingTableCell(state, selectedTableCellId);\r\n};\r\n\r\nconst moveTableColumnLeft = (state, action) => {\r\n  const selectedTableCellId = state.get('selectedTableCellId');\r\n  if (!selectedTableCellId) {\r\n    return state;\r\n  }\r\n\r\n  state = state.update('headers', headers =>\r\n    updateTableContainingCellId(\r\n      headers,\r\n      selectedTableCellId,\r\n      (_rowIndex, columnIndex) => rows =>\r\n        columnIndex === 0\r\n          ? rows\r\n          : rows.map(row =>\r\n              row.update('contents', contents =>\r\n                contents.size === 0\r\n                  ? contents\r\n                  : contents\r\n                      .insert(columnIndex - 1, contents.get(columnIndex))\r\n                      .delete(columnIndex + 1)\r\n              )\r\n            )\r\n    )\r\n  );\r\n\r\n  return updateDescriptionOfHeaderContainingTableCell(state, selectedTableCellId);\r\n};\r\n\r\nconst moveTableColumnRight = (state, action) => {\r\n  const selectedTableCellId = state.get('selectedTableCellId');\r\n  if (!selectedTableCellId) {\r\n    return state;\r\n  }\r\n\r\n  state = state.update('headers', headers =>\r\n    updateTableContainingCellId(\r\n      headers,\r\n      selectedTableCellId,\r\n      (_rowIndex, columnIndex) => rows =>\r\n        columnIndex + 1 >= rows.getIn([0, 'contents']).size\r\n          ? rows\r\n          : rows.map(row =>\r\n              row.update('contents', contents =>\r\n                contents.size === 0\r\n                  ? contents\r\n                  : contents\r\n                      .insert(columnIndex, contents.get(columnIndex + 1))\r\n                      .delete(columnIndex + 2)\r\n              )\r\n            )\r\n    )\r\n  );\r\n\r\n  return updateDescriptionOfHeaderContainingTableCell(state, selectedTableCellId);\r\n};\r\n\r\nconst updateTableCellValue = (state, action) => {\r\n  state = state.update('headers', headers =>\r\n    updateTableContainingCellId(\r\n      headers,\r\n      action.cellId,\r\n      (rowIndex, colIndex) => rows =>\r\n        rows.updateIn([rowIndex, 'contents', colIndex], cell =>\r\n          cell\r\n            .set('rawContents', action.newValue)\r\n            .set(\r\n              'contents',\r\n              fromJS(parseMarkupAndCookies(action.newValue, { excludeCookies: true }))\r\n            )\r\n        )\r\n    )\r\n  );\r\n\r\n  return updateDescriptionOfHeaderContainingTableCell(state, action.cellId);\r\n};\r\n\r\nconst insertCapture = (state, action) => {\r\n  const headers = state.get('headers');\r\n  const { template, content, shouldPrepend } = action;\r\n\r\n  const isTopLevelTarget = template.get('headerPaths').filter(path => path.length !== 0).size === 0;\r\n\r\n  const parentHeader = isTopLevelTarget\r\n    ? null\r\n    : headerWithPath(headers, template.get('headerPaths'));\r\n  if (!parentHeader && !isTopLevelTarget) {\r\n    return state;\r\n  }\r\n\r\n  const newHeader = newHeaderFromText(content, state.get('todoKeywordSets')).set(\r\n    'nestingLevel',\r\n    isTopLevelTarget ? 1 : parentHeader.get('nestingLevel') + 1\r\n  );\r\n\r\n  if (isTopLevelTarget) {\r\n    return state.update('headers', headers => headers.push(newHeader));\r\n  } else {\r\n    const parentHeaderIndex = indexOfHeaderWithId(headers, parentHeader.get('id'));\r\n    const numSubheaders = numSubheadersOfHeaderWithId(headers, parentHeader.get('id'));\r\n    const newIndex = parentHeaderIndex + 1 + (shouldPrepend ? 0 : numSubheaders);\r\n\r\n    state = state.update('headers', headers => headers.insert(newIndex, newHeader));\r\n\r\n    state = updateCookiesOfHeaderWithId(state, parentHeader.get('id'));\r\n\r\n    return state;\r\n  }\r\n};\r\n\r\nconst clearPendingCapture = state => state.set('pendingCapture', null);\r\n\r\nconst updateParentListCheckboxes = (state, itemPath) => {\r\n  const parentListItemPath = itemPath.slice(0, itemPath.length - 4);\r\n  const parentListItem = state.getIn(parentListItemPath);\r\n  if (!parentListItem.has('checkboxState')) {\r\n    return state;\r\n  }\r\n\r\n  const childrenCheckedStates = parentListItem\r\n    .get('contents')\r\n    .filter(part => part.get('type') === 'list')\r\n    .flatMap(listPart =>\r\n      listPart\r\n        .get('items')\r\n        .filter(item => item.get('isCheckbox'))\r\n        .map(checkboxItem => checkboxItem.get('checkboxState'))\r\n    );\r\n\r\n  if (childrenCheckedStates.every(state => state === 'checked')) {\r\n    state = state.setIn(parentListItemPath.concat(['checkboxState']), 'checked');\r\n  } else if (childrenCheckedStates.every(state => state === 'unchecked')) {\r\n    state = state.setIn(parentListItemPath.concat(['checkboxState']), 'unchecked');\r\n  } else {\r\n    state = state.setIn(parentListItemPath.concat(['checkboxState']), 'partial');\r\n  }\r\n\r\n  const childCompletionStates = childrenCheckedStates\r\n    .map(state => {\r\n      switch (state) {\r\n        case 'checked':\r\n          return true;\r\n        case 'unchecked':\r\n          return false;\r\n        case 'partial':\r\n          return false;\r\n        default:\r\n          return false;\r\n      }\r\n    })\r\n    .toJS();\r\n\r\n  state = state.updateIn(parentListItemPath.concat('titleLine'), titleLine =>\r\n    updateCookiesInAttributedStringWithChildCompletionStates(titleLine, childCompletionStates)\r\n  );\r\n\r\n  if (parentListItem.get('isCheckbox')) {\r\n    return updateParentListCheckboxes(state, parentListItemPath);\r\n  } else {\r\n    return state;\r\n  }\r\n};\r\n\r\nconst advanceCheckboxState = (state, action) => {\r\n  const pathAndPart = pathAndPartOfListItemWithIdInHeaders(state.get('headers'), action.listItemId);\r\n  const { path, listItemPart } = pathAndPart;\r\n\r\n  const hasDirectCheckboxChildren = listItemPart\r\n    .get('contents')\r\n    .filter(part => part.get('type') === 'list')\r\n    .some(listPart => listPart.get('items').some(item => item.get('isCheckbox')));\r\n  if (hasDirectCheckboxChildren) {\r\n    return state;\r\n  }\r\n\r\n  const newCheckboxState = {\r\n    checked: 'unchecked',\r\n    unchecked: 'checked',\r\n    partial: 'unchecked',\r\n  }[listItemPart.get('checkboxState')];\r\n\r\n  state = state.setIn(['headers'].concat(path).concat(['checkboxState']), newCheckboxState);\r\n  state = updateParentListCheckboxes(state, ['headers'].concat(path));\r\n\r\n  const headerIndex = path[0];\r\n  state = updateCookiesOfHeaderWithId(state, state.getIn(['headers', headerIndex, 'id']));\r\n  state = state.updateIn(['headers', headerIndex], header =>\r\n    header.set('rawDescription', attributedStringToRawText(header.get('description')))\r\n  );\r\n\r\n  return state;\r\n};\r\n\r\nconst setSelectedListItemId = (state, action) => state.set('selectedListItemId', action.listItemId);\r\n\r\nconst updateDescriptionOfHeaderContainingListItem = (state, listItemId, header = null) => {\r\n  let headerIndex = -1;\r\n  const headers = state.get('headers');\r\n  if (!header) {\r\n    const pathAndPart = pathAndPartOfListItemWithIdInHeaders(headers, listItemId);\r\n    headerIndex = pathAndPart.path[0];\r\n  } else {\r\n    headerIndex = indexOfHeaderWithId(headers, header.get('id'));\r\n  }\r\n\r\n  if (headerIndex >= 0) {\r\n    return state.updateIn(['headers', headerIndex], header =>\r\n      header.set('rawDescription', attributedStringToRawText(header.get('description')))\r\n    );\r\n  } else {\r\n    return state;\r\n  }\r\n};\r\n\r\nconst updateListTitleValue = (state, action) => {\r\n  const selectedListItemId = action.listItemId;\r\n  if (!selectedListItemId) {\r\n    return state;\r\n  }\r\n\r\n  state = state.update('headers', headers =>\r\n    updateListContainingListItemId(\r\n      headers,\r\n      selectedListItemId,\r\n      itemIndex => items =>\r\n        items.updateIn([itemIndex], item =>\r\n          item.set('titleLine', fromJS(parseMarkupAndCookies(action.newValue)))\r\n        )\r\n    )\r\n  );\r\n\r\n  return updateDescriptionOfHeaderContainingListItem(state, selectedListItemId);\r\n};\r\n\r\nconst updateListContentsValue = (state, action) => {\r\n  const selectedListItemId = action.listItemId;\r\n  if (!selectedListItemId) {\r\n    return state;\r\n  }\r\n\r\n  state = state.update('headers', headers =>\r\n    updateListContainingListItemId(\r\n      headers,\r\n      selectedListItemId,\r\n      itemIndex => items =>\r\n        items.updateIn([itemIndex], item =>\r\n          item.set('contents', fromJS(parseRawText(action.newValue)))\r\n        )\r\n    )\r\n  );\r\n\r\n  return updateDescriptionOfHeaderContainingListItem(state, selectedListItemId);\r\n};\r\n\r\nconst addNewListItem = (state, action) => {\r\n  const selectedListItemId = state.get('selectedListItemId');\r\n  if (!selectedListItemId) {\r\n    return state;\r\n  }\r\n\r\n  const pathAndPart = pathAndPartOfListItemWithIdInHeaders(\r\n    state.get('headers'),\r\n    selectedListItemId\r\n  );\r\n\r\n  let newItem = newListItem();\r\n  if (pathAndPart.listItemPart.get('isCheckbox')) {\r\n    newItem = newItem.set('isCheckbox', true).set('checkboxState', 'unchecked');\r\n  }\r\n\r\n  state = state.update('headers', headers =>\r\n    updateListContainingListItemId(\r\n      headers,\r\n      selectedListItemId,\r\n      itemIndex => items => items.insert(itemIndex + 1, newItem)\r\n    )\r\n  );\r\n  return updateDescriptionOfHeaderContainingListItem(state, selectedListItemId);\r\n};\r\n\r\nconst selectNextSiblingListItem = (state, action) => {\r\n  const selectedListItemId = state.get('selectedListItemId');\r\n  if (!selectedListItemId) {\r\n    return state;\r\n  }\r\n\r\n  const pathAndPart = pathAndPartOfListItemWithIdInHeaders(\r\n    state.get('headers'),\r\n    selectedListItemId\r\n  );\r\n  let { path } = pathAndPart;\r\n  path[path.length - 1] = path[path.length - 1] + 1;\r\n\r\n  state = state.set('selectedListItemId', state.getIn(['headers'].concat(path).concat('id')));\r\n\r\n  return state;\r\n};\r\n\r\nconst removeListItem = (state, action) => {\r\n  const selectedListItemId = state.get('selectedListItemId');\r\n  if (!selectedListItemId) {\r\n    return state;\r\n  }\r\n\r\n  const containingHeader = headerThatContainsListItemId(state.get('headers'), selectedListItemId);\r\n\r\n  state = state.update('headers', headers =>\r\n    updateListContainingListItemId(\r\n      headers,\r\n      selectedListItemId,\r\n      itemIndex => items => items.delete(itemIndex)\r\n    )\r\n  );\r\n\r\n  state = state.set('selectedListItemId', null);\r\n\r\n  return updateDescriptionOfHeaderContainingListItem(state, selectedListItemId, containingHeader);\r\n};\r\n\r\nconst moveListItemUp = state => {\r\n  const selectedListItemId = state.get('selectedListItemId');\r\n  if (!selectedListItemId) {\r\n    return state;\r\n  }\r\n\r\n  state = state.update('headers', headers =>\r\n    updateListContainingListItemId(\r\n      headers,\r\n      selectedListItemId,\r\n      itemIndex => items =>\r\n        itemIndex === 0\r\n          ? items\r\n          : items.insert(itemIndex - 1, items.get(itemIndex)).delete(itemIndex + 1)\r\n    )\r\n  );\r\n\r\n  return updateDescriptionOfHeaderContainingListItem(state, selectedListItemId);\r\n};\r\n\r\nconst moveListItemDown = state => {\r\n  const selectedListItemId = state.get('selectedListItemId');\r\n  if (!selectedListItemId) {\r\n    return state;\r\n  }\r\n\r\n  state = state.update('headers', headers =>\r\n    updateListContainingListItemId(\r\n      headers,\r\n      selectedListItemId,\r\n      itemIndex => items =>\r\n        itemIndex + 1 === items.size\r\n          ? items\r\n          : items.insert(itemIndex, items.get(itemIndex + 1)).delete(itemIndex + 2)\r\n    )\r\n  );\r\n\r\n  return updateDescriptionOfHeaderContainingListItem(state, selectedListItemId);\r\n};\r\n\r\nconst moveListItemLeft = state => {\r\n  const selectedListItemId = state.get('selectedListItemId');\r\n  if (!selectedListItemId) {\r\n    return state;\r\n  }\r\n\r\n  const pathAndPart = pathAndPartOfListItemWithIdInHeaders(\r\n    state.get('headers'),\r\n    selectedListItemId\r\n  );\r\n\r\n  const hasChildrenItem = pathAndPart.listItemPart\r\n    .get('contents')\r\n    .filter(part => part.get('type') === 'list')\r\n    .some(listPart => listPart.get('items').size > 0);\r\n  if (hasChildrenItem) {\r\n    return state;\r\n  }\r\n  return moveListSubtreeLeft(state);\r\n};\r\n\r\nconst moveListItemRight = state => {\r\n  const selectedListItemId = state.get('selectedListItemId');\r\n  if (!selectedListItemId) {\r\n    return state;\r\n  }\r\n\r\n  const pathAndPart = pathAndPartOfListItemWithIdInHeaders(\r\n    state.get('headers'),\r\n    selectedListItemId\r\n  );\r\n  let { path, listItemPart: selectedListItem } = pathAndPart;\r\n  const listPart = state.getIn(['headers'].concat(path.slice(0, path.length - 2)));\r\n  const prevSiblingItemIndex = path[path.length - 1] - 1;\r\n\r\n  if (prevSiblingItemIndex < 0) {\r\n    return state;\r\n  }\r\n\r\n  state = state.update('headers', headers =>\r\n    updateListContainingListItemId(\r\n      headers,\r\n      selectedListItemId,\r\n      itemIndex => items => items.delete(itemIndex)\r\n    )\r\n  );\r\n\r\n  const prevSiblingItemContentsPath = ['headers']\r\n    .concat(path.slice(0, path.length - 1))\r\n    .concat(prevSiblingItemIndex)\r\n    .concat('contents');\r\n\r\n  const childrenListParts = selectedListItem\r\n    .get('contents')\r\n    .filter(part => part.get('type') === 'list');\r\n\r\n  selectedListItem = selectedListItem.update('contents', contents =>\r\n    contents.filter(part => part.get('type') !== 'list')\r\n  );\r\n\r\n  state = state.updateIn(prevSiblingItemContentsPath, contents =>\r\n    updateContentsWithListItemAddition(contents, selectedListItem, listPart)\r\n  );\r\n\r\n  childrenListParts.map(listPart =>\r\n    listPart.get('items').forEach((item, itemIndex) => {\r\n      state = state.updateIn(prevSiblingItemContentsPath, contents =>\r\n        updateContentsWithListItemAddition(contents, item, listPart)\r\n      );\r\n    })\r\n  );\r\n\r\n  return updateDescriptionOfHeaderContainingListItem(state, selectedListItemId);\r\n};\r\n\r\nconst moveListSubtreeLeft = state => {\r\n  const selectedListItemId = state.get('selectedListItemId');\r\n  if (!selectedListItemId) {\r\n    return state;\r\n  }\r\n\r\n  const pathAndPart = pathAndPartOfListItemWithIdInHeaders(\r\n    state.get('headers'),\r\n    selectedListItemId\r\n  );\r\n  let { path, listItemPart: selectedListItem } = pathAndPart;\r\n  const selectedListItemIndex = path[path.length - 1];\r\n  if (path.filter(partOfPath => partOfPath === 'items').length < 2) {\r\n    return state;\r\n  }\r\n\r\n  const parentListItem = parentListItemWithIdInHeaders(\r\n    state.getIn(['headers']),\r\n    selectedListItemId\r\n  );\r\n\r\n  parentListItem\r\n    .get('contents')\r\n    .filter(part => part.get('type') === 'list')\r\n    .map(listPart =>\r\n      listPart.get('items').forEach((item, itemIndex) => {\r\n        if (itemIndex > selectedListItemIndex) {\r\n          selectedListItem = selectedListItem.update('contents', contents =>\r\n            updateContentsWithListItemAddition(contents, item, listPart)\r\n          );\r\n        }\r\n      })\r\n    );\r\n\r\n  state = state.update('headers', headers =>\r\n    updateListContainingListItemId(\r\n      headers,\r\n      selectedListItemId,\r\n      itemIndex => items => items.filter((_item, index) => index < selectedListItemIndex)\r\n    )\r\n  );\r\n\r\n  state = state.update('headers', headers =>\r\n    updateListContainingListItemId(\r\n      headers,\r\n      parentListItem.get('id'),\r\n      itemIndex => items => items.insert(itemIndex + 1, selectedListItem)\r\n    )\r\n  );\r\n\r\n  return updateDescriptionOfHeaderContainingListItem(state, selectedListItemId);\r\n};\r\n\r\nconst moveListSubtreeRight = state => {\r\n  const selectedListItemId = state.get('selectedListItemId');\r\n  if (!selectedListItemId) {\r\n    return state;\r\n  }\r\n\r\n  const pathAndPart = pathAndPartOfListItemWithIdInHeaders(\r\n    state.get('headers'),\r\n    selectedListItemId\r\n  );\r\n  const { path, listItemPart: selectedListItem } = pathAndPart;\r\n  const listPart = state.getIn(['headers'].concat(path.slice(0, path.length - 2)));\r\n  const prevSiblingItemIndex = path[path.length - 1] - 1;\r\n  if (prevSiblingItemIndex < 0) {\r\n    return state;\r\n  }\r\n\r\n  state = state.update('headers', headers =>\r\n    updateListContainingListItemId(\r\n      headers,\r\n      selectedListItemId,\r\n      itemIndex => items => itemIndex === 0 ? items : items.delete(itemIndex)\r\n    )\r\n  );\r\n\r\n  state = state.updateIn(\r\n    ['headers']\r\n      .concat(path.slice(0, path.length - 1))\r\n      .concat(prevSiblingItemIndex)\r\n      .concat('contents'),\r\n    contents => updateContentsWithListItemAddition(contents, selectedListItem, listPart)\r\n  );\r\n\r\n  return updateDescriptionOfHeaderContainingListItem(state, selectedListItemId);\r\n};\r\n\r\nconst setLastSyncAt = (state, action) => state.set('lastSyncAt', action.lastSyncAt);\r\n\r\nconst setHeaderTags = (state, action) => {\r\n  const headers = state.get('headers');\r\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\r\n  if (headerIndex === -1) {\r\n    return state;\r\n  }\r\n\r\n  return state.setIn(['headers', headerIndex, 'titleLine', 'tags'], action.tags);\r\n};\r\n\r\nconst reorderTags = (state, action) => {\r\n  const selectedHeaderId = state.get('selectedHeaderId');\r\n  if (!selectedHeaderId) {\r\n    return state;\r\n  }\r\n  const headerIndex = indexOfHeaderWithId(state.get('headers'), selectedHeaderId);\r\n\r\n  return state.updateIn(['headers', headerIndex, 'titleLine', 'tags'], tags =>\r\n    tags.splice(action.fromIndex, 1).splice(action.toIndex, 0, tags.get(action.fromIndex))\r\n  );\r\n};\r\n\r\nconst reorderPropertyList = (state, action) => {\r\n  const headerId = action.headerId;\r\n  if (!headerId) {\r\n    return state;\r\n  }\r\n  const headerIndex = indexOfHeaderWithId(state.get('headers'), headerId);\r\n\r\n  return state.updateIn(['headers', headerIndex, 'propertyListItems'], propertyListItems =>\r\n    propertyListItems\r\n      .splice(action.fromIndex, 1)\r\n      .splice(action.toIndex, 0, propertyListItems.get(action.fromIndex))\r\n  );\r\n};\r\n\r\nconst updateTimestampWithId = (state, action) => {\r\n  const pathAndPart = pathAndPartOfTimestampItemWithIdInHeaders(\r\n    state.get('headers'),\r\n    action.timestampId\r\n  );\r\n  if (!pathAndPart) {\r\n    return state;\r\n  }\r\n\r\n  const { path } = pathAndPart;\r\n  const headerIndex = path[0];\r\n\r\n  return state\r\n    .setIn(['headers'].concat(path), action.newTimestamp)\r\n    .updateIn(['headers', headerIndex], header =>\r\n      header.set('rawDescription', attributedStringToRawText(header.get('description')))\r\n    )\r\n    .updateIn(['headers', headerIndex], header =>\r\n      header.setIn(\r\n        ['titleLine', 'rawTitle'],\r\n        attributedStringToRawText(header.getIn(['titleLine', 'title']))\r\n      )\r\n    );\r\n};\r\n\r\nconst updatePlanningItemTimestamp = (state, action) => {\r\n  const { headerId, planningItemIndex, newTimestamp } = action;\r\n  const headerIndex = indexOfHeaderWithId(state.get('headers'), headerId);\r\n\r\n  return state.setIn(\r\n    ['headers', headerIndex, 'planningItems', planningItemIndex, 'timestamp'],\r\n    newTimestamp\r\n  );\r\n};\r\n\r\nconst addNewPlanningItem = (state, action) => {\r\n  const headerIndex = indexOfHeaderWithId(state.get('headers'), action.headerId);\r\n\r\n  const newPlanningItem = fromJS({\r\n    id: generateId(),\r\n    type: action.planningType,\r\n    timestamp: getCurrentTimestamp(),\r\n  });\r\n\r\n  return state.updateIn(['headers', headerIndex, 'planningItems'], planningItems =>\r\n    !!planningItems ? planningItems.push(newPlanningItem) : List([newPlanningItem])\r\n  );\r\n};\r\n\r\nexport const updatePropertyListItems = (state, action) => {\r\n  const headerIndex = indexOfHeaderWithId(state.get('headers'), action.headerId);\r\n\r\n  return state.setIn(['headers', headerIndex, 'propertyListItems'], action.newPropertyListItems);\r\n};\r\n\r\nconst setOrgFileErrorMessage = (state, action) => state.set('orgFileErrorMessage', action.message);\r\n\r\nexport default (state = new Map(), action) => {\r\n  if (action.dirtying) {\r\n    state = state.set('isDirty', true);\r\n  }\r\n\r\n  switch (action.type) {\r\n    case 'DISPLAY_FILE':\r\n      return displayFile(state, action);\r\n    case 'STOP_DISPLAYING_FILE':\r\n      return stopDisplayingFile(state, action);\r\n    case 'TOGGLE_HEADER_OPENED':\r\n      return toggleHeaderOpened(state, action);\r\n    case 'OPEN_HEADER':\r\n      return openHeader(state, action);\r\n    case 'SELECT_HEADER':\r\n      return selectHeader(state, action);\r\n    case 'OPEN_PARENTS_OF_HEADER':\r\n      return openParentsOfHeader(state, action);\r\n    case 'ADVANCE_TODO_STATE':\r\n      return advanceTodoState(state, action);\r\n    case 'ENTER_EDIT_MODE':\r\n      return enterEditMode(state, action);\r\n    case 'EXIT_EDIT_MODE':\r\n      return exitEditMode(state, action);\r\n    case 'UPDATE_HEADER_TITLE':\r\n      return updateHeaderTitle(state, action);\r\n    case 'UPDATE_HEADER_DESCRIPTION':\r\n      return updateHeaderDescription(state, action);\r\n    case 'ADD_HEADER':\r\n      return addHeader(state, action);\r\n    case 'SELECT_NEXT_SIBLING_HEADER':\r\n      return selectNextSiblingHeader(state, action);\r\n    case 'SELECT_NEXT_VISIBLE_HEADER':\r\n      return selectNextVisibleHeader(state, action);\r\n    case 'SELECT_PREVIOUS_VISIBLE_HEADER':\r\n      return selectPreviousVisibleHeader(state, action);\r\n    case 'REMOVE_HEADER':\r\n      return removeHeader(state, action);\r\n    case 'MOVE_HEADER_UP':\r\n      return moveHeaderUp(state, action);\r\n    case 'MOVE_HEADER_DOWN':\r\n      return moveHeaderDown(state, action);\r\n    case 'MOVE_HEADER_LEFT':\r\n      return moveHeaderLeft(state, action);\r\n    case 'MOVE_HEADER_RIGHT':\r\n      return moveHeaderRight(state, action);\r\n    case 'MOVE_SUBTREE_LEFT':\r\n      return moveSubtreeLeft(state, action);\r\n    case 'MOVE_SUBTREE_RIGHT':\r\n      return moveSubtreeRight(state, action);\r\n    case 'NO_OP':\r\n      return noOp(state, action);\r\n    case 'APPLY_OPENNESS_STATE':\r\n      return applyOpennessState(state, action);\r\n    case 'SET_DIRTY':\r\n      return setDirty(state, action);\r\n    case 'FOCUS_HEADER':\r\n      return focusHeader(state, action);\r\n    case 'UNFOCUS_HEADER':\r\n      return unfocusHeader(state, action);\r\n    case 'SET_SELECTED_TABLE_CELL_ID':\r\n      return setSelectedTableCellId(state, action);\r\n    case 'ADD_NEW_TABLE_ROW':\r\n      return addNewTableRow(state, action);\r\n    case 'REMOVE_TABLE_ROW':\r\n      return removeTableRow(state, action);\r\n    case 'ADD_NEW_TABLE_COLUMN':\r\n      return addNewTableColumn(state, action);\r\n    case 'REMOVE_TABLE_COLUMN':\r\n      return removeTableColumn(state, action);\r\n    case 'MOVE_TABLE_ROW_DOWN':\r\n      return moveTableRowDown(state, action);\r\n    case 'MOVE_TABLE_ROW_UP':\r\n      return moveTableRowUp(state, action);\r\n    case 'MOVE_TABLE_COLUMN_LEFT':\r\n      return moveTableColumnLeft(state, action);\r\n    case 'MOVE_TABLE_COLUMN_RIGHT':\r\n      return moveTableColumnRight(state, action);\r\n    case 'UPDATE_TABLE_CELL_VALUE':\r\n      return updateTableCellValue(state, action);\r\n    case 'INSERT_CAPTURE':\r\n      return insertCapture(state, action);\r\n    case 'CLEAR_PENDING_CAPTURE':\r\n      return clearPendingCapture(state, action);\r\n    case 'ADVANCE_CHECKBOX_STATE':\r\n      return advanceCheckboxState(state, action);\r\n    case 'SET_SELECTED_LIST_ITEM_ID':\r\n      return setSelectedListItemId(state, action);\r\n    case 'UPDATE_LIST_TITLE_VALUE':\r\n      return updateListTitleValue(state, action);\r\n    case 'UPDATE_LIST_CONTENTS_VALUE':\r\n      return updateListContentsValue(state, action);\r\n    case 'ADD_NEW_LIST_ITEM':\r\n      return addNewListItem(state, action);\r\n    case 'SELECT_NEXT_SIBLING_LIST_ITEM':\r\n      return selectNextSiblingListItem(state, action);\r\n    case 'REMOVE_LIST_ITEM':\r\n      return removeListItem(state, action);\r\n    case 'MOVE_LIST_ITEM_UP':\r\n      return moveListItemUp(state, action);\r\n    case 'MOVE_LIST_ITEM_DOWN':\r\n      return moveListItemDown(state, action);\r\n    case 'MOVE_LIST_ITEM_LEFT':\r\n      return moveListItemLeft(state, action);\r\n    case 'MOVE_LIST_ITEM_RIGHT':\r\n      return moveListItemRight(state, action);\r\n    case 'MOVE_LIST_SUBTREE_LEFT':\r\n      return moveListSubtreeLeft(state, action);\r\n    case 'MOVE_LIST_SUBTREE_RIGHT':\r\n      return moveListSubtreeRight(state, action);\r\n    case 'SET_LAST_SYNC_AT':\r\n      return setLastSyncAt(state, action);\r\n    case 'SET_HEADER_TAGS':\r\n      return setHeaderTags(state, action);\r\n    case 'REORDER_TAGS':\r\n      return reorderTags(state, action);\r\n    case 'REORDER_PROPERTY_LIST':\r\n      return reorderPropertyList(state, action);\r\n    case 'UPDATE_TIMESTAMP_WITH_ID':\r\n      return updateTimestampWithId(state, action);\r\n    case 'UPDATE_PLANNING_ITEM_TIMESTAMP':\r\n      return updatePlanningItemTimestamp(state, action);\r\n    case 'ADD_NEW_PLANNING_ITEM':\r\n      return addNewPlanningItem(state, action);\r\n    case 'UPDATE_PROPERTY_LIST_ITEMS':\r\n      return updatePropertyListItems(state, action);\r\n    case 'SET_ORG_FILE_ERROR_MESSAGE':\r\n      return setOrgFileErrorMessage(state, action);\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n","import { Map, List, fromJS } from 'immutable';\n\nimport generateId from '../lib/id_generator';\nimport { applyCaptureSettingsFromConfig } from '../util/settings_persister';\n\nconst indexOfTemplateWithId = (templates, templateId) =>\n  templates.findIndex(template => template.get('id') === templateId);\n\nconst addNewEmptyCaptureTemplate = state => {\n  if (!state.get('captureTemplates')) {\n    state = state.set('captureTemplates', new List());\n  }\n\n  return state.update('captureTemplates', templates =>\n    templates.push(\n      fromJS({\n        id: generateId(),\n        description: '',\n        letter: '',\n        iconName: '',\n        isAvailableInAllOrgFiles: true,\n        orgFilesWhereAvailable: [''],\n        headerPaths: [''],\n        shouldPrepend: false,\n        template: '',\n      })\n    )\n  );\n};\n\nconst updateTemplateFieldPathValue = (state, action) => {\n  const templateIndex = indexOfTemplateWithId(state.get('captureTemplates'), action.templateId);\n\n  return state.setIn(['captureTemplates', templateIndex].concat(action.fieldPath), action.newValue);\n};\n\nconst addNewTemplateOrgFileAvailability = (state, action) => {\n  const templateIndex = indexOfTemplateWithId(state.get('captureTemplates'), action.templateId);\n\n  return state.updateIn(['captureTemplates', templateIndex, 'orgFilesWhereAvailable'], orgFiles =>\n    orgFiles.push('')\n  );\n};\n\nconst removeTemplateOrgFileAvailability = (state, action) => {\n  const templateIndex = indexOfTemplateWithId(state.get('captureTemplates'), action.templateId);\n\n  return state.updateIn(['captureTemplates', templateIndex, 'orgFilesWhereAvailable'], orgFiles =>\n    orgFiles.delete(action.orgFileAvailabilityIndex)\n  );\n};\n\nconst addNewTemplateHeaderPath = (state, action) => {\n  const templateIndex = indexOfTemplateWithId(state.get('captureTemplates'), action.templateId);\n\n  return state.updateIn(['captureTemplates', templateIndex, 'headerPaths'], headerPaths =>\n    headerPaths.push('')\n  );\n};\n\nconst removeTemplateHeaderPath = (state, action) => {\n  const templateIndex = indexOfTemplateWithId(state.get('captureTemplates'), action.templateId);\n\n  return state.updateIn(['captureTemplates', templateIndex, 'headerPaths'], headerPaths =>\n    headerPaths.delete(action.headerPathIndex)\n  );\n};\n\nconst deleteTemplate = (state, action) => {\n  const templateIndex = indexOfTemplateWithId(state.get('captureTemplates'), action.templateId);\n\n  return state.update('captureTemplates', templates => templates.delete(templateIndex));\n};\n\nconst restoreCaptureSettings = (state, action) => {\n  if (!action.newSettings) {\n    return state;\n  }\n\n  return applyCaptureSettingsFromConfig(state, action.newSettings);\n};\n\nconst reorderCaptureTemplate = (state, action) =>\n  state.update('captureTemplates', templates =>\n    templates.splice(action.fromIndex, 1).splice(action.toIndex, 0, templates.get(action.fromIndex))\n  );\n\nexport default (state = new Map(), action) => {\n  switch (action.type) {\n    case 'ADD_NEW_EMPTY_CAPTURE_TEMPLATE':\n      return addNewEmptyCaptureTemplate(state, action);\n    case 'UPDATE_TEMPLATE_FIELD_PATH_VALUE':\n      return updateTemplateFieldPathValue(state, action);\n    case 'ADD_NEW_TEMPLATE_ORG_FILE_AVAILABILITY':\n      return addNewTemplateOrgFileAvailability(state, action);\n    case 'REMOVE_TEMPLATE_ORG_FILE_AVAILABILITY':\n      return removeTemplateOrgFileAvailability(state, action);\n    case 'ADD_NEW_TEMPLATE_HEADER_PATH':\n      return addNewTemplateHeaderPath(state, action);\n    case 'REMOVE_TEMPLATE_HEADER_PATH':\n      return removeTemplateHeaderPath(state, action);\n    case 'DELETE_TEMPLATE':\n      return deleteTemplate(state, action);\n    case 'RESTORE_CAPTURE_SETTINGS':\n      return restoreCaptureSettings(state, action);\n    case 'REORDER_CAPTURE_TEMPLATE':\n      return reorderCaptureTemplate(state, action);\n    default:\n      return state;\n  }\n};\n","import { combineReducers } from 'redux';\nimport undoable, { includeAction } from 'redux-linear-undo';\n\nimport baseReducer from './base';\nimport syncBackendReducer from './sync_backend';\nimport orgReducer from './org';\nimport captureReducer from './capture';\n\nconst UNDOABLE_ACTIONS = [\n  'ADD_HEADER',\n  'REMOVE_HEADER',\n  'MOVE_HEADER_UP',\n  'MOVE_HEADER_DOWN',\n  'MOVE_HEADER_LEFT',\n  'MOVE_HEADER_RIGHT',\n  'MOVE_SUBTREE_LEFT',\n  'MOVE_SUBTREE_RIGHT',\n  'ADVANCE_TODO_STATE',\n  'EDIT_HEADER_TITLE',\n  'EDIT_HEADER_DESCRIPTION',\n  'NO_OP',\n  'ADD_NEW_TABLE_ROW',\n  'ADD_NEW_TABLE_COLUMN',\n  'MOVE_TABLE_ROW_DOWN',\n  'MOVE_TABLE_ROW_UP',\n  'MOVE_TABLE_COLUMN_LEFT',\n  'MOVE_TABLE_COLUMN_RIGHT',\n  'ADD_NEW_LIST_ITEM',\n  'REMOVE_LIST_ITEM',\n  'MOVE_LIST_ITEM_UP',\n  'MOVE_LIST_ITEM_DOWN',\n  'MOVE_LIST_ITEM_LEFT',\n  'MOVE_LIST_ITEM_RIGHT',\n  'MOVE_LIST_SUBTREE_LEFT',\n  'MOVE_LIST_SUBTREE_RIGHT',\n  'INSERT_CAPTURE',\n];\n\nexport default combineReducers({\n  base: baseReducer,\n  syncBackend: syncBackendReducer,\n  org: undoable(orgReducer, {\n    filter: includeAction(UNDOABLE_ACTIONS),\n    linearizeHistory: true,\n  }),\n  capture: captureReducer,\n});\n","import { Map } from 'immutable';\n\nconst signOut = (state, action) => state.set('isAuthenticated', false).set('client', null);\n\nconst setCurrentFileBrowserDirectoryListing = (state, action) =>\n  state.set(\n    'currentFileBrowserDirectoryListing',\n    Map({\n      listing: action.directoryListing,\n      hasMore: action.hasMore,\n      additionalSyncBackendState: action.additionalSyncBackendState,\n    })\n  );\n\nconst setIsLoadingMoreDirectoryListing = (state, action) =>\n  state\n    .update('currentFileBrowserDirectoryListing', currentFileBrowserDirectoryListing =>\n      !!currentFileBrowserDirectoryListing ? currentFileBrowserDirectoryListing : Map()\n    )\n    .setIn(['currentFileBrowserDirectoryListing', 'isLoadingMore'], action.isLoadingMore);\n\nexport default (state = new Map(), action) => {\n  switch (action.type) {\n    case 'SIGN_OUT':\n      return signOut(state, action);\n    case 'SET_CURRENT_FILE_BROWSER_DIRECTORY_LISTING':\n      return setCurrentFileBrowserDirectoryListing(state, action);\n    case 'SET_IS_LOADING_MORE_DIRECTORY_LISTING':\n      return setIsLoadingMoreDirectoryListing(state, action);\n    default:\n      return state;\n  }\n};\n","import { createStore, applyMiddleware, compose } from 'redux';\nimport thunk from 'redux-thunk';\nimport googleAnalyticsLogger from './middleware/google_analytics_logging';\nimport liveSync from './middleware/live_sync';\nimport syncOnBecomingVisible from './middleware/sync_on_becoming_visible';\nimport rootReducer from './reducers';\n\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\n\nexport default initialState =>\n  createStore(\n    rootReducer,\n    initialState,\n    composeEnhancers(applyMiddleware(thunk, googleAnalyticsLogger, liveSync, syncOnBecomingVisible))\n  );\n","import migrateAccessTokenToDropboxAccessToken from './migrate_access_token_to_dropbox_access_token';\nimport migrateStoreInDropboxToStoreInSyncBackend from './migrate_store_in_dropbox_to_store_in_sync_backend';\n\nexport default () => {\n  migrateAccessTokenToDropboxAccessToken();\n  migrateStoreInDropboxToStoreInSyncBackend();\n};\n","import { isLocalStorageAvailable } from '../util/settings_persister';\n\nexport default () => {\n  if (!isLocalStorageAvailable) {\n    return;\n  }\n\n  const accessToken = localStorage.getItem('accessToken');\n  if (!accessToken) {\n    return;\n  }\n\n  localStorage.setItem('dropboxAccessToken', accessToken);\n  localStorage.removeItem('accessToken');\n};\n","import { isLocalStorageAvailable } from '../util/settings_persister';\n\nexport default () => {\n  if (!isLocalStorageAvailable) {\n    return;\n  }\n\n  const shouldStoreSettingsInDropbox = localStorage.getItem('shouldStoreSettingsInDropbox');\n  if (!shouldStoreSettingsInDropbox) {\n    return;\n  }\n\n  localStorage.setItem('shouldStoreSettingsInSyncBackend', shouldStoreSettingsInDropbox);\n  localStorage.removeItem('shouldStoreSettingsInDropbox');\n};\n","const parseQueryString = str => {\n  var ret = Object.create(null);\n\n  if (typeof str !== 'string') {\n    return ret;\n  }\n\n  str = str.trim().replace(/^(\\?|#|&)/, '');\n\n  if (!str) {\n    return ret;\n  }\n\n  str.split('&').forEach(function (param) {\n    var parts = param.replace(/\\+/g, ' ').split('=');\n    // Firefox (pre 40) decodes `%3D` to `=`\n    // https://github.com/sindresorhus/query-string/pull/37\n    var key = parts.shift();\n    var val = parts.length > 0 ? parts.join('=') : undefined;\n\n    key = decodeURIComponent(key);\n\n    // missing `=` should be `null`:\n    // http://w3.org/TR/2012/WD-url-20120524/#collect-url-parameters\n    val = val === undefined ? null : decodeURIComponent(val);\n\n    if (ret[key] === undefined) {\n      ret[key] = val;\n    } else if (Array.isArray(ret[key])) {\n      ret[key].push(val);\n    } else {\n      ret[key] = [ret[key], val];\n    }\n  });\n\n  return ret;\n};\n\nexport default parseQueryString;\n","/* global gapi, google */\r\n\r\nimport { setLoadingMessage, hideLoadingMessage, clearModalStack, setIsLoading } from './base';\r\nimport {\r\n  displayFile,\r\n  applyOpennessState,\r\n  setDirty,\r\n  setLastSyncAt,\r\n  setOrgFileErrorMessage,\r\n} from './org';\r\nimport { persistField } from '../util/settings_persister';\r\nimport { Dropbox } from 'dropbox';\r\n\r\nimport { addSeconds } from 'date-fns';\r\n\r\nexport const signOut = () => (dispatch, getState) => {\r\n  switch (getState().syncBackend.get('client', {}).type) {\r\n    case 'Dropbox':\r\n      persistField('dropboxAccessToken', null);\r\n      break;\r\n    case 'Google Drive':\r\n      const token = gapi.client.getToken();\r\n      if (token) {\r\n        persistField('googleDriveAccessToken', null);\r\n        google.accounts.oauth2.revoke(token);\r\n        gapi.client.setToken('');\r\n        window.location.reload();\r\n      }\r\n      break;\r\n    default:\r\n  }\r\n\r\n  persistField('authenticatedSyncService', null);\r\n\r\n  dispatch({ type: 'SIGN_OUT' });\r\n  dispatch(clearModalStack());\r\n  dispatch(hideLoadingMessage());\r\n};\r\n\r\nexport const setCurrentFileBrowserDirectoryListing = (\r\n  directoryListing,\r\n  hasMore,\r\n  additionalSyncBackendState\r\n) => ({\r\n  type: 'SET_CURRENT_FILE_BROWSER_DIRECTORY_LISTING',\r\n  directoryListing,\r\n  hasMore,\r\n  additionalSyncBackendState,\r\n});\r\n\r\nexport const setIsLoadingMoreDirectoryListing = isLoadingMore => ({\r\n  type: 'SET_IS_LOADING_MORE_DIRECTORY_LISTING',\r\n  isLoadingMore,\r\n});\r\n\r\nexport const getDirectoryListing = path => (dispatch, getState) => {\r\n  dispatch(setLoadingMessage('Getting listing...'));\r\n\r\n  window.console.log('reading directories');\r\n\r\n  const client = getState().syncBackend.get('client');\r\n  client\r\n    .getDirectoryListing(path)\r\n    .then(({ listing, hasMore, additionalSyncBackendState }) => {\r\n      dispatch(setCurrentFileBrowserDirectoryListing(listing, hasMore, additionalSyncBackendState));\r\n      dispatch(hideLoadingMessage());\r\n    })\r\n    .catch(error => {\r\n      const msg = `There was an error retrieving files! (status: ${error.status})`;\r\n\r\n      if (error.status === 401 || error.status === 404) {\r\n        window.console.warn(msg);\r\n        const dropbox = new Dropbox({ clientId: process.env.REACT_APP_DROPBOX_CLIENT_ID, fetch });\r\n        const authURL = dropbox.getAuthenticationUrl(\r\n          window.location.origin + process.env.PUBLIC_URL + '/'\r\n        );\r\n        window.location = authURL;\r\n      } else {\r\n        alert(msg);\r\n      }\r\n\r\n      dispatch(hideLoadingMessage());\r\n    });\r\n};\r\n\r\nexport const loadMoreDirectoryListing = () => (dispatch, getState) => {\r\n  dispatch(setIsLoadingMoreDirectoryListing(true));\r\n\r\n  const client = getState().syncBackend.get('client');\r\n  const currentFileBrowserDirectoryListing = getState().syncBackend.get(\r\n    'currentFileBrowserDirectoryListing'\r\n  );\r\n  client\r\n    .getMoreDirectoryListing(currentFileBrowserDirectoryListing.get('additionalSyncBackendState'))\r\n    .then(({ listing, hasMore, additionalSyncBackendState }) => {\r\n      const extendedListing = currentFileBrowserDirectoryListing.get('listing').concat(listing);\r\n      dispatch(\r\n        setCurrentFileBrowserDirectoryListing(extendedListing, hasMore, additionalSyncBackendState)\r\n      );\r\n      dispatch(setIsLoadingMoreDirectoryListing(false));\r\n    });\r\n};\r\n\r\nexport const pushBackup = (pathOrFileId, contents) => {\r\n  return (dispatch, getState) => {\r\n    const client = getState().syncBackend.get('client');\r\n    switch (client.type) {\r\n      case 'Dropbox':\r\n        client.createFile(`${pathOrFileId}.org-web-bak`, contents);\r\n        break;\r\n      case 'Google Drive':\r\n        pathOrFileId = pathOrFileId.startsWith('/') ? pathOrFileId.substr(1) : pathOrFileId;\r\n        client.duplicateFile(pathOrFileId, fileName => `${fileName}.org-web-bak`);\r\n        break;\r\n      default:\r\n    }\r\n  };\r\n};\r\n\r\nexport const downloadFile = path => {\r\n  return (dispatch, getState) => {\r\n    dispatch(setLoadingMessage('Downloading file...'));\r\n\r\n    getState()\r\n      .syncBackend.get('client')\r\n      .getFileContents(path)\r\n      .then(fileContents => {\r\n        dispatch(setDirty(false));\r\n        dispatch(hideLoadingMessage());\r\n        dispatch(pushBackup(path, fileContents));\r\n        dispatch(setLastSyncAt(addSeconds(new Date(), 5)));\r\n        dispatch(displayFile(path, fileContents));\r\n        dispatch(applyOpennessState());\r\n      })\r\n      .catch(e => {\r\n        if (e.status === 401 || e.status === 404) {\r\n          const dropbox = new Dropbox({ clientId: process.env.REACT_APP_DROPBOX_CLIENT_ID, fetch });\r\n          const authURL = dropbox.getAuthenticationUrl(\r\n            window.location.origin + process.env.PUBLIC_URL + '/'\r\n          );\r\n          window.location = authURL;\r\n        }\r\n        dispatch(hideLoadingMessage());\r\n        dispatch(setIsLoading(false));\r\n        dispatch(setOrgFileErrorMessage('File not found'));\r\n      });\r\n  };\r\n};\r\n","import { Dropbox } from 'dropbox';\n\nimport { fromJS, Map } from 'immutable';\n\nexport default accessToken => {\n  const dropboxClient = new Dropbox({ accessToken, fetch });\n\n  const isSignedIn = () => new Promise(resolve => resolve(true));\n\n  const transformDirectoryListing = listing =>\n    fromJS(\n      listing.map(entry => ({\n        id: entry.id,\n        name: entry.name,\n        isDirectory: entry['.tag'] === 'folder',\n        path: entry.path_display,\n      }))\n    );\n\n  const getDirectoryListing = path =>\n    new Promise((resolve, reject) => {\n      dropboxClient\n        .filesListFolder({ path })\n        .then(response =>\n          resolve({\n            listing: transformDirectoryListing(response.entries),\n            hasMore: response.has_more,\n            additionalSyncBackendState: Map({\n              cursor: response.cursor,\n            }),\n          })\n        )\n        .catch(reject);\n    });\n\n  const getMoreDirectoryListing = additionalSyncBackendState => {\n    const cursor = additionalSyncBackendState.get('cursor');\n    return new Promise((resolve, reject) =>\n      dropboxClient.filesListFolderContinue({ cursor }).then(response =>\n        resolve({\n          listing: transformDirectoryListing(response.entries),\n          hasMore: response.has_more,\n          additionalSyncBackendState: Map({\n            cursor: response.cursor,\n          }),\n        })\n      )\n    );\n  };\n\n  const uploadFile = (path, contents) =>\n    new Promise((resolve, reject) =>\n      dropboxClient\n        .filesUpload({\n          path,\n          contents,\n          mode: {\n            '.tag': 'overwrite',\n          },\n          autorename: true,\n        })\n        .then(resolve)\n        .catch(reject)\n    );\n\n  const updateFile = uploadFile;\n  const createFile = uploadFile;\n\n  const getFileContentsAndMetadata = path =>\n    new Promise((resolve, reject) =>\n      dropboxClient\n        .filesDownload({ path })\n        .then(response => {\n          const reader = new FileReader();\n          reader.addEventListener('loadend', () =>\n            resolve({\n              contents: reader.result,\n              lastModifiedAt: response.server_modified,\n            })\n          );\n          reader.readAsText(response.fileBlob);\n        })\n        .catch(error => {\n          if (!!error.error && JSON.parse(error.error).error['.tag'] === 'expired_access_token') {\n            reject(new Response(null, { status: 401 }));\n          }\n          if (!!error.error && JSON.parse(error.error).error['.tag'] === 'not_found') {\n            reject();\n          }\n        })\n    );\n\n  const getFileContents = path =>\n    new Promise((resolve, reject) =>\n      getFileContentsAndMetadata(path)\n        .then(({ contents }) => resolve(contents))\n        .catch(reject)\n    );\n\n  const deleteFile = path =>\n    new Promise((resolve, reject) =>\n      dropboxClient\n        .filesDelete({ path })\n        .then(resolve)\n        .catch(error => reject(error.error.error['.tag'] === 'path_lookup', error))\n    );\n\n  return {\n    type: 'Dropbox',\n    isSignedIn,\n    getDirectoryListing,\n    getMoreDirectoryListing,\n    updateFile,\n    createFile,\n    getFileContentsAndMetadata,\n    getFileContents,\n    deleteFile,\n  };\n};\n","/* global process */\n\nimport { fromJS, Map } from 'immutable';\nimport { persistField, getPersistedField } from '../util/settings_persister';\n\nexport default () => {\n  const initGoogleDriveAPIClient = () =>\n    new Promise((resolve, reject) => {\n      window.gapi.load('client', () => {\n        window.gapi.client\n          .init({\n            apiKey: process.env.REACT_APP_GOOGLE_DRIVE_API_KEY,\n            discoveryDocs: ['https://www.googleapis.com/discovery/v1/apis/drive/v3/rest'],\n          })\n          .then(async () => {\n            const googleDriveAccessTokenString = getPersistedField('googleDriveAccessToken');\n            if (googleDriveAccessTokenString) {\n              const googleDriveAccessToken = JSON.parse(googleDriveAccessTokenString);\n              window.gapi.client.setToken(googleDriveAccessToken);\n              resolve();\n            } else {\n              const tokenClient = window.google.accounts.oauth2.initTokenClient({\n                client_id: process.env.REACT_APP_GOOGLE_DRIVE_CLIENT_ID,\n                scope: 'https://www.googleapis.com/auth/drive.file',\n                callback: accessToken => {\n                  persistField('authenticatedSyncService', 'Google Drive');\n                  persistField('googleDriveAccessToken', JSON.stringify(accessToken));\n                  resolve();\n                },\n              });\n              tokenClient.requestAccessToken({ prompt: 'consent' });\n            }\n          });\n      });\n    });\n\n  const getAPIClient = (() => {\n    let isInited = false;\n    let isIniting = false;\n    const afterInitCallbacks = [];\n\n    return () => {\n      return new Promise((resolve, reject) => {\n        if (isInited) {\n          resolve(window.gapi);\n        } else {\n          if (window.gapi && !isIniting) {\n            isIniting = true;\n            initGoogleDriveAPIClient().then(() => {\n              isInited = true;\n              afterInitCallbacks.forEach(callback => callback(window.gapi));\n              resolve(window.gapi);\n            });\n          } else {\n            afterInitCallbacks.push(resolve);\n          }\n        }\n      });\n    };\n  })();\n\n  // Trigger the API client init when the gapi script loads.\n  if (window.gapi) {\n    getAPIClient();\n  } else {\n    // This handler will be called when the <script> tag loads.\n    window.handleGoogleDriveClientLoad = getAPIClient;\n  }\n\n  const isSignedIn = () =>\n    new Promise((resolve, reject) => {\n      getAPIClient().then(gapi => {\n        resolve(gapi.client.getToken() !== null);\n      });\n    });\n\n  const transformDirectoryListing = listing =>\n    fromJS(\n      listing.map(entry => ({\n        id: entry.id,\n        name: entry.name,\n        isDirectory: entry.mimeType === 'application/vnd.google-apps.folder',\n        path: `/${entry.id}`,\n      }))\n    );\n\n  const getFiles = (directoryId, nextPageToken = null) => {\n    const fileListPromise = new Promise((resolve, reject) => {\n      getAPIClient().then(gapi => {\n        gapi.client.drive.files\n          .list({\n            pageSize: 30,\n            fields: 'nextPageToken, files(id, name, mimeType, parents)',\n            q: `'${directoryId === '' ? 'root' : directoryId}' in parents and trashed = false`,\n            pageToken: nextPageToken,\n          })\n          .then(response => {\n            resolve({\n              listing: transformDirectoryListing(response.result.files),\n              hasMore: !!response.result.nextPageToken,\n              additionalSyncBackendState: Map({\n                currentDirectoryId: directoryId,\n                nextPageToken: response.result.nextPageToken,\n              }),\n            });\n          })\n          .catch(reject);\n      });\n    });\n\n    const fileParentPromise = new Promise((resolve, reject) => {\n      if (directoryId === '') {\n        resolve(null);\n      } else {\n        getAPIClient()\n          .then(gapi =>\n            gapi.client.drive.files.get({\n              fileId: directoryId,\n              fields: 'parents',\n            })\n          )\n          .then(response => {\n            if (!response.result.parents) {\n              resolve(null);\n            } else {\n              resolve(response.result.parents[0]);\n            }\n          })\n          .catch(reject);\n      }\n    });\n\n    const rootFolderIdPromise = new Promise((resolve, reject) => {\n      if (!!window.rootFolderId) {\n        resolve(window.rootFolderId);\n      } else {\n        getAPIClient()\n          .then(gapi =>\n            gapi.client.drive.files.get({\n              fileId: 'root',\n              fields: 'id',\n            })\n          )\n          .then(response => {\n            window.rootFolderId = response.result.id;\n            resolve(response.result.id);\n          })\n          .catch(reject);\n      }\n    });\n\n    return new Promise((resolve, reject) => {\n      Promise.all([fileListPromise, fileParentPromise, rootFolderIdPromise]).then(\n        ([listing, parentId, rootFolderId]) => {\n          const directoryParentId = parentId === rootFolderId ? '' : parentId;\n          listing.additionalSyncBackendState = listing.additionalSyncBackendState.set(\n            'parentId',\n            directoryParentId\n          );\n          resolve(listing);\n        }\n      );\n    });\n  };\n\n  const getDirectoryListing = directoryId =>\n    getFiles(directoryId.startsWith('/') ? directoryId.substr(1) : directoryId);\n\n  const getMoreDirectoryListing = additionalSyncBackendState => {\n    const directoryId = additionalSyncBackendState.get('currentDirectoryId');\n    const nextPageToken = additionalSyncBackendState.get('nextPageToken');\n    return getFiles(directoryId, nextPageToken);\n  };\n\n  const fileIdByNameAndParent = (name, parentId) =>\n    new Promise((resolve, reject) => {\n      getAPIClient()\n        .then(gapi =>\n          gapi.client.drive.files.list({\n            pageSize: 1,\n            fields: 'files(id)',\n            q: `'${parentId}' in parents and trashed = false and name = '${name}'`,\n          })\n        )\n        .then(response =>\n          resolve(response.result.files.length > 0 ? response.result.files[0].id : null)\n        )\n        .catch(reject);\n    });\n\n  const updateFile = (fileId, contents) => {\n    fileId = fileId.startsWith('/') ? fileId.substr(1) : fileId;\n\n    return getAPIClient().then(gapi => {\n      fetch(`https://www.googleapis.com/upload/drive/v3/files/${fileId}?uploadType=media`, {\n        method: 'PATCH',\n        headers: {\n          Authorization: `Bearer ${gapi.auth.getToken().access_token}`,\n        },\n        body: contents,\n      });\n    });\n  };\n\n  const createFile = (name, parentId, contents) => {\n    return new Promise((resolve, reject) => {\n      fileIdByNameAndParent(name, parentId)\n        .then(fileId =>\n          !!fileId\n            ? updateFile(fileId, contents).then(resolve).catch(reject)\n            : getAPIClient().then(gapi => {\n                gapi.client.drive.files\n                  .create({\n                    name,\n                    parents: parentId,\n                  })\n                  .then(response => updateFile(response.result.id, contents))\n                  .then(resolve)\n                  .catch(reject);\n              })\n        )\n        .catch(reject);\n    });\n  };\n\n  const duplicateFile = (fileId, fileNameCallback) => {\n    return new Promise((resolve, reject) => {\n      getAPIClient().then(gapi => {\n        gapi.client.drive.files\n          .get({\n            fileId,\n            fields: 'name, parents',\n          })\n          .then(getResponse => {\n            if (!getResponse.result.name) {\n              reject();\n            } else {\n              const newFileName = fileNameCallback(getResponse.result.name);\n              const parents = getResponse.result.parents[0];\n              fileIdByNameAndParent(newFileName, parents).then(backupFileId => {\n                const makeCopy = () => {\n                  gapi.client.drive.files\n                    .copy({\n                      fileId,\n                      parents,\n                      name: newFileName,\n                    })\n                    .then(copyResponse => {\n                      resolve();\n                    })\n                    .catch(reject);\n                };\n\n                if (!!backupFileId) {\n                  gapi.client.drive.files\n                    .delete({ fileId: backupFileId })\n                    .then(makeCopy)\n                    .catch(reject);\n                } else {\n                  makeCopy();\n                }\n              });\n            }\n          });\n      });\n    });\n  };\n\n  const getFileContentsAndMetadata = fileId =>\n    new Promise((resolve, reject) => {\n      getAPIClient().then(gapi => {\n        fileId = fileId.startsWith('/') ? fileId.substr(1) : fileId;\n\n        const fileContentsPromise = new Promise(resolve => {\n          gapi.client.drive.files\n            .get({\n              fileId,\n              alt: 'media',\n            })\n            .then(response => resolve(decodeURIComponent(escape(response.body))))\n            .catch(error => {\n              if (error.body && JSON.parse(error.body).error.errors[0].reason === 'notFound') {\n                reject();\n              }\n            });\n        });\n\n        const fileModifiedTimePromise = new Promise(resolve => {\n          gapi.client.drive.files\n            .get({\n              fileId,\n              fields: 'modifiedTime',\n            })\n            .then(response => {\n              resolve(response.result.modifiedTime);\n            })\n            .catch(error => {\n              if (error.body && JSON.parse(error.body).error.errors[0].reason === 'notFound') {\n                reject();\n              }\n            });\n        });\n\n        Promise.all([fileContentsPromise, fileModifiedTimePromise]).then(\n          ([contents, lastModifiedAt]) => {\n            resolve({\n              contents,\n              lastModifiedAt,\n            });\n          }\n        );\n      });\n    });\n\n  const getFileContents = fileId =>\n    new Promise((resolve, reject) =>\n      getFileContentsAndMetadata(fileId)\n        .then(({ contents }) => resolve(contents))\n        .catch(reject)\n    );\n\n  const getFileContentsByNameAndParent = (name, parentId) =>\n    new Promise((resolve, reject) =>\n      fileIdByNameAndParent(name, parentId).then(fileId => getFileContents(fileId).then(resolve))\n    );\n\n  const deleteFileByNameAndParent = (name, parentId) =>\n    new Promise((resolve, reject) => {\n      getAPIClient().then(gapi =>\n        gapi.client.drive.files\n          .list({\n            pageSize: 1,\n            fields: 'files(id)',\n            q: `'${parentId}' in parents and trashed = false and name = '${name}'`,\n          })\n          .then(listResponse => {\n            if (listResponse.result.files.length > 0) {\n              gapi.client.drive.files\n                .delete({\n                  fileId: listResponse.result.files[0].id,\n                })\n                .then(resolve)\n                .catch(reject);\n            } else {\n              resolve();\n            }\n          })\n      );\n    });\n\n  return {\n    type: 'Google Drive',\n    isSignedIn,\n    getDirectoryListing,\n    getMoreDirectoryListing,\n    updateFile,\n    createFile,\n    duplicateFile,\n    getFileContentsAndMetadata,\n    getFileContents,\n    getFileContentsByNameAndParent,\n    deleteFileByNameAndParent,\n  };\n};\n","import React from 'react';\n\nimport './stylesheet.css';\n\nconst PrivacyPolicy = () => {\n  return (\n    <div className=\"privacy-policy-container\">\n      <h1>Privacy Policy</h1>\n      <p>Last updated: April 15th, 2019</p>\n      <p>\n        We (\"us\" or \"our\") operate https://org-web.org (the \"Site\"). This page informs you of our\n        policies regarding the collection, use and disclosure of Personal Information we receive\n        from users of the Site.\n      </p>\n      <p>\n        We use your Personal Information only for providing and improving the Site. By using the\n        Site, you agree to the collection and use of information in accordance with this policy.\n      </p>\n      <h2>Information Collection And Use</h2>\n      <p>\n        While using our Site, we may ask you to provide us with certain personally identifiable\n        information that can be used to contact or identify you. Personally identifiable information\n        may include, but is not limited to your name (\"Personal Information\").\n      </p>\n      <h2>Log Data</h2>\n      <p>\n        Like many site operators, we collect information that your browser sends whenever you visit\n        our Site (\"Log Data\").\n      </p>\n      <p>\n        This Log Data may include information such as your computer's Internet Protocol (\"IP\")\n        address, browser type, browser version, the pages of our Site that you visit, the time and\n        date of your visit, the time spent on those pages and other statistics.\n      </p>\n      <p>\n        In addition, we may use third party services such as Google Analytics that collect, monitor\n        and analyze this data.\n      </p>\n      <h2>Cookies</h2>\n      <p>\n        Cookies are files with small amount of data, which may include an anonymous unique\n        identifier. Cookies are sent to your browser from a web site and stored on your computer's\n        hard drive.\n      </p>\n      <p>\n        Like many sites, we use \"cookies\" to collect information. You can instruct your browser to\n        refuse all cookies or to indicate when a cookie is being sent. However, if you do not accept\n        cookies, you may not be able to use some portions of our Site.\n      </p>\n      <h2>Security</h2>\n      <p>\n        The security of your Personal Information is important to us, but remember that no method of\n        transmission over the Internet, or method of electronic storage, is 100% secure. While we\n        strive to use commercially acceptable means to protect your Personal Information, we cannot\n        guarantee its absolute security.\n      </p>\n      <h2>Changes To This Privacy Policy</h2>\n      <p>\n        This Privacy Policy is effective as of April 15th, 2019 and will remain in effect except\n        with respect to any changes in its provisions in the future, which will be in effect\n        immediately after being posted on this page.\n      </p>\n      <p>\n        We reserve the right to update or change our Privacy Policy at any time and you should check\n        this Privacy Policy periodically. Your continued use of the Service after we post any\n        modifications to the Privacy Policy on this page will constitute your acknowledgment of the\n        modifications and your consent to abide and be bound by the modified Privacy Policy.\n      </p>\n      <p>\n        If we make any material changes to this Privacy Policy, we will notify you either through\n        the email address you have provided us, or by placing a prominent notice on our website.\n      </p>\n      <h2>Contact</h2>\n      <p>Us If you have any questions about this Privacy Policy, please contact us.</p>\n    </div>\n  );\n};\nexport default PrivacyPolicy;\n","import React, { PureComponent, Fragment } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport { Link, withRouter } from 'react-router-dom';\n\nimport logo from './org-web.svg';\n\nimport './stylesheet.css';\n\nimport * as baseActions from '../../actions/base';\nimport { ActionCreators as undoActions } from 'redux-linear-undo';\n\nimport { List } from 'immutable';\nimport _ from 'lodash';\nimport classNames from 'classnames';\n\nclass HeaderBar extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, [\n      'handleChangelogClick',\n      'handleSettingsClick',\n      'handleModalPageDoneClick',\n      'handleSettingsSubPageBackClick',\n      'handleUndoClick',\n      'handleHelpClick',\n    ]);\n  }\n\n  getPathRoot() {\n    const {\n      location: { pathname },\n    } = this.props;\n    return pathname.split('/')[1];\n  }\n\n  renderFileBrowserBackButton() {\n    const {\n      location: { pathname },\n      syncBackendType,\n    } = this.props;\n    if (syncBackendType === 'Google Drive') {\n      return <div />;\n    }\n\n    let directoryPath = pathname.substr('/files'.length);\n    if (directoryPath.endsWith('/')) {\n      directoryPath = directoryPath.substring(0, directoryPath.length - 1);\n    }\n\n    if (directoryPath === '') {\n      return <div />;\n    } else {\n      const pathParts = directoryPath.split('/');\n      const parentDirectoryName = pathParts[pathParts.length - 2];\n      const parentPath = pathParts.slice(0, pathParts.length - 1).join('/');\n\n      return (\n        <Link to={`/files${parentPath}`} className=\"header-bar__back-button\">\n          <i className=\"fas fa-chevron-left\" />\n          <span className=\"header-bar__back-button__directory-path\">{parentDirectoryName}/</span>\n        </Link>\n      );\n    }\n  }\n\n  renderOrgFileBackButton() {\n    const {\n      location: { pathname },\n    } = this.props;\n\n    let filePath = pathname.substr('/file'.length);\n    if (filePath.endsWith('/')) {\n      filePath = filePath.substring(0, filePath.length - 1);\n    }\n\n    const pathParts = filePath.split('/');\n    const directoryPath = pathParts.slice(0, pathParts.length - 1).join('/');\n\n    return (\n      <Link to={`/files${directoryPath}`} className=\"header-bar__back-button\">\n        <i className=\"fas fa-chevron-left\" />\n        <span className=\"header-bar__back-button__directory-path\">File browser</span>\n      </Link>\n    );\n  }\n\n  renderLogo() {\n    return (\n      <div className=\"header-bar__logo-container\">\n        <img className=\"header-bar__logo\" src={logo} alt=\"Logo\" width=\"30\" height=\"30\" />\n        <h2 className=\"header-bar__app-name\">org-web</h2>\n      </div>\n    );\n  }\n\n  renderSampleFileBackButton() {\n    return (\n      <Link to={`/`} className=\"header-bar__back-button\">\n        <i className=\"fas fa-chevron-left\" />\n        <span className=\"header-bar__back-button__directory-path\">Home</span>\n      </Link>\n    );\n  }\n\n  renderSignInBackButton() {\n    return (\n      <Link to={`/`} className=\"header-bar__back-button\">\n        <i className=\"fas fa-chevron-left\" />\n        <span className=\"header-bar__back-button__directory-path\">Home</span>\n      </Link>\n    );\n  }\n\n  handleSettingsSubPageBackClick() {\n    this.props.base.popModalPage();\n  }\n\n  renderSettingsSubPageBackButton() {\n    return (\n      <div className=\"header-bar__back-button\" onClick={this.handleSettingsSubPageBackClick}>\n        <i className=\"fas fa-chevron-left\" />\n        <span className=\"header-bar__back-button__directory-path\">Settings</span>\n      </div>\n    );\n  }\n\n  renderBackButton() {\n    const { activeModalPage } = this.props;\n\n    switch (activeModalPage) {\n      case 'changelog':\n        return this.renderSettingsSubPageBackButton();\n      case 'keyboard_shortcuts_editor':\n        return this.renderSettingsSubPageBackButton();\n      case 'capture_templates_editor':\n        return this.renderSettingsSubPageBackButton();\n      case 'sample':\n        return this.renderSettingsSubPageBackButton();\n      case 'settings':\n        return <div />;\n      default:\n    }\n\n    switch (this.getPathRoot()) {\n      case '':\n        return this.renderLogo();\n      case 'files':\n        return this.renderFileBrowserBackButton();\n      case 'file':\n        return this.renderOrgFileBackButton();\n      case 'sample':\n        return this.renderSampleFileBackButton();\n      case 'sign_in':\n        return this.renderSignInBackButton();\n      default:\n        return <div />;\n    }\n  }\n\n  renderTitle() {\n    const titleContainerWithText = text => <div className=\"header-bar__title\">{text}</div>;\n\n    switch (this.props.activeModalPage) {\n      case 'changelog':\n        return titleContainerWithText('Changelog');\n      case 'settings':\n        return titleContainerWithText('Settings');\n      case 'keyboard_shortcuts_editor':\n        return titleContainerWithText('Shortcuts');\n      case 'capture_templates_editor':\n        return titleContainerWithText('Capture');\n      case 'sample':\n        return titleContainerWithText('Sample');\n      default:\n    }\n\n    switch (this.getPathRoot()) {\n      case 'sample':\n        return titleContainerWithText('Sample');\n      case 'sign_in':\n        return titleContainerWithText('Sign in');\n      default:\n    }\n\n    return titleContainerWithText('');\n  }\n\n  handleChangelogClick() {\n    this.props.base.pushModalPage('changelog');\n  }\n\n  handleSettingsClick() {\n    this.props.base.pushModalPage('settings');\n  }\n\n  handleModalPageDoneClick() {\n    this.props.base.clearModalStack();\n  }\n\n  handleUndoClick() {\n    if (this.props.isUndoEnabled) {\n      this.props.undo.undo();\n    }\n  }\n\n  handleHelpClick() {\n    this.props.base.pushModalPage('settings');\n    this.props.base.pushModalPage('sample');\n  }\n\n  renderActions() {\n    const { isAuthenticated, hasUnseenChangelog, activeModalPage, path, isUndoEnabled } =\n      this.props;\n\n    if (!!activeModalPage) {\n      return (\n        <div className=\"header-bar__actions\" onClick={this.handleModalPageDoneClick}>\n          Done\n        </div>\n      );\n    } else {\n      const undoIconClassName = classNames('fas fa-undo header-bar__actions__item', {\n        'header-bar__actions__item--disabled': !isUndoEnabled,\n      });\n\n      const settingsIconClassName = classNames('fas fa-cogs header-bar__actions__item', {\n        'settings-icon--has-unseen-changelog': hasUnseenChangelog,\n      });\n\n      return (\n        <div className=\"header-bar__actions\">\n          {!isAuthenticated && this.getPathRoot() !== 'sign_in' && (\n            <Link to=\"/sign_in\">\n              <div className=\"header-bar__actions__item\" title=\"Sign in\">\n                Sign in\n              </div>\n            </Link>\n          )}\n\n          {!isAuthenticated && (\n            <a href=\"https://github.com/DanielDe/org-web\" target=\"_blank\" rel=\"noopener noreferrer\">\n              <i className=\"fab fa-github header-bar__actions__item\" />\n            </a>\n          )}\n\n          {isAuthenticated && !activeModalPage && !!path && (\n            <Fragment>\n              <i className={undoIconClassName} onClick={this.handleUndoClick} title=\"Undo\" />\n              <i\n                className=\"fas fa-question-circle header-bar__actions__item\"\n                onClick={this.handleHelpClick}\n                title=\"Help\"\n              />\n            </Fragment>\n          )}\n\n          {isAuthenticated && (\n            <i\n              className={settingsIconClassName}\n              onClick={this.handleSettingsClick}\n              title=\"Settings\"\n            />\n          )}\n        </div>\n      );\n    }\n  }\n\n  render() {\n    const className = classNames('header-bar', {\n      'header-bar--with-logo': this.getPathRoot() === '',\n    });\n\n    return (\n      <div className={className}>\n        {this.renderBackButton()}\n        {this.renderTitle()}\n        {this.renderActions()}\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = (state, props) => {\n  return {\n    isAuthenticated: state.syncBackend.get('isAuthenticated'),\n    hasUnseenChangelog: state.base.get('hasUnseenChangelog'),\n    activeModalPage: state.base.get('modalPageStack', List()).last(),\n    path: state.org.present.get('path'),\n    isUndoEnabled: state.org.past.length > 0,\n    syncBackendType: state.syncBackend.get('client') && state.syncBackend.get('client').type,\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    base: bindActionCreators(baseActions, dispatch),\n    undo: bindActionCreators(undoActions, dispatch),\n  };\n};\n\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(HeaderBar));\n","import React from 'react';\nimport { Link } from 'react-router-dom';\nimport preval from 'preval.macro';\n\nimport './stylesheet.css';\n\nexport default () => {\n  const buildTimestamp = preval`module.exports = new Date().toLocaleString();`;\n\n  return (\n    <div className=\"landing-container\">\n      <h1 className=\"landing-app-name\">org-web</h1>\n      <div>{`(built at ${buildTimestamp})`}</div>\n      <h2 className=\"landing-tagline\">Edit your org files online.</h2>\n      <h2 className=\"landing-tagline\">Optimized for mobile.</h2>\n      <h2 className=\"landing-tagline\">\n        Syncs with Dropbox\n        <br />\n        and Google Drive.\n      </h2>\n\n      <Link to=\"/sample\">\n        <div className=\"btn landing-button view-sample-button\">View sample</div>\n      </Link>\n      <Link to=\"/sign_in\">\n        <div className=\"btn landing-button\">Sign in</div>\n      </Link>\n\n      <div className=\"mailing-list-signup-container\">\n        Interested in getting updates about org-web? Sign up for the{' '}\n        <a href=\"http://eepurl.com/dK5F9w\" target=\"_blank\" rel=\"noopener noreferrer\">\n          mailing list\n        </a>{' '}\n        (Or check out some{' '}\n        <a\n          href=\"https://us19.campaign-archive.com/home/?u=36b9d8082ddb55e6cc7e22339&id=f427625e31\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n        >\n          past emails\n        </a>{' '}\n        before you sign up)\n      </div>\n    </div>\n  );\n};\n","import React, { useEffect } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport { Link } from 'react-router-dom';\r\n\r\nimport './stylesheet.css';\r\n\r\nimport classNames from 'classnames';\r\n\r\nimport * as syncBackendActions from '../../actions/sync_backend';\r\n\r\nconst FileBrowser = ({\r\n  path,\r\n  listing,\r\n  hasMore,\r\n  isLoadingMore,\r\n  syncBackendType,\r\n  syncBackend,\r\n  additionalSyncBackendState,\r\n}) => {\r\n  useEffect(() => syncBackend.getDirectoryListing(path), [path]);\r\n\r\n  const handleLoadMoreClick = () => syncBackend.loadMoreDirectoryListing();\r\n\r\n  const getParentDirectoryPath = () => {\r\n    switch (syncBackendType) {\r\n      case 'Dropbox':\r\n        const pathParts = path.split('/');\r\n        return pathParts.slice(0, pathParts.length - 1).join('/');\r\n      case 'Google Drive':\r\n        return !!additionalSyncBackendState.get('parentId')\r\n          ? '/' + additionalSyncBackendState.get('parentId')\r\n          : null;\r\n      default:\r\n        return null;\r\n    }\r\n  };\r\n\r\n  const isTopLevelDirectory = path === '';\r\n\r\n  return (\r\n    <div className=\"file-browser-container\">\r\n      {syncBackendType === 'Dropbox' && (\r\n        <h3 className=\"file-browser__header\">Directory: {isTopLevelDirectory ? '/' : path}</h3>\r\n      )}\r\n\r\n      <ul className=\"file-browser__file-list\">\r\n        {!isTopLevelDirectory && (\r\n          <Link to={`/files${getParentDirectoryPath()}`}>\r\n            <li className=\"file-browser__file-list__element\">\r\n              <i className=\"fas fa-folder file-browser__file-list__icon--directory\" /> ..\r\n            </li>\r\n          </Link>\r\n        )}\r\n\r\n        {(listing || []).map(file => {\r\n          const isDirectory = file.get('isDirectory');\r\n          const isBackupFile = file.get('name').endsWith('.org-web-bak');\r\n          const isOrgFile = file.get('name').endsWith('.org');\r\n          const isSettingsFile = file.get('name') === '.org-web-config.json';\r\n\r\n          const iconClass = classNames('file-browser__file-list__icon fas', {\r\n            'fa-folder': isDirectory,\r\n            'file-browser__file-list__icon--directory': isDirectory,\r\n            'fa-file': !isDirectory && !isBackupFile && !isSettingsFile,\r\n            'file-browser__file-list__icon--not-org': !isOrgFile,\r\n            'fa-copy': isBackupFile,\r\n            'fa-cogs': isSettingsFile,\r\n          });\r\n\r\n          if (file.get('isDirectory')) {\r\n            return (\r\n              <Link to={`/files${file.get('path')}`} key={file.get('id')}>\r\n                <li className=\"file-browser__file-list__element\">\r\n                  <i className={iconClass} /> {file.get('name')}/\r\n                </li>\r\n              </Link>\r\n            );\r\n          } else {\r\n            return (\r\n              <Link to={`/file${file.get('path')}`} key={file.get('id')}>\r\n                <li className=\"file-browser__file-list__element\">\r\n                  <i className={iconClass} /> {file.get('name')}\r\n                </li>\r\n              </Link>\r\n            );\r\n          }\r\n        })}\r\n\r\n        {hasMore &&\r\n          (isLoadingMore ? (\r\n            <li className=\"file-browser__file-list__loading-more-container\">\r\n              <i className=\"fas fa-spinner fa-lg fa-spin\" />\r\n            </li>\r\n          ) : (\r\n            <li\r\n              className=\"file-browser__file-list__element file-browser__file-list__element--load-more-row\"\r\n              onClick={handleLoadMoreClick}\r\n            >\r\n              Load more...\r\n            </li>\r\n          ))}\r\n      </ul>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst mapStateToProps = (state, props) => {\r\n  const currentFileBrowserDirectoryListing = state.syncBackend.get(\r\n    'currentFileBrowserDirectoryListing'\r\n  );\r\n  return {\r\n    syncBackendType: state.syncBackend.get('client').type,\r\n    listing: !!currentFileBrowserDirectoryListing\r\n      ? currentFileBrowserDirectoryListing.get('listing')\r\n      : null,\r\n    hasMore:\r\n      !!currentFileBrowserDirectoryListing && currentFileBrowserDirectoryListing.get('hasMore'),\r\n    isLoadingMore:\r\n      !!currentFileBrowserDirectoryListing &&\r\n      currentFileBrowserDirectoryListing.get('isLoadingMore'),\r\n    additionalSyncBackendState:\r\n      !!currentFileBrowserDirectoryListing &&\r\n      currentFileBrowserDirectoryListing.get('additionalSyncBackendState'),\r\n  };\r\n};\r\n\r\nconst mapDispatchToProps = dispatch => {\r\n  return {\r\n    syncBackend: bindActionCreators(syncBackendActions, dispatch),\r\n  };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(FileBrowser);\r\n","import React, { useState, useEffect } from 'react';\nimport { Motion, spring } from 'react-motion';\n\nimport './stylesheet.css';\n\nexport default ({ message }) => {\n  const [shouldRenderIndicator, setShouldRenderIndicator] = useState(true);\n  const [lastMessage, setLastMessage] = useState(message);\n\n  useEffect(() => {\n    if (!!message) {\n      setLastMessage(message);\n      setShouldRenderIndicator(true);\n    }\n  }, [message]);\n\n  const handleAnimationRest = () => {\n    if (!!message) {\n      return;\n    }\n\n    setShouldRenderIndicator(false);\n    setLastMessage(null);\n  };\n\n  const handleClick = () => setShouldRenderIndicator(false);\n\n  if (!shouldRenderIndicator) {\n    return null;\n  }\n\n  const style = {\n    opacity: spring(!!message ? 0.9 : 0, { stiffness: 300 }),\n  };\n\n  return (\n    <Motion style={style} onRest={handleAnimationRest}>\n      {style => (\n        <div className=\"loading-indicator\" style={style} onClick={handleClick}>\n          {lastMessage}\n        </div>\n      )}\n    </Motion>\n  );\n};\n","import React from 'react';\n\nimport './stylesheet.css';\n\nexport default ({\n  subPartDataAndHandlers: {\n    onEnterTableEditMode,\n    onAddNewTableRow,\n    onRemoveTableRow,\n    onAddNewTableColumn,\n    onRemoveTableColumn,\n  },\n}) => {\n  return (\n    <div className=\"table-action-drawer-container\">\n      <div className=\" table-action-drawer__edit-icon-container\" onClick={onEnterTableEditMode}>\n        <i className=\"fas fa-pencil-alt fa-lg\" />\n      </div>\n\n      <div className=\"table-action-drawer__sub-icon-container\" onClick={onAddNewTableRow}>\n        <i className=\"fas fa-plus fa-lg table-action-drawer__main-icon\" />\n        <i className=\"fas fa-columns fa-sm table-action-drawer__sub-icon table-action-drawer__sub-icon--rotated\" />\n      </div>\n\n      <div className=\"table-action-drawer__sub-icon-container\" onClick={onRemoveTableRow}>\n        <i className=\"fas fa-times fa-lg table-action-drawer__main-icon\" />\n        <i className=\"fas fa-columns fa-sm table-action-drawer__sub-icon table-action-drawer__sub-icon--rotated\" />\n      </div>\n\n      <div className=\"table-action-drawer__sub-icon-container\" onClick={onAddNewTableColumn}>\n        <i className=\"fas fa-plus fa-lg table-action-drawer__main-icon\" />\n        <i className=\"fas fa-columns fa-sm table-action-drawer__sub-icon\" />\n      </div>\n\n      <div className=\"table-action-drawer__sub-icon-container\" onClick={onRemoveTableColumn}>\n        <i className=\"fas fa-times fa-lg table-action-drawer__main-icon\" />\n        <i className=\"fas fa-columns fa-sm table-action-drawer__sub-icon\" />\n      </div>\n    </div>\n  );\n};\n","import React, { PureComponent, Fragment } from 'react';\nimport { UnmountClosed as Collapse } from 'react-collapse';\n\nimport './stylesheet.css';\n\nimport AttributedString from '../../../AttributedString';\nimport TableActionDrawer from './TableActionDrawer';\n\nimport { getCurrentTimestampAsText } from '../../../../../../lib/timestamps';\n\nimport _ from 'lodash';\nimport classNames from 'classnames';\nimport { Map } from 'immutable';\n\nexport default class TablePart extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, [\n      'handleCellSelect',\n      'handleTextareaBlur',\n      'handleCellChange',\n      'handleInsertTimestamp',\n      'handleTextareaRef',\n    ]);\n\n    this.state = {\n      rawCellValues: this.generateCellValueMap(props.table),\n      shouldIgnoreBlur: false,\n    };\n  }\n\n  componentDidUpdate(prevProps) {\n    const {\n      subPartDataAndHandlers: { onTableCellValueUpdate, selectedTableCellId, inTableEditMode },\n    } = this.props;\n    const { rawCellValues } = this.state;\n\n    if (prevProps.subPartDataAndHandlers.inTableEditMode && !inTableEditMode) {\n      if (rawCellValues.has(selectedTableCellId)) {\n        onTableCellValueUpdate(selectedTableCellId, rawCellValues.get(selectedTableCellId));\n      }\n    }\n\n    if (this.props.table !== prevProps.table) {\n      this.setState({ rawCellValues: this.generateCellValueMap(this.props.table) });\n    }\n  }\n\n  generateCellValueMap(table) {\n    return Map(\n      table\n        .get('contents')\n        .map(row => row.get('contents').map(cell => [cell.get('id'), cell.get('rawContents')]))\n        .flatten()\n    );\n  }\n\n  handleCellSelect(cellId) {\n    return () => this.props.subPartDataAndHandlers.onTableCellSelect(cellId);\n  }\n\n  handleTextareaBlur() {\n    setTimeout(() => {\n      if (!this.state.shouldIgnoreBlur) {\n        this.props.subPartDataAndHandlers.onExitTableEditMode();\n      } else {\n        this.setState({ shouldIgnoreBlur: false });\n      }\n    }, 0);\n  }\n\n  handleCellChange(event) {\n    const { rawCellValues } = this.state;\n    const {\n      subPartDataAndHandlers: { selectedTableCellId },\n    } = this.props;\n\n    this.setState({\n      rawCellValues: rawCellValues.set(selectedTableCellId, event.target.value),\n    });\n  }\n\n  handleInsertTimestamp() {\n    // Clicking this button will unfocus the textarea, but we don't want to exit edit mode,\n    // so instruct the blur handler to ignore the event.\n    this.setState({ shouldIgnoreBlur: true });\n\n    const { rawCellValues } = this.state;\n    const {\n      subPartDataAndHandlers: { selectedTableCellId },\n    } = this.props;\n    const cellValue = rawCellValues.get(selectedTableCellId);\n\n    const insertionIndex = this.textarea.selectionStart;\n    this.setState({\n      rawCellValues: rawCellValues.set(\n        selectedTableCellId,\n        cellValue.substring(0, insertionIndex) +\n          getCurrentTimestampAsText() +\n          cellValue.substring(this.textarea.selectionEnd || insertionIndex)\n      ),\n    });\n\n    this.textarea.focus();\n  }\n\n  handleTextareaRef(textarea) {\n    this.textarea = textarea;\n  }\n\n  render() {\n    const {\n      table,\n      subPartDataAndHandlers: { selectedTableCellId, inTableEditMode, shouldDisableActions },\n    } = this.props;\n    const { rawCellValues } = this.state;\n\n    const isTableSelected = table\n      .get('contents')\n      .some(row => row.get('contents').some(cell => cell.get('id') === selectedTableCellId));\n\n    return (\n      <Fragment>\n        <table className=\"table-part\">\n          <tbody>\n            {table.get('contents').map(row => (\n              <tr key={row.get('id')}>\n                {row.get('contents').map(cell => {\n                  const isCellSelected = cell.get('id') === selectedTableCellId;\n\n                  const className = classNames('table-part__cell', {\n                    'table-part__cell--selected': isCellSelected,\n                  });\n\n                  return (\n                    <td\n                      className={className}\n                      key={cell.get('id')}\n                      onClick={this.handleCellSelect(cell.get('id'))}\n                    >\n                      {isCellSelected && inTableEditMode ? (\n                        <div className=\"table-cell__edit-container\">\n                          <textarea\n                            autoFocus\n                            className=\"textarea\"\n                            rows=\"3\"\n                            value={rawCellValues.get(cell.get('id'))}\n                            onBlur={this.handleTextareaBlur}\n                            onChange={this.handleCellChange}\n                            ref={this.handleTextareaRef}\n                          />\n                          <div\n                            className=\"table-cell__insert-timestamp-button\"\n                            onClick={this.handleInsertTimestamp}\n                          >\n                            <i className=\"fas fa-plus insert-timestamp-icon\" />\n                            Insert timestamp\n                          </div>\n                        </div>\n                      ) : cell.get('contents').size > 0 ? (\n                        <AttributedString\n                          parts={cell.get('contents')}\n                          subPartDataAndHandlers={this.props.subPartDataAndHandlers}\n                        />\n                      ) : (\n                        '   '\n                      )}\n                    </td>\n                  );\n                })}\n              </tr>\n            ))}\n          </tbody>\n        </table>\n\n        <Collapse isOpened={isTableSelected && !shouldDisableActions}>\n          <TableActionDrawer subPartDataAndHandlers={this.props.subPartDataAndHandlers} />\n        </Collapse>\n      </Fragment>\n    );\n  }\n}\n","// Interpolates between two colors.\n// colorA and colorB should be objects with keys {r, g, b, a}.\n// interpolationFactor should be a number between 0 and 1 representing how far from colorA to\n// colorB it should interpolate.\n// An object with keys {r, g, b, a} will be returned.\nexport const interpolateColors = (colorA, colorB, interpolationFactor) => {\n  return {\n    r: parseInt((colorB.r - colorA.r) * interpolationFactor + colorA.r, 10),\n    g: parseInt((colorB.g - colorA.g) * interpolationFactor + colorA.g, 10),\n    b: parseInt((colorB.b - colorA.b) * interpolationFactor + colorA.b, 10),\n    a: (colorB.a - colorA.a) * interpolationFactor + colorA.a,\n  };\n};\n\nexport const rgbaObject = (r, g, b, a) => {\n  return { r, g, b, a };\n};\n\nexport const rgbaString = rgba => {\n  return `rgba(${rgba.r}, ${rgba.g}, ${rgba.b}, ${rgba.a})`;\n};\n","import React from 'react';\nimport { Motion, spring } from 'react-motion';\n\nimport { interpolateColors, rgbaObject, rgbaString } from '../../../lib/color';\n\nimport './stylesheet.css';\n\nexport default ({ state, onClick }) => {\n  const uncheckedColor = rgbaObject(255, 255, 255, 1);\n  const checkedColor = rgbaObject(94, 52, 140, 1);\n\n  const checkboxStyle = {\n    colorFactor: spring(\n      {\n        checked: 1,\n        partial: 1,\n        unchecked: 0,\n      }[state],\n      { stiffness: 300 }\n    ),\n  };\n\n  return (\n    <Motion style={checkboxStyle}>\n      {style => {\n        const backgroundColor = rgbaString(\n          interpolateColors(uncheckedColor, checkedColor, style.colorFactor)\n        );\n\n        return (\n          <div className=\"checkbox\" onClick={onClick} style={{ backgroundColor }}>\n            <div className=\"checkbox__inner-container\">\n              {state === 'checked' && <i className=\"fas fa-check\" />}\n              {state === 'partial' && <i className=\"fas fa-minus\" />}\n              {state === 'unchecked' && <i className=\"fas fa-square\" />}\n            </div>\n          </div>\n        );\n      }}\n    </Motion>\n  );\n};\n","import React from 'react';\n\nimport './stylesheet.css';\n\nexport default ({\n  subPartDataAndHandlers: {\n    onEnterListTitleEditMode,\n    onEnterListContentsEditMode,\n    onAddNewListItem,\n    onRemoveListItem,\n  },\n}) => {\n  return (\n    <div className=\"list-action-drawer-container\">\n      <div className=\"list-action-drawer__row\">\n        <div className=\"list-action-drawer__edit-icon-container\" onClick={onEnterListTitleEditMode}>\n          <i className=\"fas fa-pencil-alt fa-lg\" />\n        </div>\n\n        <span className=\"list-action-drawer__separator\" />\n\n        <div\n          className=\"list-action-drawer__edit-icon-container\"\n          onClick={onEnterListContentsEditMode}\n        >\n          <i className=\"fas fa-edit fa-lg\" />\n        </div>\n\n        <span className=\"list-action-drawer__separator\" />\n\n        <div className=\"list-action-drawer__edit-icon-container\" onClick={onAddNewListItem}>\n          <i className=\"fas fa-plus fa-lg\" />\n        </div>\n\n        <span className=\"list-action-drawer__separator\" />\n\n        <div className=\"list-action-drawer__edit-icon-container\" onClick={onRemoveListItem}>\n          <i className=\"fas fa-times fa-lg\" />\n        </div>\n      </div>\n    </div>\n  );\n};\n","import React, { PureComponent, Fragment } from 'react';\nimport { UnmountClosed as Collapse } from 'react-collapse';\n\nimport './stylesheet.css';\n\nimport AttributedString from '../../../AttributedString/';\nimport Checkbox from '../../../../../UI/Checkbox/';\nimport ListActionDrawer from './ListActionDrawer';\nimport { attributedStringToRawText } from '../../../../../../lib/export_org';\n\nimport { getCurrentTimestampAsText } from '../../../../../../lib/timestamps';\n\nimport _ from 'lodash';\nimport classNames from 'classnames';\nimport { Map } from 'immutable';\n\nexport default class ListPart extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, [\n      'handleListItemSelect',\n      'handleCheckboxClick',\n      'handleTextareaBlur',\n      'handleListTitleChange',\n      'handleListContentsChange',\n      'handleInsertTimestampListTitle',\n      'handleInsertTimestampListContents',\n      'handleTextareaRef',\n    ]);\n\n    this.state = {\n      listTitleValues: this.generateListTitleValueMap(props.part),\n      listContentsValues: this.generateListContentsValueMap(props.part),\n      shouldIgnoreBlur: false,\n    };\n  }\n\n  componentDidUpdate(prevProps) {\n    const {\n      subPartDataAndHandlers: {\n        onListTitleValueUpdate,\n        onListContentsValueUpdate,\n        inListTitleEditMode,\n        inListContentsEditMode,\n        selectedListItemId,\n      },\n    } = this.props;\n    const { listTitleValues, listContentsValues } = this.state;\n\n    if (prevProps.subPartDataAndHandlers.inListTitleEditMode && !inListTitleEditMode) {\n      if (listTitleValues.has(selectedListItemId)) {\n        onListTitleValueUpdate(selectedListItemId, listTitleValues.get(selectedListItemId));\n      }\n    }\n\n    const prevSelectedListItemId = prevProps.subPartDataAndHandlers.selectedListItemId;\n    if (\n      prevSelectedListItemId !== selectedListItemId &&\n      inListTitleEditMode &&\n      prevProps.subPartDataAndHandlers.inListTitleEditMode\n    ) {\n      if (listTitleValues.has(prevSelectedListItemId)) {\n        onListTitleValueUpdate(prevSelectedListItemId, listTitleValues.get(prevSelectedListItemId));\n      }\n    }\n\n    if (prevProps.subPartDataAndHandlers.inListContentsEditMode && !inListContentsEditMode) {\n      if (listContentsValues.has(selectedListItemId)) {\n        onListContentsValueUpdate(selectedListItemId, listContentsValues.get(selectedListItemId));\n      }\n    }\n\n    if (\n      prevSelectedListItemId !== selectedListItemId &&\n      inListContentsEditMode &&\n      prevProps.subPartDataAndHandlers.inListContentsEditMode\n    ) {\n      if (listContentsValues.has(prevSelectedListItemId)) {\n        onListContentsValueUpdate(\n          prevSelectedListItemId,\n          listContentsValues.get(prevSelectedListItemId)\n        );\n      }\n    }\n\n    if (this.props.part !== prevProps.part) {\n      this.setState({ listTitleValues: this.generateListTitleValueMap(this.props.part) });\n      this.setState({ listContentsValues: this.generateListContentsValueMap(this.props.part) });\n    }\n  }\n\n  generateListTitleValueMap(part) {\n    return Map(\n      part\n        .get('items')\n        .map(item => [item.get('id'), attributedStringToRawText(item.get('titleLine'))])\n    );\n  }\n\n  generateListContentsValueMap(part) {\n    return Map(\n      part\n        .get('items')\n        .map(item => [item.get('id'), attributedStringToRawText(item.get('contents'))])\n    );\n  }\n\n  handleListItemSelect(itemId) {\n    return () => this.props.subPartDataAndHandlers.onListItemSelect(itemId);\n  }\n\n  handleCheckboxClick(itemId) {\n    return () => this.props.subPartDataAndHandlers.onCheckboxClick(itemId);\n  }\n\n  handleTextareaBlur() {\n    setTimeout(() => {\n      if (!this.state.shouldIgnoreBlur) {\n        this.props.subPartDataAndHandlers.onExitListTitleEditMode();\n      } else {\n        this.setState({ shouldIgnoreBlur: false });\n      }\n    }, 0);\n  }\n\n  handleListTitleChange(event) {\n    const { listTitleValues } = this.state;\n    const {\n      subPartDataAndHandlers: { selectedListItemId },\n    } = this.props;\n\n    this.setState({\n      listTitleValues: listTitleValues.set(selectedListItemId, event.target.value),\n    });\n  }\n\n  handleListContentsChange(event) {\n    const { listContentsValues } = this.state;\n    const {\n      subPartDataAndHandlers: { selectedListItemId },\n    } = this.props;\n\n    this.setState({\n      listContentsValues: listContentsValues.set(selectedListItemId, event.target.value),\n    });\n  }\n\n  handleInsertTimestampListTitle() {\n    // Clicking this button will unfocus the textarea, but we don't want to exit edit mode,\n    // so instruct the blur handler to ignore the event.\n    this.setState({ shouldIgnoreBlur: true });\n\n    const { listTitleValues } = this.state;\n    const {\n      subPartDataAndHandlers: { selectedListItemId },\n    } = this.props;\n    const listTitleValue = listTitleValues.get(selectedListItemId);\n\n    const insertionIndex = this.textarea.selectionStart;\n    this.setState({\n      listTitleValues: listTitleValues.set(\n        selectedListItemId,\n        listTitleValue.substring(0, insertionIndex) +\n          getCurrentTimestampAsText() +\n          listTitleValue.substring(this.textarea.selectionEnd || insertionIndex)\n      ),\n    });\n\n    this.textarea.focus();\n  }\n\n  handleInsertTimestampListContents() {\n    this.setState({ shouldIgnoreBlur: true });\n\n    const { listContentsValues } = this.state;\n    const {\n      subPartDataAndHandlers: { selectedListItemId },\n    } = this.props;\n    const listContentsValue = listContentsValues.get(selectedListItemId);\n\n    const insertionIndex = this.textarea.selectionStart;\n    this.setState({\n      listContentsValues: listContentsValues.set(\n        selectedListItemId,\n        listContentsValue.substring(0, insertionIndex) +\n          getCurrentTimestampAsText() +\n          listContentsValue.substring(this.textarea.selectionEnd || insertionIndex)\n      ),\n    });\n\n    this.textarea.focus();\n  }\n  handleTextareaRef(textarea) {\n    this.textarea = textarea;\n  }\n\n  renderContent() {\n    const {\n      part,\n      subPartDataAndHandlers: {\n        selectedListItemId,\n        inListTitleEditMode,\n        inListContentsEditMode,\n        shouldDisableActions,\n      },\n    } = this.props;\n    const { listTitleValues, listContentsValues } = this.state;\n\n    return part.get('items').map(item => {\n      const isItemSelected = item.get('id') === selectedListItemId;\n      const lineContainerClass = classNames({\n        'list-part__not_checkbox-container': !item.get('isCheckbox'),\n        'list-part__checkbox-container': item.get('isCheckbox'),\n        'list-part__item--selected': isItemSelected,\n      });\n\n      return (\n        <li key={item.get('id')} value={item.get('forceNumber')}>\n          <div className={lineContainerClass} onClick={this.handleListItemSelect(item.get('id'))}>\n            {item.get('isCheckbox') && (\n              <Checkbox\n                onClick={this.handleCheckboxClick(item.get('id'))}\n                state={item.get('checkboxState')}\n              />\n            )}\n            {isItemSelected && inListTitleEditMode ? (\n              <div className=\"list-title-line__edit-container\">\n                <textarea\n                  autoFocus\n                  className=\"textarea\"\n                  rows=\"3\"\n                  ref={this.handleTextareaRef}\n                  value={listTitleValues.get(item.get('id'))}\n                  onBlur={this.handleTextareaBlur}\n                  onChange={this.handleListTitleChange}\n                />\n                <div\n                  className=\"list-title-line__insert-timestamp-button\"\n                  onClick={this.handleInsertTimestampListTitle}\n                >\n                  <i className=\"fas fa-plus insert-timestamp-icon\" />\n                  Insert timestamp\n                </div>\n              </div>\n            ) : listTitleValues.get(item.get('id')) ? (\n              <AttributedString\n                parts={item.get('titleLine')}\n                subPartDataAndHandlers={this.props.subPartDataAndHandlers}\n              />\n            ) : (\n              <span>&nbsp;</span>\n            )}\n          </div>\n          <Collapse isOpened={isItemSelected && !shouldDisableActions}>\n            <ListActionDrawer subPartDataAndHandlers={this.props.subPartDataAndHandlers} />\n          </Collapse>\n          {isItemSelected && inListContentsEditMode ? (\n            <div className=\"list-contents__edit-container\">\n              <textarea\n                autoFocus\n                className=\"textarea\"\n                rows=\"8\"\n                ref={this.handleTextareaRef}\n                value={listContentsValues.get(item.get('id'))}\n                onBlur={this.handleTextareaBlur}\n                onChange={this.handleListContentsChange}\n              />\n              <div\n                className=\"list-contents__insert-timestamp-button\"\n                onClick={this.handleInsertTimestampListContents}\n              >\n                <i className=\"fas fa-plus insert-timestamp-icon\" />\n                Insert timestamp\n              </div>\n            </div>\n          ) : (\n            <AttributedString\n              parts={item.get('contents')}\n              subPartDataAndHandlers={this.props.subPartDataAndHandlers}\n            />\n          )}\n        </li>\n      );\n    });\n  }\n\n  render() {\n    return (\n      <Fragment>\n        {this.props.part.get('isOrdered') ? (\n          <ol className=\"attributed-string__list-part attributed-string__list-part--ordered\">\n            {this.renderContent()}\n          </ol>\n        ) : (\n          <ul className=\"attributed-string__list-part\">{this.renderContent()}</ul>\n        )}\n      </Fragment>\n    );\n  }\n}\n","import React, { Fragment } from 'react';\n\nimport './stylesheet.css';\n\nimport { renderAsText } from '../../../../../../lib/timestamps';\n\nexport default ({ part, subPartDataAndHandlers: { onTimestampClick, shouldDisableActions } }) => {\n  const handleClick = () => (shouldDisableActions ? void 0 : onTimestampClick(part.get('id')));\n\n  const firstTimestamp = part.get('firstTimestamp');\n  const secondTimestamp = part.get('secondTimestamp');\n\n  return (\n    <span className=\"attributed-string__timestamp-part\" onClick={handleClick}>\n      {!!firstTimestamp && renderAsText(firstTimestamp)}\n      {!!secondTimestamp && (\n        <Fragment>\n          {'--'}\n          {renderAsText(secondTimestamp)}\n        </Fragment>\n      )}\n    </span>\n  );\n};\n","import React from 'react';\n\nimport './stylesheet.css';\n\nimport TablePart from './components/TablePart';\nimport ListPart from './components/ListPart';\nimport TimestampPart from './components/TimestampPart';\n\nimport classNames from 'classnames';\n\nexport default ({ parts, subPartDataAndHandlers }) => {\n  let className;\n\n  return (\n    <span>\n      {parts.map(part => {\n        switch (part.get('type')) {\n          case 'text':\n            return part.get('contents');\n          case 'link':\n            const uri = part.getIn(['contents', 'uri']);\n            const title = part.getIn(['contents', 'title']) || uri;\n\n            return (\n              <a key={part.get('id')} href={uri} target=\"_blank\" rel=\"noopener noreferrer\">\n                {title}\n              </a>\n            );\n          case 'percentage-cookie':\n            className = classNames('attributed-string__cookie-part', {\n              'attributed-string__cookie-part--complete':\n                parseInt(part.get('percentage'), 10) === 100,\n            });\n\n            return (\n              <span key={part.get('id')} className={className}>\n                [{part.get('percentage')}\n                %]\n              </span>\n            );\n          case 'fraction-cookie':\n            className = classNames('attributed-string__cookie-part', {\n              'attributed-string__cookie-part--complete':\n                part.getIn(['fraction', 0]) !== '' &&\n                part.getIn(['fraction', 0]) === part.getIn(['fraction', 1]),\n            });\n\n            return (\n              <span key={part.get('id')} className={className}>\n                [{part.getIn(['fraction', 0])}/{part.getIn(['fraction', 1])}]\n              </span>\n            );\n          case 'table':\n            return (\n              <TablePart\n                key={part.get('id')}\n                table={part}\n                subPartDataAndHandlers={subPartDataAndHandlers}\n              />\n            );\n          case 'list':\n            return (\n              <ListPart\n                key={part.get('id')}\n                part={part}\n                subPartDataAndHandlers={subPartDataAndHandlers}\n              />\n            );\n          case 'inline-markup':\n            className = classNames(\n              'attributed-string__inline-markup',\n              `attributed-string__inline-markup--${part.get('markupType')}`\n            );\n\n            return (\n              <span key={part.get('id')} className={className}>\n                {part.get('content')}\n              </span>\n            );\n          case 'timestamp':\n            return (\n              <TimestampPart\n                key={part.get('id')}\n                part={part}\n                subPartDataAndHandlers={subPartDataAndHandlers}\n              />\n            );\n          default:\n            console.error(`Unrecognized attributed string part type! ${part.get('type')}`);\n            return '';\n        }\n      })}\n    </span>\n  );\n};\n","import React, { PureComponent } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport './stylesheet.css';\n\nimport _ from 'lodash';\nimport classNames from 'classnames';\n\nimport * as orgActions from '../../../../actions/org';\nimport * as baseActions from '../../../../actions/base';\n\nimport { getCurrentTimestampAsText } from '../../../../lib/timestamps';\n\nimport AttributedString from '../AttributedString';\n\nclass TitleLine extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, [\n      'handleRef',\n      'handleTitleSpanRef',\n      'handleTextareaRef',\n      'handleTitleClick',\n      'handleTextareaBlur',\n      'handleTitleChange',\n      'handleTitleFieldClick',\n      'handleTodoClick',\n      'handleTimestampClick',\n      'handleInsertTimestamp',\n    ]);\n\n    this.state = {\n      titleValue: this.calculateRawTitle(props.header),\n      containerWidth: null,\n      shouldIgnoreBlur: false,\n    };\n  }\n\n  storeContainerWidth() {\n    if (this.containerDiv) {\n      this.setState({ containerWidth: this.containerDiv.offsetWidth });\n    }\n  }\n\n  componentDidMount() {\n    this.storeContainerWidth();\n  }\n\n  componentDidUpdate(prevProps) {\n    const { header } = this.props;\n\n    if (prevProps.inEditMode && !this.props.inEditMode) {\n      this.props.org.updateHeaderTitle(header.get('id'), this.state.titleValue);\n    }\n\n    if (prevProps.header !== this.props.header) {\n      this.setState(\n        {\n          titleValue: this.calculateRawTitle(this.props.header),\n        },\n        () => this.storeContainerWidth()\n      );\n    }\n  }\n\n  handleRef(div) {\n    this.containerDiv = div;\n  }\n\n  handleTitleSpanRef(span) {\n    this.titleSpan = span;\n  }\n\n  handleTextareaRef(textarea) {\n    this.textarea = textarea;\n  }\n\n  calculateRawTitle(header) {\n    const todoKeyword = header.getIn(['titleLine', 'todoKeyword']);\n    const tags = header.getIn(['titleLine', 'tags']);\n\n    let titleValue = header.getIn(['titleLine', 'rawTitle']);\n\n    if (!!todoKeyword) {\n      titleValue = `${todoKeyword} ${titleValue}`;\n    }\n\n    if (!!tags && tags.size > 0) {\n      titleValue = `${titleValue} :${tags.join(':')}:`;\n    }\n\n    return titleValue;\n  }\n\n  handleTitleClick(event) {\n    const { header, hasContent, isSelected, onClick } = this.props;\n\n    if (!!onClick) {\n      onClick();\n    } else {\n      if (hasContent && (!header.get('opened') || isSelected)) {\n        this.props.org.toggleHeaderOpened(header.get('id'));\n      }\n\n      this.props.org.selectHeader(header.get('id'));\n    }\n  }\n\n  handleTodoClick(event) {\n    const { header, shouldTapTodoToAdvance, onClick } = this.props;\n\n    if (!!onClick) {\n      onClick();\n      event.stopPropagation();\n    } else {\n      this.props.org.selectHeader(header.get('id'));\n\n      if (shouldTapTodoToAdvance) {\n        this.props.org.advanceTodoState();\n      }\n    }\n  }\n\n  handleTextareaBlur(event) {\n    // Give the \"Insert timestamp\" button click a chance to tell us to ignore the blur event.\n    setTimeout(() => {\n      if (!this.state.shouldIgnoreBlur) {\n        this.props.org.exitEditMode();\n      } else {\n        this.setState({ shouldIgnoreBlur: false });\n      }\n    }, 100);\n  }\n\n  handleTitleChange(event) {\n    // If the last character typed was a newline at the end, exit edit mode.\n    const newTitle = event.target.value;\n    const lastCharacter = newTitle[newTitle.length - 1];\n    if (\n      this.state.titleValue === newTitle.substring(0, newTitle.length - 1) &&\n      lastCharacter === '\\n'\n    ) {\n      this.props.org.exitEditMode();\n      return;\n    }\n\n    this.setState({ titleValue: newTitle });\n  }\n\n  handleTitleFieldClick(event) {\n    event.stopPropagation();\n  }\n\n  handleTimestampClick(timestampId) {\n    this.props.base.activatePopup('timestamp-editor', { timestampId });\n  }\n\n  handleInsertTimestamp(event) {\n    // Clicking this button will unfocus the textarea, but we don't want to exit edit mode,\n    // so instruct the blur handler to ignore the event.\n    this.setState({ shouldIgnoreBlur: true });\n\n    const { titleValue } = this.state;\n    const insertionIndex = this.textarea.selectionStart;\n    this.setState({\n      titleValue:\n        titleValue.substring(0, insertionIndex) +\n        getCurrentTimestampAsText() +\n        titleValue.substring(this.textarea.selectionEnd || insertionIndex),\n    });\n\n    this.textarea.focus();\n\n    event.stopPropagation();\n  }\n\n  render() {\n    const {\n      header,\n      color,\n      hasContent,\n      inEditMode,\n      shouldDisableActions,\n      shouldDisableExplicitWidth,\n    } = this.props;\n    const { containerWidth } = this.state;\n    const todoKeyword = header.getIn(['titleLine', 'todoKeyword']);\n\n    const titleStyle = {\n      color,\n      wordBreak: 'break-word',\n    };\n\n    return (\n      <div\n        className=\"title-line\"\n        onClick={this.handleTitleClick}\n        ref={this.handleRef}\n        style={{ width: shouldDisableExplicitWidth ? '' : containerWidth }}\n      >\n        {!inEditMode && !!todoKeyword ? (\n          <span\n            className={classNames('todo-keyword', `todo-keyword--${todoKeyword.toLowerCase()}`)}\n            onClick={this.handleTodoClick}\n          >\n            {todoKeyword}\n          </span>\n        ) : (\n          ''\n        )}\n\n        {inEditMode ? (\n          <div className=\"title-line__edit-container\">\n            <textarea\n              autoFocus\n              className=\"textarea\"\n              rows=\"3\"\n              ref={this.handleTextareaRef}\n              value={this.state.titleValue}\n              onBlur={this.handleTextareaBlur}\n              onChange={this.handleTitleChange}\n              onClick={this.handleTitleFieldClick}\n            />\n            <div\n              className=\"title-line__insert-timestamp-button\"\n              onClick={this.handleInsertTimestamp}\n            >\n              <i className=\"fas fa-plus insert-timestamp-icon\" />\n              Insert timestamp\n            </div>\n          </div>\n        ) : (\n          <div>\n            <span style={titleStyle} ref={this.handleTitleSpanRef}>\n              <AttributedString\n                parts={header.getIn(['titleLine', 'title'])}\n                subPartDataAndHandlers={{\n                  onTimestampClick: this.handleTimestampClick,\n                  shouldDisableActions,\n                }}\n              />\n              {!header.get('opened') && hasContent ? '...' : ''}\n            </span>\n\n            {header.getIn(['titleLine', 'tags']).size > 0 && (\n              <div>\n                {header\n                  .getIn(['titleLine', 'tags'])\n                  .toSet()\n                  .toList()\n                  .filter(tag => !!tag)\n                  .map(tag => (\n                    <div className=\"header-tag\" key={tag}>\n                      {tag}\n                    </div>\n                  ))}\n              </div>\n            )}\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = (state, props) => {\n  return {\n    inEditMode:\n      state.org.present.get('editMode') === 'title' &&\n      state.org.present.get('selectedHeaderId') === props.header.get('id'),\n    shouldTapTodoToAdvance: state.base.get('shouldTapTodoToAdvance'),\n    isSelected: state.org.present.get('selectedHeaderId') === props.header.get('id'),\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    org: bindActionCreators(orgActions, dispatch),\n    base: bindActionCreators(baseActions, dispatch),\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(TitleLine);\n","import React, { PureComponent } from 'react';\n\nimport './stylesheet.css';\n\nimport { renderAsText } from '../../../../../../lib/timestamps';\n\nimport _ from 'lodash';\n\nexport default class PlanningItems extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, ['handleTimestampClick']);\n  }\n\n  handleTimestampClick(planningItemIndex) {\n    return () => this.props.onClick(planningItemIndex);\n  }\n\n  render() {\n    const { planningItems } = this.props;\n\n    if (planningItems.size === 0) {\n      return null;\n    }\n\n    return (\n      <div>\n        {planningItems.map((planningItem, index) => (\n          <div key={planningItem.get('id')} className=\"planning-items__item-container\">\n            <div className=\"planning-item__type\">{planningItem.get('type')}: </div>\n            <div className=\"planning-item__timestamp\" onClick={this.handleTimestampClick(index)}>\n              {renderAsText(planningItem.get('timestamp'))}\n            </div>\n          </div>\n        ))}\n      </div>\n    );\n  }\n}\n","import React, { Fragment, useState } from 'react';\n\nimport './stylesheet.css';\n\nimport AttributedString from '../../../AttributedString';\n\nexport default ({ propertyListItems, shouldDisableActions, onTimestampClick, onEdit }) => {\n  const [isDrawerCollapsed, setIsDrawerCollapsed] = useState(true);\n\n  const handleCollapseToggle = () => setIsDrawerCollapsed(!isDrawerCollapsed);\n\n  return propertyListItems.size === 0 ? null : (\n    <div className=\"property-list-container\">\n      <div className=\"property-list__property\" onClick={handleCollapseToggle}>\n        :PROPERTIES:\n        {isDrawerCollapsed ? '...' : ''}\n      </div>\n\n      {!isDrawerCollapsed && (\n        <Fragment>\n          {propertyListItems.map(propertyListItem => (\n            <div className=\"property-list__item-container\" key={propertyListItem.get('id')}>\n              <div\n                className=\"property-list__property\"\n                onClick={shouldDisableActions ? null : onEdit}\n              >\n                :{propertyListItem.get('property')}:\n              </div>\n              <div className=\"property-list__value\">\n                <AttributedString\n                  parts={propertyListItem.get('value') || []}\n                  subPartDataAndHandlers={{\n                    onTimestampClick,\n                    shouldDisableActions,\n                  }}\n                />\n              </div>\n            </div>\n          ))}\n\n          <div className=\"property-list__property\" onClick={onEdit}>\n            :END:\n          </div>\n        </Fragment>\n      )}\n    </div>\n  );\n};\n","import React, { PureComponent, Fragment } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport './stylesheet.css';\n\nimport PlanningItems from './components/PlanningItems';\nimport PropertyListItems from './components/PropertyListItems';\n\nimport _ from 'lodash';\n\nimport * as orgActions from '../../../../actions/org';\nimport * as baseActions from '../../../../actions/base';\n\nimport { renderAsText, getCurrentTimestampAsText } from '../../../../lib/timestamps';\nimport { attributedStringToRawText } from '../../../../lib/export_org';\n\nimport AttributedString from '../AttributedString';\n\nclass HeaderContent extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, [\n      'handleRef',\n      'handleTextareaRef',\n      'handleDescriptionChange',\n      'handleTableCellSelect',\n      'handleExitTableEditMode',\n      'handleTableCellValueUpdate',\n      'handleEnterTableEditMode',\n      'handleAddNewTableRow',\n      'handleRemoveTableRow',\n      'handleAddNewTableColumn',\n      'handleRemoveTableColumn',\n      'handleCheckboxClick',\n      'handleListItemSelect',\n      'handleEnterListTitleEditMode',\n      'handleExitListTitleEditMode',\n      'handleListTitleValueUpdate',\n      'handleEnterListContentsEditMode',\n      'handleExitListContentsEditMode',\n      'handleListContentsValueUpdate',\n      'handleAddNewListItem',\n      'handleRemoveListItem',\n      'handleTimestampClick',\n      'handleInsertTimestamp',\n      'handlePlanningItemTimestampClick',\n      'handlePropertyListEdit',\n    ]);\n\n    this.state = {\n      descriptionValue: this.calculateRawDescription(props.header),\n      containerWidth: null,\n    };\n  }\n\n  storeContainerWidth() {\n    if (this.containerDiv) {\n      this.setState({ containerWidth: this.containerDiv.offsetWidth });\n    }\n  }\n\n  componentDidMount() {\n    this.storeContainerWidth();\n  }\n\n  componentDidUpdate(prevProps) {\n    const { header } = this.props;\n\n    if (prevProps.inEditMode && !this.props.inEditMode) {\n      this.props.org.updateHeaderDescription(header.get('id'), this.state.descriptionValue);\n    }\n\n    if (prevProps.header !== this.props.header) {\n      this.setState(\n        {\n          descriptionValue: this.calculateRawDescription(this.props.header),\n        },\n        () => this.storeContainerWidth()\n      );\n    }\n  }\n\n  calculateRawDescription(header) {\n    const planningItems = header.get('planningItems');\n    const propertyListItems = header.get('propertyListItems');\n\n    const planningItemsText = planningItems\n      .map(\n        planningItem =>\n          `${planningItem.get('type')}: ${renderAsText(planningItem.get('timestamp'))}`\n      )\n      .join(' ');\n\n    let propertyListItemsText = '';\n    if (propertyListItems.size > 0) {\n      propertyListItemsText += ':PROPERTIES:\\n';\n      propertyListItemsText += propertyListItems\n        .map(\n          propertyListItem =>\n            `:${propertyListItem.get('property')}: ${attributedStringToRawText(\n              propertyListItem.get('value')\n            )}`\n        )\n        .join('\\n');\n      propertyListItemsText += '\\n:END:';\n    }\n\n    let descriptionText = '';\n    if (!!planningItemsText) {\n      descriptionText += planningItemsText + '\\n';\n    }\n    if (!!propertyListItemsText) {\n      descriptionText += propertyListItemsText + '\\n';\n    }\n    descriptionText += header.get('rawDescription');\n    return descriptionText;\n  }\n\n  handleTextareaRef(textarea) {\n    this.textarea = textarea;\n  }\n\n  handleRef(div) {\n    this.containerDiv = div;\n  }\n\n  handleDescriptionChange(event) {\n    this.setState({ descriptionValue: event.target.value });\n  }\n\n  handleTableCellSelect(cellId) {\n    this.props.org.setSelectedTableCellId(cellId);\n  }\n\n  handleExitTableEditMode() {\n    this.props.org.exitEditMode();\n  }\n\n  handleTableCellValueUpdate(cellId, newValue) {\n    this.props.org.updateTableCellValue(cellId, newValue);\n  }\n\n  handleEnterTableEditMode() {\n    this.props.org.enterEditMode('table');\n  }\n\n  handleAddNewTableRow() {\n    this.props.org.addNewTableRow();\n  }\n\n  handleRemoveTableRow() {\n    this.props.org.removeTableRow();\n  }\n\n  handleAddNewTableColumn() {\n    this.props.org.addNewTableColumn();\n  }\n\n  handleRemoveTableColumn() {\n    this.props.org.removeTableColumn();\n  }\n\n  handleCheckboxClick(listItemId) {\n    this.props.org.advanceCheckboxState(listItemId);\n  }\n\n  handleListItemSelect(listItemId) {\n    this.props.org.setSelectedListItemId(listItemId);\n  }\n\n  handleEnterListTitleEditMode() {\n    this.props.org.enterEditMode('list-title');\n  }\n\n  handleExitListTitleEditMode() {\n    this.props.org.exitEditMode();\n  }\n\n  handleListTitleValueUpdate(listItemId, newValue) {\n    this.props.org.updateListTitleValue(listItemId, newValue);\n  }\n\n  handleEnterListContentsEditMode() {\n    this.props.org.enterEditMode('list-contents');\n  }\n\n  handleExitListContentsEditMode() {\n    this.props.org.exitEditMode();\n  }\n\n  handleListContentsValueUpdate(listItemId, newValue) {\n    this.props.org.updateListContentsValue(listItemId, newValue);\n  }\n\n  handleAddNewListItem() {\n    this.props.org.addNewListItemAndEdit();\n  }\n\n  handleRemoveListItem() {\n    this.props.org.removeListItem();\n  }\n\n  handleTimestampClick(timestampId) {\n    this.props.base.activatePopup('timestamp-editor', { timestampId });\n  }\n\n  handleInsertTimestamp(e) {\n    e.preventDefault();\n\n    const { descriptionValue } = this.state;\n    const insertionIndex = this.textarea.selectionStart;\n    const timestamp = getCurrentTimestampAsText();\n    const newCursorPos = insertionIndex + timestamp.length;\n    const newText =\n      descriptionValue.substring(0, insertionIndex) +\n      timestamp +\n      descriptionValue.substring(this.textarea.selectionEnd || insertionIndex);\n    this.setState({ descriptionValue: newText }, () => {\n      this.textarea.setSelectionRange(newCursorPos, newCursorPos);\n    });\n  }\n\n  handlePlanningItemTimestampClick(headerId) {\n    return planningItemIndex =>\n      this.props.base.activatePopup('timestamp-editor', { headerId, planningItemIndex });\n  }\n\n  handlePropertyListEdit() {\n    const { header } = this.props;\n    this.props.base.activatePopup('property-list-editor', { headerId: header.get('id') });\n  }\n\n  render() {\n    const {\n      header,\n      isFocused,\n      indentLevel,\n      inEditMode,\n      selectedTableCellId,\n      inTableEditMode,\n      shouldDisableActions,\n      selectedListItemId,\n      inListTitleEditMode,\n      inListContentsEditMode,\n    } = this.props;\n    const { containerWidth } = this.state;\n\n    if (!header.get('opened')) {\n      return <div />;\n    }\n\n    const startWhitespaces = this.state.descriptionValue.match(/^\\s*/);\n    const indentStr = startWhitespaces ? startWhitespaces[0] : '';\n    const editMinLines = isFocused ? 30 : 10;\n    const leftMargin = 20 * indentLevel;\n\n    return (\n      <div\n        className=\"header-content-container nice-scroll\"\n        ref={this.handleRef}\n        style={{ width: containerWidth, marginLeft: `-${leftMargin}px` }}\n      >\n        {inEditMode ? (\n          <div className=\"header-content__edit-container\">\n            <textarea\n              autoFocus\n              className=\"textarea\"\n              rows={Math.min(editMinLines, this.state.descriptionValue.split('\\n').length)}\n              ref={this.handleTextareaRef}\n              value={this.state.descriptionValue}\n              onChange={this.handleDescriptionChange}\n              onFocus={e => {\n                const target = e.target;\n                setTimeout(() => {\n                  target.scrollTop = target.scrollHeight;\n                }, 0);\n              }}\n              onKeyDown={e => {\n                const target = e.target;\n                if (target && e.key === 'Enter') {\n                  e.preventDefault();\n                  const currentContent = target.value;\n                  const caretPosition = target.selectionStart;\n                  const beforeText = currentContent.substring(0, caretPosition);\n                  const afterText = currentContent.substring(caretPosition);\n                  const newlineText = '\\n' + indentStr;\n                  const newValue = beforeText + newlineText + afterText;\n                  target.value = newValue;\n                  target.setSelectionRange(\n                    caretPosition + newlineText.length,\n                    caretPosition + newlineText.length\n                  );\n                  if (afterText.length === 0) {\n                    target.scrollTop = target.scrollHeight;\n                  }\n\n                  this.setState({ descriptionValue: newValue });\n                }\n              }}\n            />\n          </div>\n        ) : (\n          <Fragment>\n            <PlanningItems\n              planningItems={header.get('planningItems')}\n              onClick={this.handlePlanningItemTimestampClick(header.get('id'))}\n            />\n            <PropertyListItems\n              propertyListItems={header.get('propertyListItems')}\n              onTimestampClick={this.handleTimestampClick}\n              shouldDisableActions={shouldDisableActions}\n              onEdit={this.handlePropertyListEdit}\n            />\n            <AttributedString\n              parts={header.get('description')}\n              subPartDataAndHandlers={{\n                onTableCellSelect: this.handleTableCellSelect,\n                selectedTableCellId: selectedTableCellId,\n                inTableEditMode: inTableEditMode,\n                onExitTableEditMode: this.handleExitTableEditMode,\n                onTableCellValueUpdate: this.handleTableCellValueUpdate,\n                onEnterTableEditMode: this.handleEnterTableEditMode,\n                onAddNewTableRow: this.handleAddNewTableRow,\n                onRemoveTableRow: this.handleRemoveTableRow,\n                onAddNewTableColumn: this.handleAddNewTableColumn,\n                onRemoveTableColumn: this.handleRemoveTableColumn,\n                onCheckboxClick: this.handleCheckboxClick,\n                onListItemSelect: this.handleListItemSelect,\n                onEnterListTitleEditMode: this.handleEnterListTitleEditMode,\n                onExitListTitleEditMode: this.handleExitListTitleEditMode,\n                onListTitleValueUpdate: this.handleListTitleValueUpdate,\n                onEnterListContentsEditMode: this.handleEnterListContentsEditMode,\n                onExitListContentsEditMode: this.handleExitListContentsEditMode,\n                onListContentsValueUpdate: this.handleListContentsValueUpdate,\n                onAddNewListItem: this.handleAddNewListItem,\n                onRemoveListItem: this.handleRemoveListItem,\n                selectedListItemId: selectedListItemId,\n                inListTitleEditMode: inListTitleEditMode,\n                inListContentsEditMode: inListContentsEditMode,\n                onTimestampClick: this.handleTimestampClick,\n                shouldDisableActions,\n              }}\n            />\n          </Fragment>\n        )}\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = (state, props) => {\n  return {\n    inEditMode:\n      state.org.present.get('editMode') === 'description' &&\n      state.org.present.get('selectedHeaderId') === props.header.get('id'),\n    isSelected: state.org.present.get('selectedHeaderId') === props.header.get('id'),\n    selectedTableCellId: state.org.present.get('selectedTableCellId'),\n    inTableEditMode: state.org.present.get('editMode') === 'table',\n    selectedListItemId: state.org.present.get('selectedListItemId'),\n    inListTitleEditMode: state.org.present.get('editMode') === 'list-title',\n    inListContentsEditMode: state.org.present.get('editMode') === 'list-contents',\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    org: bindActionCreators(orgActions, dispatch),\n    base: bindActionCreators(baseActions, dispatch),\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(HeaderContent);\n","import React, { PureComponent } from 'react';\n\nimport './stylesheet.css';\n\nexport default class HeaderActionDrawer extends PureComponent {\n  // A nasty hack required to get click handling to work properly in Firefox. No idea why its\n  // broken in the first place or why this fixes it.\n  iconWithFFClickCatcher(className, onClick) {\n    return (\n      <div onClick={onClick} className=\"header-action-drawer__ff-click-catcher-container\">\n        <div className=\"header-action-drawer__ff-click-catcher\" />\n        <i className={className} />\n      </div>\n    );\n  }\n\n  render() {\n    const { onEnterTitleEditMode, onEnterDescriptionEditMode, isFocused, onFocus, onUnfocus } =\n      this.props;\n\n    return (\n      <div className=\"header-action-drawer-container\">\n        <div className=\"header-action-drawer__row\">\n          {this.iconWithFFClickCatcher('fas fa-pencil-alt fa-lg', onEnterTitleEditMode)}\n\n          <span className=\"header-action-drawer__separator\" />\n\n          {this.iconWithFFClickCatcher('fas fa-edit fa-lg', onEnterDescriptionEditMode)}\n\n          <span className=\"header-action-drawer__separator\" />\n\n          {isFocused\n            ? this.iconWithFFClickCatcher('fas fa-expand fa-lg', onUnfocus)\n            : this.iconWithFFClickCatcher('fas fa-compress fa-lg', onFocus)}\n        </div>\n      </div>\n    );\n  }\n}\n","import React, { PureComponent } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport { Motion, spring } from 'react-motion';\nimport { UnmountClosed as Collapse } from 'react-collapse';\n\nimport * as orgActions from '../../../../actions/org';\nimport * as baseActions from '../../../../actions/base';\n\nimport './stylesheet.css';\n\nimport classNames from 'classnames';\nimport _ from 'lodash';\n\nimport TitleLine from '../TitleLine';\nimport HeaderContent from '../HeaderContent';\nimport HeaderActionDrawer from './components/HeaderActionDrawer';\n\nimport { headerWithId } from '../../../../lib/org_utils';\nimport { interpolateColors, rgbaObject, rgbaString } from '../../../../lib/color';\n\nclass Header extends PureComponent {\n  SWIPE_ACTION_ACTIVATION_DISTANCE = 80;\n  FREE_DRAG_ACTIVATION_DISTANCE = 10;\n\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, [\n      'handleRef',\n      'handleMouseDown',\n      'handleMouseMove',\n      'handleMouseUp',\n      'handleMouseOut',\n      'handleTouchMove',\n      'handleTouchStart',\n      'handleTouchEnd',\n      'handleTouchCancel',\n      'handleHeaderClick',\n      'handleEnterTitleEditMode',\n      'handleEnterDescriptionEditMode',\n      'handleShowTagsModal',\n      'handleFocus',\n      'handleUnfocus',\n      'handleAddNewHeader',\n      'handleRest',\n      'handleDeadlineClick',\n      'handleScheduledClick',\n    ]);\n\n    this.state = {\n      isDraggingFreely: false,\n      dragStartX: null,\n      dragStartY: null,\n      currentDragX: null,\n      containerWidth: null,\n      isPlayingRemoveAnimation: false,\n      heightBeforeRemove: null,\n    };\n  }\n\n  componentDidMount() {\n    if (this.containerDiv) {\n      this.setState({ containerWidth: this.containerDiv.offsetWidth });\n    }\n  }\n\n  handleRef(containerDiv) {\n    this.containerDiv = containerDiv;\n    this.props.onRef(containerDiv);\n  }\n\n  handleDragStart(event, dragX, dragY) {\n    if (this.props.shouldDisableActions) {\n      return;\n    }\n    if (this.props.inEditMode) {\n      return;\n    }\n\n    if (!!event.target.closest('.table-part')) {\n      return;\n    }\n\n    this.setState({\n      dragStartX: dragX,\n      dragStartY: dragY,\n    });\n  }\n\n  handleDragMove(dragX, dragY) {\n    const { dragStartX, dragStartY } = this.state;\n    if (dragStartX === null) {\n      return;\n    }\n\n    if (!this.state.isDraggingFreely) {\n      if (Math.abs(dragX - dragStartX) >= this.FREE_DRAG_ACTIVATION_DISTANCE) {\n        this.setState({ isDraggingFreely: true });\n      }\n    }\n\n    if (Math.abs(dragY - dragStartY) >= this.SWIPE_ACTION_ACTIVATION_DISTANCE / 2) {\n      this.setState({ dragStartX: null });\n    } else {\n      this.setState({ currentDragX: dragX });\n    }\n  }\n\n  handleDragEnd() {\n    const { dragStartX, currentDragX } = this.state;\n\n    if (!!dragStartX && !!currentDragX) {\n      const swipeDistance = currentDragX - dragStartX;\n\n      if (swipeDistance >= this.SWIPE_ACTION_ACTIVATION_DISTANCE) {\n        this.props.org.advanceTodoState(this.props.header.get('id'));\n      }\n\n      if (-1 * swipeDistance >= this.SWIPE_ACTION_ACTIVATION_DISTANCE) {\n        this.setState({\n          isPlayingRemoveAnimation: true,\n          heightBeforeRemove: this.containerDiv.offsetHeight,\n        });\n      }\n    }\n\n    this.setState({\n      dragStartX: null,\n      currentDragX: null,\n      isDraggingFreely: false,\n    });\n  }\n\n  handleDragCancel() {\n    this.setState({\n      dragStartX: null,\n      currentDragX: null,\n      isDraggingFreely: false,\n    });\n  }\n\n  handleMouseDown(event) {\n    this.handleDragStart(event, event.clientX, event.clientY);\n  }\n\n  handleMouseMove(event) {\n    this.handleDragMove(event.clientX, event.clientY);\n  }\n\n  handleMouseUp() {\n    this.handleDragEnd();\n  }\n\n  handleMouseOut() {\n    this.handleDragCancel();\n  }\n\n  handleTouchStart(event) {\n    this.handleDragStart(event, event.changedTouches[0].clientX, event.changedTouches[0].clientY);\n  }\n\n  handleTouchMove(event) {\n    this.handleDragMove(event.changedTouches[0].clientX, event.changedTouches[0].clientY);\n  }\n\n  handleTouchEnd() {\n    this.handleDragEnd();\n  }\n\n  handleTouchCancel() {\n    this.handleDragCancel();\n  }\n\n  handleHeaderClick(event) {\n    const classList = event.target.classList;\n    if (classList.contains('header') || classList.contains('header__bullet')) {\n      const { header, hasContent, isSelected } = this.props;\n\n      if (hasContent && (!header.get('opened') || isSelected)) {\n        this.props.org.toggleHeaderOpened(header.get('id'));\n      }\n\n      this.props.org.selectHeader(header.get('id'));\n    }\n  }\n\n  handleEnterTitleEditMode() {\n    this.props.org.enterEditMode('title');\n  }\n\n  handleEnterDescriptionEditMode() {\n    this.props.org.openHeader(this.props.header.get('id'));\n    this.props.org.enterEditMode('description');\n  }\n\n  handleShowTagsModal() {\n    this.props.base.activatePopup('tags-editor');\n  }\n\n  handleFocus() {\n    this.props.org.focusHeader(this.props.header.get('id'));\n  }\n\n  handleUnfocus() {\n    this.props.org.unfocusHeader();\n  }\n\n  handleAddNewHeader() {\n    this.props.org.addHeaderAndEdit(this.props.header.get('id'));\n  }\n\n  handleRest() {\n    if (this.state.isPlayingRemoveAnimation) {\n      this.props.org.removeHeader(this.props.header.get('id'));\n    }\n  }\n\n  handleDeadlineAndScheduledClick(planningType) {\n    const { header } = this.props;\n\n    const existingDeadlinePlanningItemIndex = header\n      .get('planningItems', [])\n      .findIndex(planningItem => planningItem.get('type') === planningType);\n\n    if (existingDeadlinePlanningItemIndex === -1) {\n      this.props.org.addNewPlanningItem(header.get('id'), planningType);\n      this.props.base.activatePopup('timestamp-editor', {\n        headerId: header.get('id'),\n        planningItemIndex: header.get('planningItems').size,\n      });\n    } else {\n      this.props.base.activatePopup('timestamp-editor', {\n        headerId: header.get('id'),\n        planningItemIndex: existingDeadlinePlanningItemIndex,\n      });\n    }\n\n    this.props.org.openHeader(header.get('id'));\n  }\n\n  handleDeadlineClick() {\n    this.handleDeadlineAndScheduledClick('DEADLINE');\n  }\n\n  handleScheduledClick() {\n    this.handleDeadlineAndScheduledClick('SCHEDULED');\n  }\n\n  render() {\n    const {\n      header,\n      color,\n      hasContent,\n      isSelected,\n      bulletStyle,\n      focusedHeader,\n      isFocused,\n      shouldDisableActions,\n    } = this.props;\n\n    const indentLevel = !!focusedHeader\n      ? header.get('nestingLevel') - focusedHeader.get('nestingLevel') + 1\n      : header.get('nestingLevel');\n\n    const { dragStartX, currentDragX, isDraggingFreely, isPlayingRemoveAnimation, containerWidth } =\n      this.state;\n    const marginLeft =\n      !!dragStartX && !!currentDragX && isDraggingFreely\n        ? currentDragX - dragStartX\n        : isPlayingRemoveAnimation\n        ? spring(-1 * containerWidth, { stiffness: 300 })\n        : spring(0, { stiffness: 300 });\n\n    const style = {\n      paddingLeft: 20 * indentLevel,\n      marginLeft,\n      heightFactor: isPlayingRemoveAnimation ? spring(0, { stiffness: 300 }) : 1,\n    };\n\n    const className = classNames('header', {\n      'header--selected': isSelected,\n      'header--removing': isPlayingRemoveAnimation,\n    });\n\n    return (\n      <Motion style={style} onRest={this.handleRest}>\n        {interpolatedStyle => {\n          const swipedDistance = interpolatedStyle.marginLeft;\n          const isLeftActionActivated = swipedDistance >= this.SWIPE_ACTION_ACTIVATION_DISTANCE;\n          const isRightActionActivated =\n            -1 * swipedDistance >= this.SWIPE_ACTION_ACTIVATION_DISTANCE;\n\n          const disabledColor = rgbaObject(211, 211, 211, 1);\n          const leftActivatedColor = rgbaObject(0, 128, 0, 1);\n          const rightActivatedColor = rgbaObject(255, 0, 0, 1);\n\n          const leftSwipeActionContainerStyle = {\n            width: interpolatedStyle.marginLeft,\n            backgroundColorFactor: spring(isLeftActionActivated ? 1 : 0, { stiffness: 300 }),\n          };\n          const rightSwipeActionContainerStyle = {\n            width: -1 * interpolatedStyle.marginLeft,\n            backgroundColorFactor: spring(isRightActionActivated ? 1 : 0, { stiffness: 300 }),\n          };\n\n          const leftIconStyle = {\n            display: swipedDistance > 30 ? '' : 'none',\n          };\n          const rightIconStyle = {\n            display: -1 * swipedDistance > 30 ? '' : 'none',\n          };\n\n          const { heightFactor, ...headerStyle } = interpolatedStyle;\n\n          if (isPlayingRemoveAnimation) {\n            headerStyle.height = this.state.heightBeforeRemove * heightFactor;\n          }\n\n          return (\n            <div\n              className={className}\n              style={headerStyle}\n              ref={this.handleRef}\n              onClick={this.handleHeaderClick}\n              onMouseDown={this.handleMouseDown}\n              onMouseMove={this.handleMouseMove}\n              onMouseUp={this.handleMouseUp}\n              onMouseOut={this.handleMouseOut}\n              onTouchStart={this.handleTouchStart}\n              onTouchMove={this.handleTouchMove}\n              onTouchEnd={this.handleTouchEnd}\n              onTouchCancel={this.handleTouchCancel}\n            >\n              <Motion style={leftSwipeActionContainerStyle}>\n                {leftInterpolatedStyle => {\n                  const leftStyle = {\n                    width: leftInterpolatedStyle.width,\n                    backgroundColor: rgbaString(\n                      interpolateColors(\n                        disabledColor,\n                        leftActivatedColor,\n                        leftInterpolatedStyle.backgroundColorFactor\n                      )\n                    ),\n                  };\n\n                  return (\n                    <div className=\"left-swipe-action-container\" style={leftStyle}>\n                      <i\n                        className=\"fas fa-check swipe-action-container__icon swipe-action-container__icon--left\"\n                        style={leftIconStyle}\n                      />\n                    </div>\n                  );\n                }}\n              </Motion>\n              <Motion style={rightSwipeActionContainerStyle}>\n                {rightInterpolatedStyle => {\n                  const rightStyle = {\n                    width: rightInterpolatedStyle.width,\n                    backgroundColor: rgbaString(\n                      interpolateColors(\n                        disabledColor,\n                        rightActivatedColor,\n                        rightInterpolatedStyle.backgroundColorFactor\n                      )\n                    ),\n                  };\n\n                  return (\n                    <div className=\"right-swipe-action-container\" style={rightStyle}>\n                      <i\n                        className=\"fas fa-times swipe-action-container__icon swipe-action-container__icon--right\"\n                        style={rightIconStyle}\n                      />\n                    </div>\n                  );\n                }}\n              </Motion>\n\n              <div style={{ marginLeft: -16, color }} className=\"header__bullet\">\n                {bulletStyle === 'Fancy' ? '' : '*'}\n              </div>\n              <TitleLine\n                header={header}\n                color={color}\n                hasContent={hasContent}\n                isSelected={isSelected}\n                shouldDisableActions={shouldDisableActions}\n              />\n\n              <Collapse\n                isOpened={isSelected && !shouldDisableActions}\n                springConfig={{ stiffness: 300 }}\n                style={{ marginRight: rightSwipeActionContainerStyle.width }}\n              >\n                <HeaderActionDrawer\n                  onEnterTitleEditMode={this.handleEnterTitleEditMode}\n                  onEnterDescriptionEditMode={this.handleEnterDescriptionEditMode}\n                  isFocused={isFocused}\n                  onTagsClick={this.handleShowTagsModal}\n                  onFocus={this.handleFocus}\n                  onUnfocus={this.handleUnfocus}\n                  onAddNewHeader={this.handleAddNewHeader}\n                  onDeadlineClick={this.handleDeadlineClick}\n                  onScheduledClick={this.handleScheduledClick}\n                />\n              </Collapse>\n\n              <HeaderContent\n                header={header}\n                isFocused={isFocused}\n                indentLevel={indentLevel}\n                shouldDisableActions={shouldDisableActions}\n              />\n            </div>\n          );\n        }}\n      </Motion>\n    );\n  }\n}\n\nconst mapStateToProps = (state, props) => {\n  const focusedHeader = !!state.org.present.get('focusedHeaderId')\n    ? headerWithId(state.org.present.get('headers'), state.org.present.get('focusedHeaderId'))\n    : null;\n\n  return {\n    bulletStyle: state.base.get('bulletStyle'),\n    focusedHeader,\n    isFocused: !!focusedHeader && focusedHeader.get('id') === props.header.get('id'),\n    inEditMode: !!state.org.present.get('editMode'),\n  };\n};\n\nconst mapDispatchToProps = dispatch => ({\n  org: bindActionCreators(orgActions, dispatch),\n  base: bindActionCreators(baseActions, dispatch),\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Header);\n","import React, { PureComponent } from 'react';\nimport { connect } from 'react-redux';\n\nimport './stylesheet.css';\n\nimport Header from '../Header';\n\nimport { numSubheadersOfHeaderWithId } from '../../../../lib/org_utils';\n\nimport _ from 'lodash';\nimport classNames from 'classnames';\n\nclass HeaderList extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    this.headerRefs = {};\n\n    _.bindAll(this, ['handleHeaderRef']);\n  }\n\n  componentDidUpdate(prevProps) {\n    if (prevProps.selectedHeaderId !== this.props.selectedHeaderId) {\n      const selectedHeaderDiv = this.headerRefs[this.props.selectedHeaderId];\n      if (!!selectedHeaderDiv) {\n        const boundingRectangle = selectedHeaderDiv.getBoundingClientRect();\n        const viewportHeight = document.documentElement.clientHeight;\n\n        if (boundingRectangle.top > viewportHeight * 0.9 || boundingRectangle.bottom < 0) {\n          selectedHeaderDiv.scrollIntoView();\n        }\n      }\n    }\n  }\n\n  handleHeaderRef(headerId) {\n    return div => (this.headerRefs[headerId] = div);\n  }\n\n  render() {\n    const { headers, selectedHeaderId, focusedHeaderId, shouldDisableActions } = this.props;\n\n    const headerRenderData = headers\n      .map(header => {\n        return {\n          header,\n          displayed: false,\n          hasContent:\n            !!header.get('rawDescription') ||\n            header.get('planningItems').size !== 0 ||\n            header.get('propertyListItems').size !== 0,\n        };\n      })\n      .toArray();\n\n    headerRenderData.forEach((headerRenderDatum, index) => {\n      const nestingLevel = headerRenderDatum.header.get('nestingLevel');\n\n      const hasNoParents = headerRenderData\n        .slice(0, index)\n        .every(\n          previousRenderDatum => previousRenderDatum.header.get('nestingLevel') >= nestingLevel\n        );\n      if (hasNoParents) {\n        headerRenderDatum.displayed = true;\n      }\n\n      const followingHeaders = headerRenderData.slice(index + 1);\n      for (\n        let followingHeaderIndex = 0;\n        followingHeaderIndex < followingHeaders.length;\n        ++followingHeaderIndex\n      ) {\n        const followingHeader = followingHeaders[followingHeaderIndex];\n        if (followingHeader.header.get('nestingLevel') <= nestingLevel) {\n          break;\n        }\n\n        headerRenderDatum.hasContent = true;\n\n        followingHeader.displayed =\n          headerRenderDatum.header.get('opened') && headerRenderDatum.displayed;\n      }\n    });\n\n    if (!!focusedHeaderId) {\n      const focusedHeaderIndex = headerRenderData.findIndex(\n        headerRenderDatum => headerRenderDatum.header.get('id') === focusedHeaderId\n      );\n\n      const previousHeaders = headerRenderData.slice(0, focusedHeaderIndex);\n      previousHeaders.forEach(headerRenderDatum => (headerRenderDatum.displayed = false));\n\n      const numSubheaders = numSubheadersOfHeaderWithId(headers, focusedHeaderId);\n      const followingHeaders = headerRenderData.slice(focusedHeaderIndex + numSubheaders + 1);\n      followingHeaders.forEach(headerRenderDatum => (headerRenderDatum.displayed = false));\n    }\n\n    const headerColors = [\n      'rgba(38, 143, 214, 1)',\n      'rgba(42, 164, 168, 1)',\n      'rgba(181, 142, 78, 1)',\n      'rgba(220, 64, 95, 1)',\n      'rgba(101, 128, 152, 1)',\n      'rgba(146, 164, 175, 1)',\n      'rgba(203, 85, 83, 1)',\n      'rgba(108, 119, 202, 1)',\n    ];\n\n    const displayedHeaderRenderData = headerRenderData.filter(\n      headerRenderDatum => headerRenderDatum.displayed\n    );\n\n    const className = classNames('header-list-container', {\n      'header-list-container--focused': !!focusedHeaderId,\n    });\n    return (\n      <div className={className}>\n        {displayedHeaderRenderData.map((headerRenderDatum, index) => {\n          const header = headerRenderDatum.header;\n          const color = headerColors[(header.get('nestingLevel') - 1) % headerColors.length];\n\n          return (\n            <Header\n              key={header.get('id')}\n              header={header}\n              color={color}\n              hasContent={headerRenderDatum.hasContent}\n              isSelected={header.get('id') === selectedHeaderId}\n              onRef={this.handleHeaderRef(header.get('id'))}\n              shouldDisableActions={shouldDisableActions}\n            />\n          );\n        })}\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = (state, props) => {\n  return {\n    headers: state.org.present.get('headers'),\n    selectedHeaderId: state.org.present.get('selectedHeaderId'),\n    focusedHeaderId: state.org.present.get('focusedHeaderId'),\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {};\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(HeaderList);\n","import React, { PureComponent } from 'react';\n\nimport './stylesheet.css';\n\nimport classNames from 'classnames';\nimport _ from 'lodash';\n\nexport default class ActionButton extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, ['handleClick']);\n  }\n\n  handleClick() {\n    const { onClick, isDisabled } = this.props;\n\n    if (isDisabled) {\n      return;\n    }\n\n    onClick();\n  }\n\n  render() {\n    const {\n      iconName,\n      subIconName,\n      isDisabled,\n      shouldRotateSubIcon,\n      letter,\n      additionalClassName,\n      style,\n      tooltip,\n      shouldSpinSubIcon,\n      onRef,\n    } = this.props;\n\n    const className = classNames(\n      'btn',\n      'btn--circle',\n      'action-drawer__btn',\n      additionalClassName || '',\n      {\n        fas: !letter,\n        'fa-lg': !letter,\n        [`fa-${iconName}`]: !letter,\n        'action-drawer__btn--with-sub-icon': !!subIconName,\n        'btn--disabled': isDisabled,\n        'action-drawer__btn--letter': !!letter,\n      }\n    );\n\n    const subIconClassName = classNames(\n      'fas',\n      'fa-xs',\n      `fa-${subIconName}`,\n      'action-drawer__btn__sub-icon',\n      {\n        'action-drawer__btn__sub-icon--rotated': shouldRotateSubIcon,\n        'fa-spin': shouldSpinSubIcon,\n      }\n    );\n\n    return (\n      <button\n        className={className}\n        onClick={this.handleClick}\n        style={style}\n        title={tooltip}\n        ref={onRef}\n      >\n        {!!letter && letter}\n        {!!subIconName && <i className={subIconClassName} />}\n      </button>\n    );\n  }\n}\n","import React, { Fragment, useState, useEffect, useMemo, useRef } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport { Motion, spring } from 'react-motion';\n\nimport './stylesheet.css';\n\nimport { List } from 'immutable';\n\nimport * as orgActions from '../../../../actions/org';\nimport * as captureActions from '../../../../actions/capture';\nimport * as baseActions from '../../../../actions/base';\n\nimport sampleCaptureTemplates from '../../../../lib/sample_capture_templates';\n\nimport ActionButton from './components/ActionButton/';\n\nconst ActionDrawer = ({\n  org,\n  selectedHeaderId,\n  base,\n  staticFile,\n  captureTemplates,\n  path,\n  selectedTableCellId,\n  selectedListItemId,\n  inEditMode,\n  isLoading,\n  shouldDisableSyncButtons,\n}) => {\n  const [isDisplayingArrowButtons, setIsDisplayingArrowButtons] = useState(false);\n  const [isDisplayingCaptureButtons, setIsDisplayingCaptureButtons] = useState(false);\n\n  // Send a no-op action to take care of the bug where redux-undo won't allow the first\n  // action to be undone.\n  useEffect(() => {\n    org.noOp();\n  }, []);\n\n  useEffect(() => {\n    document.querySelector('html').style.paddingBottom = '90px';\n\n    return () => (document.querySelector('html').style.paddingBottom = '0px');\n  });\n\n  const mainArrowButton = useRef(null);\n\n  const mainArrowButtonBoundingRect = useMemo(\n    () => (!!mainArrowButton.current ? mainArrowButton.current.getBoundingClientRect() : null),\n    [mainArrowButton.current]\n  );\n\n  const handleUpClick = () =>\n    !!selectedHeaderId\n      ? org.moveHeaderUp(selectedHeaderId)\n      : !!selectedTableCellId\n      ? org.moveTableRowUp()\n      : org.moveListItemUp();\n\n  const handleDownClick = () =>\n    !!selectedHeaderId\n      ? org.moveHeaderDown(selectedHeaderId)\n      : !!selectedTableCellId\n      ? org.moveTableRowDown()\n      : org.moveListItemDown();\n\n  const handleLeftClick = () =>\n    !!selectedHeaderId\n      ? org.moveHeaderLeft(selectedHeaderId)\n      : !!selectedTableCellId\n      ? org.moveTableColumnLeft()\n      : org.moveListItemLeft();\n\n  const handleRightClick = () =>\n    !!selectedHeaderId\n      ? org.moveHeaderRight(selectedHeaderId)\n      : !!selectedTableCellId\n      ? org.moveTableColumnRight()\n      : org.moveListItemRight();\n\n  const handleMoveSubtreeLeftClick = () =>\n    !!selectedHeaderId ? org.moveSubtreeLeft(selectedHeaderId) : org.moveListSubtreeLeft();\n\n  const handleMoveSubtreeRightClick = () =>\n    !!selectedHeaderId ? org.moveSubtreeRight(selectedHeaderId) : org.moveListSubtreeRight();\n\n  const handleDoneClick = () => org.exitEditMode();\n\n  const handleCaptureButtonClick = templateId => () => {\n    setIsDisplayingCaptureButtons(false);\n    base.activatePopup('capture', { templateId });\n  };\n\n  const getSampleCaptureTemplates = () => sampleCaptureTemplates;\n\n  const getAvailableCaptureTemplates = () =>\n    staticFile === 'sample'\n      ? getSampleCaptureTemplates()\n      : captureTemplates.filter(\n          template =>\n            template.get('isAvailableInAllOrgFiles') ||\n            template\n              .get('orgFilesWhereAvailable')\n              .map(availablePath =>\n                availablePath.trim().startsWith('/')\n                  ? availablePath.trim()\n                  : '/' + availablePath.trim()\n              )\n              .includes((path || '').trim())\n        );\n\n  const handleSync = () => org.sync();\n\n  const handleMainArrowButtonClick = () => setIsDisplayingArrowButtons(!isDisplayingArrowButtons);\n\n  const handleMainCaptureButtonClick = () => {\n    if (!isDisplayingCaptureButtons && getAvailableCaptureTemplates().size === 0) {\n      alert(\n        `You don't have any capture templates set up for this file! Add some in Settings > Capture Templates`\n      );\n      return;\n    }\n\n    setIsDisplayingCaptureButtons(!isDisplayingCaptureButtons);\n  };\n\n  const renderCaptureButtons = () => {\n    const availableCaptureTemplates = getAvailableCaptureTemplates();\n\n    const baseCaptureButtonStyle = {\n      position: 'absolute',\n      zIndex: 0,\n      left: 0,\n      opacity: isDisplayingArrowButtons ? 0 : 1,\n    };\n    if (!isDisplayingCaptureButtons) {\n      baseCaptureButtonStyle.boxShadow = 'none';\n    }\n\n    const mainButtonStyle = {\n      opacity: isDisplayingArrowButtons ? 0 : 1,\n      position: 'relative',\n      zIndex: 1,\n    };\n\n    const animatedStyle = {\n      bottom: spring(isDisplayingCaptureButtons ? 70 : 0, { stiffness: 300 }),\n    };\n\n    return (\n      <Motion style={animatedStyle}>\n        {style => (\n          <div className=\"action-drawer__capture-buttons-container\">\n            <ActionButton\n              iconName={isDisplayingCaptureButtons ? 'times' : 'list-ul'}\n              isDisabled={false}\n              onClick={handleMainCaptureButtonClick}\n              style={mainButtonStyle}\n              tooltip={\n                isDisplayingCaptureButtons ? 'Hide capture templates' : 'Show capture templates'\n              }\n            />\n\n            {availableCaptureTemplates.map((template, index) => (\n              <ActionButton\n                key={template.get('id')}\n                letter={template.get('letter')}\n                iconName={template.get('iconName')}\n                isDisabled={false}\n                onClick={handleCaptureButtonClick(template.get('id'))}\n                style={{ ...baseCaptureButtonStyle, bottom: style.bottom * (index + 1) }}\n                tooltip={`Activate \"${template.get('description')}\" capture template`}\n              />\n            ))}\n          </div>\n        )}\n      </Motion>\n    );\n  };\n\n  const renderMovementButtons = () => {\n    const baseArrowButtonStyle = {\n      opacity: isDisplayingCaptureButtons ? 0 : 1,\n    };\n    if (!isDisplayingArrowButtons) {\n      baseArrowButtonStyle.boxShadow = 'none';\n    }\n\n    let centerXOffset = 0;\n    if (!!mainArrowButtonBoundingRect) {\n      centerXOffset =\n        window.screen.width / 2 -\n        (mainArrowButtonBoundingRect.x + mainArrowButtonBoundingRect.width / 2);\n    }\n\n    const animatedStyles = {\n      centerXOffset: spring(isDisplayingArrowButtons ? centerXOffset : 0, { stiffness: 300 }),\n      topRowYOffset: spring(isDisplayingArrowButtons ? 150 : 0, { stiffness: 300 }),\n      bottomRowYOffset: spring(isDisplayingArrowButtons ? 80 : 0, { stiffness: 300 }),\n      firstColumnXOffset: spring(isDisplayingArrowButtons ? 70 : 0, {\n        stiffness: 300,\n      }),\n      secondColumnXOffset: spring(isDisplayingArrowButtons ? 140 : 0, {\n        stiffness: 300,\n      }),\n    };\n\n    let subIconNameStr = null;\n    let tooltipUpStr = 'Move header up';\n    let tooltipDownStr = 'Move header down';\n    let tooltipLeftStr = 'Move header left';\n    let tooltipRightStr = 'Move header right';\n    if (!!selectedTableCellId) {\n      subIconNameStr = 'table';\n      tooltipUpStr = 'Move row up';\n      tooltipDownStr = 'Move row down';\n      tooltipLeftStr = 'Move column left';\n      tooltipRightStr = 'Move column right';\n    } else if (!!selectedListItemId) {\n      subIconNameStr = 'list';\n      tooltipUpStr = 'Move list up';\n      tooltipDownStr = 'Move list down';\n      tooltipLeftStr = 'Move list left';\n      tooltipRightStr = 'Move list right';\n    }\n\n    return (\n      <Motion style={animatedStyles}>\n        {style => (\n          <div\n            className=\"action-drawer__arrow-buttons-container\"\n            style={{ left: style.centerXOffset }}\n          >\n            <ActionButton\n              additionalClassName=\"action-drawer__arrow-button\"\n              iconName=\"arrow-up\"\n              subIconName={subIconNameStr}\n              isDisabled={false}\n              onClick={handleUpClick}\n              style={{ ...baseArrowButtonStyle, bottom: style.topRowYOffset }}\n              tooltip={tooltipUpStr}\n            />\n            <ActionButton\n              additionalClassName=\"action-drawer__arrow-button\"\n              iconName=\"arrow-down\"\n              subIconName={subIconNameStr}\n              isDisabled={false}\n              onClick={handleDownClick}\n              style={{ ...baseArrowButtonStyle, bottom: style.bottomRowYOffset }}\n              tooltip={tooltipDownStr}\n            />\n            <ActionButton\n              additionalClassName=\"action-drawer__arrow-button\"\n              iconName=\"arrow-left\"\n              subIconName={subIconNameStr}\n              isDisabled={false}\n              onClick={handleLeftClick}\n              style={{\n                ...baseArrowButtonStyle,\n                bottom: style.bottomRowYOffset,\n                right: style.firstColumnXOffset,\n              }}\n              tooltip={tooltipLeftStr}\n            />\n            <ActionButton\n              additionalClassName=\"action-drawer__arrow-button\"\n              iconName=\"arrow-right\"\n              subIconName={subIconNameStr}\n              isDisabled={false}\n              onClick={handleRightClick}\n              style={{\n                ...baseArrowButtonStyle,\n                bottom: style.bottomRowYOffset,\n                left: style.firstColumnXOffset,\n              }}\n              tooltip={tooltipRightStr}\n            />\n            {!selectedTableCellId && (\n              <Fragment>\n                <ActionButton\n                  additionalClassName=\"action-drawer__arrow-button\"\n                  iconName=\"chevron-left\"\n                  subIconName={subIconNameStr}\n                  isDisabled={false}\n                  onClick={handleMoveSubtreeLeftClick}\n                  style={{\n                    ...baseArrowButtonStyle,\n                    bottom: style.bottomRowYOffset,\n                    right: style.secondColumnXOffset,\n                  }}\n                  tooltip=\"Move entire subtree left\"\n                />\n                <ActionButton\n                  additionalClassName=\"action-drawer__arrow-button\"\n                  iconName=\"chevron-right\"\n                  subIconName={subIconNameStr}\n                  isDisabled={false}\n                  onClick={handleMoveSubtreeRightClick}\n                  style={{\n                    ...baseArrowButtonStyle,\n                    bottom: style.bottomRowYOffset,\n                    left: style.secondColumnXOffset,\n                  }}\n                  tooltip=\"Move entire subtree right\"\n                />\n              </Fragment>\n            )}\n\n            <ActionButton\n              iconName={isDisplayingArrowButtons ? 'times' : 'arrows-alt'}\n              subIconName={subIconNameStr}\n              additionalClassName=\"action-drawer__main-arrow-button\"\n              isDisabled={false}\n              onClick={handleMainArrowButtonClick}\n              style={{ opacity: isDisplayingCaptureButtons ? 0 : 1 }}\n              tooltip={isDisplayingArrowButtons ? 'Hide movement buttons' : 'Show movement buttons'}\n              onRef={mainArrowButton}\n            />\n          </div>\n        )}\n      </Motion>\n    );\n  };\n\n  const handleAgendaClick = () => base.activatePopup('agenda');\n\n  return (\n    <div className=\"action-drawer-container nice-scroll\">\n      {inEditMode ? (\n        <button className=\"btn action-drawer__done-btn\" onClick={handleDoneClick}>\n          Done\n        </button>\n      ) : (\n        <Fragment>\n          <ActionButton\n            iconName=\"cloud\"\n            subIconName=\"sync-alt\"\n            shouldSpinSubIcon={isLoading}\n            isDisabled={shouldDisableSyncButtons}\n            onClick={handleSync}\n            style={{ opacity: isDisplayingArrowButtons || isDisplayingCaptureButtons ? 0 : 1 }}\n            tooltip=\"Sync changes\"\n          />\n\n          {renderMovementButtons()}\n\n          <ActionButton\n            iconName=\"calendar-alt\"\n            shouldSpinSubIcon={isLoading}\n            isDisabled={false}\n            onClick={handleAgendaClick}\n            style={{ opacity: isDisplayingArrowButtons || isDisplayingCaptureButtons ? 0 : 1 }}\n            tooltip=\"Show agenda\"\n          />\n\n          {renderCaptureButtons()}\n        </Fragment>\n      )}\n    </div>\n  );\n};\n\nconst mapStateToProps = (state, props) => {\n  return {\n    inEditMode: !!state.org.present.get('editMode'),\n    selectedHeaderId: state.org.present.get('selectedHeaderId'),\n    isDirty: state.org.present.get('isDirty'),\n    isFocusedHeaderActive: !!state.org.present.get('focusedHeaderId'),\n    selectedTableCellId: state.org.present.get('selectedTableCellId'),\n    selectedListItemId: state.org.present.get('selectedListItemId'),\n    captureTemplates: state.capture.get('captureTemplates', new List()),\n    path: state.org.present.get('path'),\n    isLoading: state.base.get('isLoading'),\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    org: bindActionCreators(orgActions, dispatch),\n    capture: bindActionCreators(captureActions, dispatch),\n    base: bindActionCreators(baseActions, dispatch),\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ActionDrawer);\n","import React from 'react';\nimport { Motion, spring } from 'react-motion';\n\nimport { interpolateColors, rgbaObject, rgbaString } from '../../../lib/color';\n\nimport './stylesheet.css';\n\nexport default ({ isEnabled, onToggle }) => {\n  const disabledColor = rgbaObject(255, 255, 255, 1);\n  const enabledColor = rgbaObject(94, 52, 140, 1);\n\n  const switchStyle = {\n    colorFactor: spring(isEnabled ? 1 : 0, { stiffness: 300 }),\n  };\n\n  const grabberStyle = {\n    marginLeft: spring(isEnabled ? 42 : 0, { stiffness: 300 }),\n  };\n\n  return (\n    <Motion style={switchStyle}>\n      {style => {\n        const backgroundColor = rgbaString(\n          interpolateColors(disabledColor, enabledColor, style.colorFactor)\n        );\n\n        return (\n          <div className=\"switch\" style={{ backgroundColor }} onClick={onToggle}>\n            <Motion style={grabberStyle}>\n              {style => <div className=\"switch__grabber\" style={style} />}\n            </Motion>\n          </div>\n        );\n      }}\n    </Motion>\n  );\n};\n","import React, { useState, useEffect, useLayoutEffect, useRef } from 'react';\n\nimport './stylesheet.css';\n\nimport { Motion, spring } from 'react-motion';\nimport classNames from 'classnames';\n\nexport default ({ children, shouldIncludeCloseButton, onClose }) => {\n  const [isVisible, setIsVisible] = useState(false);\n  const [dragOffsetY, setDragOffsetY] = useState(null);\n\n  useLayoutEffect(() => {\n    setIsVisible(true);\n  }, []);\n\n  const initialClientY = useRef();\n  const innerContainer = useRef();\n\n  const innerContainerHeight = useRef();\n  useLayoutEffect(() => {\n    innerContainerHeight.current = innerContainer.current.offsetHeight;\n  });\n  const endInnerContainerDrag = () => {\n    setIsVisible(dragOffsetY <= innerContainerHeight.current * 0.3);\n    setDragOffsetY(null);\n  };\n\n  const handleInnerContainerClick = event => event.stopPropagation();\n\n  const handleClose = () => setIsVisible(false);\n\n  const handleAnimationRest = () => (!isVisible && !!onClose ? onClose() : void 0);\n\n  const handleTouchStart = event => (initialClientY.current = event.targetTouches[0].clientY);\n\n  const handleTouchMove = event => {\n    if (event.target.classList.contains('drag-handle')) {\n      return;\n    }\n\n    const isScrollingDown = initialClientY.current > event.targetTouches[0].clientY;\n\n    if (\n      isScrollingDown &&\n      innerContainer.current.scrollHeight - innerContainer.current.scrollTop <=\n        innerContainer.current.clientHeight\n    ) {\n      event.preventDefault();\n    } else if (!isScrollingDown && innerContainer.current.scrollTop === 0) {\n      event.preventDefault();\n\n      setDragOffsetY(event.targetTouches[0].clientY - initialClientY.current);\n    }\n  };\n\n  const handleTouchEndOrCancel = event => endInnerContainerDrag();\n\n  useEffect(() => {\n    if (!!innerContainer.current) {\n      // Super annoying logic for disabling scrolling of the body when a slide up is active.\n      // Briefly: if we're already at the top of our Drawer and trying to scroll up, disable\n      // scrolling. Likewise, if we're already at the bottom of our Drawer and trying to scroll\n      // down, disable scrolling.\n      innerContainer.current.addEventListener('touchstart', handleTouchStart);\n      innerContainer.current.addEventListener('touchmove', handleTouchMove);\n      innerContainer.current.addEventListener('touchend', handleTouchEndOrCancel);\n      innerContainer.current.addEventListener('touchcancel', handleTouchEndOrCancel);\n\n      return () => {\n        innerContainer.current.removeEventListener('touchstart', handleTouchStart);\n        innerContainer.current.removeEventListener('touchmove', handleTouchMove);\n        innerContainer.current.removeEventListener('touchend', handleTouchEndOrCancel);\n        innerContainer.current.removeEventListener('touchcancel', handleTouchEndOrCancel);\n      };\n    } else {\n      return null;\n    }\n  }, [innerContainer.current, dragOffsetY]);\n\n  useEffect(() => {\n    // A ridiculous hack to get around what is presumably a Mobile Safari bug in iOS 12.\n    // Without this, I can't scroll the inner container in the agenda view.\n    setTimeout(() => {\n      innerContainer.current.style.left = '0';\n      setTimeout(() => {\n        innerContainer.current.style.left = '-1px';\n      }, 0);\n    }, 0);\n  }, [children]);\n\n  const outerClassName = classNames('drawer-outer-container', {\n    'drawer-outer-container--visible': isVisible,\n  });\n\n  const innerStyle = {\n    offsetY:\n      dragOffsetY ||\n      spring(isVisible ? 0 : innerContainerHeight.current || window.innerHeight, {\n        stiffness: 300,\n      }),\n  };\n\n  return (\n    <Motion style={innerStyle} onRest={handleAnimationRest}>\n      {style => {\n        const interpolatedStyle = {\n          transform: `translateY(${style.offsetY}px)`,\n        };\n\n        return (\n          <div className={outerClassName} onClick={!!onClose ? handleClose : null}>\n            <div\n              onClick={handleInnerContainerClick}\n              className=\"drawer-inner-container nice-scroll\"\n              ref={innerContainer}\n              style={interpolatedStyle}\n            >\n              <div className=\"drawer__grabber\" />\n\n              {shouldIncludeCloseButton && (\n                <button className=\"fas fa-times fa-lg drawer__close-button\" onClick={handleClose} />\n              )}\n\n              {children}\n            </div>\n          </div>\n        );\n      }}\n    </Motion>\n  );\n};\n","import React, { Fragment, useState, useEffect, useRef, useMemo } from 'react';\n\nimport './stylesheet.css';\n\nimport ActionButton from '../ActionDrawer/components/ActionButton/';\nimport Switch from '../../../UI/Switch/';\nimport Drawer from '../../../UI/Drawer/';\n\nimport { headerWithPath } from '../../../../lib/org_utils';\nimport substituteTemplateVariables from '../../../../lib/capture_template_substitution';\n\nimport classNames from 'classnames';\n\nexport default ({ template, onCapture, headers, onClose }) => {\n  const [substitutedTemplate, initialCursorIndex] = useMemo(\n    () => substituteTemplateVariables(template.get('template')),\n    [template.get('template')]\n  );\n\n  const isTopLevelTarget = template.get('headerPaths').filter(path => path.length !== 0).size === 0;\n  const targetHeader = useMemo(\n    () => headerWithPath(headers, template.get('headerPaths')),\n    [headers, template.get('headerPaths')]\n  );\n\n  const [textareaValue, setTextareaValue] = useState(substitutedTemplate);\n  const [shouldPrepend, setShouldPrepend] = useState(template.get('shouldPrepend'));\n\n  const textarea = useRef(null);\n\n  useEffect(() => {\n    if (textarea.current) {\n      textarea.current.focus();\n      if (initialCursorIndex !== null) {\n        textarea.current.selectionStart = initialCursorIndex;\n        textarea.current.selectionEnd = initialCursorIndex;\n      }\n    }\n  }, [textarea]);\n\n  const handleCaptureClick = () => onCapture(template.get('id'), textareaValue, shouldPrepend);\n\n  const handleTextareaChange = event => setTextareaValue(event.target.value);\n\n  const handlePrependSwitchToggle = () => setShouldPrepend(!shouldPrepend);\n\n  return (\n    <Drawer onClose={onClose}>\n      <div className=\"capture-modal-header\">\n        <ActionButton\n          letter={template.get('letter')}\n          iconName={template.get('iconName')}\n          isDisabled={false}\n          onClick={() => {}}\n          style={{ marginRight: 20 }}\n        />\n\n        <span>{template.get('description')}</span>\n      </div>\n\n      <div\n        className={classNames('capture-modal-header-path', {\n          'capture-modal-header-path--top-level': isTopLevelTarget,\n        })}\n      >\n        {isTopLevelTarget ? 'Top level header' : template.get('headerPaths').join(' > ')}\n      </div>\n\n      {!!targetHeader || isTopLevelTarget ? (\n        <Fragment>\n          <textarea\n            className=\"textarea capture-modal-textarea\"\n            rows=\"4\"\n            value={textareaValue}\n            onChange={handleTextareaChange}\n            ref={textarea}\n          />\n\n          <div className=\"capture-modal-button-container\">\n            <div className=\"capture-modal-prepend-container\">\n              <span className=\"capture-modal-prepend-label\">Prepend:</span>\n              <Switch isEnabled={shouldPrepend} onToggle={handlePrependSwitchToggle} />\n            </div>\n\n            <button className=\"btn capture-modal-button\" onClick={handleCaptureClick}>\n              Capture\n            </button>\n          </div>\n        </Fragment>\n      ) : (\n        <div className=\"capture-modal-error-message\">\n          The specified header path doesn't exist in this org file!\n        </div>\n      )}\n\n      <br />\n    </Drawer>\n  );\n};\n","import React from 'react';\n\nimport './stylesheet.css';\n\nimport Drawer from '../../../UI/Drawer/';\n\nimport formatDate from 'date-fns/format';\nimport { distanceInWordsToNow } from 'date-fns';\n\nexport default ({ lastServerModifiedAt, onPull, onPush, onCancel }) => {\n  return (\n    <Drawer>\n      <h2 className=\"sync-confirmation-modal__header\">Sync conflict</h2>\n      Since you last pulled, a newer version of the file has been pushed to the server. The newer\n      version is from:\n      <br />\n      <br />\n      <div className=\"sync-confirmation-modal__last-sync-time\">\n        {formatDate(lastServerModifiedAt, 'MMMM Do, YYYY [at] h:mm:ss a')}\n        <br />({distanceInWordsToNow(lastServerModifiedAt)} ago)\n      </div>\n      <div className=\"sync-confirmation-modal__buttons-container\">\n        <button className=\"btn sync-confirmation-modal__button\" onClick={onPull}>\n          Pull latest version from server\n        </button>\n        <button className=\"btn sync-confirmation-modal__button\" onClick={onPush}>\n          Overwrite server version\n        </button>\n        <button className=\"btn sync-confirmation-modal__button\" onClick={onCancel}>\n          Cancel sync\n        </button>\n      </div>\n      <br />\n    </Drawer>\n  );\n};\n","import React, { PureComponent, Fragment } from 'react';\n\nimport { Droppable, Draggable } from 'react-beautiful-dnd';\n\nimport './stylesheet.css';\n\nimport Drawer from '../../../UI/Drawer/';\n\nimport _ from 'lodash';\nimport classNames from 'classnames';\n\nexport default class TagsEditorModal extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, ['handleRemoveTag', 'handleAddNewTag', 'handleTagChange']);\n\n    this.state = {\n      allTags: props.allTags,\n    };\n  }\n\n  componentDidUpdate(prevProps) {\n    const prevTags = prevProps.header.getIn(['titleLine', 'tags']);\n    const currentTags = this.props.header.getIn(['titleLine', 'tags']);\n    if (prevTags.size === currentTags.size - 1 && currentTags.last() === '') {\n      if (this.lastTextfield) {\n        this.lastTextfield.focus();\n      }\n    }\n  }\n\n  handleTagChange(tagIndex) {\n    return event => {\n      const tags = this.props.header.getIn(['titleLine', 'tags']);\n      this.props.onChange(tags.set(tagIndex, event.target.value.replace(/(\\s+|:)/g, '')));\n    };\n  }\n\n  handleRemoveTag(tagIndex) {\n    return () => {\n      const tags = this.props.header.getIn(['titleLine', 'tags']);\n      this.props.onChange(tags.delete(tagIndex));\n    };\n  }\n\n  handleAddNewTag() {\n    const tags = this.props.header.getIn(['titleLine', 'tags']);\n    this.props.onChange(tags.push(''));\n  }\n\n  handleExistingTagClick(newTag) {\n    return () => {\n      const tags = this.props.header.getIn(['titleLine', 'tags']);\n      if (tags.includes(newTag)) {\n        this.props.onChange(tags.filter(tag => tag !== newTag));\n      } else {\n        this.props.onChange(tags.push(newTag));\n      }\n    };\n  }\n\n  render() {\n    const { header, onClose } = this.props;\n    const { allTags } = this.state;\n\n    const headerTags = header.getIn(['titleLine', 'tags']);\n\n    return (\n      <Drawer onClose={onClose}>\n        <h2 className=\"drawer-modal__title\">Edit tags</h2>\n\n        {headerTags.size === 0 ? (\n          <div className=\"no-tags-message\">\n            This header doesn't have any tags.\n            <br />\n            <br />\n            Click the <i className=\"fas fa-plus\" /> button to add a new one, or choose from the list\n            of all of your tags below.\n          </div>\n        ) : (\n          <Droppable droppableId=\"tags-editor-droppable\" type=\"TAG\">\n            {(provided, snapshot) => (\n              <div className=\"tags-container\" ref={provided.innerRef} {...provided.droppableProps}>\n                <Fragment>\n                  {headerTags.map((tag, index) => (\n                    <Draggable draggableId={`tag--${index}`} index={index} key={index}>\n                      {(provided, snapshot) => (\n                        <div\n                          className={classNames('tag-container', {\n                            'tag-container--dragging': snapshot.isDragging,\n                          })}\n                          ref={provided.innerRef}\n                          {...provided.draggableProps}\n                        >\n                          <input\n                            type=\"text\"\n                            className=\"textfield tag-container__textfield\"\n                            value={tag}\n                            onChange={this.handleTagChange(index)}\n                            ref={textfield => (this.lastTextfield = textfield)}\n                          />\n                          <div className=\"tag-container__actions-container\">\n                            <i\n                              className=\"fas fa-times fa-lg\"\n                              onClick={this.handleRemoveTag(index)}\n                            />\n                            <i\n                              className=\"fas fa-bars fa-lg tag-container__drag-handle drag-handle\"\n                              {...provided.dragHandleProps}\n                            />\n                          </div>\n                        </div>\n                      )}\n                    </Draggable>\n                  ))}\n\n                  {provided.placeholder}\n                </Fragment>\n              </div>\n            )}\n          </Droppable>\n        )}\n\n        <div className=\"tags-editor__add-new-container\">\n          <button className=\"fas fa-plus fa-lg btn btn--circle\" onClick={this.handleAddNewTag} />\n        </div>\n\n        <hr className=\"tags-editor__separator\" />\n\n        <h2 className=\"tags-editor__title\">All tags</h2>\n\n        <div className=\"all-tags-container\">\n          {allTags\n            .filter(tag => !!tag)\n            .map(tag => {\n              const className = classNames('all-tags__tag', {\n                'all-tags__tag--in-use': headerTags.includes(tag),\n              });\n\n              return (\n                <div className={className} key={tag} onClick={this.handleExistingTagClick(tag)}>\n                  {tag}\n                </div>\n              );\n            })}\n        </div>\n      </Drawer>\n    );\n  }\n}\n","import React from 'react';\n\nimport './stylesheet.css';\n\nimport classNames from 'classnames';\n\nexport default ({ buttons, selectedButton, useEqualWidthTabs, onSelect }) => {\n  const handleButtonClick = buttonName => () => onSelect(buttonName);\n\n  const containerClassName = classNames('tab-buttons', {\n    'tab-buttons--equal-width-tabs': useEqualWidthTabs,\n  });\n\n  const style = {\n    gridTemplateColumns: useEqualWidthTabs ? `repeat(${buttons.length}, 1fr)` : null,\n  };\n\n  return (\n    <div className={containerClassName} style={style}>\n      {buttons.map(buttonName => {\n        const className = classNames('tab-buttons__btn', {\n          'tab-buttons__btn--selected': buttonName === selectedButton,\n        });\n\n        return (\n          <div key={buttonName} className={className} onClick={handleButtonClick(buttonName)}>\n            {buttonName}\n          </div>\n        );\n      })}\n    </div>\n  );\n};\n","import React, { PureComponent, Fragment } from 'react';\n\nimport './stylesheet.css';\n\nimport Switch from '../../../../../UI/Switch/';\nimport TabButtons from '../../../../../UI/TabButtons/';\n\nimport { renderAsText } from '../../../../../../lib/timestamps';\n\nimport _ from 'lodash';\nimport parseDate from 'date-fns/parse';\nimport formatDate from 'date-fns/format';\n\nexport default class TimestampEditor extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, [\n      'handleActiveToggle',\n      'handleDateChange',\n      'handleAddRepeater',\n      'handleRemoveRepeater',\n      'handleRepeaterTypeChange',\n      'handleRepeaterValueChange',\n      'handleRepeaterUnitChange',\n      'handleAddDelay',\n      'handleRemoveDelay',\n      'handleDelayTypeChange',\n      'handleDelayValueChange',\n      'handleDelayUnitChange',\n    ]);\n  }\n\n  handleActiveToggle() {\n    this.props.onChange(this.props.timestamp.update('isActive', isActive => !isActive));\n  }\n\n  handleDateChange(event) {\n    const { onChange, timestamp } = this.props;\n\n    const [newYear, newMonth, newDay, newDayName] = formatDate(\n      parseDate(event.target.value),\n      'YYYY MM DD ddd'\n    ).split(' ');\n    onChange(\n      timestamp\n        .set('year', newYear)\n        .set('month', newMonth)\n        .set('day', newDay)\n        .set('dayName', newDayName)\n    );\n  }\n\n  handleAddTime(startOrEnd) {\n    return () => {\n      const { onChange, timestamp } = this.props;\n\n      const [hourKey, minuteKey] =\n        startOrEnd === 'start' ? ['startHour', 'startMinute'] : ['endHour', 'endMinute'];\n      const [hour, minute] = formatDate(new Date(), 'HH:mm').split(':');\n      onChange(timestamp.set(hourKey, hour).set(minuteKey, minute));\n    };\n  }\n\n  handleRemoveTime(startOrEnd) {\n    return () => {\n      const { onChange, timestamp } = this.props;\n\n      const [hourKey, minuteKey] =\n        startOrEnd === 'start' ? ['startHour', 'startMinute'] : ['endHour', 'endMinute'];\n      onChange(timestamp.set(hourKey, null).set(minuteKey, null));\n    };\n  }\n\n  handleTimeChange(startOrEnd) {\n    return event => {\n      const { onChange, timestamp } = this.props;\n\n      const [hourKey, minuteKey] =\n        startOrEnd === 'start' ? ['startHour', 'startMinute'] : ['endHour', 'endMinute'];\n      let [hour, minute] = event.target.value.split(':');\n      hour = hour.startsWith('0') ? hour.substring(1) : hour;\n      onChange(timestamp.set(hourKey, hour).set(minuteKey, minute));\n    };\n  }\n\n  handleAddRepeater() {\n    const { onChange, timestamp } = this.props;\n    onChange(timestamp.set('repeaterType', '+').set('repeaterValue', 1).set('repeaterUnit', 'h'));\n  }\n\n  handleRemoveRepeater() {\n    const { onChange, timestamp } = this.props;\n    onChange(\n      timestamp.set('repeaterType', null).set('repeaterValue', null).set('repeaterUnit', null)\n    );\n  }\n\n  handleRepeaterTypeChange(newRepeaterType) {\n    const { onChange, timestamp } = this.props;\n    onChange(timestamp.set('repeaterType', newRepeaterType));\n  }\n\n  handleRepeaterValueChange(event) {\n    const { onChange, timestamp } = this.props;\n    onChange(timestamp.set('repeaterValue', event.target.value));\n  }\n\n  handleRepeaterUnitChange(newRepeaterUnit) {\n    const { onChange, timestamp } = this.props;\n    onChange(timestamp.set('repeaterUnit', newRepeaterUnit));\n  }\n\n  handleAddDelay() {\n    const { onChange, timestamp } = this.props;\n    onChange(timestamp.set('delayType', '-').set('delayValue', 1).set('delayUnit', 'h'));\n  }\n\n  handleRemoveDelay() {\n    const { onChange, timestamp } = this.props;\n    onChange(timestamp.set('delayType', null).set('delayValue', null).set('delayUnit', null));\n  }\n\n  handleDelayTypeChange(newDelayType) {\n    const { onChange, timestamp } = this.props;\n    onChange(timestamp.set('delayType', newDelayType));\n  }\n\n  handleDelayValueChange(event) {\n    const { onChange, timestamp } = this.props;\n    onChange(timestamp.set('delayValue', event.target.value));\n  }\n\n  handleDelayUnitChange(newDelayUnit) {\n    const { onChange, timestamp } = this.props;\n    onChange(timestamp.set('delayUnit', newDelayUnit));\n  }\n\n  renderTimeField(label, timeKey, hour, minute, showRemoveButton = true) {\n    return (\n      <div className=\"timestamp-editor__field-container timestamp-editor__field-container--inline\">\n        <div className=\"timestamp-editor__field-title\">{label}</div>\n        <div className=\"timestamp-editor__field\">\n          {!!hour ? (\n            <Fragment>\n              <input\n                type=\"time\"\n                className=\"timestamp-editor__time-input\"\n                value={`${hour.padStart(2, '0')}:${minute.padStart(2, '0')}`}\n                onChange={this.handleTimeChange(timeKey)}\n              />\n              {showRemoveButton && (\n                <i\n                  className=\"fas fa-times fa-lg timestamp-editor__icon timestamp-editor__icon--remove\"\n                  onClick={this.handleRemoveTime(timeKey)}\n                />\n              )}\n            </Fragment>\n          ) : (\n            <i\n              className=\"fas fa-plus timestamp-editor__icon timestamp-editor__icon--add\"\n              onClick={this.handleAddTime(timeKey)}\n            />\n          )}\n        </div>\n      </div>\n    );\n  }\n\n  renderRepeater() {\n    const { repeaterType, repeaterValue, repeaterUnit } = this.props.timestamp.toJS();\n\n    return (\n      <div className=\"timestamp-editor__field-container\">\n        <div className=\"timestamp-editor__field-title\">Repeater</div>\n        <div className=\"timestamp-editor__field timestamp-editor__field--delay-repeater\">\n          {!!repeaterType ? (\n            <Fragment>\n              <div className=\"timestamp-editor__delay-repeater-type\">\n                <TabButtons\n                  buttons={['+', '++', '.+']}\n                  selectedButton={repeaterType || '+'}\n                  onSelect={this.handleRepeaterTypeChange}\n                />\n              </div>\n              <input\n                type=\"number\"\n                min=\"1\"\n                className=\"textfield delay-repeater-value-input\"\n                value={repeaterValue || 1}\n                onChange={this.handleRepeaterValueChange}\n              />\n              <div>\n                <TabButtons\n                  buttons={'hdwmy'.split('')}\n                  selectedButton={repeaterUnit || 'h'}\n                  onSelect={this.handleRepeaterUnitChange}\n                />\n              </div>\n              <i\n                className=\"fas fa-times fa-lg timestamp-editor__icon timestamp-editor__icon--remove\"\n                onClick={this.handleRemoveRepeater}\n              />\n            </Fragment>\n          ) : (\n            <i\n              className=\"fas fa-plus timestamp-editor__icon timestamp-editor__icon--add\"\n              onClick={this.handleAddRepeater}\n            />\n          )}\n        </div>\n      </div>\n    );\n  }\n\n  renderDelay() {\n    const { delayType, delayValue, delayUnit } = this.props.timestamp.toJS();\n\n    return (\n      <div className=\"timestamp-editor__field-container\">\n        <div className=\"timestamp-editor__field-title\">Delay</div>\n        <div className=\"timestamp-editor__field\">\n          {!!delayType ? (\n            <Fragment>\n              <div className=\"timestamp-editor__delay-repeater-type\">\n                <TabButtons\n                  buttons={['-', '--']}\n                  selectedButton={delayType || '-'}\n                  onSelect={this.handleDelayTypeChange}\n                />\n              </div>\n              <input\n                type=\"number\"\n                min=\"1\"\n                className=\"textfield delay-repeater-value-input\"\n                value={delayValue || 1}\n                onChange={this.handleDelayValueChange}\n              />\n              <div>\n                <TabButtons\n                  buttons={'hdwmy'.split('')}\n                  selectedButton={delayUnit || 'h'}\n                  onSelect={this.handleDelayUnitChange}\n                />\n              </div>\n              <i\n                className=\"fas fa-times fa-lg timestamp-editor__icon timestamp-editor__icon--remove\"\n                onClick={this.handleRemoveDelay}\n              />\n            </Fragment>\n          ) : (\n            <i\n              className=\"fas fa-plus timestamp-editor__icon timestamp-editor__icon--add\"\n              onClick={this.handleAddDelay}\n            />\n          )}\n        </div>\n      </div>\n    );\n  }\n\n  render() {\n    const { timestamp } = this.props;\n    const { isActive, year, month, day, startHour, startMinute, endHour, endMinute } =\n      timestamp.toJS();\n\n    return (\n      <div>\n        <div className=\"timestamp-editor__render\">{renderAsText(timestamp)}</div>\n\n        <div className=\"timestamp-editor__date-time-fields-container\">\n          <div className=\"timestamp-editor__field-container timestamp-editor__field-container--inline\">\n            <div className=\"timestamp-editor__field-title\">Active</div>\n            <div className=\"timestamp-editor__field\">\n              <Switch isEnabled={isActive} onToggle={this.handleActiveToggle} />\n            </div>\n          </div>\n\n          <div className=\"timestamp-editor__field-container timestamp-editor__field-container--inline\">\n            <div className=\"timestamp-editor__field-title\">Date</div>\n            <div className=\"timestamp-editor__field\">\n              <input\n                type=\"date\"\n                className=\"timestamp-editor__date-input\"\n                onChange={this.handleDateChange}\n                value={`${year}-${month}-${day}`}\n              />\n            </div>\n          </div>\n\n          {this.renderTimeField('Start time', 'start', startHour, startMinute, !endHour)}\n          {!!startHour && this.renderTimeField('End time', 'end', endHour, endMinute)}\n        </div>\n\n        {this.renderRepeater()}\n        {this.renderDelay()}\n      </div>\n    );\n  }\n}\n","import React, { PureComponent, Fragment } from 'react';\n\nimport './stylesheet.css';\n\nimport TimestampEditor from './components/TimestampEditor';\nimport Drawer from '../../../UI/Drawer/';\n\nimport _ from 'lodash';\nimport formatDate from 'date-fns/format';\nimport { Map } from 'immutable';\n\nexport default class TimestampEditorModal extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, ['handleAddEndTimestamp', 'handleRemoveEndTimestamp']);\n  }\n\n  handleChange(key) {\n    return newTimestamp => this.props.onChange(this.props.timestamp.set(key, newTimestamp));\n  }\n\n  handleAddEndTimestamp() {\n    const { timestamp } = this.props;\n    const [year, month, day, dayName] = formatDate(new Date(), 'YYYY MM DD ddd').split(' ');\n    this.props.onChange(\n      timestamp.set(\n        'secondTimestamp',\n        Map({\n          year,\n          month,\n          day,\n          dayName,\n          isActive: timestamp.getIn(['firstTimestamp', 'isActive']),\n        })\n      )\n    );\n  }\n\n  handleRemoveEndTimestamp() {\n    this.props.onChange(this.props.timestamp.set('secondTimestamp', null));\n  }\n\n  render() {\n    const { timestamp, onClose, singleTimestampOnly } = this.props;\n\n    return (\n      <Drawer onClose={onClose}>\n        <h2 className=\"timestamp-editor__title\">Edit timestamp</h2>\n\n        <TimestampEditor\n          timestamp={timestamp.get('firstTimestamp')}\n          onChange={this.handleChange('firstTimestamp')}\n        />\n\n        {!singleTimestampOnly &&\n          (!!timestamp.get('secondTimestamp') ? (\n            <Fragment>\n              <div className=\"timestamp-editor__separator\">\n                <div className=\"timestamp-editor__separator__margin-line\" />\n                to\n                <div className=\"timestamp-editor__separator__margin-line\" />\n              </div>\n\n              <TimestampEditor\n                timestamp={timestamp.get('secondTimestamp')}\n                onChange={this.handleChange('secondTimestamp')}\n              />\n\n              <div className=\"timestamp-editor__button-container\">\n                <button\n                  className=\"btn timestamp-editor__add-new-button\"\n                  onClick={this.handleRemoveEndTimestamp}\n                >\n                  Remove end timestamp\n                </button>\n              </div>\n            </Fragment>\n          ) : (\n            <div className=\"timestamp-editor__button-container\">\n              <button\n                className=\"btn timestamp-editor__add-new-button\"\n                onClick={this.handleAddEndTimestamp}\n              >\n                Add end timestamp\n              </button>\n            </div>\n          ))}\n\n        <br />\n      </Drawer>\n    );\n  }\n}\n","import React, { PureComponent, Fragment } from 'react';\n\nimport './stylesheet.css';\n\nimport Drawer from '../../../UI/Drawer';\n\nimport { attributedStringToRawText } from '../../../../lib/export_org';\nimport generateId from '../../../../lib/id_generator';\nimport { parseMarkupAndCookies } from '../../../../lib/parse_org';\n\nimport { Droppable, Draggable } from 'react-beautiful-dnd';\nimport classNames from 'classnames';\nimport { fromJS } from 'immutable';\nimport _ from 'lodash';\n\nexport default class PropertyListEditorModal extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, ['handleAddNewItem']);\n  }\n\n  componentDidUpdate(prevProps) {\n    const prevItems = prevProps.propertyListItems;\n    const currentItems = this.props.propertyListItems;\n    if (prevItems.size === currentItems.size - 1 && currentItems.last().get('property') === '') {\n      if (this.lastTextfield) {\n        this.lastTextfield.focus();\n      }\n    }\n  }\n\n  handlePropertyChange(propertyListItemId) {\n    return event => {\n      const propertyListItemIndex = this.props.propertyListItems.findIndex(\n        propertyListItem => propertyListItem.get('id') === propertyListItemId\n      );\n      this.props.onChange(\n        this.props.propertyListItems.setIn([propertyListItemIndex, 'property'], event.target.value)\n      );\n    };\n  }\n\n  handleValueChange(propertyListItemId) {\n    return event => {\n      const { propertyListItems, onChange } = this.props;\n\n      const propertyListItemIndex = propertyListItems.findIndex(\n        propertyListItem => propertyListItem.get('id') === propertyListItemId\n      );\n      onChange(\n        propertyListItems.setIn(\n          [propertyListItemIndex, 'value'],\n          fromJS(parseMarkupAndCookies(event.target.value))\n        )\n      );\n    };\n  }\n\n  handleRemoveItem(propertyListItemId) {\n    return () =>\n      this.props.onChange(\n        this.props.propertyListItems.filter(\n          propertyListItem => propertyListItem.get('id') !== propertyListItemId\n        )\n      );\n  }\n\n  handleAddNewItem() {\n    this.props.onChange(\n      this.props.propertyListItems.push(\n        fromJS({\n          property: '',\n          value: '',\n          id: generateId(),\n        })\n      )\n    );\n  }\n\n  render() {\n    const { onClose, propertyListItems } = this.props;\n\n    return (\n      <Drawer onClose={onClose}>\n        <h2 className=\"drawer-modal__title\">Edit property list</h2>\n\n        {propertyListItems.size === 0 ? (\n          <div className=\"no-items-message\">\n            There are no items in this property list.\n            <br />\n            <br />\n            Click the <i className=\"fas fa-plus\" /> button to add a new one.\n          </div>\n        ) : (\n          <Droppable droppableId=\"property-list-editor-droppable\" type=\"PROPERTY-LIST\">\n            {(provided, snapshot) => (\n              <div\n                className=\"property-list-editor__items-container\"\n                ref={provided.innerRef}\n                {...provided.droppableProps}\n              >\n                <Fragment>\n                  {propertyListItems.map((propertyListItem, index) => (\n                    <Draggable\n                      draggableId={`property-list-item--${index}`}\n                      index={index}\n                      key={propertyListItem.get('id')}\n                    >\n                      {(provided, snapshot) => (\n                        <div\n                          className={classNames('property-list-editor__item-container', {\n                            'property-list-editor__item-container--dragging': snapshot.isDragging,\n                          })}\n                          ref={provided.innerRef}\n                          {...provided.draggableProps}\n                        >\n                          <div className=\"item__textfields-container\">\n                            <input\n                              type=\"text\"\n                              className=\"textfield item-container__textfield\"\n                              value={propertyListItem.get('property')}\n                              onChange={this.handlePropertyChange(propertyListItem.get('id'))}\n                              ref={textfield => (this.lastTextfield = textfield)}\n                            />\n                            <input\n                              type=\"text\"\n                              className=\"textfield item-container__textfield\"\n                              value={attributedStringToRawText(propertyListItem.get('value'))}\n                              onChange={this.handleValueChange(propertyListItem.get('id'))}\n                            />\n                          </div>\n                          <div className=\"item-container__actions-container\">\n                            <i\n                              className=\"fas fa-times fa-lg\"\n                              onClick={this.handleRemoveItem(propertyListItem.get('id'))}\n                            />\n                            <i\n                              className=\"fas fa-bars fa-lg item-container__drag-handle drag-handle\"\n                              {...provided.dragHandleProps}\n                            />\n                          </div>\n                        </div>\n                      )}\n                    </Draggable>\n                  ))}\n\n                  {provided.placeholder}\n                </Fragment>\n              </div>\n            )}\n          </Droppable>\n        )}\n\n        <div className=\"property-list-editor__add-new-container\">\n          <button className=\"fas fa-plus fa-lg btn btn--circle\" onClick={this.handleAddNewItem} />\n        </div>\n      </Drawer>\n    );\n  }\n}\n","import React, { PureComponent, Fragment } from 'react';\n\nimport './stylesheet.css';\n\nimport TitleLine from '../../../TitleLine';\n\nimport { isTodoKeywordCompleted } from '../../../../../../lib/org_utils';\nimport {\n  dateForTimestamp,\n  subtractTimestampUnitFromDate,\n  addTimestampUnitToDate,\n} from '../../../../../../lib/timestamps';\n\nimport {\n  isToday,\n  startOfDay,\n  endOfDay,\n  isBefore,\n  isAfter,\n  isEqual,\n  isWithinRange,\n  isPast,\n  distanceInWordsToNow,\n} from 'date-fns';\nimport formatDate from 'date-fns/format';\nimport classNames from 'classnames';\n\nexport default class AgendaDay extends PureComponent {\n  handleHeaderClick(headerId) {\n    return () => this.props.onHeaderClick(headerId);\n  }\n\n  render() {\n    const {\n      date,\n      headers,\n      todoKeywordSets,\n      dateDisplayType,\n      onToggleDateDisplayType,\n      agendaDefaultDeadlineDelayValue,\n      agendaDefaultDeadlineDelayUnit,\n    } = this.props;\n\n    const dateStart = startOfDay(date);\n    const dateEnd = endOfDay(date);\n\n    const planningItemsAndHeaders = headers\n      .flatMap(header => {\n        const planningItemsforDate = header.get('planningItems').filter(planningItem => {\n          const timestamp = planningItem.get('timestamp');\n          if (!timestamp.get('isActive')) {\n            return false;\n          }\n\n          const planningItemDate = dateForTimestamp(timestamp);\n          const isCompletedTodo =\n            !!header.getIn(['titleLine', 'todoKeyword']) &&\n            isTodoKeywordCompleted(todoKeywordSets, header.getIn(['titleLine', 'todoKeyword']));\n          if (isCompletedTodo) {\n            return false;\n          }\n\n          if (planningItem.get('type') === 'DEADLINE') {\n            if (isToday(date)) {\n              if (isBefore(planningItemDate, new Date())) {\n                return true;\n              }\n\n              const [delayValue, delayUnit] = !!timestamp.get('delayType')\n                ? [timestamp.get('delayValue'), timestamp.get('delayUnit')]\n                : [agendaDefaultDeadlineDelayValue, agendaDefaultDeadlineDelayUnit];\n\n              const appearDate = subtractTimestampUnitFromDate(\n                planningItemDate,\n                delayValue,\n                delayUnit\n              );\n              return isAfter(date, appearDate) || isEqual(date, appearDate);\n            } else {\n              return isWithinRange(planningItemDate, dateStart, dateEnd);\n            }\n          } else if (planningItem.get('type') === 'SCHEDULED') {\n            let appearDate = planningItemDate;\n            if (!!timestamp.get('delayType')) {\n              const hasBeenRepeated = header\n                .get('propertyListItems')\n                .some(propertyListItem => propertyListItem.get('property') === 'LAST_REPEAT');\n              if (timestamp.get('delayType') === '--' && !hasBeenRepeated) {\n                appearDate = addTimestampUnitToDate(\n                  planningItemDate,\n                  timestamp.get('delayValue'),\n                  timestamp.get('delayUnit')\n                );\n              }\n            }\n\n            if (isToday(date) && isAfter(date, appearDate)) {\n              return true;\n            }\n\n            return isWithinRange(appearDate, dateStart, dateEnd);\n          } else {\n            return false;\n          }\n        });\n\n        return planningItemsforDate.map(planningItem => [planningItem, header]);\n      })\n      .sortBy(([planningItem, header]) => {\n        const { startHour, startMinute, endHour, endMinute, month, day } = planningItem\n          .get('timestamp')\n          .toJS();\n\n        return [!!startHour ? 0 : 1, startHour, startMinute, endHour, endMinute, month, day];\n      });\n\n    return (\n      <div className=\"agenda-day__container\">\n        <div className=\"agenda-day__title\">\n          {isToday(date) && <div className=\"agenda-day__today-indicator\" />}\n          <div className=\"agenda-day__title__day-name\">{formatDate(date, 'dddd')}</div>\n          <div className=\"agenda-day__title__date\">{formatDate(date, 'MMMM Do, YYYY')}</div>\n        </div>\n\n        <div className=\"agenda-day__headers-container\">\n          {planningItemsAndHeaders.map(([planningItem, header]) => {\n            const planningItemDate = dateForTimestamp(planningItem.get('timestamp'));\n            const hasTodoKeyword = !!header.getIn(['titleLine', 'todoKeyword']);\n\n            const dateClassName = classNames('agenda-day__header-planning-date', {\n              'agenda-day__header-planning-date--overdue':\n                hasTodoKeyword && isPast(planningItemDate),\n            });\n\n            return (\n              <div key={planningItem.get('id')} className=\"agenda-day__header-container\">\n                <div className=\"agenda-day__header__planning-item-container\">\n                  <div className=\"agenda-day__header-planning-type\">{planningItem.get('type')}</div>\n                  <div className={dateClassName} onClick={onToggleDateDisplayType}>\n                    {dateDisplayType === 'absolute'\n                      ? formatDate(planningItemDate, 'MM/DD')\n                      : `${distanceInWordsToNow(planningItemDate)} ago`}\n\n                    {!!planningItem.getIn(['timestamp', 'startHour']) && (\n                      <Fragment>\n                        <br />\n                        {formatDate(planningItemDate, 'h:mma')}\n                      </Fragment>\n                    )}\n                  </div>\n                </div>\n                <div className=\"agenda-day__header__header-container\">\n                  <TitleLine\n                    header={header}\n                    color=\"black\"\n                    hasContent={false}\n                    isSelected={false}\n                    shouldDisableActions\n                    shouldDisableExplicitWidth\n                    onClick={this.handleHeaderClick(header.get('id'))}\n                  />\n                </div>\n              </div>\n            );\n          })}\n        </div>\n      </div>\n    );\n  }\n}\n","import React, { PureComponent } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport './stylesheet.css';\n\nimport AgendaDay from './components/AgendaDay';\nimport Drawer from '../../../UI/Drawer';\nimport TabButtons from '../../../UI/TabButtons';\n\nimport * as orgActions from '../../../../actions/org';\n\nimport _ from 'lodash';\nimport {\n  addDays,\n  addWeeks,\n  addMonths,\n  subDays,\n  subWeeks,\n  subMonths,\n  startOfWeek,\n  startOfMonth,\n  getDaysInMonth,\n} from 'date-fns';\nimport formatDate from 'date-fns/format';\n\nclass AgendaModal extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, [\n      'handleTimeframeTypeChange',\n      'handleNextDateClick',\n      'handlePreviousDateClick',\n      'handleHeaderClick',\n      'handleToggleDateDisplayType',\n    ]);\n\n    this.state = {\n      selectedDate: new Date(),\n      timeframeType: 'Week',\n      dateDisplayType: 'absolute',\n    };\n  }\n\n  handleTimeframeTypeChange(timeframeType) {\n    this.setState({ timeframeType });\n  }\n\n  handleNextDateClick() {\n    const { selectedDate, timeframeType } = this.state;\n\n    switch (timeframeType) {\n      case 'Day':\n        this.setState({ selectedDate: addDays(selectedDate, 1) });\n        break;\n      case 'Week':\n        this.setState({ selectedDate: addWeeks(selectedDate, 1) });\n        break;\n      case 'Month':\n        this.setState({ selectedDate: addMonths(selectedDate, 1) });\n        break;\n      default:\n        return '';\n    }\n  }\n\n  handleHeaderClick(headerId) {\n    this.props.onClose();\n    this.props.org.selectHeaderAndOpenParents(headerId);\n  }\n\n  handlePreviousDateClick() {\n    const { selectedDate, timeframeType } = this.state;\n\n    switch (timeframeType) {\n      case 'Day':\n        this.setState({ selectedDate: subDays(selectedDate, 1) });\n        break;\n      case 'Week':\n        this.setState({ selectedDate: subWeeks(selectedDate, 1) });\n        break;\n      case 'Month':\n        this.setState({ selectedDate: subMonths(selectedDate, 1) });\n        break;\n      default:\n        return '';\n    }\n  }\n\n  handleToggleDateDisplayType() {\n    const { dateDisplayType } = this.state;\n\n    this.setState({\n      dateDisplayType: dateDisplayType === 'absolute' ? 'relative' : 'absolute',\n    });\n  }\n\n  calculateTimeframeHeader() {\n    const { selectedDate, timeframeType } = this.state;\n\n    switch (timeframeType) {\n      case 'Day':\n        return formatDate(selectedDate, 'MMMM Do');\n      case 'Week':\n        const weekStart = startOfWeek(selectedDate);\n        const weekEnd = addWeeks(weekStart, 1);\n        return `${formatDate(weekStart, 'MMM Do')} - ${formatDate(\n          weekEnd,\n          'MMM Do'\n        )} (W${formatDate(weekStart, 'W')})`;\n      case 'Month':\n        return formatDate(selectedDate, 'MMMM');\n      default:\n        return '';\n    }\n  }\n\n  render() {\n    const {\n      onClose,\n      headers,\n      todoKeywordSets,\n      agendaDefaultDeadlineDelayValue,\n      agendaDefaultDeadlineDelayUnit,\n    } = this.props;\n    const { timeframeType, selectedDate, dateDisplayType } = this.state;\n\n    let dates = [];\n    switch (timeframeType) {\n      case 'Day':\n        dates = [selectedDate];\n        break;\n      case 'Week':\n        const weekStart = startOfWeek(selectedDate);\n        dates = _.range(7).map(daysAfter => addDays(weekStart, daysAfter));\n        break;\n      case 'Month':\n        const monthStart = startOfMonth(selectedDate);\n        dates = _.range(getDaysInMonth(selectedDate)).map(daysAfter =>\n          addDays(monthStart, daysAfter)\n        );\n        break;\n      default:\n    }\n\n    return (\n      <Drawer onClose={onClose}>\n        <h2 className=\"agenda__title\">Agenda</h2>\n\n        <div className=\"agenda__tab-container\">\n          <TabButtons\n            buttons={['Day', 'Week', 'Month']}\n            selectedButton={timeframeType}\n            onSelect={this.handleTimeframeTypeChange}\n            useEqualWidthTabs\n          />\n        </div>\n\n        <div className=\"agenda__timeframe-header-container\">\n          <i className=\"fas fa-chevron-left fa-lg\" onClick={this.handlePreviousDateClick} />\n          <div className=\"agenda__timeframe-header\">{this.calculateTimeframeHeader()}</div>\n          <i className=\"fas fa-chevron-right fa-lg\" onClick={this.handleNextDateClick} />\n        </div>\n\n        <div className=\"agenda__days-container\">\n          {dates.map(date => (\n            <AgendaDay\n              key={formatDate(date)}\n              date={date}\n              headers={headers}\n              onHeaderClick={this.handleHeaderClick}\n              todoKeywordSets={todoKeywordSets}\n              dateDisplayType={dateDisplayType}\n              onToggleDateDisplayType={this.handleToggleDateDisplayType}\n              agendaDefaultDeadlineDelayValue={agendaDefaultDeadlineDelayValue}\n              agendaDefaultDeadlineDelayUnit={agendaDefaultDeadlineDelayUnit}\n            />\n          ))}\n        </div>\n\n        <br />\n      </Drawer>\n    );\n  }\n}\n\nconst mapStateToProps = state => ({\n  todoKeywordSets: state.org.present.get('todoKeywordSets'),\n  agendaDefaultDeadlineDelayValue: state.base.get('agendaDefaultDeadlineDelayValue') || 5,\n  agendaDefaultDeadlineDelayUnit: state.base.get('agendaDefaultDeadlineDelayUnit') || 'd',\n});\n\nconst mapDispatchToProps = dispatch => ({\n  org: bindActionCreators(orgActions, dispatch),\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(AgendaModal);\n","const DEFAULT_BINDINGS = [\n  ['Select next header', 'selectNextVisibleHeader', 'ctrl+n'],\n  ['Select previous header', 'selectPreviousVisibleHeader', 'ctrl+p'],\n  ['Toggle header opened', 'toggleHeaderOpened', 'tab'],\n  ['Advance todo state', 'advanceTodo', 'ctrl+t'],\n  ['Edit title', 'editTitle', 'ctrl+h'],\n  ['Edit description', 'editDescription', 'ctrl+d'],\n  ['Exit edit mode', 'exitEditMode', 'command+enter'],\n  ['Add header', 'addHeader', 'ctrl+enter'],\n  ['Remove header', 'removeHeader', 'backspace'],\n  ['Move header up', 'moveHeaderUp', 'ctrl+command+p'],\n  ['Move header down', 'moveHeaderDown', 'ctrl+command+n'],\n  ['Move header left', 'moveHeaderLeft', 'ctrl+command+b'],\n  ['Move header right', 'moveHeaderRight', 'ctrl+command+f'],\n  ['Undo', 'undo', 'ctrl+shift+-'],\n];\n\nexport const calculateNamedKeybindings = customKeybindings =>\n  DEFAULT_BINDINGS.map(([bindingName, _bindingAction, binding]) => [\n    bindingName,\n    customKeybindings.get(bindingName, binding),\n  ]);\n\nexport const calculateActionedKeybindings = customKeybindings =>\n  DEFAULT_BINDINGS.map(([bindingName, bindingAction, binding]) => [\n    bindingAction,\n    customKeybindings.get(bindingName, binding),\n  ]);\n","/* global ga */\r\n\r\nimport React, { PureComponent, Fragment } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport { Redirect } from 'react-router-dom';\r\n\r\nimport { HotKeys } from 'react-hotkeys';\r\n\r\nimport './stylesheet.css';\r\n\r\nimport HeaderList from './components/HeaderList';\r\nimport ActionDrawer from './components/ActionDrawer';\r\nimport CaptureModal from './components/CaptureModal';\r\nimport SyncConfirmationModal from './components/SyncConfirmationModal';\r\nimport TagsEditorModal from './components/TagsEditorModal';\r\nimport TimestampEditorModal from './components/TimestampEditorModal';\r\nimport PropertyListEditorModal from './components/PropertyListEditorModal';\r\nimport AgendaModal from './components/AgendaModal';\r\n\r\nimport * as baseActions from '../../actions/base';\r\nimport * as syncBackendActions from '../../actions/sync_backend';\r\nimport * as orgActions from '../../actions/org';\r\nimport * as captureActions from '../../actions/capture';\r\nimport { ActionCreators as undoActions } from 'redux-linear-undo';\r\n\r\nimport sampleCaptureTemplates from '../../lib/sample_capture_templates';\r\nimport { calculateActionedKeybindings } from '../../lib/keybindings';\r\nimport { timestampWithId, headerWithId } from '../../lib/org_utils';\r\n\r\nimport _ from 'lodash';\r\nimport { fromJS, OrderedSet } from 'immutable';\r\n\r\nclass OrgFile extends PureComponent {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    _.bindAll(this, [\r\n      'handleSelectNextVisibleHeaderHotKey',\r\n      'handleSelectPreviousVisibleHeaderHotKey',\r\n      'handleToggleHeaderOpenedHotKey',\r\n      'handleAdvanceTodoHotKey',\r\n      'handleEditTitleHotKey',\r\n      'handleEditDescriptionHotKey',\r\n      'handleExitEditModeHotKey',\r\n      'handleAddHeaderHotKey',\r\n      'handleRemoveHeaderHotKey',\r\n      'handleMoveHeaderUpHotKey',\r\n      'handleMoveHeaderDownHotKey',\r\n      'handleMoveHeaderLeftHotKey',\r\n      'handleMoveHeaderRightHotKey',\r\n      'handleUndoHotKey',\r\n      'handleContainerRef',\r\n      'handleCapture',\r\n      'handlePopupClose',\r\n      'handleSyncConfirmationPull',\r\n      'handleSyncConfirmationPush',\r\n      'handleSyncConfirmationCancel',\r\n      'handleTagsChange',\r\n      'handlePropertyListItemsChange',\r\n    ]);\r\n\r\n    this.state = {\r\n      hasUncaughtError: false,\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    const { staticFile, path, loadedPath } = this.props;\r\n\r\n    if (!!staticFile) {\r\n      this.props.base.loadStaticFile(staticFile);\r\n\r\n      if (staticFile === 'changelog') {\r\n        this.props.base.setHasUnseenChangelog(false);\r\n      }\r\n\r\n      setTimeout(() => (document.querySelector('html').scrollTop = 0), 0);\r\n    } else if (!!path && path !== loadedPath) {\r\n      this.props.syncBackend.downloadFile(path);\r\n    }\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    const { staticFile } = this.props;\r\n\r\n    if (!!staticFile) {\r\n      this.props.base.unloadStaticFile();\r\n    } else {\r\n      this.props.org.stopDisplayingFile();\r\n    }\r\n  }\r\n\r\n  componentDidUpdate() {\r\n    const { headers, pendingCapture } = this.props;\r\n    if (!!pendingCapture && !!headers && headers.size > 0) {\r\n      this.props.org.insertPendingCapture();\r\n    }\r\n  }\r\n\r\n  componentDidCatch(error) {\r\n    ga('send', 'event', 'error', 'OrgFile componentDidCatch', error);\r\n\r\n    this.setState({ hasUncaughtError: true });\r\n  }\r\n\r\n  handleSelectNextVisibleHeaderHotKey() {\r\n    this.props.org.selectNextVisibleHeader();\r\n  }\r\n\r\n  handleSelectPreviousVisibleHeaderHotKey() {\r\n    this.props.org.selectPreviousVisibleHeader();\r\n  }\r\n\r\n  handleToggleHeaderOpenedHotKey() {\r\n    const { selectedHeaderId } = this.props;\r\n\r\n    if (selectedHeaderId) {\r\n      this.props.org.toggleHeaderOpened(selectedHeaderId);\r\n    }\r\n  }\r\n\r\n  handleAdvanceTodoHotKey() {\r\n    this.props.org.advanceTodoState();\r\n  }\r\n\r\n  handleEditTitleHotKey() {\r\n    this.props.org.enterEditMode('title');\r\n  }\r\n\r\n  handleEditDescriptionHotKey() {\r\n    this.props.org.openHeader(this.props.selectedHeaderId);\r\n    this.props.org.enterEditMode('description');\r\n  }\r\n\r\n  handleExitEditModeHotKey() {\r\n    this.props.org.exitEditMode();\r\n    this.container.focus();\r\n  }\r\n\r\n  handleAddHeaderHotKey() {\r\n    this.props.org.addHeaderAndEdit(this.props.selectedHeaderId);\r\n  }\r\n\r\n  handleRemoveHeaderHotKey() {\r\n    const { selectedHeaderId } = this.props;\r\n\r\n    this.props.org.selectNextSiblingHeader(selectedHeaderId);\r\n    this.props.org.removeHeader(selectedHeaderId);\r\n  }\r\n\r\n  handleMoveHeaderUpHotKey() {\r\n    this.props.org.moveHeaderUp(this.props.selectedHeaderId);\r\n  }\r\n\r\n  handleMoveHeaderDownHotKey() {\r\n    this.props.org.moveHeaderDown(this.props.selectedHeaderId);\r\n  }\r\n\r\n  handleMoveHeaderLeftHotKey() {\r\n    this.props.org.moveHeaderLeft(this.props.selectedHeaderId);\r\n  }\r\n\r\n  handleMoveHeaderRightHotKey() {\r\n    this.props.org.moveHeaderRight(this.props.selectedHeaderId);\r\n  }\r\n\r\n  handleUndoHotKey() {\r\n    this.props.undo.undo();\r\n  }\r\n\r\n  handleContainerRef(container) {\r\n    this.container = container;\r\n    if (this.container) {\r\n      this.container.focus();\r\n    }\r\n  }\r\n\r\n  handleCapture(templateId, content, shouldPrepend) {\r\n    this.props.org.insertCapture(templateId, content, shouldPrepend);\r\n  }\r\n\r\n  handlePopupClose() {\r\n    this.props.base.closePopup();\r\n  }\r\n\r\n  handleSyncConfirmationPull() {\r\n    this.props.org.sync({ forceAction: 'pull' });\r\n    this.props.base.closePopup();\r\n  }\r\n\r\n  handleSyncConfirmationPush() {\r\n    this.props.org.sync({ forceAction: 'push' });\r\n    this.props.base.closePopup();\r\n  }\r\n\r\n  handleSyncConfirmationCancel() {\r\n    this.props.base.closePopup();\r\n  }\r\n\r\n  handleTagsChange(newTags) {\r\n    this.props.org.setHeaderTags(this.props.selectedHeaderId, newTags);\r\n  }\r\n\r\n  handlePropertyListItemsChange(newPropertyListItems) {\r\n    this.props.org.updatePropertyListItems(\r\n      this.props.activePopupData.get('headerId'),\r\n      newPropertyListItems\r\n    );\r\n  }\r\n\r\n  handleTimestampChange(popupData) {\r\n    if (!!popupData.get('timestampId')) {\r\n      return newTimestamp =>\r\n        this.props.org.updateTimestampWithId(popupData.get('timestampId'), newTimestamp);\r\n    } else {\r\n      return newTimestamp =>\r\n        this.props.org.updatePlanningItemTimestamp(\r\n          popupData.get('headerId'),\r\n          popupData.get('planningItemIndex'),\r\n          newTimestamp.get('firstTimestamp')\r\n        );\r\n    }\r\n  }\r\n\r\n  renderActivePopup() {\r\n    const { activePopupType, activePopupData, captureTemplates, headers, selectedHeader } =\r\n      this.props;\r\n\r\n    switch (activePopupType) {\r\n      case 'sync-confirmation':\r\n        return (\r\n          <SyncConfirmationModal\r\n            lastServerModifiedAt={activePopupData.get('lastServerModifiedAt')}\r\n            onPull={this.handleSyncConfirmationPull}\r\n            onPush={this.handleSyncConfirmationPush}\r\n            onCancel={this.handleSyncConfirmationCancel}\r\n          />\r\n        );\r\n      case 'capture':\r\n        return (\r\n          <CaptureModal\r\n            template={captureTemplates.find(\r\n              template => template.get('id') === activePopupData.get('templateId')\r\n            )}\r\n            headers={headers}\r\n            onCapture={this.handleCapture}\r\n            onClose={this.handlePopupClose}\r\n          />\r\n        );\r\n      case 'tags-editor':\r\n        return !!selectedHeader ? (\r\n          <TagsEditorModal\r\n            header={selectedHeader}\r\n            allTags={OrderedSet(\r\n              headers.flatMap(header => header.getIn(['titleLine', 'tags']))\r\n            ).sort()}\r\n            onClose={this.handlePopupClose}\r\n            onChange={this.handleTagsChange}\r\n          />\r\n        ) : null;\r\n      case 'timestamp-editor':\r\n        let editingTimestamp = null;\r\n        if (activePopupData.get('timestampId')) {\r\n          editingTimestamp = timestampWithId(headers, activePopupData.get('timestampId'));\r\n        } else {\r\n          editingTimestamp = fromJS({\r\n            firstTimestamp: headerWithId(headers, activePopupData.get('headerId')).getIn([\r\n              'planningItems',\r\n              activePopupData.get('planningItemIndex'),\r\n              'timestamp',\r\n            ]),\r\n          });\r\n        }\r\n\r\n        return (\r\n          <TimestampEditorModal\r\n            timestamp={editingTimestamp}\r\n            singleTimestampOnly={!activePopupData.get('timestampId')}\r\n            onClose={this.handlePopupClose}\r\n            onChange={this.handleTimestampChange(activePopupData)}\r\n          />\r\n        );\r\n\r\n      case 'property-list-editor':\r\n        return (\r\n          <PropertyListEditorModal\r\n            onClose={this.handlePopupClose}\r\n            onChange={this.handlePropertyListItemsChange}\r\n            propertyListItems={headerWithId(headers, activePopupData.get('headerId')).get(\r\n              'propertyListItems'\r\n            )}\r\n          />\r\n        );\r\n      case 'agenda':\r\n        return <AgendaModal onClose={this.handlePopupClose} headers={headers} />;\r\n      default:\r\n        return null;\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const {\r\n      headers,\r\n      shouldDisableDirtyIndicator,\r\n      shouldDisableSyncButtons,\r\n      shouldDisableActions,\r\n      isDirty,\r\n      parsingErrorMessage,\r\n      path,\r\n      staticFile,\r\n      customKeybindings,\r\n      inEditMode,\r\n      orgFileErrorMessage,\r\n    } = this.props;\r\n\r\n    if (!path && !staticFile) {\r\n      return <Redirect to=\"/files\" />;\r\n    }\r\n\r\n    if (this.state.hasUncaughtError) {\r\n      return (\r\n        <div className=\"error-message-container\">\r\n          Uh oh, you ran into a bug!\r\n          <br />\r\n          <br />\r\n          This was probably the result of an error in attempting to parse your org file. It'd be\r\n          super helpful if you could{' '}\r\n          <a\r\n            href=\"https://github.com/DanielDe/org-web/issues/new\"\r\n            target=\"_blank\"\r\n            rel=\"noopener noreferrer\"\r\n          >\r\n            create an issue\r\n          </a>{' '}\r\n          (and include the org file if possible!)\r\n        </div>\r\n      );\r\n    }\r\n\r\n    if (!!orgFileErrorMessage) {\r\n      return <div className=\"error-message-container\">{orgFileErrorMessage}</div>;\r\n    }\r\n\r\n    if (!headers) {\r\n      return <div />;\r\n    }\r\n\r\n    const keyMap = _.fromPairs(calculateActionedKeybindings(customKeybindings));\r\n\r\n    // Automatically call preventDefault on all the keyboard events that come through for\r\n    // these hotkeys.\r\n    const preventDefaultAndHandleEditMode =\r\n      (callback, ignoreInEditMode = false) =>\r\n      event => {\r\n        if (ignoreInEditMode && inEditMode) {\r\n          return;\r\n        }\r\n\r\n        if (ignoreInEditMode && ['TEXTAREA', 'INPUT'].includes(document.activeElement.nodeName)) {\r\n          return;\r\n        }\r\n\r\n        event.preventDefault();\r\n        callback(event);\r\n      };\r\n\r\n    const handlers = {\r\n      selectNextVisibleHeader: preventDefaultAndHandleEditMode(\r\n        this.handleSelectNextVisibleHeaderHotKey\r\n      ),\r\n      selectPreviousVisibleHeader: preventDefaultAndHandleEditMode(\r\n        this.handleSelectPreviousVisibleHeaderHotKey\r\n      ),\r\n      toggleHeaderOpened: preventDefaultAndHandleEditMode(\r\n        this.handleToggleHeaderOpenedHotKey,\r\n        true\r\n      ),\r\n      advanceTodo: preventDefaultAndHandleEditMode(this.handleAdvanceTodoHotKey),\r\n      editTitle: preventDefaultAndHandleEditMode(this.handleEditTitleHotKey),\r\n      editDescription: preventDefaultAndHandleEditMode(this.handleEditDescriptionHotKey),\r\n      exitEditMode: preventDefaultAndHandleEditMode(this.handleExitEditModeHotKey),\r\n      addHeader: preventDefaultAndHandleEditMode(this.handleAddHeaderHotKey),\r\n      removeHeader: preventDefaultAndHandleEditMode(this.handleRemoveHeaderHotKey, true),\r\n      moveHeaderUp: preventDefaultAndHandleEditMode(this.handleMoveHeaderUpHotKey),\r\n      moveHeaderDown: preventDefaultAndHandleEditMode(this.handleMoveHeaderDownHotKey),\r\n      moveHeaderLeft: preventDefaultAndHandleEditMode(this.handleMoveHeaderLeftHotKey),\r\n      moveHeaderRight: preventDefaultAndHandleEditMode(this.handleMoveHeaderRightHotKey),\r\n      undo: preventDefaultAndHandleEditMode(this.handleUndoHotKey),\r\n    };\r\n\r\n    return (\r\n      <HotKeys keyMap={keyMap} handlers={handlers}>\r\n        <div className=\"org-file-container\" tabIndex=\"-1\" ref={this.handleContainerRef}>\r\n          {headers.size === 0 ? (\r\n            <div className=\"org-file__parsing-error-message\">\r\n              <h3>Couldn't parse file</h3>\r\n\r\n              {!!parsingErrorMessage ? (\r\n                <Fragment>{parsingErrorMessage}</Fragment>\r\n              ) : (\r\n                <Fragment>\r\n                  If you think this is a bug, please{' '}\r\n                  <a\r\n                    href=\"https://github.com/DanielDe/org-web/issues/new\"\r\n                    target=\"_blank\"\r\n                    rel=\"noopener noreferrer\"\r\n                  >\r\n                    create an issue\r\n                  </a>{' '}\r\n                  and include the org file if possible!\r\n                </Fragment>\r\n              )}\r\n            </div>\r\n          ) : (\r\n            <HeaderList shouldDisableActions={shouldDisableActions} />\r\n          )}\r\n\r\n          {isDirty && !shouldDisableDirtyIndicator && (\r\n            <div className=\"dirty-indicator\">Unpushed changes</div>\r\n          )}\r\n\r\n          {!shouldDisableActions && (\r\n            <ActionDrawer\r\n              shouldDisableSyncButtons={shouldDisableSyncButtons}\r\n              staticFile={staticFile}\r\n            />\r\n          )}\r\n\r\n          {this.renderActivePopup()}\r\n        </div>\r\n      </HotKeys>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state, props) => {\r\n  const headers = state.org.present.get('headers');\r\n  const selectedHeaderId = state.org.present.get('selectedHeaderId');\r\n  const activePopup = state.base.get('activePopup');\r\n\r\n  return {\r\n    headers,\r\n    selectedHeaderId,\r\n    isDirty: state.org.present.get('isDirty'),\r\n    loadedPath: state.org.present.get('path'),\r\n    selectedHeader: headers && headers.find(header => header.get('id') === selectedHeaderId),\r\n    customKeybindings: state.base.get('customKeybindings'),\r\n    inEditMode: !!state.org.present.get('editMode'),\r\n    activePopupType: !!activePopup ? activePopup.get('type') : null,\r\n    activePopupData: !!activePopup ? activePopup.get('data') : null,\r\n    captureTemplates: state.capture.get('captureTemplates').concat(sampleCaptureTemplates),\r\n    pendingCapture: state.org.present.get('pendingCapture'),\r\n    orgFileErrorMessage: state.org.present.get('orgFileErrorMessage'),\r\n  };\r\n};\r\n\r\nconst mapDispatchToProps = dispatch => {\r\n  return {\r\n    base: bindActionCreators(baseActions, dispatch),\r\n    syncBackend: bindActionCreators(syncBackendActions, dispatch),\r\n    org: bindActionCreators(orgActions, dispatch),\r\n    undo: bindActionCreators(undoActions, dispatch),\r\n    capture: bindActionCreators(captureActions, dispatch),\r\n  };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(OrgFile);\r\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\nimport preval from 'preval.macro';\n\nimport { withRouter } from 'react-router-dom';\n\nimport * as syncBackendActions from '../../actions/sync_backend';\nimport * as baseActions from '../../actions/base';\n\nimport './stylesheet.css';\n\nimport TabButtons from '../UI/TabButtons';\nimport Switch from '../UI/Switch';\n\nconst Settings = ({\n  fontSize,\n  bulletStyle,\n  shouldTapTodoToAdvance,\n  shouldStoreSettingsInSyncBackend,\n  shouldLiveSync,\n  shouldSyncOnBecomingVisibile,\n  agendaDefaultDeadlineDelayValue,\n  agendaDefaultDeadlineDelayUnit,\n  hasUnseenChangelog,\n  syncBackend,\n  base,\n}) => {\n  const handleSignOutClick = () =>\n    window.confirm('Are you sure you want to sign out?') ? syncBackend.signOut() : void 0;\n\n  const handleKeyboardShortcutsClick = () => base.pushModalPage('keyboard_shortcuts_editor');\n\n  const handleCaptureTemplatesClick = () => base.pushModalPage('capture_templates_editor');\n\n  const handleFontSizeChange = newFontSize => base.setFontSize(newFontSize);\n\n  const handleBulletStyleChange = newBulletStyle => base.setBulletStyle(newBulletStyle);\n\n  const handleShouldTapTodoToAdvanceChange = () =>\n    base.setShouldTapTodoToAdvance(!shouldTapTodoToAdvance);\n\n  const handleAgendaDefaultDeadlineDelayValueChange = event =>\n    base.setAgendaDefaultDeadlineDelayValue(event.target.value);\n\n  const handleAgendaDefaultDeadlineDelayUnitChange = newDelayUnit =>\n    base.setAgendaDefaultDeadlineDelayUnit(newDelayUnit);\n\n  const handleShouldLiveSyncChange = () => base.setShouldLiveSync(!shouldLiveSync);\n\n  const handleShouldSyncOnBecomingVisibleChange = () =>\n    base.setShouldSyncOnBecomingVisibile(!shouldSyncOnBecomingVisibile);\n\n  const handleShouldStoreSettingsInSyncBackendChange = () =>\n    base.setShouldStoreSettingsInSyncBackend(!shouldStoreSettingsInSyncBackend);\n\n  const handleChangelogClick = () => base.pushModalPage('changelog');\n\n  const handleHelpClick = () => base.pushModalPage('sample');\n\n  const buildTimestamp = preval`module.exports = new Date().toLocaleString();`;\n\n  return (\n    <div className=\"settings-container\">\n      <div className=\"setting-container\">\n        <div className=\"setting-label\">Last built</div>\n        {buildTimestamp}\n      </div>\n\n      <div className=\"setting-container\">\n        <div className=\"setting-label\">Font size</div>\n        <TabButtons\n          buttons={['Regular', 'Large']}\n          selectedButton={fontSize}\n          onSelect={handleFontSizeChange}\n        />\n      </div>\n\n      <div className=\"setting-container\">\n        <div className=\"setting-label\">Bullet style</div>\n        <TabButtons\n          buttons={['Classic', 'Fancy']}\n          selectedButton={bulletStyle}\n          onSelect={handleBulletStyleChange}\n        />\n      </div>\n\n      <div className=\"setting-container\">\n        <div className=\"setting-label\">Tap TODO to advance state</div>\n        <Switch isEnabled={shouldTapTodoToAdvance} onToggle={handleShouldTapTodoToAdvanceChange} />\n      </div>\n\n      <div className=\"setting-container\">\n        <div className=\"setting-label\">\n          Live sync\n          <div className=\"setting-label__description\">\n            If enabled, changes are automatically pushed to the sync backend as you make them.\n          </div>\n        </div>\n        <Switch isEnabled={shouldLiveSync} onToggle={handleShouldLiveSyncChange} />\n      </div>\n\n      <div className=\"setting-container\">\n        <div className=\"setting-label\">\n          Sync on application becoming visible\n          <div className=\"setting-label__description\">\n            If enabled, the current org file is pulled from the sync backend when the browser tab\n            becomes visible. This prevents you from having a stale file before starting to make\n            changes to it.\n          </div>\n        </div>\n        <Switch\n          isEnabled={shouldSyncOnBecomingVisibile}\n          onToggle={handleShouldSyncOnBecomingVisibleChange}\n        />\n      </div>\n\n      <div className=\"setting-container\">\n        <div className=\"setting-label\">\n          Store settings in sync backend\n          <div className=\"setting-label__description\">\n            Store settings and keyboard shortcuts in a .org-web-config.json file in your sync\n            backend to sync betweeen multiple devices.\n          </div>\n        </div>\n        <Switch\n          isEnabled={shouldStoreSettingsInSyncBackend}\n          onToggle={handleShouldStoreSettingsInSyncBackendChange}\n        />\n      </div>\n\n      <div className=\"setting-container setting-container--vertical\">\n        <div className=\"setting-label\">Default DEADLINE warning period</div>\n\n        <div className=\"default-deadline-warning-container\">\n          <input\n            type=\"number\"\n            min=\"0\"\n            className=\"textfield default-deadline-value-textfield\"\n            value={agendaDefaultDeadlineDelayValue}\n            onChange={handleAgendaDefaultDeadlineDelayValueChange}\n          />\n\n          <TabButtons\n            buttons={'hdwmy'.split('')}\n            selectedButton={agendaDefaultDeadlineDelayUnit}\n            onSelect={handleAgendaDefaultDeadlineDelayUnitChange}\n          />\n        </div>\n      </div>\n      <div className=\"settings-buttons-container\">\n        <button className=\"btn settings-btn\" onClick={handleCaptureTemplatesClick}>\n          Capture templates\n        </button>\n        <button className=\"btn settings-btn\" onClick={handleKeyboardShortcutsClick}>\n          Keyboard shortcuts\n        </button>\n\n        <hr className=\"settings-button-separator\" />\n\n        <button className=\"btn settings-btn\" onClick={handleChangelogClick}>\n          Changelog\n          {hasUnseenChangelog && (\n            <div className=\"changelog-badge-container\">\n              <i className=\"fas fa-gift\" />\n            </div>\n          )}\n        </button>\n        <button className=\"btn settings-btn\" onClick={handleHelpClick}>\n          Help\n        </button>\n        <button className=\"btn settings-btn\">\n          <a\n            href=\"https://github.com/DanielDe/org-web\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n            style={{ color: 'white' }}\n          >\n            Github repo <i className=\"fas fa-external-link-alt fa-sm\" />\n          </a>\n        </button>\n\n        <hr className=\"settings-button-separator\" />\n\n        <button className=\"btn settings-btn\">\n          <a\n            href=\"http://eepurl.com/dK5F9w\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n            style={{ color: 'white' }}\n          >\n            Mailing list <i className=\"fas fa-external-link-alt fa-sm\" />\n          </a>\n        </button>\n\n        <div className=\"settings-button-help-text\">\n          Sign up for the mailing list if you're interested in getting occasional ({'<'}1 per week)\n          updates on org-web. Or take a look at some{' '}\n          <a\n            href=\"https://us19.campaign-archive.com/home/?u=36b9d8082ddb55e6cc7e22339&id=f427625e31\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n          >\n            past emails\n          </a>{' '}\n          before you sign up. You can unsubscribe at any time!\n        </div>\n\n        <button className=\"btn settings-btn\">\n          <a\n            href=\"https://twitter.com/org_web_org\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n            style={{ color: 'white' }}\n          >\n            Twitter <i className=\"fas fa-external-link-alt fa-sm\" />\n          </a>\n        </button>\n\n        <hr className=\"settings-button-separator\" />\n\n        <button className=\"btn settings-btn\" onClick={handleSignOutClick}>\n          Sign out\n        </button>\n      </div>\n    </div>\n  );\n};\n\nconst mapStateToProps = (state, props) => {\n  return {\n    fontSize: state.base.get('fontSize') || 'Regular',\n    bulletStyle: state.base.get('bulletStyle') || 'Classic',\n    shouldTapTodoToAdvance: state.base.get('shouldTapTodoToAdvance'),\n    agendaDefaultDeadlineDelayValue: state.base.get('agendaDefaultDeadlineDelayValue') || 5,\n    agendaDefaultDeadlineDelayUnit: state.base.get('agendaDefaultDeadlineDelayUnit') || 'd',\n    shouldStoreSettingsInSyncBackend: state.base.get('shouldStoreSettingsInSyncBackend'),\n    shouldLiveSync: state.base.get('shouldLiveSync'),\n    shouldSyncOnBecomingVisibile: state.base.get('shouldSyncOnBecomingVisibile'),\n    hasUnseenChangelog: state.base.get('hasUnseenChangelog'),\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    syncBackend: bindActionCreators(syncBackendActions, dispatch),\n    base: bindActionCreators(baseActions, dispatch),\n  };\n};\n\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(Settings));\n","import React, { PureComponent } from 'react';\n\nimport './stylesheet.css';\n\nimport _ from 'lodash';\nimport classNames from 'classnames';\n\nexport default class ShortcutRow extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, ['handleRebindClick', 'handleKeyPress']);\n\n    this.state = {\n      isEditMode: false,\n    };\n  }\n\n  componentDidMount() {\n    this.rebindArea.addEventListener('blur', () => this.setState({ isEditMode: false }));\n  }\n\n  handleRebindClick() {\n    this.setState({ isEditMode: true });\n    document.addEventListener('keypress', this.handleKeyPress);\n  }\n\n  handleKeyPress(event) {\n    this.setState({ isEditMode: false });\n    document.removeEventListener('keypress', this.handleKeyPress);\n\n    let key = null;\n    if (event.code.startsWith('Key')) {\n      key = event.code.substr(3).toLowerCase();\n    } else if (event.code.startsWith('Digit')) {\n      key = event.code.substr(5);\n    } else {\n      key = {\n        Minus: '-',\n        Equal: '=',\n        Backspace: 'backspace',\n        Enter: 'enter',\n        Return: 'return',\n        Tab: 'tab',\n        BracketLeft: '[',\n        BracketRight: ']',\n        Semicolon: ';',\n        Quote: '\"',\n        Backslash: '\\\\',\n        Comma: ',',\n        Period: '.',\n        Slash: '/',\n      }[event.code];\n    }\n\n    if (!key) {\n      return;\n    }\n\n    const modifiers = [\n      ['ctrlKey', 'ctrl'],\n      ['altKey', 'alt'],\n      ['metaKey', 'meta'],\n      ['shiftKey', 'shift'],\n    ];\n\n    const newModifiers = modifiers\n      .filter(([modifier, _]) => event[modifier])\n      .map(([_, symbol]) => symbol)\n      .join('+');\n    const newBinding = `${newModifiers}${!!newModifiers ? '+' : ''}${key}`;\n\n    this.props.onBindingChange(this.props.name, newBinding);\n  }\n\n  symbolizeKeybinding(binding) {\n    if (!binding) {\n      return '';\n    }\n\n    const replacements = [\n      ['ctrl', '^'],\n      ['alt', ''],\n      ['option', ''],\n      ['command', ''],\n      ['meta', ''],\n      ['shift', ''],\n      ['backspace', ''],\n      ['return', ''],\n      ['enter', ''],\n      ['left', ''],\n      ['right', ''],\n      ['up', ''],\n      ['down', ''],\n    ];\n\n    return replacements.reduce(\n      (currentBinding, [name, symbol]) => currentBinding.replace(RegExp(`${name}\\\\+?`), symbol),\n      binding\n    );\n  }\n\n  render() {\n    const { name, binding } = this.props;\n    const { isEditMode } = this.state;\n\n    const rebindAreaClassName = classNames('keyboard-shortcut-container__shortcut-key', {\n      'keyboard-shortcut-container__shortcut-key--edit-mode': isEditMode,\n    });\n\n    return (\n      <div className=\"keyboard-shortcut-container\">\n        <div className=\"keyboard-shortcut-container__shortcut-name\">{name}</div>\n        <div\n          className={rebindAreaClassName}\n          onClick={this.handleRebindClick}\n          tabIndex=\"-1\"\n          ref={div => (this.rebindArea = div)}\n        >\n          {isEditMode ? '...' : this.symbolizeKeybinding(binding)}\n        </div>\n      </div>\n    );\n  }\n}\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport { withRouter } from 'react-router-dom';\n\nimport { Map } from 'immutable';\n\nimport ShortcutRow from './components/ShortcutRow';\n\nimport * as baseActions from '../../actions/base';\n\nimport { calculateNamedKeybindings } from '../../lib/keybindings';\n\nimport './stylesheet.css';\n\nconst KeyboardShortcutsEditor = ({ customKeybindings, base }) => {\n  const handleBindingChange = (bindingName, newBinding) => {\n    const alreadyInUseBinding = calculateNamedKeybindings(customKeybindings).filter(\n      ([_, binding]) => binding === newBinding\n    )[0];\n\n    if (!!alreadyInUseBinding) {\n      alert(`That binding is already in use for \"${alreadyInUseBinding[0]}\"`);\n      return;\n    }\n\n    base.setCustomKeybinding(bindingName, newBinding);\n  };\n\n  return (\n    <div className=\"keyboard-shortcuts-editor-container\">\n      {calculateNamedKeybindings(customKeybindings).map(([name, binding]) => (\n        <ShortcutRow\n          key={name}\n          name={name}\n          binding={binding}\n          onBindingChange={handleBindingChange}\n        />\n      ))}\n    </div>\n  );\n};\n\nconst mapStateToProps = (state, props) => {\n  return {\n    customKeybindings: state.base.get('customKeybindings') || Map(),\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    base: bindActionCreators(baseActions, dispatch),\n  };\n};\n\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(KeyboardShortcutsEditor));\n","import React, { Fragment, useState } from 'react';\nimport { UnmountClosed as Collapse } from 'react-collapse';\n\nimport { Draggable } from 'react-beautiful-dnd';\n\nimport './stylesheet.css';\n\nimport ActionButton from '../../../OrgFile/components/ActionDrawer/components/ActionButton';\nimport Switch from '../../../UI/Switch/';\n\nimport classNames from 'classnames';\n\nexport default ({\n  template,\n  index,\n  onFieldPathUpdate,\n  onAddNewTemplateOrgFileAvailability,\n  onRemoveTemplateOrgFileAvailability,\n  onAddNewTemplateHeaderPath,\n  onRemoveTemplateHeaderPath,\n  onDeleteTemplate,\n  syncBackendType,\n}) => {\n  const [isCollapsed, setIsCollapsed] = useState(!!template.get('description'));\n  const handleHeaderBarClick = () => setIsCollapsed(!isCollapsed);\n\n  const updateField = fieldName => event =>\n    onFieldPathUpdate(template.get('id'), [fieldName], event.target.value);\n\n  const toggleAvailabilityInAllOrgFiles = () =>\n    onFieldPathUpdate(\n      template.get('id'),\n      ['isAvailableInAllOrgFiles'],\n      !template.get('isAvailableInAllOrgFiles')\n    );\n\n  const togglePrepend = () =>\n    onFieldPathUpdate(template.get('id'), ['shouldPrepend'], !template.get('shouldPrepend'));\n\n  const handleAddNewOrgFileAvailability = () => {\n    onAddNewTemplateOrgFileAvailability(template.get('id'));\n  };\n\n  const handleRemoveOrgFileAvailability = index => () =>\n    onRemoveTemplateOrgFileAvailability(template.get('id'), index);\n\n  const handleOrgFileAvailabilityChange = orgFileAvailabilityIndex => event =>\n    onFieldPathUpdate(\n      template.get('id'),\n      ['orgFilesWhereAvailable', orgFileAvailabilityIndex],\n      event.target.value\n    );\n\n  const handleAddNewHeaderPath = () => onAddNewTemplateHeaderPath(template.get('id'));\n\n  const handleRemoveHeaderPath = headerPathIndex => () =>\n    onRemoveTemplateHeaderPath(template.get('id'), headerPathIndex);\n\n  const handleHeaderPathChange = headerPathIndex => event =>\n    onFieldPathUpdate(template.get('id'), ['headerPaths', headerPathIndex], event.target.value);\n\n  const handleDeleteClick = () => {\n    if (\n      window.confirm(\n        `Are you sure you want to delete the \"${template.get('description')}\" template?`\n      )\n    ) {\n      onDeleteTemplate(template.get('id'));\n    }\n  };\n\n  const renderDescriptionField = template => (\n    <div className=\"capture-template__field-container\">\n      <div className=\"capture-template__field\">\n        <div>Description:</div>\n        <input\n          type=\"text\"\n          className=\"textfield\"\n          value={template.get('description', '')}\n          onChange={updateField('description')}\n        />\n      </div>\n    </div>\n  );\n\n  const renderIconField = template => (\n    <div className=\"capture-template__field-container\">\n      <div className=\"capture-template__field\">\n        <div>Letter:</div>\n        <input\n          type=\"text\"\n          className=\"textfield capture-template__letter-textfield\"\n          maxLength=\"1\"\n          value={template.get('letter', '')}\n          onChange={updateField('letter')}\n          autoCapitalize=\"none\"\n        />\n      </div>\n\n      <div className=\"capture-template__field__or-container\">\n        <div className=\"capture-template__field__or-line\" />\n        <div className=\"capture-template__field__or\">or</div>\n        <div className=\"capture-template__field__or-line\" />\n      </div>\n\n      <div className=\"capture-template__field\">\n        <div>Icon name:</div>\n        <input\n          type=\"text\"\n          className=\"textfield\"\n          value={template.get('iconName')}\n          onChange={updateField('iconName')}\n          autoCapitalize=\"none\"\n          autoCorrect=\"none\"\n        />\n      </div>\n\n      <div className=\"capture-template__help-text\">\n        Instead of a letter, you can specify the name of any free Font Awesome icon (like lemon or\n        calendar-plus) to use as the capture icon. You can search the available icons{' '}\n        <a\n          href=\"https://fontawesome.com/icons?d=gallery&s=solid&m=free\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n        >\n          here\n        </a>\n        .\n      </div>\n    </div>\n  );\n\n  const renderOrgFileAvailability = template => (\n    <div className=\"capture-template__field-container\">\n      <div className=\"capture-template__field\">\n        <div>Available in all org files?</div>\n        <Switch\n          isEnabled={template.get('isAvailableInAllOrgFiles')}\n          onToggle={toggleAvailabilityInAllOrgFiles}\n        />\n      </div>\n\n      <div className=\"capture-template__help-text\">\n        You can make this capture template available in all org files, or just the ones you specify.\n        {syncBackendType === 'Dropbox' && (\n          <Fragment>\n            {' '}\n            Specify full paths starting from the root of your Dropbox, like{' '}\n            <code>/org/todo.org</code>\n          </Fragment>\n        )}\n        {syncBackendType === 'Google Drive' && (\n          <Fragment>\n            {' '}\n            Specify the file id of each file. You can find the file id in the URL of the file in\n            org-web (e.g.,{' '}\n            <code>\n              /file/\n              {'<file id>'}\n            </code>\n            ).\n          </Fragment>\n        )}\n      </div>\n\n      <Collapse\n        isOpened={!template.get('isAvailableInAllOrgFiles')}\n        springConfig={{ stiffness: 300 }}\n      >\n        <div className=\"multi-textfields-container\">\n          {template.get('orgFilesWhereAvailable').map((orgFilePath, index) => (\n            <div key={`org-file-availability-${index}`} className=\"multi-textfield-container\">\n              <input\n                type=\"text\"\n                placeholder=\"e.g., /org/todo.org\"\n                className=\"textfield multi-textfield-field\"\n                value={orgFilePath}\n                onChange={handleOrgFileAvailabilityChange(index)}\n              />\n              <button\n                className=\"fas fa-times fa-lg remove-multi-textfield-button\"\n                onClick={handleRemoveOrgFileAvailability(index)}\n              />\n            </div>\n          ))}\n        </div>\n\n        <div className=\"add-new-multi-textfield-button-container\">\n          <button\n            className=\"fas fa-plus add-new-multi-textfield-button\"\n            onClick={handleAddNewOrgFileAvailability}\n          />\n        </div>\n      </Collapse>\n    </div>\n  );\n\n  const renderHeaderPaths = template => (\n    <div className=\"capture-template__field-container\">\n      <div className=\"capture-template__field\" style={{ marginTop: 7 }}>\n        <div>Header path</div>\n      </div>\n\n      <div className=\"capture-template__help-text\">\n        Specify the path to the header under which the new header should be filed. One header per\n        textfield.\n      </div>\n\n      <div className=\"multi-textfields-container\">\n        {template.get('headerPaths').map((headerPath, index) => (\n          <div key={`header-path-${index}`} className=\"multi-textfield-container\">\n            <input\n              type=\"text\"\n              placeholder=\"e.g., Todos\"\n              className=\"textfield multi-textfield-field\"\n              value={headerPath}\n              onChange={handleHeaderPathChange(index)}\n            />\n            <button\n              className=\"fas fa-times fa-lg remove-multi-textfield-button\"\n              onClick={handleRemoveHeaderPath(index)}\n            />\n          </div>\n        ))}\n      </div>\n\n      <div className=\"add-new-multi-textfield-button-container\">\n        <button\n          className=\"fas fa-plus add-new-multi-textfield-button\"\n          onClick={handleAddNewHeaderPath}\n        />\n      </div>\n    </div>\n  );\n\n  const renderPrependField = template => (\n    <div className=\"capture-template__field-container\">\n      <div className=\"capture-template__field\">\n        <div>Prepend?</div>\n        <Switch isEnabled={template.get('shouldPrepend')} onToggle={togglePrepend} />\n      </div>\n\n      <div className=\"capture-template__help-text\">\n        By default, new captured headers are appended to the specified header path. Enable this\n        setting to prepend them instead.\n      </div>\n    </div>\n  );\n\n  const renderTemplateField = template => (\n    <div className=\"capture-template__field-container\">\n      <div className=\"capture-template__field\" style={{ marginTop: 7 }}>\n        <div>Template</div>\n      </div>\n\n      <textarea\n        className=\"textarea template-textarea\"\n        rows=\"3\"\n        value={template.get('template')}\n        onChange={updateField('template')}\n      />\n\n      <div className=\"capture-template__help-text\">\n        The template for creating the capture item. You can use the following template variables\n        that will be expanded upon capture:\n        <ul>\n          <li>\n            <code>%?</code> - Place the cursor here.\n          </li>\n          <li>\n            <code>%t</code> - Timestamp, date only.\n          </li>\n          <li>\n            <code>%T</code> - Timestamp, with date and time.\n          </li>\n          <li>\n            <code>%u</code> - Inactive timestamp, date only.\n          </li>\n          <li>\n            <code>%U</code> - Inactive timestamp, with date and time.\n          </li>\n          <li>\n            <code>%{'<custom variable>'}</code> - A custom variable from a URL param capture. See{' '}\n            <a href=\"https://github.com/DanielDe/org-web/#capture-params-and-siri-support\">\n              the README file\n            </a>{' '}\n            for more details.\n          </li>\n        </ul>\n      </div>\n    </div>\n  );\n\n  const renderDeleteButton = template => (\n    <div className=\"capture-template__field-container capture-template__delete-button-container\">\n      <button\n        className=\"btn settings-btn capture-template__delete-button\"\n        onClick={handleDeleteClick}\n      >\n        Delete template\n      </button>\n    </div>\n  );\n\n  const caretClassName = classNames(\n    'fas fa-2x fa-caret-right capture-template-container__header__caret',\n    {\n      'capture-template-container__header__caret--rotated': !isCollapsed,\n    }\n  );\n\n  return (\n    <Draggable draggableId={`capture-template--${template.get('id')}`} index={index}>\n      {(provided, snapshot) => (\n        <div\n          className={classNames('capture-template-container', {\n            'capture-template-container--dragging': snapshot.isDragging,\n          })}\n          ref={provided.innerRef}\n          {...provided.draggableProps}\n        >\n          <div className=\"capture-template-container__header\" onClick={handleHeaderBarClick}>\n            <i className={caretClassName} />\n            <ActionButton\n              iconName={template.get('iconName')}\n              letter={template.get('letter')}\n              onClick={() => {}}\n              style={{ marginRight: 20 }}\n            />\n            <span className=\"capture-template-container__header__title\">\n              {template.get('description')}\n            </span>\n            <i\n              className=\"fas fa-bars fa-lg capture-template-container__header__drag-handle\"\n              {...provided.dragHandleProps}\n            />\n          </div>\n\n          <Collapse isOpened={!isCollapsed} springConfig={{ stiffness: 300 }}>\n            <div className=\"capture-template-container__content\">\n              {renderDescriptionField(template)}\n              {renderIconField(template)}\n              {renderOrgFileAvailability(template)}\n              {renderHeaderPaths(template)}\n              {renderPrependField(template)}\n              {renderTemplateField(template)}\n              {renderDeleteButton(template)}\n            </div>\n          </Collapse>\n        </div>\n      )}\n    </Draggable>\n  );\n};\n","import React, { Fragment } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport { Droppable } from 'react-beautiful-dnd';\n\nimport './stylesheet.css';\n\nimport * as captureActions from '../../actions/capture';\n\nimport CaptureTemplate from './components/CaptureTemplate';\n\nimport { List } from 'immutable';\n\nconst CaptureTemplatesEditor = ({ captureTemplates, syncBackendType, capture }) => {\n  const handleAddNewTemplateClick = () => capture.addNewEmptyCaptureTemplate();\n\n  const handleFieldPathUpdate = (templateId, fieldPath, newValue) =>\n    capture.updateTemplateFieldPathValue(templateId, fieldPath, newValue);\n\n  const handleAddNewTemplateOrgFileAvailability = templateId =>\n    capture.addNewTemplateOrgFileAvailability(templateId);\n\n  const handleRemoveTemplateOrgFileAvailability = (templateId, orgFileAvailabilityIndex) =>\n    capture.removeTemplateOrgFileAvailability(templateId, orgFileAvailabilityIndex);\n\n  const handleAddNewTemplateHeaderPath = templateId => capture.addNewTemplateHeaderPath(templateId);\n\n  const handleRemoveTemplateHeaderPath = (templateId, headerPathIndex) =>\n    capture.removeTemplateHeaderPath(templateId, headerPathIndex);\n\n  const handleDeleteTemplate = templateId => capture.deleteTemplate(templateId);\n\n  const handleReorderTemplate = (fromIndex, toIndex) =>\n    capture.reorderCaptureTemplate(fromIndex, toIndex);\n\n  return (\n    <div>\n      <Droppable droppableId=\"capture-templates-editor-droppable\" type=\"CAPTURE-TEMPLATE\">\n        {(provided, snapshot) => (\n          <div\n            className=\"capture-templates-container\"\n            ref={provided.innerRef}\n            {...provided.droppableProps}\n          >\n            {captureTemplates.size === 0 ? (\n              <div className=\"no-capture-templates-message\">\n                You don't currently have any capture templates - add one by pressing the{' '}\n                <i className=\"fas fa-plus\" /> button.\n                <br />\n                <br />\n                Capture templates show up in the action drawer and give you quick access to creating\n                new headers (like org-capture).\n              </div>\n            ) : (\n              <Fragment>\n                {captureTemplates.map((template, index) => (\n                  <CaptureTemplate\n                    key={template.get('id')}\n                    index={index}\n                    template={template}\n                    syncBackendType={syncBackendType}\n                    onFieldPathUpdate={handleFieldPathUpdate}\n                    onAddNewTemplateOrgFileAvailability={handleAddNewTemplateOrgFileAvailability}\n                    onRemoveTemplateOrgFileAvailability={handleRemoveTemplateOrgFileAvailability}\n                    onAddNewTemplateHeaderPath={handleAddNewTemplateHeaderPath}\n                    onRemoveTemplateHeaderPath={handleRemoveTemplateHeaderPath}\n                    onDeleteTemplate={handleDeleteTemplate}\n                    onReorder={handleReorderTemplate}\n                  />\n                ))}\n\n                {provided.placeholder}\n              </Fragment>\n            )}\n          </div>\n        )}\n      </Droppable>\n\n      <div className=\"new-capture-template-button-container\">\n        <button className=\"fas fa-plus fa-lg btn btn--circle\" onClick={handleAddNewTemplateClick} />\n      </div>\n    </div>\n  );\n};\n\nconst mapStateToProps = (state, props) => {\n  return {\n    captureTemplates: state.capture.get('captureTemplates', new List()),\n    syncBackendType: state.syncBackend.get('client').type,\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    capture: bindActionCreators(captureActions, dispatch),\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(CaptureTemplatesEditor);\n","/* global process, gapi, google */\r\n\r\nimport React, { PureComponent } from 'react';\r\n\r\nimport './stylesheet.css';\r\n\r\nimport DropboxLogo from './dropbox.svg';\r\nimport GoogleDriveLogo from './google_drive.png';\r\n\r\nimport { persistField } from '../../util/settings_persister';\r\n\r\nimport { Dropbox } from 'dropbox';\r\n\r\nimport _ from 'lodash';\r\n\r\nexport default class SyncServiceSignIn extends PureComponent {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    _.bindAll(this, ['handleDropboxClick', 'handleGoogleDriveClick']);\r\n  }\r\n\r\n  handleDropboxClick() {\r\n    persistField('authenticatedSyncService', 'Dropbox');\r\n\r\n    const dropbox = new Dropbox({ clientId: process.env.REACT_APP_DROPBOX_CLIENT_ID, fetch });\r\n    const authURL = dropbox.getAuthenticationUrl(\r\n      window.location.origin + process.env.PUBLIC_URL + '/'\r\n    );\r\n    window.location = authURL;\r\n  }\r\n\r\n  handleGoogleDriveClick() {\r\n    try {\r\n      gapi.load('client', () => {\r\n        window.gapi.client\r\n          .init({\r\n            apiKey: process.env.REACT_APP_GOOGLE_DRIVE_API_KEY,\r\n            discoveryDocs: ['https://www.googleapis.com/discovery/v1/apis/drive/v3/rest'],\r\n          })\r\n          .then(async () => {\r\n            const tokenClient = google.accounts.oauth2.initTokenClient({\r\n              client_id: process.env.REACT_APP_GOOGLE_DRIVE_CLIENT_ID,\r\n              scope: 'https://www.googleapis.com/auth/drive.file',\r\n              callback: accessToken => {\r\n                persistField('authenticatedSyncService', 'Google Drive');\r\n                persistField('googleDriveAccessToken', JSON.stringify(accessToken));\r\n                window.location.reload();\r\n              },\r\n            });\r\n            tokenClient.requestAccessToken({ prompt: 'consent' });\r\n          });\r\n      });\r\n    } catch (error) {\r\n      alert(\r\n        `The Google Drive API client isn't available - you might be blocking it with an ad blocker`\r\n      );\r\n      return;\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"sync-service-sign-in-container\">\r\n        <p className=\"sync-service-sign-in__help-text\">\r\n          org-web syncs your files with Dropbox or Google Drive. Choose your preferred sync backend\r\n          below to sign in.\r\n        </p>\r\n\r\n        <div className=\"sync-service-container\" onClick={this.handleDropboxClick}>\r\n          <img src={DropboxLogo} alt=\"Dropbox logo\" className=\"dropbox-logo\" />\r\n        </div>\r\n\r\n        <div className=\"sync-service-container\" onClick={this.handleGoogleDriveClick}>\r\n          <img src={GoogleDriveLogo} alt=\"Google Drive logo\" className=\"google-drive-logo\" />\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import React, { PureComponent, Fragment } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { bindActionCreators } from 'redux';\r\n\r\nimport { Route, Switch, Redirect, Prompt, withRouter } from 'react-router-dom';\r\n\r\nimport './stylesheet.css';\r\n\r\nimport { List } from 'immutable';\r\nimport _ from 'lodash';\r\nimport classNames from 'classnames';\r\n\r\nimport { parseOrg } from '../../lib/parse_org';\r\n\r\nimport raw from 'raw.macro';\r\n\r\nimport PrivacyPolicy from '../PrivacyPolicy';\r\nimport HeaderBar from '../HeaderBar';\r\nimport Landing from '../Landing';\r\nimport FileBrowser from '../FileBrowser';\r\nimport LoadingIndicator from '../LoadingIndicator';\r\nimport OrgFile from '../OrgFile';\r\nimport Settings from '../Settings';\r\nimport KeyboardShortcutsEditor from '../KeyboardShortcutsEditor';\r\nimport CaptureTemplatesEditor from '../CaptureTemplatesEditor';\r\nimport SyncServiceSignIn from '../SyncServiceSignIn';\r\n\r\nimport * as syncBackendActions from '../../actions/sync_backend';\r\nimport * as orgActions from '../../actions/org';\r\nimport * as baseActions from '../../actions/base';\r\n\r\nclass Entry extends PureComponent {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    _.bindAll(this, ['renderChangelogFile', 'renderSampleFile', 'renderFileBrowser', 'renderFile']);\r\n  }\r\n\r\n  componentDidMount() {\r\n    const { lastSeenChangelogHeader, isAuthenticated } = this.props;\r\n\r\n    const changelogFile = parseOrg(raw('../../../changelog.org'));\r\n    const firstHeaderTitle = changelogFile.getIn(['headers', 0, 'titleLine', 'rawTitle']);\r\n    if (\r\n      isAuthenticated &&\r\n      !!lastSeenChangelogHeader &&\r\n      firstHeaderTitle !== lastSeenChangelogHeader\r\n    ) {\r\n      this.props.base.setHasUnseenChangelog(true);\r\n    }\r\n    this.props.base.setLastSeenChangelogHeader(firstHeaderTitle);\r\n  }\r\n\r\n  componentDidUpdate() {\r\n    this.shouldPromptWhenLeaving()\r\n      ? (window.onbeforeunload = () => true)\r\n      : (window.onbeforeunload = undefined);\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    window.onbeforeunload = undefined;\r\n  }\r\n\r\n  renderChangelogFile() {\r\n    return (\r\n      <OrgFile\r\n        staticFile=\"changelog\"\r\n        shouldDisableDirtyIndicator={true}\r\n        shouldDisableActions={true}\r\n        shouldDisableSyncButtons={false}\r\n        parsingErrorMessage={\r\n          \"The contents of changelog.org couldn't be loaded. You probably forgot to set the environment variable - see the Development section of README.org for details!\"\r\n        }\r\n      />\r\n    );\r\n  }\r\n\r\n  renderSampleFile() {\r\n    return (\r\n      <OrgFile\r\n        staticFile=\"sample\"\r\n        shouldDisableDirtyIndicator={true}\r\n        shouldDisableActionDrawer={false}\r\n        shouldDisableSyncButtons={true}\r\n        parsingErrorMessage={\r\n          \"The contents of sample.org couldn't be loaded. You probably forgot to set the environment variable - see the Development section of README.org for details!\"\r\n        }\r\n      />\r\n    );\r\n  }\r\n\r\n  renderFileBrowser({\r\n    match: {\r\n      params: { path = '' },\r\n    },\r\n  }) {\r\n    if (!!path) {\r\n      path = '/' + path;\r\n    }\r\n\r\n    return <FileBrowser path={path} />;\r\n  }\r\n\r\n  renderFile({\r\n    match: {\r\n      params: { path },\r\n    },\r\n  }) {\r\n    if (!!path) {\r\n      path = '/' + path;\r\n    }\r\n\r\n    return (\r\n      <OrgFile\r\n        path={path}\r\n        shouldDisableDirtyIndicator={false}\r\n        shouldDisableActionDrawer={false}\r\n        shouldDisableSyncButtons={false}\r\n      />\r\n    );\r\n  }\r\n\r\n  shouldPromptWhenLeaving() {\r\n    return this.props.location.pathname.startsWith('/file/') && this.props.isDirty;\r\n  }\r\n\r\n  render() {\r\n    const {\r\n      isAuthenticated,\r\n      loadingMessage,\r\n      fontSize,\r\n      activeModalPage,\r\n      pendingCapture,\r\n      location: { pathname },\r\n    } = this.props;\r\n\r\n    const pendingCapturePath = !!pendingCapture && `/file${pendingCapture.get('capturePath')}`;\r\n    const shouldRedirectToCapturePath = pendingCapturePath && pendingCapturePath !== pathname;\r\n\r\n    const className = classNames('entry-container', {\r\n      'entry-container--large-font': fontSize === 'Large',\r\n    });\r\n\r\n    return (\r\n      <div className={className}>\r\n        <HeaderBar />\r\n\r\n        <LoadingIndicator message={loadingMessage} />\r\n\r\n        <Prompt\r\n          when={this.shouldPromptWhenLeaving()}\r\n          message={() => 'You have unpushed changes - are you sure you want to leave this page?'}\r\n        />\r\n\r\n        {activeModalPage === 'changelog' ? (\r\n          this.renderChangelogFile()\r\n        ) : isAuthenticated ? (\r\n          ['keyboard_shortcuts_editor', 'settings', 'capture_templates_editor', 'sample'].includes(\r\n            activeModalPage\r\n          ) ? (\r\n            <Fragment>\r\n              {activeModalPage === 'settings' && <Settings />}\r\n              {activeModalPage === 'keyboard_shortcuts_editor' && <KeyboardShortcutsEditor />}\r\n              {activeModalPage === 'capture_templates_editor' && <CaptureTemplatesEditor />}\r\n              {activeModalPage === 'sample' && this.renderSampleFile()}\r\n            </Fragment>\r\n          ) : (\r\n            <Switch>\r\n              {shouldRedirectToCapturePath && <Redirect to={pendingCapturePath} />}\r\n              <Route path=\"/privacy-policy\" exact component={PrivacyPolicy} />\r\n              <Route path=\"/file/:path+\" render={this.renderFile} />\r\n              <Route path=\"/files/:path*\" render={this.renderFileBrowser} />\r\n              <Redirect to=\"/file/life.org\" />\r\n            </Switch>\r\n          )\r\n        ) : (\r\n          <Switch>\r\n            <Route path=\"/privacy-policy\" exact component={PrivacyPolicy} />\r\n            <Route path=\"/sample\" exact={true} render={this.renderSampleFile} />\r\n            <Route path=\"/sign_in\" exact={true} component={SyncServiceSignIn} />\r\n            <Route path=\"/\" exact={true} component={Landing} />\r\n            <Redirect to=\"/\" />\r\n          </Switch>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state, props) => {\r\n  return {\r\n    loadingMessage: state.base.get('loadingMessage'),\r\n    isAuthenticated: state.syncBackend.get('isAuthenticated'),\r\n    fontSize: state.base.get('fontSize'),\r\n    lastSeenChangelogHeader: state.base.get('lastSeenChangelogHeader'),\r\n    activeModalPage: state.base.get('modalPageStack', List()).last(),\r\n    pendingCapture: state.org.present.get('pendingCapture'),\r\n    isDirty: state.org.present.get('isDirty'),\r\n  };\r\n};\r\n\r\nconst mapDispatchToProps = dispatch => {\r\n  return {\r\n    syncBackend: bindActionCreators(syncBackendActions, dispatch),\r\n    org: bindActionCreators(orgActions, dispatch),\r\n    base: bindActionCreators(baseActions, dispatch),\r\n  };\r\n};\r\n\r\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(Entry));\r\n","import React, { PureComponent } from 'react';\nimport { Provider } from 'react-redux';\nimport Store from './store';\nimport {\n  readInitialState,\n  loadSettingsFromConfigFile,\n  subscribeToChanges,\n  persistField,\n  getPersistedField,\n} from './util/settings_persister';\nimport runAllMigrations from './migrations';\nimport parseQueryString from './util/parse_query_string';\nimport { HashRouter as Router } from 'react-router-dom';\n\nimport { DragDropContext } from 'react-beautiful-dnd';\n\nimport { reorderCaptureTemplate } from './actions/capture';\nimport { reorderTags, reorderPropertyList } from './actions/org';\nimport { signOut } from './actions/sync_backend';\nimport { setDisappearingLoadingMessage } from './actions/base';\n\nimport createDropboxSyncBackendClient from './sync_backend_clients/dropbox_sync_backend_client';\nimport createGoogleDriveSyncBackendClient from './sync_backend_clients/google_drive_sync_backend_client';\n\nimport './base.css';\n\nimport Entry from './components/Entry';\n\nimport _ from 'lodash';\nimport { Map } from 'immutable';\n\nexport default class App extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    runAllMigrations();\n\n    const initialState = readInitialState();\n\n    window.initialHash = window.location.hash.substring(0);\n    const hashContents = parseQueryString(window.location.hash);\n    const authenticatedSyncService = getPersistedField('authenticatedSyncService', true);\n    let client = null;\n\n    if (!!authenticatedSyncService) {\n      switch (authenticatedSyncService) {\n        case 'Dropbox':\n          const dropboxAccessToken = hashContents.access_token;\n          if (dropboxAccessToken) {\n            client = createDropboxSyncBackendClient(dropboxAccessToken);\n            initialState.syncBackend = Map({\n              isAuthenticated: true,\n              client,\n            });\n            persistField('dropboxAccessToken', dropboxAccessToken);\n            window.location.hash = '';\n          } else {\n            const persistedDropboxAccessToken = getPersistedField('dropboxAccessToken', true);\n            if (!!persistedDropboxAccessToken) {\n              client = createDropboxSyncBackendClient(persistedDropboxAccessToken);\n              initialState.syncBackend = Map({\n                isAuthenticated: true,\n                client,\n              });\n            }\n          }\n          break;\n        case 'Google Drive':\n          client = createGoogleDriveSyncBackendClient();\n          initialState.syncBackend = Map({\n            isAuthenticated: true,\n            client,\n          });\n          break;\n        default:\n      }\n    }\n\n    const queryStringContents = parseQueryString(window.location.search);\n    const { captureFile, captureTemplateName, captureContent } = queryStringContents;\n    if (!!captureFile && !!captureTemplateName) {\n      const capturePath = captureFile.startsWith('/') ? captureFile : `/${captureFile}`;\n      const customCaptureVariables = Map(\n        Object.entries(queryStringContents)\n          .map(([key, value]) => {\n            const CUSTOM_VARIABLE_PREFIX = 'captureVariable_';\n            if (key.startsWith(CUSTOM_VARIABLE_PREFIX)) {\n              return [key.substring(CUSTOM_VARIABLE_PREFIX.length), value];\n            }\n\n            return null;\n          })\n          .filter(item => !!item)\n      );\n      initialState.org.present = initialState.org.present.set(\n        'pendingCapture',\n        Map({\n          capturePath,\n          captureTemplateName,\n          captureContent,\n          customCaptureVariables,\n        })\n      );\n    }\n\n    this.store = Store(initialState);\n    this.store.subscribe(subscribeToChanges(this.store));\n\n    if (!!client) {\n      client.isSignedIn().then(isSignedIn => {\n        if (isSignedIn) {\n          loadSettingsFromConfigFile(this.store.dispatch, this.store.getState);\n        } else {\n          this.store.dispatch(signOut());\n        }\n      });\n    } else {\n      if (!!this.store.getState().org.present.get('pendingCapture')) {\n        this.store.dispatch(\n          setDisappearingLoadingMessage(\n            `You need to sign in before you can use capture templates`,\n            5000\n          )\n        );\n      }\n    }\n\n    _.bindAll(this, ['handleDragEnd']);\n  }\n\n  handleDragEnd(result) {\n    if (!result.destination) {\n      return;\n    }\n\n    if (result.type === 'CAPTURE-TEMPLATE') {\n      this.store.dispatch(reorderCaptureTemplate(result.source.index, result.destination.index));\n    } else if (result.type === 'TAG') {\n      this.store.dispatch(reorderTags(result.source.index, result.destination.index));\n    } else if (result.type === 'PROPERTY-LIST') {\n      this.store.dispatch(reorderPropertyList(result.source.index, result.destination.index));\n    }\n  }\n\n  render() {\n    return (\n      <DragDropContext onDragEnd={this.handleDragEnd}>\n        <Router basename={process.env.PUBLIC_URL}>\n          <Provider store={this.store}>\n            <div className=\"App\">\n              <Entry />\n            </div>\n          </Provider>\n        </Router>\n      </DragDropContext>\n    );\n  }\n}\n","// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)\n);\n\nexport default function register() {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Lets check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://goo.gl/SC7cgQ'\n          );\n        });\n      } else {\n        // Is not local host. Just register service worker\n        registerValidSW(swUrl);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the old content will have been purged and\n              // the fresh content will have been added to the cache.\n              // It's the perfect time to display a \"New content is\n              // available; please refresh.\" message in your web app.\n              console.log('New content is available; please refresh.');\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      if (\n        response.status === 404 ||\n        response.headers.get('content-type').indexOf('javascript') === -1\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl);\n      }\n    })\n    .catch(() => {\n      console.log('No internet connection found. App is running in offline mode.');\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport { unregister } from './registerServiceWorker';\n\nunregister();\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}