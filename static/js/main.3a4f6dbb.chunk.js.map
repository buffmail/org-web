{"version":3,"sources":["components/HeaderBar/org-web.svg","components/SyncServiceSignIn/dropbox.svg","components/SyncServiceSignIn/google_drive.png","middleware/google_analytics_logging.js","actions/base.js","lib/timestamps.js","lib/export_org.js","lib/capture_template_substitution.js","lib/id_generator.js","lib/org_utils.js","lib/sample_capture_templates.js","actions/org.js","middleware/live_sync.js","middleware/sync_on_becoming_visible.js","actions/capture.js","util/settings_persister.js","reducers/base.js","lib/parse_org.js","reducers/org.js","reducers/capture.js","reducers/index.js","reducers/sync_backend.js","store.js","migrations/index.js","migrations/migrate_access_token_to_dropbox_access_token.js","migrations/migrate_store_in_dropbox_to_store_in_sync_backend.js","util/parse_query_string.js","actions/sync_backend.js","sync_backend_clients/dropbox_sync_backend_client.js","sync_backend_clients/google_drive_sync_backend_client.js","components/PrivacyPolicy/index.js","components/HeaderBar/index.js","components/Landing/index.js","components/FileBrowser/index.js","components/LoadingIndicator/index.js","components/OrgFile/components/AttributedString/components/TablePart/TableActionDrawer/index.js","components/OrgFile/components/AttributedString/components/TablePart/index.js","lib/color.js","components/UI/Checkbox/index.js","components/OrgFile/components/AttributedString/components/ListPart/ListActionDrawer/index.js","components/OrgFile/components/AttributedString/components/ListPart/index.js","components/OrgFile/components/AttributedString/components/TimestampPart/index.js","components/OrgFile/components/AttributedString/index.js","components/OrgFile/components/TitleLine/index.js","components/OrgFile/components/HeaderContent/components/PlanningItems/index.js","components/OrgFile/components/HeaderContent/components/PropertyListItems/index.js","components/OrgFile/components/HeaderContent/index.js","components/OrgFile/components/Header/components/HeaderActionDrawer/index.js","components/OrgFile/components/Header/index.js","components/OrgFile/components/HeaderList/index.js","components/OrgFile/components/ActionDrawer/components/ActionButton/index.js","components/OrgFile/components/ActionDrawer/index.js","components/UI/Switch/index.js","components/UI/Drawer/index.js","components/OrgFile/components/CaptureModal/index.js","components/OrgFile/components/SyncConfirmationModal/index.js","components/OrgFile/components/TagsEditorModal/index.js","components/UI/TabButtons/index.js","components/OrgFile/components/TimestampEditorModal/components/TimestampEditor/index.js","components/OrgFile/components/TimestampEditorModal/index.js","components/OrgFile/components/PropertyListEditorModal/index.js","components/OrgFile/components/AgendaModal/components/AgendaDay/index.js","components/OrgFile/components/AgendaModal/index.js","lib/keybindings.js","components/OrgFile/index.js","components/Settings/index.js","components/KeyboardShortcutsEditor/components/ShortcutRow/index.js","components/KeyboardShortcutsEditor/index.js","components/CaptureTemplatesEditor/components/CaptureTemplate/index.js","components/CaptureTemplatesEditor/index.js","components/SyncServiceSignIn/index.js","components/Entry/index.js","App.js","registerServiceWorker.js","index.js"],"names":["module","exports","__webpack_require__","p","google_analytics_logging","store","next","action","type","payload","Object","objectWithoutProperties","eventFieldsToRedact","SET_CURRENT_FILE_BROWSER_DIRECTORY_LISTING","AUTHENTICATE","DISPLAY_FILE","forEach","field","objectSpread","defineProperty","ga","JSON","stringify","setLoadingMessage","loadingMessage","hideLoadingMessage","setIsLoading","isLoading","setDisappearingLoadingMessage","delay","dispatch","setTimeout","setLastViewedFile","lastViewedPath","lastViewedContents","loadStaticFile","staticFile","getState","org","present","get","displayFile","changelog","sample","unloadStaticFile","stopDisplayingFile","base","setFontSize","newFontSize","setBulletStyle","newBulletStyle","setShouldTapTodoToAdvance","newShouldTapTodoToAdvance","setAgendaDefaultDeadlineDelayUnit","newAgendaDefaultDeadlineDelayUnit","setAgendaDefaultDeadlineDelayValue","newAgendaDefaultDeadlineDelayValue","setShouldLiveSync","shouldLiveSync","setShouldSyncOnBecomingVisibile","shouldSyncOnBecomingVisibile","setShouldStoreSettingsInSyncBackend","newShouldStoreSettingsInSyncBackend","client","syncBackend","deleteFile","catch","doesFileNotExist","error","alert","concat","deleteFileByNameAndParent","window","previousSettingsFileContents","setHasUnseenChangelog","newHasUnseenChangelog","setLastSeenChangelogHeader","newLastSeenChangelogHeader","setCustomKeybinding","keybindingName","keybinding","restoreBaseSettings","newSettings","pushModalPage","modalPage","popModalPage","clearModalStack","activatePopup","popupType","data","closePopup","renderAsText","timestamp","_timestamp$toJS","toJS","isActive","year","month","day","dayName","startHour","startMinute","endHour","endMinute","repeaterType","repeaterValue","repeaterUnit","delayType","delayValue","delayUnit","timestampText","getCurrentTimestamp","_ref","arguments","length","undefined","_ref$isActive","_ref$withStartTime","withStartTime","time","Date","formatDate","getCurrentTimestampAsText","dateForTimestamp","_timestamp$toJS2","timestampString","padStart","parseDate","addTimestampUnitToDate","date","numUnits","timestampUnit","h","addHours","d","addDays","w","addWeeks","m","addMonths","y","addYears","formattedAttributedStringText","parts","map","part","getIn","join","attributedStringToRawText","prevParts","unshift","zip","linkPart","_ref2","slicedToArray","prevPart","text","tablePart","rowHeights","row","Math","max","apply","toConsumableArray","cell","_","countBy","numColumns","size","columnWidths","times","columnIndex","content","lineLengths","split","line","trim","dropRight","flatten","rowIndex","rowHeight","contentRows","lineIndex","formattedLineLengths","padCount","repeat","contentRow","separator","columnWidth","tablePartToRawText","listPart","bulletCharacter","previousNumber","item","optionalLeadingSpace","titleText","contentText","indentedContentText","listItemText","number","forceNumber","stateCharacter","checked","unchecked","partial","listPartToRawText","timestampPartToRawText","console","optionalNewlinePrefix","includes","endsWith","capture_template_substitution","templateString","customVariables","Map","substitutions","%t","%T","%u","%U","entrySeq","key","value","substitutedString","entries","_ref3","_ref4","formatString","replace","RegExp","cursorIndex","indexOf","id_generator","nextId","indexOfHeaderWithId","headers","headerId","findIndex","header","headerWithId","subheadersOfHeaderWithId","headerIndex","afterHeaders","slice","nextSiblingHeaderIndex","siblingHeader","numSubheadersOfHeaderWithId","parentIdOfHeaderWithId","parentHeader","reverse","find","previousHeader","isHeaderVisible","parentHeaderId","openDirectParent","state","i","directParentIdOfHeaderWithId","parentHeaderIndex","setIn","headerWithPath","headerPath","firstHeader","first","skip","tablePartContainsCellId","cellId","some","headerThatContainsTableCellId","doesAttributedStringContainTableCellId","filter","pathAndPartOfTimestampItemWithIdInAttributedString","timestampId","partIndex","path","timestampPart","itemIndex","pathAndPart","result","cellIndex","pathAndPartOfListContainingItemIdInAttributedString","itemId","listPartContainsItemId","pathAndPartOfListItemWithIdInHeaders","listItemId","pathAndPartOfListItemWithIdInAttributedString","listItemPart","pathAndPartOfTableContainingCellIdInHeaders","pathAndPartOfTableContainingCellIdInAttributedString","updateTableContainingCellId","updaterCallbackGenerator","_pathAndPartOfTableCo","rowIndexContainingCellId","columnIndexContainingCellId","updateIn","updateListContainingListItemId","_pathAndPartOfListCon","pathAndPartOfListContainingItemIdInHeaders","itemIndexContainingId","updateContentsWithListItemAddition","listItem","last","insertIdx","insert","set","generateId","List","fromJS","id","items","numberTerminatorCharacter","isOrdered","update","push","timestampWithIdInAttributedString","todoKeywordSetForKeyword","todoKeywordSets","keyword","keywordSet","contains","description","headerPaths","iconName","isAvailableInAllOrgFiles","letter","orgFilesWhereAvailable","shouldPrepend","template","isSample","contents","setLastSyncAt","lastSyncAt","ActionTypes","CLEAR_HISTORY","unfocusHeader","sync","_ref$forceAction","forceAction","_ref$successMessage","successMessage","_ref$shouldSuppressMe","shouldSuppressMessages","setOrgFileErrorMessage","getFileContentsAndMetadata","then","lastModifiedAt","isDirty","lastServerModifiedAt","isAfter","updateFile","fileConfigLines","linesBeforeHeadings","configContent","todoKeywordSet","nestingLevel","titleLine","todoKeyword","rawTitle","tags","tag","planningItems","planningItemsContent","planningItem","trimRight","propertyListItems","propertyListItem","property","rawDescription","startsWith","exportOrg","setDirty","addSeconds","toString","applyOpennessState","openHeader","toggleHeaderOpened","selectHeader","setSelectedTableCellId","setSelectedListItemId","selectHeaderAndOpenParents","advanceTodoState","dirtying","enterEditMode","editModeType","exitEditMode","updateHeaderTitle","newRawTitle","updateHeaderDescription","newRawDescription","addHeader","selectNextSiblingHeader","addHeaderAndEdit","selectNextVisibleHeader","selectPreviousVisibleHeader","removeHeader","moveHeaderUp","moveHeaderDown","moveHeaderLeft","moveHeaderRight","moveSubtreeLeft","moveSubtreeRight","focusHeader","noOp","addNewTableRow","removeTableRow","addNewTableColumn","removeTableColumn","moveTableRowDown","moveTableRowUp","moveTableColumnLeft","moveTableColumnRight","updateTableCellValue","newValue","insertCapture","templateId","capture","sampleCaptureTemplates","clearPendingCapture","insertPendingCapture","pendingCapture","templateName","captureContent","customCaptureVariables","history","pushState","location","pathname","_substituteTemplateVa","substituteTemplateVariables","_substituteTemplateVa2","substitutedTemplate","initialCursorIndex","substring","advanceCheckboxState","updateListTitleValue","updateListContentsValue","addNewListItem","selectNextSiblingListItem","addNewListItemAndEdit","removeListItem","moveListItemUp","moveListItemDown","moveListItemLeft","moveListItemRight","moveListSubtreeLeft","moveListSubtreeRight","setHeaderTags","reorderTags","fromIndex","toIndex","reorderPropertyList","updateTimestampWithId","newTimestamp","updatePlanningItemTimestamp","planningItemIndex","addNewPlanningItem","planningType","updatePropertyListItems","newPropertyListItems","message","live_sync","debouncedDispatchSync","debounce","sync_on_becoming_visible","addEventListener","addNewEmptyCaptureTemplate","updateTemplateFieldPathValue","fieldPath","addNewTemplateOrgFileAvailability","removeTemplateOrgFileAvailability","orgFileAvailabilityIndex","addNewTemplateHeaderPath","removeTemplateHeaderPath","headerPathIndex","deleteTemplate","restoreCaptureSettings","reorderCaptureTemplate","isLocalStorageAvailable","localStorage","setItem","getItem","e","debouncedPushConfigToSyncBackend","syncBackendClient","createFile","maxWait","persistableFields","category","name","shouldStoreInConfig","default","getFieldsToPersist","fields","depreacted","getConfigFileContents","fieldsToPersist","fromPairs","readInitialState","initialState","past","future","parse","templates","opennessState","opennessStateJSONString","readOpennessState","loadSettingsFromConfigFile","fileContentsPromise","getFileContents","getFileContentsByNameAndParent","configFileContents","config","_error","subscribeToChanges","settingsFileContents","currentFilePath","openHeaderPaths","getOpenHeaderPaths","openedHeaders","_loop","_i","title","subheaders","openSubheaderPaths","openedSubheaderPath","persistField","getPersistedField","nullable","applyCategorySettingsFromConfig","markupAndCookieRegex","timestampRegex","timestampFromRegexMatch","match","partIndices","_partIndices$map","_partIndices$map2","typeBracket","timeStart","timeEnd","firstDelayRepeatType","firstDelayRepeatValue","firstDelayRepeatUnit","secondDelayRepeatType","secondDelayRepeatValue","secondDelayRepeatUnit","parseMarkupAndCookies","rawText","_ref5","_ref5$shouldAppendNew","shouldAppendNewline","matches","excludeCookies","exec","uri","index","percentCookieMatch","percentage","fractionCookieMatch","fraction","markupType","~","*","/","+","=","markupPrefixLength","firstTimestamp","range","secondTimestamp","lineParts","startIndex","trailingText","parseTable","tableLines","table","columnProperties","lastRow","lineCells","substr","cellContents","rawContents","maxNumColumns","parseRawText","_ref6$excludeContentE","excludeContentElements","lines","LIST_HEADER_REGEX","currentListHeaderNestingLevel","rawLineParts","numLeadingSpaces","processedLineParts","linePart","takeWhile","contentLines","checkboxState","isCheckbox"," ","X","-","newListItem","lastIndex","parseDescriptionPrefixElements","planningItemsParse","singlePlanningItemRegex","concatRegexes","optionalSinglePlanningItemRegex","planningRegex","planningMatch","planningTypeIndex","strippedDescription","_parsePlanningItems","propertyListParse","propertiesLineIndex","endLineIndex","parsePropertyList","defaultKeywordSets","keywords","completedKeywords","parseTitleLine","flatMap","titleParts","possibleTags","test","newHeaderWithTitle","opened","_len","regexes","Array","_key","reduce","prev","curr","parseOrg","fileContents","keywordTokens","pipeIndex","configLine","_parseDescriptionPref2","updateCookiesInAttributedStringWithChildCompletionStates","completionStates","doneCount","isDone","totalCount","floor","updateCookiesOfHeaderWithId","directChildren","subheader","updateCookiesOfParentOfHeaderWithId","currentTodoState","currentTodoSet","newStateIndex","newTodoState","indexedPlanningItemsWithRepeaters","currentDate","newDate","isBefore","applyRepeater","lastRepeatTimestamp","newLastRepeatValue","nextVisibleHeader","nextVisibleHeaderAfterIndex","previousVisibleHeader","previousVisibleHeaderAfterIndex","fileOpennessState","openHeaderPath","openHeaderWithPath","maxNestingLevel","firstTitle","rest","take","takeLast","updateDescriptionOfHeaderContainingTableCell","selectedTableCellId","rows","newEmptyTableRowLikeRows","_rowIndex","colIndex","isTopLevelTarget","newHeader","_parseDescriptionPref","newHeaderFromText","numSubheaders","newIndex","newCheckboxState","updateParentListCheckboxes","itemPath","parentListItemPath","parentListItem","has","childrenCheckedStates","checkboxItem","every","childCompletionStates","updateDescriptionOfHeaderContainingListItem","selectedListItemId","newItem","containingHeader","headerThatContainsListItemId","delete","selectedListItem","selectedListItemIndex","partOfPath","parentListItemWithIdInHeaders","_item","_pathAndPart2","_pathAndPart3","propertyListItemIndex","plistPathAndPart","indexOfTemplateWithId","captureTemplates","applyCaptureSettingsFromConfig","combineReducers","stack","pop","signOut","listing","directoryListing","hasMore","additionalSyncBackendState","setCurrentFileBrowserDirectoryListing","currentFileBrowserDirectoryListing","isLoadingMore","setIsLoadingMoreDirectoryListing","undoable","parsedFile","isOpened","openParentsOfHeader","newTitleLine","nextSibling","numHeadersToRemove","previousSiblingIndex","indexOfPreviousSibling","nextSiblingIndex","nextSiblingSubheaders","previousParentHeaderId","counter","prevSiblingItemIndex","prevSiblingItemContentsPath","childrenListParts","selectedHeaderId","splice","newPlanningItem","includeAction","linearizeHistory","templateIndex","orgFiles","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","src_store","createStore","rootReducer","applyMiddleware","thunk","googleAnalyticsLogger","liveSync","syncOnBecomingVisible","migrations","accessToken","removeItem","migrateAccessTokenToDropboxAccessToken","shouldStoreSettingsInDropbox","migrateStoreInDropboxToStoreInSyncBackend","parseQueryString","str","ret","create","param","shift","val","decodeURIComponent","isArray","token","gapi","getToken","google","accounts","oauth2","revoke","setToken","reload","getDirectoryListing","log","status","process","authURL","Dropbox","clientId","fetch","getAuthenticationUrl","origin","loadMoreDirectoryListing","getMoreDirectoryListing","extendedListing","pushBackup","pathOrFileId","duplicateFile","fileName","downloadFile","dropbox_sync_backend_client","dropboxClient","transformDirectoryListing","entry","isDirectory","path_display","uploadFile","Promise","resolve","reject","filesUpload","mode",".tag","autorename","filesDownload","response","reader","FileReader","server_modified","readAsText","fileBlob","isSignedIn","filesListFolder","has_more","cursor","filesListFolderContinue","filesDelete","google_drive_sync_backend_client","getAPIClient","isInited","isIniting","afterInitCallbacks","load","init","apiKey","discoveryDocs","asyncToGenerator","regenerator_default","a","mark","_callee","googleDriveAccessTokenString","googleDriveAccessToken","wrap","_context","initTokenClient","client_id","scope","callback","requestAccessToken","prompt","stop","handleGoogleDriveClientLoad","getFiles","directoryId","nextPageToken","fileListPromise","drive","files","list","pageSize","q","pageToken","mimeType","currentDirectoryId","fileParentPromise","fileId","parents","rootFolderIdPromise","rootFolderId","all","parentId","directoryParentId","fileIdByNameAndParent","method","Authorization","auth","access_token","body","alt","escape","errors","reason","fileModifiedTimePromise","modifiedTime","_ref6","fileNameCallback","getResponse","newFileName","backupFileId","makeCopy","copy","copyResponse","listResponse","PrivacyPolicy","react_default","createElement","className","HeaderBar","props","_this","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","bindAll","assertThisInitialized","_this$props","syncBackendType","directoryPath","pathParts","parentDirectoryName","parentPath","Link","to","filePath","src","logo","width","height","onClick","handleSettingsSubPageBackClick","activeModalPage","renderSettingsSubPageBackButton","getPathRoot","renderLogo","renderFileBrowserBackButton","renderOrgFileBackButton","renderSampleFileBackButton","renderSignInBackButton","titleContainerWithText","isUndoEnabled","undo","_this$props2","isAuthenticated","hasUnseenChangelog","handleModalPageDoneClick","undoIconClassName","classNames","header-bar__actions__item--disabled","settingsIconClassName","settings-icon--has-unseen-changelog","href","target","rel","react","handleUndoClick","handleHelpClick","handleSettingsClick","header-bar--with-logo","renderBackButton","renderTitle","renderActions","PureComponent","withRouter","connect","bindActionCreators","baseActions","undoActions","Landing","syncBackendActions","useEffect","isTopLevelDirectory","getParentDirectoryPath","file","isBackupFile","isOrgFile","isSettingsFile","iconClass","fa-folder","file-browser__file-list__icon--directory","fa-file","file-browser__file-list__icon--not-org","fa-copy","fa-cogs","LoadingIndicator","_useState","useState","_useState2","shouldRenderIndicator","setShouldRenderIndicator","_useState3","_useState4","lastMessage","setLastMessage","handleClick","style","opacity","spring","stiffness","react_motion","onRest","TableActionDrawer","_ref$subPartDataAndHa","subPartDataAndHandlers","onEnterTableEditMode","onAddNewTableRow","onRemoveTableRow","onAddNewTableColumn","onRemoveTableColumn","TablePart","rawCellValues","generateCellValueMap","shouldIgnoreBlur","prevProps","_this$props$subPartDa","onTableCellValueUpdate","inTableEditMode","setState","_this2","onTableCellSelect","_this3","onExitTableEditMode","event","cellValue","insertionIndex","textarea","selectionStart","selectionEnd","focus","_this4","_this$props$subPartDa2","shouldDisableActions","isTableSelected","isCellSelected","table-part__cell--selected","handleCellSelect","autoFocus","onBlur","handleTextareaBlur","onChange","handleCellChange","ref","handleTextareaRef","handleInsertTimestamp","AttributedString","react_collapse_lib","interpolateColors","colorA","colorB","interpolationFactor","r","parseInt","g","b","rgbaObject","rgbaString","rgba","Checkbox","uncheckedColor","checkedColor","checkboxStyle","colorFactor","backgroundColor","ListActionDrawer","onEnterListTitleEditMode","onEnterListContentsEditMode","onAddNewListItem","onRemoveListItem","ListPart","listTitleValues","generateListTitleValueMap","listContentsValues","generateListContentsValueMap","onListTitleValueUpdate","onListContentsValueUpdate","inListTitleEditMode","inListContentsEditMode","_this$state","prevSelectedListItemId","onListItemSelect","onCheckboxClick","onExitListTitleEditMode","listTitleValue","listContentsValue","_this5","_this$state2","isItemSelected","lineContainerClass","list-part__not_checkbox-container","list-part__checkbox-container","list-part__item--selected","handleListItemSelect","handleCheckboxClick","handleListTitleChange","handleInsertTimestampListTitle","handleListContentsChange","handleInsertTimestampListContents","renderContent","TimestampPart","onTimestampClick","attributed-string__cookie-part--complete","TablePart_TablePart","ListPart_ListPart","TitleLine","titleValue","calculateRawTitle","containerWidth","containerDiv","offsetWidth","storeContainerWidth","inEditMode","div","span","titleSpan","hasContent","isSelected","shouldTapTodoToAdvance","stopPropagation","newTitle","lastCharacter","_this$props3","color","shouldDisableExplicitWidth","titleStyle","wordBreak","handleTitleClick","handleRef","toLowerCase","handleTodoClick","handleTitleChange","handleTitleFieldClick","handleTitleSpanRef","handleTimestampClick","toSet","toList","orgActions","PlanningItems","PropertyListItems","onEdit","isDrawerCollapsed","setIsDrawerCollapsed","HeaderContent","descriptionValue","calculateRawDescription","planningItemsText","propertyListItemsText","descriptionText","startWhitespaces","indentStr","min","handleDescriptionChange","onFocus","scrollTop","scrollHeight","onKeyDown","preventDefault","currentContent","caretPosition","beforeText","afterText","newlineText","setSelectionRange","PlanningItems_PlanningItems","handlePlanningItemTimestampClick","handlePropertyListEdit","handleTableCellSelect","handleExitTableEditMode","handleTableCellValueUpdate","handleEnterTableEditMode","handleAddNewTableRow","handleRemoveTableRow","handleAddNewTableColumn","handleRemoveTableColumn","handleEnterListTitleEditMode","handleExitListTitleEditMode","handleListTitleValueUpdate","handleEnterListContentsEditMode","onExitListContentsEditMode","handleExitListContentsEditMode","handleListContentsValueUpdate","handleAddNewListItem","handleRemoveListItem","HeaderActionDrawer","onEnterTitleEditMode","onEnterDescriptionEditMode","onTagsClick","isFocused","onUnfocus","onAddNewHeader","onDeadlineClick","onScheduledClick","iconWithFFClickCatcher","Header","SWIPE_ACTION_ACTIVATION_DISTANCE","FREE_DRAG_ACTIVATION_DISTANCE","isDraggingFreely","dragStartX","dragStartY","currentDragX","isPlayingRemoveAnimation","heightBeforeRemove","onRef","dragX","dragY","closest","abs","swipeDistance","offsetHeight","handleDragStart","clientX","clientY","handleDragMove","handleDragEnd","handleDragCancel","changedTouches","classList","existingDeadlinePlanningItemIndex","handleDeadlineAndScheduledClick","bulletStyle","focusedHeader","indentLevel","_this$state3","paddingLeft","marginLeft","heightFactor","header--selected","header--removing","handleRest","interpolatedStyle","swipedDistance","isLeftActionActivated","isRightActionActivated","disabledColor","leftActivatedColor","rightActivatedColor","leftSwipeActionContainerStyle","backgroundColorFactor","rightSwipeActionContainerStyle","leftIconStyle","display","rightIconStyle","headerStyle","handleHeaderClick","onMouseDown","handleMouseDown","onMouseMove","handleMouseMove","onMouseUp","handleMouseUp","onMouseOut","handleMouseOut","onTouchStart","handleTouchStart","onTouchMove","handleTouchMove","onTouchEnd","handleTouchEnd","onTouchCancel","handleTouchCancel","leftInterpolatedStyle","leftStyle","rightInterpolatedStyle","rightStyle","components_TitleLine","springConfig","marginRight","HeaderActionDrawer_HeaderActionDrawer","handleEnterTitleEditMode","handleEnterDescriptionEditMode","handleShowTagsModal","handleFocus","handleUnfocus","handleAddNewHeader","handleDeadlineClick","handleScheduledClick","components_HeaderContent","HeaderList","headerRefs","selectedHeaderDiv","boundingRectangle","getBoundingClientRect","viewportHeight","document","documentElement","clientHeight","top","bottom","scrollIntoView","focusedHeaderId","headerRenderData","displayed","toArray","headerRenderDatum","previousRenderDatum","followingHeaders","followingHeaderIndex","followingHeader","focusedHeaderIndex","headerColors","displayedHeaderRenderData","header-list-container--focused","components_Header","handleHeaderRef","ActionButton","isDisabled","_classNames","subIconName","shouldRotateSubIcon","additionalClassName","tooltip","shouldSpinSubIcon","fas","fa-lg","subIconClassName","action-drawer__btn__sub-icon--rotated","fa-spin","isFocusedHeaderActive","captureActions","shouldDisableSyncButtons","isDisplayingArrowButtons","setIsDisplayingArrowButtons","isDisplayingCaptureButtons","setIsDisplayingCaptureButtons","querySelector","paddingBottom","mainArrowButton","useRef","mainArrowButtonBoundingRect","useMemo","current","handleUpClick","handleDownClick","handleLeftClick","handleRightClick","handleMoveSubtreeLeftClick","handleMoveSubtreeRightClick","getAvailableCaptureTemplates","availablePath","handleMainArrowButtonClick","handleMainCaptureButtonClick","ActionButton_ActionButton","baseArrowButtonStyle","boxShadow","centerXOffset","screen","x","animatedStyles","topRowYOffset","bottomRowYOffset","firstColumnXOffset","secondColumnXOffset","subIconNameStr","tooltipUpStr","tooltipDownStr","tooltipLeftStr","tooltipRightStr","left","right","renderMovementButtons","availableCaptureTemplates","baseCaptureButtonStyle","position","zIndex","mainButtonStyle","animatedStyle","renderCaptureButtons","UI_Switch","isEnabled","onToggle","enabledColor","switchStyle","grabberStyle","Drawer","children","shouldIncludeCloseButton","onClose","isVisible","setIsVisible","dragOffsetY","setDragOffsetY","useLayoutEffect","initialClientY","innerContainer","innerContainerHeight","handleInnerContainerClick","handleClose","targetTouches","isScrollingDown","handleTouchEndOrCancel","removeEventListener","outerClassName","drawer-outer-container--visible","innerStyle","offsetY","innerHeight","transform","CaptureModal","onCapture","_useMemo","_useMemo2","targetHeader","textareaValue","setTextareaValue","setShouldPrepend","capture-modal-header-path--top-level","SyncConfirmationModal","onPull","onPush","onCancel","distanceInWordsToNow","TagsEditorModal","allTags","prevTags","currentTags","lastTextfield","tagIndex","newTag","headerTags","react_beautiful_dnd_esm","droppableId","provided","snapshot","assign","innerRef","droppableProps","draggableId","tag-container--dragging","isDragging","draggableProps","handleTagChange","textfield","handleRemoveTag","dragHandleProps","placeholder","handleAddNewTag","all-tags__tag--in-use","handleExistingTagClick","TabButtons","buttons","selectedButton","useEqualWidthTabs","onSelect","handleButtonClick","buttonName","containerClassName","tab-buttons--equal-width-tabs","gridTemplateColumns","tab-buttons__btn--selected","TimestampEditor","_formatDate$split","_formatDate$split2","newYear","newMonth","newDay","newDayName","startOrEnd","_this2$props","hourKey","minuteKey","_formatDate$split3","_formatDate$split4","hour","minute","_this3$props","_this4$props","_event$target$value$s","_event$target$value$s2","newRepeaterType","_this$props4","_this$props5","newRepeaterUnit","_this$props6","_this$props7","_this$props8","newDelayType","_this$props9","_this$props10","newDelayUnit","_this$props11","label","timeKey","showRemoveButton","handleTimeChange","handleRemoveTime","handleAddTime","_this$props$timestamp","handleRepeaterTypeChange","handleRepeaterValueChange","handleRepeaterUnitChange","handleRemoveRepeater","handleAddRepeater","_this$props$timestamp2","handleDelayTypeChange","handleDelayValueChange","handleDelayUnitChange","handleRemoveDelay","handleAddDelay","handleActiveToggle","handleDateChange","renderTimeField","renderRepeater","renderDelay","TimestampEditorModal","singleTimestampOnly","TimestampEditor_TimestampEditor","handleChange","handleRemoveEndTimestamp","handleAddEndTimestamp","PropertyListEditorModal","prevItems","currentItems","propertyListItemId","property-list-editor__item-container--dragging","handlePropertyChange","handleValueChange","handleRemoveItem","handleAddNewItem","AgendaDay","onHeaderClick","dateDisplayType","onToggleDateDisplayType","agendaDefaultDeadlineDelayValue","agendaDefaultDeadlineDelayUnit","dateStart","startOfDay","dateEnd","endOfDay","planningItemsAndHeaders","planningItemDate","isTodoKeywordCompleted","isToday","appearDate","subHours","subDays","subWeeks","subMonths","subYears","subtractTimestampUnitFromDate","isEqual","isWithinRange","hasBeenRepeated","sortBy","_planningItem$get$toJ","hasTodoKeyword","dateClassName","agenda-day__header-planning-date--overdue","isPast","AgendaModal","selectedDate","timeframeType","weekStart","startOfWeek","weekEnd","_this$state4","dates","daysAfter","monthStart","startOfMonth","getDaysInMonth","handleTimeframeTypeChange","handlePreviousDateClick","calculateTimeframeHeader","handleNextDateClick","AgendaDay_AgendaDay","handleToggleDateDisplayType","DEFAULT_BINDINGS","calculateNamedKeybindings","customKeybindings","bindingName","binding","OrgFile","hasUncaughtError","loadedPath","container","newTags","activePopupData","popupData","activePopupType","selectedHeader","handleSyncConfirmationPull","handleSyncConfirmationPush","handleSyncConfirmationCancel","handleCapture","handlePopupClose","TagsEditorModal_TagsEditorModal","OrderedSet","sort","handleTagsChange","editingTimestamp","timestampWithId","TimestampEditorModal_TimestampEditorModal","handleTimestampChange","PropertyListEditorModal_PropertyListEditorModal","handlePropertyListItemsChange","components_AgendaModal","shouldDisableDirtyIndicator","parsingErrorMessage","orgFileErrorMessage","Redirect","keyMap","bindingAction","calculateActionedKeybindings","preventDefaultAndHandleEditMode","ignoreInEditMode","activeElement","nodeName","handlers","handleSelectNextVisibleHeaderHotKey","handleSelectPreviousVisibleHeaderHotKey","handleToggleHeaderOpenedHotKey","advanceTodo","handleAdvanceTodoHotKey","editTitle","handleEditTitleHotKey","editDescription","handleEditDescriptionHotKey","handleExitEditModeHotKey","handleAddHeaderHotKey","handleRemoveHeaderHotKey","handleMoveHeaderUpHotKey","handleMoveHeaderDownHotKey","handleMoveHeaderLeftHotKey","handleMoveHeaderRightHotKey","handleUndoHotKey","index_es","tabIndex","handleContainerRef","components_HeaderList","components_ActionDrawer","renderActivePopup","activePopup","fontSize","shouldStoreSettingsInSyncBackend","confirm","ShortcutRow","isEditMode","rebindArea","handleKeyPress","code","Minus","Equal","Backspace","Enter","Return","Tab","BracketLeft","BracketRight","Semicolon","Quote","Backslash","Comma","Period","Slash","newModifiers","modifier","newBinding","onBindingChange","currentBinding","symbol","rebindAreaClassName","keyboard-shortcut-container__shortcut-key--edit-mode","handleRebindClick","symbolizeKeybinding","handleBindingChange","alreadyInUseBinding","ShortcutRow_ShortcutRow","CaptureTemplate","onFieldPathUpdate","onAddNewTemplateOrgFileAvailability","onRemoveTemplateOrgFileAvailability","onAddNewTemplateHeaderPath","onRemoveTemplateHeaderPath","onDeleteTemplate","isCollapsed","setIsCollapsed","handleHeaderBarClick","updateField","fieldName","toggleAvailabilityInAllOrgFiles","togglePrepend","handleAddNewOrgFileAvailability","handleRemoveOrgFileAvailability","handleOrgFileAvailabilityChange","handleAddNewHeaderPath","handleRemoveHeaderPath","handleHeaderPathChange","handleDeleteClick","caretClassName","capture-template-container__header__caret--rotated","capture-template-container--dragging","renderDescriptionField","maxLength","autoCapitalize","autoCorrect","renderIconField","orgFilePath","renderOrgFileAvailability","marginTop","renderHeaderPaths","renderPrependField","renderTemplateField","handleFieldPathUpdate","handleAddNewTemplateOrgFileAvailability","handleRemoveTemplateOrgFileAvailability","handleAddNewTemplateHeaderPath","handleRemoveTemplateHeaderPath","handleDeleteTemplate","handleReorderTemplate","onReorder","SyncServiceSignIn","handleDropboxClick","DropboxLogo","handleGoogleDriveClick","GoogleDriveLogo","Entry","lastSeenChangelogHeader","firstHeaderTitle","shouldPromptWhenLeaving","onbeforeunload","components_OrgFile","shouldDisableActionDrawer","_ref$match$params$pat","params","components_FileBrowser","pendingCapturePath","shouldRedirectToCapturePath","entry-container--large-font","components_HeaderBar","Prompt","when","renderChangelogFile","components_Settings","components_KeyboardShortcutsEditor","components_CaptureTemplatesEditor","renderSampleFile","Switch","Route","exact","component","render","renderFile","renderFileBrowser","App","runAllMigrations","initialHash","hash","hashContents","authenticatedSyncService","dropboxAccessToken","createDropboxSyncBackendClient","persistedDropboxAccessToken","createGoogleDriveSyncBackendClient","queryStringContents","search","captureFile","captureTemplateName","capturePath","Store","subscribe","destination","source","onDragEnd","HashRouter","basename","es","components_Entry","isLocalhost","Boolean","hostname","registerValidSW","swUrl","navigator","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","ReactDOM","App_App","getElementById","URL","ready","unregister","checkValidServiceWorker","registerServiceWorker"],"mappings":"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","file":"static/js/main.3a4f6dbb.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/org-web.b087bbb4.svg\";","module.exports = __webpack_public_path__ + \"static/media/dropbox.44db08f0.svg\";","module.exports = __webpack_public_path__ + \"static/media/google_drive.f5fd3e02.png\";","/* global ga */\n\nexport default store => next => action => {\n  let { type, ...payload } = action;\n\n  const eventFieldsToRedact = {\n    SET_CURRENT_FILE_BROWSER_DIRECTORY_LISTING: ['directoryListing'],\n    AUTHENTICATE: ['dropboxAccessToken'],\n    DISPLAY_FILE: ['contents'],\n  };\n\n  if (!!eventFieldsToRedact[type]) {\n    eventFieldsToRedact[type].forEach(field => {\n      payload = { ...payload, [field]: '--REDACTED--' };\n    });\n  }\n\n  ga('send', 'event', 'action', type, JSON.stringify(payload));\n\n  return next(action);\n};\n","import { displayFile, stopDisplayingFile } from './org';\n\nimport raw from 'raw.macro';\n\nexport const setLoadingMessage = loadingMessage => ({\n  type: 'SET_LOADING_MESSAGE',\n  loadingMessage,\n});\n\nexport const hideLoadingMessage = () => ({\n  type: 'HIDE_LOADING_MESSAGE',\n});\n\nexport const setIsLoading = isLoading => ({\n  type: 'SET_IS_LOADING',\n  isLoading,\n});\n\nexport const setDisappearingLoadingMessage = (loadingMessage, delay) => dispatch => {\n  dispatch(setLoadingMessage(loadingMessage));\n  setTimeout(() => dispatch(hideLoadingMessage()), delay);\n};\n\nexport const setLastViewedFile = (lastViewedPath, lastViewedContents) => ({\n  type: 'SET_LAST_VIEWED_FILE',\n  lastViewedPath,\n  lastViewedContents,\n});\n\nexport const loadStaticFile = staticFile => {\n  return (dispatch, getState) => {\n    dispatch(\n      setLastViewedFile(getState().org.present.get('path'), getState().org.present.get('contents'))\n    );\n\n    const fileContents = {\n      changelog: raw('../../changelog.org'),\n      sample: raw('../../sample.org'),\n    }[staticFile];\n\n    dispatch(displayFile(null, fileContents));\n  };\n};\n\nexport const unloadStaticFile = () => {\n  return (dispatch, getState) => {\n    dispatch(stopDisplayingFile());\n\n    if (!!getState().base.get('lastViewedPath')) {\n      dispatch(\n        displayFile(\n          getState().base.get('lastViewedPath'),\n          getState().base.get('lastViewedContents')\n        )\n      );\n    }\n  };\n};\n\nexport const setFontSize = newFontSize => ({\n  type: 'SET_FONT_SIZE',\n  newFontSize,\n});\n\nexport const setBulletStyle = newBulletStyle => ({\n  type: 'SET_BULLET_STYLE',\n  newBulletStyle,\n});\n\nexport const setShouldTapTodoToAdvance = newShouldTapTodoToAdvance => ({\n  type: 'SET_SHOULD_TAP_TODO_TO_ADVANCE',\n  newShouldTapTodoToAdvance,\n});\n\nexport const setAgendaDefaultDeadlineDelayUnit = newAgendaDefaultDeadlineDelayUnit => ({\n  type: 'SET_AGENDA_DEFAULT_DEADLINE_DELAY_UNIT',\n  newAgendaDefaultDeadlineDelayUnit,\n});\n\nexport const setAgendaDefaultDeadlineDelayValue = newAgendaDefaultDeadlineDelayValue => ({\n  type: 'SET_AGENDA_DEFAULT_DEADLINE_DELAY_VALUE',\n  newAgendaDefaultDeadlineDelayValue,\n});\n\nexport const setShouldLiveSync = shouldLiveSync => ({\n  type: 'SET_SHOULD_LIVE_SYNC',\n  shouldLiveSync,\n});\n\nexport const setShouldSyncOnBecomingVisibile = shouldSyncOnBecomingVisibile => ({\n  type: 'SET_SHOULD_SYNC_ON_BECOMING_VISIBLE',\n  shouldSyncOnBecomingVisibile,\n});\n\nexport const setShouldStoreSettingsInSyncBackend = newShouldStoreSettingsInSyncBackend => {\n  return (dispatch, getState) => {\n    dispatch({\n      type: 'SET_SHOULD_STORE_SETTINGS_IN_SYNC_BACKEND',\n      newShouldStoreSettingsInSyncBackend,\n    });\n\n    if (!newShouldStoreSettingsInSyncBackend) {\n      const client = getState().syncBackend.get('client');\n      switch (client.type) {\n        case 'Dropbox':\n          client\n            .deleteFile('/.org-web-config.json')\n            .catch((doesFileNotExist, error) =>\n              doesFileNotExist\n                ? null\n                : alert(\n                    `There was an error trying to delete the .org-web-config.json file: ${error}`\n                  )\n            );\n          break;\n        case 'Google Drive':\n          client.deleteFileByNameAndParent('.org-web-config.json', 'root');\n          break;\n        default:\n      }\n\n      window.previousSettingsFileContents = null;\n    }\n  };\n};\n\nexport const setHasUnseenChangelog = newHasUnseenChangelog => ({\n  type: 'SET_HAS_UNSEEN_CHANGELOG',\n  newHasUnseenChangelog,\n});\n\nexport const setLastSeenChangelogHeader = newLastSeenChangelogHeader => ({\n  type: 'SET_LAST_SEEN_CHANGELOG_HEADER',\n  newLastSeenChangelogHeader,\n});\n\nexport const setCustomKeybinding = (keybindingName, keybinding) => ({\n  type: 'SET_CUSTOM_KEYBINDING',\n  keybindingName,\n  keybinding,\n});\n\nexport const restoreBaseSettings = newSettings => ({\n  type: 'RESTORE_BASE_SETTINGS',\n  newSettings,\n});\n\nexport const pushModalPage = modalPage => ({\n  type: 'PUSH_MODAL_PAGE',\n  modalPage,\n});\n\nexport const popModalPage = () => ({\n  type: 'POP_MODAL_PAGE',\n});\n\nexport const clearModalStack = () => ({\n  type: 'CLEAR_MODAL_STACK',\n});\n\nexport const activatePopup = (popupType, data) => ({\n  type: 'ACTIVATE_POPUP',\n  popupType,\n  data,\n});\n\nexport const closePopup = () => ({\n  type: 'CLOSE_POPUP',\n});\n","import formatDate from 'date-fns/format';\nimport parseDate from 'date-fns/parse';\nimport {\n  addHours,\n  addDays,\n  addWeeks,\n  addMonths,\n  addYears,\n  subHours,\n  subDays,\n  subWeeks,\n  subMonths,\n  subYears,\n  isBefore,\n} from 'date-fns';\n\nexport const renderAsText = timestamp => {\n  const {\n    isActive,\n    year,\n    month,\n    day,\n    dayName,\n    startHour,\n    startMinute,\n    endHour,\n    endMinute,\n    repeaterType,\n    repeaterValue,\n    repeaterUnit,\n    delayType,\n    delayValue,\n    delayUnit,\n  } = timestamp.toJS();\n\n  let timestampText = '';\n  timestampText += isActive ? '<' : '[';\n  timestampText += `${year}-${month}-${day}`;\n  timestampText += !!dayName ? ` ${dayName}` : '';\n  timestampText += !!startHour ? ` ${startHour}:${startMinute}` : '';\n  timestampText += !!endHour ? `-${endHour}:${endMinute}` : '';\n  timestampText += !!repeaterType ? ` ${repeaterType}${repeaterValue}${repeaterUnit}` : '';\n  timestampText += !!delayType ? ` ${delayType}${delayValue}${delayUnit}` : '';\n  timestampText += isActive ? '>' : ']';\n\n  return timestampText;\n};\n\nexport const getCurrentTimestamp = ({ isActive = true, withStartTime = false } = {}) => {\n  const time = new Date();\n\n  const timestamp = {\n    isActive,\n    year: formatDate(time, 'YYYY'),\n    month: formatDate(time, 'MM'),\n    day: formatDate(time, 'DD'),\n    dayName: formatDate(time, 'ddd'),\n    startHour: null,\n    startMinute: null,\n    endHour: null,\n    endMinute: null,\n    repeaterType: null,\n    repeaterValue: null,\n    repeaterUnit: null,\n    delayType: null,\n    delayValue: null,\n    delayUnit: null,\n  };\n\n  if (withStartTime) {\n    timestamp.startHour = formatDate(time, 'HH');\n    timestamp.startMinute = formatDate(time, 'mm');\n  }\n\n  return timestamp;\n};\n\nexport const getCurrentTimestampAsText = () => `[${formatDate(new Date(), 'YYYY-MM-DD ddd')}]`;\n\nexport const dateForTimestamp = timestamp => {\n  const { year, month, day, startHour, startMinute } = timestamp.toJS();\n\n  let timestampString = `${year}-${month}-${day}`;\n  if (!!startHour && !!startMinute) {\n    timestampString += ` ${startHour.padStart(2, '0')}:${startMinute}`;\n  }\n\n  return parseDate(timestampString);\n};\n\nexport const addTimestampUnitToDate = (date, numUnits, timestampUnit) =>\n  ({\n    h: addHours(date, numUnits),\n    d: addDays(date, numUnits),\n    w: addWeeks(date, numUnits),\n    m: addMonths(date, numUnits),\n    y: addYears(date, numUnits),\n  }[timestampUnit]);\n\nexport const subtractTimestampUnitFromDate = (date, numUnits, timestampUnit) =>\n  ({\n    h: subHours(date, numUnits),\n    d: subDays(date, numUnits),\n    w: subWeeks(date, numUnits),\n    m: subMonths(date, numUnits),\n    y: subYears(date, numUnits),\n  }[timestampUnit]);\n\nexport const applyRepeater = (timestamp, currentDate) => {\n  if (!timestamp.get('repeaterType')) {\n    return timestamp;\n  }\n\n  let newDate = null;\n  switch (timestamp.get('repeaterType')) {\n    case '+':\n      newDate = addTimestampUnitToDate(\n        dateForTimestamp(timestamp),\n        timestamp.get('repeaterValue'),\n        timestamp.get('repeaterUnit')\n      );\n      break;\n    case '++':\n      newDate = addTimestampUnitToDate(\n        dateForTimestamp(timestamp),\n        timestamp.get('repeaterValue'),\n        timestamp.get('repeaterUnit')\n      );\n      while (isBefore(newDate, currentDate)) {\n        newDate = addTimestampUnitToDate(\n          newDate,\n          timestamp.get('repeaterValue'),\n          timestamp.get('repeaterUnit')\n        );\n      }\n      break;\n    case '.+':\n      newDate = addTimestampUnitToDate(\n        new Date(),\n        timestamp.get('repeaterValue'),\n        timestamp.get('repeaterUnit')\n      );\n      break;\n    default:\n      console.error(`Unrecognized timestamp repeater type: ${timestamp.get('repeaterType')}`);\n      return timestamp;\n  }\n\n  timestamp = timestamp\n    .set('day', formatDate(newDate, 'DD'))\n    .set('dayName', formatDate(newDate, 'ddd'))\n    .set('month', formatDate(newDate, 'MM'))\n    .set('year', formatDate(newDate, 'YYYY'));\n\n  if (timestamp.get('startHour') !== undefined && timestamp.get('startHour') !== null) {\n    timestamp = timestamp\n      .set('startHour', formatDate(newDate, 'HH'))\n      .set('startMinute', formatDate(newDate, 'mm'));\n  }\n\n  return timestamp;\n};\n","import _ from 'lodash';\nimport { fromJS } from 'immutable';\n\nimport { renderAsText } from './timestamps';\n\nconst linkPartToRawText = linkPart => {\n  if (!!linkPart.getIn(['contents', 'title'])) {\n    return `[[${linkPart.getIn(['contents', 'uri'])}][${linkPart.getIn(['contents', 'title'])}]]`;\n  } else {\n    return `[[${linkPart.getIn(['contents', 'uri'])}]]`;\n  }\n};\n\nconst formattedAttributedStringText = parts => {\n  return parts\n    .map(part => {\n      switch (part.get('type')) {\n        case 'text':\n          return part.get('contents');\n        case 'link':\n          if (part.getIn(['contents', 'title'])) {\n            return part.getIn(['contents', 'title']);\n          } else {\n            return part.getIn(['contents', 'uri']);\n          }\n        case 'table':\n          return '';\n        default:\n          return '';\n      }\n    })\n    .join('');\n};\n\nconst tablePartToRawText = tablePart => {\n  const rowHeights = tablePart\n    .get('contents')\n    .map(row =>\n      Math.max(\n        ...row.get('contents').map(cell => (_.countBy(cell.get('rawContents'))['\\n'] || 0) + 1)\n      )\n    )\n    .toJS();\n\n  const numColumns = tablePart.getIn(['contents', 0, 'contents']).size;\n  const columnWidths = _.times(numColumns).map(columnIndex =>\n    Math.max(\n      ...tablePart.get('contents').map(row => {\n        const content = row.getIn(['contents', columnIndex, 'contents']);\n        const formattedText = formattedAttributedStringText(content);\n        const lineLengths = formattedText.split('\\n').map(line => line.trim().length);\n        return Math.max(...lineLengths);\n      })\n    )\n  );\n\n  const rowStrings = _.dropRight(\n    _.flatten(\n      tablePart\n        .get('contents')\n        .map((row, rowIndex) => {\n          const rowHeight = rowHeights[rowIndex];\n\n          const contentRows = _.times(rowHeight)\n            .map(lineIndex =>\n              row\n                .get('contents')\n                .map((cell, columnIndex) => {\n                  const content = cell.get('contents');\n                  const formattedText = formattedAttributedStringText(content);\n                  const formattedLineLengths = formattedText\n                    .split('\\n')\n                    .map(line => line.trim().length);\n                  const line = (cell.get('rawContents').split('\\n')[lineIndex] || '').trim();\n\n                  const padCount = columnWidths[columnIndex] - formattedLineLengths[lineIndex];\n\n                  return line + ' '.repeat(padCount);\n                })\n                .toJS()\n                .join(' | ')\n            )\n            .map(contentRow => `| ${contentRow} |`);\n\n          const separator =\n            '|' + columnWidths.map(columnWidth => '-'.repeat(columnWidth + 2)).join('+') + '|';\n\n          return contentRows.concat(separator);\n        })\n        .toJS()\n    )\n  );\n\n  return rowStrings.join('\\n');\n};\n\nconst listPartToRawText = listPart => {\n  const bulletCharacter = listPart.get('bulletCharacter');\n\n  let previousNumber = 0;\n  return listPart\n    .get('items')\n    .map(item => {\n      const optionalLeadingSpace = !listPart.get('isOrdered') && bulletCharacter === '*' ? ' ' : '';\n\n      const titleText = attributedStringToRawText(item.get('titleLine'));\n\n      const contentText = attributedStringToRawText(item.get('contents'));\n      const indentedContentText = contentText\n        .split('\\n')\n        .map(line => (!!line.trim() ? `${optionalLeadingSpace}  ${line}` : ''))\n        .join('\\n');\n\n      let listItemText = null;\n      if (listPart.get('isOrdered')) {\n        let number = ++previousNumber;\n        let forceNumber = item.get('forceNumber');\n        if (!!forceNumber) {\n          number = forceNumber;\n          previousNumber = number;\n        }\n\n        listItemText = `${number}${listPart.get('numberTerminatorCharacter')}`;\n\n        if (!!forceNumber) {\n          listItemText += ` [@${forceNumber}]`;\n        }\n\n        if (item.get('isCheckbox')) {\n          const stateCharacter = {\n            checked: 'X',\n            unchecked: ' ',\n            partial: '-',\n          }[item.get('checkboxState')];\n\n          listItemText += ` [${stateCharacter}]`;\n        }\n\n        listItemText += ` ${titleText}`;\n      } else {\n        listItemText = `${optionalLeadingSpace}${bulletCharacter}`;\n\n        if (item.get('isCheckbox')) {\n          const stateCharacter = {\n            checked: 'X',\n            unchecked: ' ',\n            partial: '-',\n          }[item.get('checkboxState')];\n\n          listItemText += ` [${stateCharacter}]`;\n        }\n\n        listItemText += ` ${titleText}`;\n      }\n\n      if (!!contentText) {\n        listItemText += `\\n${indentedContentText}`;\n      }\n\n      return listItemText;\n    })\n    .join('\\n');\n};\n\nconst timestampPartToRawText = part => {\n  let text = renderAsText(part.get('firstTimestamp'));\n  if (part.get('secondTimestamp')) {\n    text += `--${renderAsText(part.get('secondTimestamp'))}`;\n  }\n\n  return text;\n};\n\nexport const attributedStringToRawText = parts => {\n  if (!parts) {\n    return '';\n  }\n\n  const prevParts = parts.unshift(null);\n\n  return parts\n    .zip(prevParts)\n    .map(([part, prevPart]) => {\n      let text = '';\n      switch (part.get('type')) {\n        case 'text':\n          text = part.get('contents');\n          break;\n        case 'link':\n          text = linkPartToRawText(part);\n          break;\n        case 'fraction-cookie':\n          text = `[${part.getIn(['fraction', 0]) || ''}/${part.getIn(['fraction', 1]) || ''}]`;\n          break;\n        case 'percentage-cookie':\n          text = `[${part.get('percentage') || ''}%]`;\n          break;\n        case 'table':\n          text = tablePartToRawText(part);\n          break;\n        case 'list':\n          text = listPartToRawText(part);\n          break;\n        case 'timestamp':\n          text = timestampPartToRawText(part);\n          break;\n        default:\n          console.error(\n            `Unknown attributed string part type in attributedStringToRawText: ${part.get('type')}`\n          );\n      }\n\n      let optionalNewlinePrefix = '';\n      if (!!prevPart) {\n        if (['list', 'table'].includes(prevPart.get('type'))) {\n          optionalNewlinePrefix = '\\n';\n        } else if (\n          part.get('type') === 'list' &&\n          prevPart.get('type') === 'text' &&\n          !prevPart.get('contents').endsWith('\\n')\n        ) {\n          optionalNewlinePrefix = '\\n';\n        }\n      }\n      return optionalNewlinePrefix + text;\n    })\n    .join('');\n};\n\nexport default (headers, todoKeywordSets, fileConfigLines, linesBeforeHeadings) => {\n  let configContent = '';\n\n  if (fileConfigLines.size > 0) {\n    configContent = fileConfigLines.join('\\n') + '\\n';\n  }\n\n  if (!todoKeywordSets.get(0).get('default')) {\n    configContent =\n      configContent +\n      todoKeywordSets\n        .map(todoKeywordSet => {\n          return todoKeywordSet.get('configLine');\n        })\n        .join('\\n') +\n      '\\n';\n  }\n\n  if (linesBeforeHeadings.size > 0) {\n    configContent = configContent + linesBeforeHeadings.join('\\n');\n  }\n\n  // TODO: maybe this adds empty lines?\n  if (configContent.length > 0) {\n    configContent = configContent + '\\n';\n  }\n\n  const headerContent = headers\n    .toJS()\n    .map(header => {\n      let contents = '';\n      contents += '*'.repeat(header.nestingLevel);\n\n      if (header.titleLine.todoKeyword) {\n        contents += ` ${header.titleLine.todoKeyword}`;\n      }\n      contents += ` ${header.titleLine.rawTitle}`;\n\n      if (header.titleLine.tags.length > 0) {\n        contents += ` :${header.titleLine.tags.filter(tag => !!tag).join(':')}:`;\n      }\n\n      if (header.planningItems.length > 0) {\n        const planningItemsContent = header.planningItems\n          .map(\n            planningItem => `${planningItem.type}: ${renderAsText(fromJS(planningItem.timestamp))}`\n          )\n          .join(' ')\n          .trimRight();\n        contents += `\\n  ${planningItemsContent}`;\n      }\n\n      if (header.propertyListItems.length > 0) {\n        contents += '\\n:PROPERTIES:';\n        header.propertyListItems.forEach(propertyListItem => {\n          contents += `\\n:${propertyListItem.property}: ${attributedStringToRawText(\n            fromJS(propertyListItem.value)\n          )}`;\n        });\n        contents += '\\n:END:\\n';\n      }\n\n      if (header.description) {\n        if (!header.rawDescription.startsWith('\\n') && header.rawDescription.length !== 0) {\n          contents += '\\n';\n        }\n        contents += header.rawDescription;\n      }\n\n      return contents;\n    })\n    .join('\\n');\n\n  return configContent + headerContent;\n};\n","import { Map } from 'immutable';\nimport formatDate from 'date-fns/format';\nimport _ from 'lodash';\n\nexport default (templateString, customVariables = Map()) => {\n  if (!templateString) {\n    return ['', null];\n  }\n\n  const substitutions = {\n    '%t': `<${formatDate(new Date(), 'YYYY-MM-DD ddd')}>`,\n    '%T': `<${formatDate(new Date(), 'YYYY-MM-DD ddd HH:mm')}>`,\n    '%u': `[${formatDate(new Date(), 'YYYY-MM-DD ddd')}]`,\n    '%U': `[${formatDate(new Date(), 'YYYY-MM-DD ddd HH:mm')}]`,\n  };\n\n  customVariables.entrySeq().forEach(([key, value]) => {\n    substitutions[`%${key}`] = value;\n  });\n\n  let substitutedString = templateString;\n  _.entries(substitutions).forEach(\n    ([formatString, value]) =>\n      (substitutedString = substitutedString.replace(RegExp(formatString, 'g'), value))\n  );\n\n  const cursorIndex = substitutedString.includes('%?') ? substitutedString.indexOf('%?') : null;\n  substitutedString = substitutedString.replace(/%\\?/, '');\n\n  return [substitutedString, cursorIndex];\n};\n","export default (() => {\n  let nextId = 1;\n  return () => nextId++;\n})();\n","import generateId from './id_generator';\n\nimport { List, fromJS } from 'immutable';\n\nexport const indexOfHeaderWithId = (headers, headerId) => {\n  return headers.findIndex(header => header.get('id') === headerId);\n};\n\nexport const headerWithId = (headers, headerId) => {\n  return headers.get(indexOfHeaderWithId(headers, headerId));\n};\n\nexport const subheadersOfHeaderWithId = (headers, headerId) => {\n  const header = headerWithId(headers, headerId);\n  const headerIndex = indexOfHeaderWithId(headers, headerId);\n\n  const afterHeaders = headers.slice(headerIndex + 1);\n  const nextSiblingHeaderIndex = afterHeaders.findIndex(siblingHeader => {\n    return siblingHeader.get('nestingLevel') <= header.get('nestingLevel');\n  });\n\n  if (nextSiblingHeaderIndex === -1) {\n    return afterHeaders;\n  } else {\n    return afterHeaders.slice(0, nextSiblingHeaderIndex);\n  }\n};\n\nexport const numSubheadersOfHeaderWithId = (headers, headerId) =>\n  subheadersOfHeaderWithId(headers, headerId).size;\n\nexport const directParentIdOfHeaderWithId = (headers, headerId) => {\n  const header = headerWithId(headers, headerId);\n  const headerIndex = indexOfHeaderWithId(headers, headerId);\n\n  for (let i = headerIndex - 1; i >= 0; --i) {\n    const previousHeader = headers.get(i);\n\n    if (previousHeader.get('nestingLevel') === header.get('nestingLevel') - 1) {\n      return previousHeader.get('id');\n    }\n\n    if (previousHeader.get('nestingLevel') < header.get('nestingLevel')) {\n      return null;\n    }\n  }\n\n  return null;\n};\n\nexport const parentIdOfHeaderWithId = (headers, headerId) => {\n  const header = headerWithId(headers, headerId);\n  const headerIndex = indexOfHeaderWithId(headers, headerId);\n\n  const previousHeaders = headers.slice(0, headerIndex).reverse();\n  const parentHeader = previousHeaders.find(\n    previousHeader => previousHeader.get('nestingLevel') < header.get('nestingLevel')\n  );\n\n  if (!parentHeader) {\n    return null;\n  }\n\n  return parentHeader.get('id');\n};\n\nexport const indexOfPreviousSibling = (headers, headerIndex) => {\n  const nestingLevel = headers.getIn([headerIndex, 'nestingLevel']);\n\n  for (let i = headerIndex - 1; i >= 0; --i) {\n    const header = headers.get(i);\n\n    if (header.get('nestingLevel') < nestingLevel) {\n      return null;\n    }\n\n    if (header.get('nestingLevel') === nestingLevel) {\n      return i;\n    }\n  }\n\n  return null;\n};\n\nconst isHeaderVisible = (headers, headerId) => {\n  const parentHeaderId = parentIdOfHeaderWithId(headers, headerId);\n  if (!parentHeaderId) {\n    return true;\n  }\n\n  const parentHeader = headerWithId(headers, parentHeaderId);\n  return parentHeader.get('opened') && isHeaderVisible(headers, parentHeader.get('id'));\n};\n\nexport const nextVisibleHeaderAfterIndex = (headers, headerIndex) => {\n  const followingHeaders = headers.slice(headerIndex + 1);\n  return followingHeaders.find(header => isHeaderVisible(headers, header.get('id')));\n};\n\nexport const previousVisibleHeaderAfterIndex = (headers, headerIndex) => {\n  const previousHeaders = headers.slice(0, headerIndex).reverse();\n  return previousHeaders.find(header => isHeaderVisible(headers, header.get('id')));\n};\n\nexport const openDirectParent = (state, headerId) => {\n  const parentHeaderId = directParentIdOfHeaderWithId(state.get('headers'), headerId);\n  if (parentHeaderId !== null) {\n    const parentHeaderIndex = indexOfHeaderWithId(state.get('headers'), parentHeaderId);\n    state = state.setIn(['headers', parentHeaderIndex, 'opened'], true);\n  }\n\n  return state;\n};\n\nexport const getOpenHeaderPaths = headers => {\n  let openedHeaders = [];\n  for (let i = 0; i < headers.size; ++i) {\n    const header = headers.get(i);\n    if (!header.get('opened')) {\n      continue;\n    }\n\n    const title = header.getIn(['titleLine', 'rawTitle']);\n\n    const subheaders = subheadersOfHeaderWithId(headers, header.get('id'));\n    const openSubheaderPaths = getOpenHeaderPaths(subheaders);\n\n    if (openSubheaderPaths.length > 0) {\n      openSubheaderPaths.forEach(openedSubheaderPath => {\n        openedHeaders.push([title].concat(openedSubheaderPath));\n      });\n    } else {\n      openedHeaders.push([title]);\n    }\n\n    i += subheaders.size;\n  }\n\n  return openedHeaders;\n};\n\nexport const headerWithPath = (headers, headerPath) => {\n  if (headerPath.size === 0) {\n    return null;\n  }\n\n  const firstHeader = headers.find(\n    header =>\n      parentIdOfHeaderWithId(headers, header.get('id')) === null &&\n      header.getIn(['titleLine', 'rawTitle']).trim() === headerPath.first().trim()\n  );\n  if (!firstHeader) {\n    return null;\n  }\n\n  if (headerPath.size === 1) {\n    return firstHeader;\n  }\n\n  const subheaders = subheadersOfHeaderWithId(headers, firstHeader.get('id'));\n  return headerWithPath(subheaders, headerPath.skip(1));\n};\n\nexport const openHeaderWithPath = (headers, headerPath, maxNestingLevel = 1) => {\n  if (headerPath.size === 0) {\n    return headers;\n  }\n\n  const firstTitle = headerPath.first();\n  const headerIndex = headers.findIndex(header => {\n    const rawTitle = header.getIn(['titleLine', 'rawTitle']);\n    const nestingLevel = header.get('nestingLevel');\n    return rawTitle === firstTitle && nestingLevel <= maxNestingLevel;\n  });\n  if (headerIndex === -1) {\n    return headers;\n  }\n\n  headers = headers.update(headerIndex, header => header.set('opened', true));\n\n  let subheaders = subheadersOfHeaderWithId(headers, headers.getIn([headerIndex, 'id']));\n  subheaders = openHeaderWithPath(subheaders, headerPath.rest(), maxNestingLevel + 1);\n\n  headers = headers\n    .take(headerIndex + 1)\n    .concat(subheaders)\n    .concat(headers.takeLast(headers.size - (headerIndex + 1 + subheaders.size)));\n\n  return headers;\n};\n\nconst tablePartContainsCellId = (tablePart, cellId) =>\n  tablePart\n    .get('contents')\n    .some(row => row.get('contents').some(cell => cell.get('id') === cellId));\n\nconst doesAttributedStringContainTableCellId = (parts, cellId) =>\n  parts\n    .filter(part => ['table', 'list'].includes(part.get('type')))\n    .some(part =>\n      part.get('type') === 'table'\n        ? tablePartContainsCellId(part, cellId)\n        : part\n            .get('items')\n            .some(item => doesAttributedStringContainTableCellId(item.get('contents'), cellId))\n    );\n\nexport const headerThatContainsTableCellId = (headers, cellId) =>\n  headers.find(header => doesAttributedStringContainTableCellId(header.get('description'), cellId));\n\nexport const pathAndPartOfTimestampItemWithIdInAttributedString = (parts, timestampId) =>\n  parts\n    .map((part, partIndex) => {\n      if (part.get('type') === 'timestamp' && part.get('id') === timestampId) {\n        return {\n          path: [partIndex],\n          timestampPart: part,\n        };\n      } else if (part.get('type') === 'list') {\n        return part\n          .get('items')\n          .map((item, itemIndex) => {\n            let pathAndPart = pathAndPartOfTimestampItemWithIdInAttributedString(\n              item.get('contents'),\n              timestampId\n            );\n            if (!!pathAndPart) {\n              const { path, timestampPart } = pathAndPart;\n              return {\n                path: [partIndex, 'items', itemIndex, 'contents'].concat(path),\n                timestampPart,\n              };\n            } else {\n              let pathAndPart = pathAndPartOfTimestampItemWithIdInAttributedString(\n                item.get('titleLine'),\n                timestampId\n              );\n              if (!!pathAndPart) {\n                const { path, timestampPart } = pathAndPart;\n                return {\n                  path: [partIndex, 'items', itemIndex, 'titleLine'].concat(path),\n                  timestampPart,\n                };\n              } else {\n                return null;\n              }\n            }\n          })\n          .filter(result => !!result)\n          .first();\n      } else if (part.get('type') === 'table') {\n        return part\n          .get('contents')\n          .map((row, rowIndex) => {\n            return row\n              .get('contents')\n              .map((cell, cellIndex) => {\n                const pathAndPart = pathAndPartOfTimestampItemWithIdInAttributedString(\n                  cell.get('contents'),\n                  timestampId\n                );\n                if (!!pathAndPart) {\n                  const { path, timestampPart } = pathAndPart;\n                  return {\n                    path: [\n                      partIndex,\n                      'contents',\n                      rowIndex,\n                      'contents',\n                      cellIndex,\n                      'contents',\n                    ].concat(path),\n                    timestampPart,\n                  };\n                } else {\n                  return null;\n                }\n              })\n              .filter(result => !!result)\n              .first();\n          })\n          .filter(result => !!result)\n          .first();\n      } else {\n        return null;\n      }\n    })\n    .filter(result => !!result)\n    .first();\n\nconst listPartContainsItemId = (listPart, itemId) =>\n  listPart.get('items').some(item => item.get('id') === itemId);\n\nexport const headerThatContainsListItemId = (headers, listItemId) => {\n  const pathAndPart = pathAndPartOfListItemWithIdInHeaders(headers, listItemId);\n  const headerIndex = pathAndPart.path[0];\n  return headers.get(headerIndex);\n};\n\nexport const pathAndPartOfListItemWithIdInAttributedString = (parts, listItemId) =>\n  parts\n    .map((part, partIndex) => {\n      if (part.get('type') === 'list') {\n        return part\n          .get('items')\n          .map((item, itemIndex) => {\n            if (item.get('id') === listItemId) {\n              return {\n                path: [partIndex, 'items', itemIndex],\n                listItemPart: item,\n              };\n            } else {\n              const pathAndPart = pathAndPartOfListItemWithIdInAttributedString(\n                item.get('contents'),\n                listItemId\n              );\n              if (!!pathAndPart) {\n                const { path, listItemPart } = pathAndPart;\n                return {\n                  path: [partIndex, 'items', itemIndex, 'contents'].concat(path),\n                  listItemPart,\n                };\n              } else {\n                return null;\n              }\n            }\n          })\n          .filter(result => !!result)\n          .first();\n      } else {\n        return null;\n      }\n    })\n    .filter(result => !!result)\n    .first();\n\nexport const pathAndPartOfTableContainingCellIdInAttributedString = (parts, cellId) =>\n  parts\n    .map((part, partIndex) => {\n      if (part.get('type') === 'table') {\n        if (tablePartContainsCellId(part, cellId)) {\n          return { path: [partIndex], tablePart: part };\n        } else {\n          return null;\n        }\n      } else if (part.get('type') === 'list') {\n        return part\n          .get('items')\n          .map((item, itemIndex) => {\n            const pathAndPart = pathAndPartOfTableContainingCellIdInAttributedString(\n              item.get('contents'),\n              cellId\n            );\n            if (!!pathAndPart) {\n              const { path, tablePart } = pathAndPart;\n              return {\n                path: [partIndex, 'items', itemIndex, 'contents'].concat(path),\n                tablePart,\n              };\n            } else {\n              return null;\n            }\n          })\n          .filter(result => !!result)\n          .first();\n      } else {\n        return null;\n      }\n    })\n    .filter(result => !!result)\n    .first();\n\nexport const pathAndPartOfListContainingItemIdInHeaders = (headers, itemId) =>\n  headers\n    .map((header, headerIndex) => {\n      const pathAndPart = pathAndPartOfListContainingItemIdInAttributedString(\n        header.get('description'),\n        itemId\n      );\n      if (!pathAndPart) {\n        return null;\n      }\n\n      const { path, listPart } = pathAndPart;\n      return {\n        path: [headerIndex, 'description'].concat(path),\n        listPart,\n      };\n    })\n    .filter(result => !!result)\n    .first();\n\nexport const pathAndPartOfListContainingItemIdInAttributedString = (parts, itemId) =>\n  parts\n    .map((part, partIndex) => {\n      if (part.get('type') === 'list') {\n        if (listPartContainsItemId(part, itemId)) {\n          return { path: [partIndex], listPart: part };\n        } else {\n          return part\n            .get('items')\n            .map((item, itemIndex) => {\n              const pathAndPart = pathAndPartOfListContainingItemIdInAttributedString(\n                item.get('contents'),\n                itemId\n              );\n              if (!!pathAndPart) {\n                const { path, listPart } = pathAndPart;\n                return {\n                  path: [partIndex, 'items', itemIndex, 'contents'].concat(path),\n                  listPart,\n                };\n              } else {\n                return null;\n              }\n            })\n            .filter(result => !!result)\n            .first();\n        }\n      } else {\n        return null;\n      }\n    })\n    .filter(result => !!result)\n    .first();\n\nexport const pathAndPartOfTimestampItemWithIdInHeaders = (headers, timestampId) =>\n  headers\n    .map((header, headerIndex) => {\n      let pathAndPart = pathAndPartOfTimestampItemWithIdInAttributedString(\n        header.getIn(['titleLine', 'title']),\n        timestampId\n      );\n      if (!!pathAndPart) {\n        const { path, timestampPart } = pathAndPart;\n        return {\n          path: [headerIndex, 'titleLine', 'title'].concat(path),\n          timestampPart,\n        };\n      }\n\n      pathAndPart = pathAndPartOfTimestampItemWithIdInAttributedString(\n        header.get('description'),\n        timestampId\n      );\n      if (!!pathAndPart) {\n        const { path, timestampPart } = pathAndPart;\n        return {\n          path: [headerIndex, 'description'].concat(path),\n          timestampPart,\n        };\n      }\n\n      pathAndPart = header\n        .get('propertyListItems')\n        .map((propertyListItem, propertyListItemIndex) => {\n          if (!propertyListItem.get('value')) {\n            return null;\n          }\n\n          const plistPathAndPart = pathAndPartOfTimestampItemWithIdInAttributedString(\n            propertyListItem.get('value'),\n            timestampId\n          );\n          if (!!plistPathAndPart) {\n            const { path, timestampPart } = plistPathAndPart;\n            return {\n              path: [headerIndex, 'propertyListItems', propertyListItemIndex, 'value'].concat(path),\n              timestampPart,\n            };\n          }\n\n          return null;\n        })\n        .filter(result => !!result)\n        .first();\n      if (!!pathAndPart) {\n        return pathAndPart;\n      }\n\n      return null;\n    })\n    .filter(result => !!result)\n    .first();\n\nexport const pathAndPartOfListItemWithIdInHeaders = (headers, listItemId) =>\n  headers\n    .map((header, headerIndex) => {\n      const pathAndPart = pathAndPartOfListItemWithIdInAttributedString(\n        header.get('description'),\n        listItemId\n      );\n      if (!pathAndPart) {\n        return null;\n      }\n\n      const { path, listItemPart } = pathAndPart;\n      return {\n        path: [headerIndex, 'description'].concat(path),\n        listItemPart,\n      };\n    })\n    .filter(result => !!result)\n    .first();\n\nexport const pathAndPartOfTableContainingCellIdInHeaders = (headers, cellId) =>\n  headers\n    .map((header, headerIndex) => {\n      const pathAndPart = pathAndPartOfTableContainingCellIdInAttributedString(\n        header.get('description'),\n        cellId\n      );\n      if (!pathAndPart) {\n        return null;\n      }\n\n      const { path, tablePart } = pathAndPart;\n      return {\n        path: [headerIndex, 'description'].concat(path),\n        tablePart,\n      };\n    })\n    .filter(result => !!result)\n    .first();\n\nexport const updateTableContainingCellId = (headers, cellId, updaterCallbackGenerator) => {\n  const { path, tablePart } = pathAndPartOfTableContainingCellIdInHeaders(headers, cellId);\n\n  const rowIndexContainingCellId = tablePart\n    .get('contents')\n    .findIndex(row => row.get('contents').some(cell => cell.get('id') === cellId));\n  const columnIndexContainingCellId = tablePart\n    .getIn(['contents', rowIndexContainingCellId, 'contents'])\n    .findIndex(cell => cell.get('id') === cellId);\n\n  return headers.updateIn(\n    path.concat(['contents']),\n    updaterCallbackGenerator(rowIndexContainingCellId, columnIndexContainingCellId)\n  );\n};\n\nexport const newEmptyTableRowLikeRows = rows =>\n  rows\n    .get(0)\n    .set('id', generateId())\n    .update('contents', contents =>\n      contents.map(cell =>\n        cell.set('id', generateId()).set('contents', new List()).set('rawContents', '')\n      )\n    );\n\nexport const newEmptyTableCell = () =>\n  fromJS({\n    id: generateId(),\n    contents: [],\n    rawContents: '',\n  });\n\nexport const newListPart = () =>\n  fromJS({\n    type: 'list',\n    id: generateId(),\n    items: [],\n    bulletCharacter: '-',\n    numberTerminatorCharacter: null,\n    isOrdered: false,\n  });\n\nexport const newListPartLikePart = part => part.set('id', generateId()).set('items', new List());\n\nexport const newListItem = () =>\n  fromJS({\n    id: generateId(),\n    titleLine: [],\n    contents: [],\n    forceNumber: null,\n    isCheckbox: false,\n  });\n\nexport const parentListItemWithIdInHeaders = (headers, listItemId) => {\n  const pathAndPart = pathAndPartOfListItemWithIdInHeaders(headers, listItemId);\n  let { path } = pathAndPart;\n  return headers.getIn(path.slice(0, path.length - 4));\n};\n\nexport const updateListContainingListItemId = (headers, listItemId, updaterCallbackGenerator) => {\n  const { path, listPart } = pathAndPartOfListContainingItemIdInHeaders(headers, listItemId);\n\n  const itemIndexContainingId = listPart\n    .get('items')\n    .findIndex(item => item.get('id') === listItemId);\n\n  return headers.updateIn(path.concat(['items']), updaterCallbackGenerator(itemIndexContainingId));\n};\n\nexport const updateContentsWithListItemAddition = (parts, listItem, listPart = null) => {\n  if (parts.size === 0 || parts.last().get('type') !== 'list') {\n    const insertIdx = parts.size;\n    if (!!listPart) {\n      parts = parts.insert(insertIdx, newListPartLikePart(listPart));\n    } else {\n      parts = parts.insert(insertIdx, newListPart());\n    }\n  }\n\n  return parts.map(part => {\n    switch (part.get('type')) {\n      case 'list':\n        return part.update('items', items => items.push(listItem));\n      default:\n        return part;\n    }\n  });\n};\n\nexport const timestampWithIdInAttributedString = (parts, timestampId) => {\n  if (!parts) {\n    return null;\n  }\n\n  const pathAndPart = pathAndPartOfTimestampItemWithIdInAttributedString(parts, timestampId);\n  if (!!pathAndPart) {\n    return pathAndPart.timestampPart;\n  } else {\n    return null;\n  }\n};\n\nexport const timestampWithId = (headers, timestampId) =>\n  headers\n    .map(\n      header =>\n        timestampWithIdInAttributedString(header.getIn(['titleLine', 'title']), timestampId) ||\n        timestampWithIdInAttributedString(header.get('description'), timestampId) ||\n        header\n          .get('propertyListItems')\n          .map(propertyListItem =>\n            timestampWithIdInAttributedString(propertyListItem.get('value'), timestampId)\n          )\n          .filter(result => !!result)\n          .first()\n    )\n    .find(result => !!result);\n\nexport const todoKeywordSetForKeyword = (todoKeywordSets, keyword) =>\n  todoKeywordSets.find(keywordSet => keywordSet.get('keywords').contains(keyword)) ||\n  todoKeywordSets.first();\n\nexport const isTodoKeywordCompleted = (todoKeywordSets, keyword) =>\n  todoKeywordSetForKeyword(todoKeywordSets, keyword).get('completedKeywords').includes(keyword);\n","import generateId from './id_generator';\n\nimport { fromJS } from 'immutable';\n\nexport default fromJS([\n  {\n    description: 'Groceries',\n    headerPaths: ['Capture', 'Groceries'],\n    iconName: 'lemon',\n    id: generateId(),\n    isAvailableInAllOrgFiles: false,\n    letter: '',\n    orgFilesWhereAvailable: [],\n    shouldPrepend: false,\n    template: '* TODO %?',\n    isSample: true,\n  },\n  {\n    description: 'Deeply nested header',\n    headerPaths: ['Capture', 'Deeply', 'Nested', 'Headers', 'Work', 'Too!'],\n    iconName: 'fighter-jet',\n    id: generateId(),\n    isAvailableInAllOrgFiles: false,\n    letter: '',\n    orgFilesWhereAvailable: [],\n    shouldPrepend: true,\n    template: '* You can insert timestamps too! %T %?',\n    isSample: true,\n  },\n]);\n","import { ActionTypes } from 'redux-linear-undo';\nimport {\n  setLoadingMessage,\n  hideLoadingMessage,\n  setIsLoading,\n  setDisappearingLoadingMessage,\n  activatePopup,\n  closePopup,\n} from './base';\nimport exportOrg from '../lib/export_org';\nimport substituteTemplateVariables from '../lib/capture_template_substitution';\nimport { headerWithPath } from '../lib/org_utils';\n\nimport sampleCaptureTemplates from '../lib/sample_capture_templates';\n\nimport { isAfter, addSeconds } from 'date-fns';\nimport parseDate from 'date-fns/parse';\n\nexport const displayFile = (path, contents) => ({\n  type: 'DISPLAY_FILE',\n  path,\n  contents,\n});\n\nexport const setLastSyncAt = lastSyncAt => ({\n  type: 'SET_LAST_SYNC_AT',\n  lastSyncAt,\n});\n\nexport const stopDisplayingFile = () => {\n  return (dispatch, getState) => {\n    dispatch({ type: 'STOP_DISPLAYING_FILE' });\n    dispatch({ type: ActionTypes.CLEAR_HISTORY });\n    dispatch(unfocusHeader());\n    dispatch(closePopup());\n    dispatch(setLastSyncAt(null));\n  };\n};\n\nexport const sync =\n  ({\n    forceAction = null,\n    successMessage = 'Changes pushed',\n    shouldSuppressMessages = false,\n  } = {}) =>\n  (dispatch, getState) => {\n    const client = getState().syncBackend.get('client');\n    const path = getState().org.present.get('path');\n    if (path === null) {\n      return;\n    }\n\n    if (!shouldSuppressMessages) {\n      dispatch(setLoadingMessage('Syncing...'));\n    }\n    dispatch(setIsLoading(true));\n    dispatch(setOrgFileErrorMessage(null));\n\n    client\n      .getFileContentsAndMetadata(path)\n      .then(({ contents, lastModifiedAt }) => {\n        const isDirty = getState().org.present.get('isDirty');\n        const lastServerModifiedAt = parseDate(lastModifiedAt);\n        const lastSyncAt = getState().org.present.get('lastSyncAt');\n\n        if (isAfter(lastSyncAt, lastServerModifiedAt) || forceAction === 'push') {\n          if (isDirty) {\n            client\n              .updateFile(\n                path,\n                exportOrg(\n                  getState().org.present.get('headers'),\n                  getState().org.present.get('todoKeywordSets'),\n                  getState().org.present.get('fileConfigLines'),\n                  getState().org.present.get('linesBeforeHeadings')\n                )\n              )\n              .then(() => {\n                if (!shouldSuppressMessages) {\n                  dispatch(setDisappearingLoadingMessage(successMessage, 2000));\n                }\n                dispatch(setIsLoading(false));\n                dispatch(setDirty(false));\n                dispatch(setLastSyncAt(addSeconds(new Date(), 5)));\n              })\n              .catch(error => {\n                alert(`There was an error pushing the file: ${error.toString()}`);\n                dispatch(hideLoadingMessage());\n                dispatch(setIsLoading(false));\n              });\n          } else {\n            if (!shouldSuppressMessages) {\n              dispatch(setDisappearingLoadingMessage('Nothing to sync', 2000));\n            }\n            dispatch(setIsLoading(false));\n          }\n        } else {\n          if (isDirty && forceAction !== 'pull') {\n            dispatch(hideLoadingMessage());\n            dispatch(setIsLoading(false));\n            dispatch(activatePopup('sync-confirmation', { lastServerModifiedAt }));\n          } else {\n            dispatch(displayFile(path, contents));\n            dispatch(applyOpennessState());\n            dispatch(setDirty(false));\n            dispatch(setLastSyncAt(addSeconds(new Date(), 5)));\n            if (!shouldSuppressMessages) {\n              dispatch(setDisappearingLoadingMessage('Latest version pulled', 2000));\n            }\n            dispatch(setIsLoading(false));\n          }\n        }\n      })\n      .catch(() => {\n        dispatch(hideLoadingMessage());\n        dispatch(setIsLoading(false));\n        dispatch(setOrgFileErrorMessage('File not found'));\n      });\n  };\n\nexport const openHeader = headerId => ({\n  type: 'OPEN_HEADER',\n  headerId,\n});\n\nexport const toggleHeaderOpened = headerId => ({\n  type: 'TOGGLE_HEADER_OPENED',\n  headerId,\n});\n\nexport const selectHeader = headerId => dispatch => {\n  dispatch({ type: 'SELECT_HEADER', headerId });\n\n  if (!!headerId) {\n    dispatch(setSelectedTableCellId(null));\n    dispatch(setSelectedListItemId(null));\n  }\n};\n\nexport const selectHeaderAndOpenParents = headerId => dispatch => {\n  dispatch(selectHeader(headerId));\n  dispatch({ type: 'OPEN_PARENTS_OF_HEADER', headerId });\n};\n\nexport const advanceTodoState = (headerId = null) => ({\n  type: 'ADVANCE_TODO_STATE',\n  headerId,\n  dirtying: true,\n});\n\nexport const enterEditMode = editModeType => ({\n  type: 'ENTER_EDIT_MODE',\n  editModeType,\n});\n\nexport const exitEditMode = () => ({\n  type: 'EXIT_EDIT_MODE',\n});\n\nexport const updateHeaderTitle = (headerId, newRawTitle) => ({\n  type: 'UPDATE_HEADER_TITLE',\n  headerId,\n  newRawTitle,\n  dirtying: true,\n});\n\nexport const updateHeaderDescription = (headerId, newRawDescription) => ({\n  type: 'UPDATE_HEADER_DESCRIPTION',\n  headerId,\n  newRawDescription,\n  dirtying: true,\n});\n\nexport const addHeader = headerId => ({\n  type: 'ADD_HEADER',\n  headerId,\n  dirtying: true,\n});\n\nexport const selectNextSiblingHeader = headerId => ({\n  type: 'SELECT_NEXT_SIBLING_HEADER',\n  headerId,\n});\n\nexport const addHeaderAndEdit = headerId => dispatch => {\n  dispatch(addHeader(headerId));\n  dispatch(selectNextSiblingHeader(headerId));\n  dispatch(enterEditMode('title'));\n};\n\nexport const selectNextVisibleHeader = headerId => ({\n  type: 'SELECT_NEXT_VISIBLE_HEADER',\n  headerId,\n});\n\nexport const selectPreviousVisibleHeader = headerId => ({\n  type: 'SELECT_PREVIOUS_VISIBLE_HEADER',\n  headerId,\n});\n\nexport const removeHeader = headerId => ({\n  type: 'REMOVE_HEADER',\n  headerId,\n  dirtying: true,\n});\n\nexport const moveHeaderUp = headerId => ({\n  type: 'MOVE_HEADER_UP',\n  headerId,\n  dirtying: true,\n});\n\nexport const moveHeaderDown = headerId => ({\n  type: 'MOVE_HEADER_DOWN',\n  headerId,\n  dirtying: true,\n});\n\nexport const moveHeaderLeft = headerId => ({\n  type: 'MOVE_HEADER_LEFT',\n  headerId,\n  dirtying: true,\n});\n\nexport const moveHeaderRight = headerId => ({\n  type: 'MOVE_HEADER_RIGHT',\n  headerId,\n  dirtying: true,\n});\n\nexport const moveSubtreeLeft = headerId => ({\n  type: 'MOVE_SUBTREE_LEFT',\n  headerId,\n  dirtying: true,\n});\n\nexport const moveSubtreeRight = headerId => ({\n  type: 'MOVE_SUBTREE_RIGHT',\n  headerId,\n  dirtying: true,\n});\n\nexport const focusHeader = headerId => ({\n  type: 'FOCUS_HEADER',\n  headerId,\n});\n\nexport const unfocusHeader = () => ({\n  type: 'UNFOCUS_HEADER',\n});\n\nexport const noOp = () => ({\n  type: 'NO_OP',\n});\n\nexport const applyOpennessState = () => ({\n  type: 'APPLY_OPENNESS_STATE',\n});\n\nexport const setDirty = isDirty => ({\n  type: 'SET_DIRTY',\n  isDirty,\n});\n\nexport const setSelectedTableCellId = cellId => dispatch => {\n  dispatch({ type: 'SET_SELECTED_TABLE_CELL_ID', cellId });\n\n  if (!!cellId) {\n    dispatch(selectHeader(null));\n    dispatch(setSelectedListItemId(null));\n  }\n};\n\nexport const addNewTableRow = () => ({\n  type: 'ADD_NEW_TABLE_ROW',\n  dirtying: true,\n});\n\nexport const removeTableRow = () => ({\n  type: 'REMOVE_TABLE_ROW',\n  dirtying: true,\n});\n\nexport const addNewTableColumn = () => ({\n  type: 'ADD_NEW_TABLE_COLUMN',\n  dirtying: true,\n});\n\nexport const removeTableColumn = () => ({\n  type: 'REMOVE_TABLE_COLUMN',\n  dirtying: true,\n});\n\nexport const moveTableRowDown = () => ({\n  type: 'MOVE_TABLE_ROW_DOWN',\n  dirtying: true,\n});\n\nexport const moveTableRowUp = () => ({\n  type: 'MOVE_TABLE_ROW_UP',\n  dirtying: true,\n});\n\nexport const moveTableColumnLeft = () => ({\n  type: 'MOVE_TABLE_COLUMN_LEFT',\n  dirtying: true,\n});\n\nexport const moveTableColumnRight = () => ({\n  type: 'MOVE_TABLE_COLUMN_RIGHT',\n  dirtying: true,\n});\n\nexport const updateTableCellValue = (cellId, newValue) => ({\n  type: 'UPDATE_TABLE_CELL_VALUE',\n  cellId,\n  newValue,\n  dirtying: true,\n});\n\nexport const insertCapture = (templateId, content, shouldPrepend) => (dispatch, getState) => {\n  dispatch(closePopup());\n\n  const template = getState()\n    .capture.get('captureTemplates')\n    .concat(sampleCaptureTemplates)\n    .find(template => template.get('id') === templateId);\n  dispatch({ type: 'INSERT_CAPTURE', template, content, shouldPrepend, dirtying: true });\n};\n\nexport const clearPendingCapture = () => ({\n  type: 'CLEAR_PENDING_CAPTURE',\n});\n\nexport const insertPendingCapture = () => (dispatch, getState) => {\n  const pendingCapture = getState().org.present.get('pendingCapture');\n  const templateName = pendingCapture.get('captureTemplateName');\n  const captureContent = pendingCapture.get('captureContent');\n  const customCaptureVariables = pendingCapture.get('customCaptureVariables');\n\n  dispatch(clearPendingCapture());\n  window.history.pushState({}, '', window.location.pathname);\n\n  const template = getState()\n    .capture.get('captureTemplates')\n    .filter(\n      template =>\n        template.get('isAvailableInAllOrgFiles') ||\n        template.get('orgFilesWhereAvailable').includes(getState().org.present.get('path'))\n    )\n    .find(template => template.get('description').trim() === templateName.trim());\n  if (!template) {\n    dispatch(\n      setDisappearingLoadingMessage(\n        `Capture failed: \"${templateName}\" template not found or not available in this file`,\n        8000\n      )\n    );\n    return;\n  }\n\n  const targetHeader = headerWithPath(\n    getState().org.present.get('headers'),\n    template.get('headerPaths')\n  );\n  if (!targetHeader) {\n    dispatch(\n      setDisappearingLoadingMessage(\n        `Capture failed: \"${template.get('description')}\" header path invalid in this file`,\n        8000\n      )\n    );\n    return;\n  }\n\n  const [substitutedTemplate, initialCursorIndex] = substituteTemplateVariables(\n    template.get('template'),\n    customCaptureVariables\n  );\n\n  const content = !!initialCursorIndex\n    ? `${substitutedTemplate.substring(\n        0,\n        initialCursorIndex\n      )}${captureContent}${substitutedTemplate.substring(initialCursorIndex)}`\n    : `${substitutedTemplate}${captureContent}`;\n\n  dispatch(insertCapture(template.get('id'), content, template.get('shouldPrepend')));\n  dispatch(sync({ successMessage: 'Item captured' }));\n};\n\nexport const advanceCheckboxState = listItemId => ({\n  type: 'ADVANCE_CHECKBOX_STATE',\n  listItemId,\n  dirtying: true,\n});\n\nexport const setSelectedListItemId = listItemId => dispatch => {\n  dispatch({ type: 'SET_SELECTED_LIST_ITEM_ID', listItemId });\n\n  if (!!listItemId) {\n    dispatch(selectHeader(null));\n    dispatch(setSelectedTableCellId(null));\n  }\n};\n\nexport const updateListTitleValue = (listItemId, newValue) => ({\n  type: 'UPDATE_LIST_TITLE_VALUE',\n  listItemId,\n  newValue,\n  dirtying: true,\n});\n\nexport const updateListContentsValue = (listItemId, newValue) => ({\n  type: 'UPDATE_LIST_CONTENTS_VALUE',\n  listItemId,\n  newValue,\n  dirtying: true,\n});\n\nexport const addNewListItem = () => ({\n  type: 'ADD_NEW_LIST_ITEM',\n  dirtying: true,\n});\n\nexport const selectNextSiblingListItem = () => ({\n  type: 'SELECT_NEXT_SIBLING_LIST_ITEM',\n});\n\nexport const addNewListItemAndEdit = () => dispatch => {\n  dispatch(addNewListItem());\n  dispatch(selectNextSiblingListItem());\n  dispatch(enterEditMode('list-title'));\n};\n\nexport const removeListItem = () => ({\n  type: 'REMOVE_LIST_ITEM',\n  dirtying: true,\n});\n\nexport const moveListItemUp = () => ({\n  type: 'MOVE_LIST_ITEM_UP',\n  dirtying: true,\n});\n\nexport const moveListItemDown = () => ({\n  type: 'MOVE_LIST_ITEM_DOWN',\n  dirtying: true,\n});\n\nexport const moveListItemLeft = () => ({\n  type: 'MOVE_LIST_ITEM_LEFT',\n  dirtying: true,\n});\n\nexport const moveListItemRight = () => ({\n  type: 'MOVE_LIST_ITEM_RIGHT',\n  dirtying: true,\n});\n\nexport const moveListSubtreeLeft = () => ({\n  type: 'MOVE_LIST_SUBTREE_LEFT',\n  dirtying: true,\n});\n\nexport const moveListSubtreeRight = () => ({\n  type: 'MOVE_LIST_SUBTREE_RIGHT',\n  dirtying: true,\n});\n\nexport const setHeaderTags = (headerId, tags) => ({\n  type: 'SET_HEADER_TAGS',\n  headerId,\n  tags,\n  dirtying: true,\n});\n\nexport const reorderTags = (fromIndex, toIndex) => ({\n  type: 'REORDER_TAGS',\n  fromIndex,\n  toIndex,\n  dirtying: true,\n});\n\nexport const reorderPropertyList = (fromIndex, toIndex) => (dispatch, getState) =>\n  dispatch({\n    type: 'REORDER_PROPERTY_LIST',\n    fromIndex,\n    toIndex,\n    headerId: getState().base.getIn(['activePopup', 'data', 'headerId']),\n    dirtying: true,\n  });\n\nexport const updateTimestampWithId = (timestampId, newTimestamp) => ({\n  type: 'UPDATE_TIMESTAMP_WITH_ID',\n  timestampId,\n  newTimestamp,\n  dirtying: true,\n});\n\nexport const updatePlanningItemTimestamp = (headerId, planningItemIndex, newTimestamp) => ({\n  type: 'UPDATE_PLANNING_ITEM_TIMESTAMP',\n  headerId,\n  planningItemIndex,\n  newTimestamp,\n  dirtying: true,\n});\n\nexport const addNewPlanningItem = (headerId, planningType) => ({\n  type: 'ADD_NEW_PLANNING_ITEM',\n  headerId,\n  planningType,\n  dirtying: true,\n});\n\nexport const updatePropertyListItems = (headerId, newPropertyListItems) => ({\n  type: 'UPDATE_PROPERTY_LIST_ITEMS',\n  headerId,\n  newPropertyListItems,\n  dirtying: true,\n});\n\nexport const setOrgFileErrorMessage = message => ({\n  type: 'SET_ORG_FILE_ERROR_MESSAGE',\n  message,\n});\n","import { sync } from '../actions/org';\n\nexport default store => next => action => {\n  if (action.dirtying && store.getState().base.get('shouldLiveSync')) {\n    store.dispatch(sync({ shouldSuppressMessages: true }));\n  }\n\n  return next(action);\n};\n","import { sync } from '../actions/org';\nimport { debounce } from 'lodash';\n\nconst dispatchSync = store => store.dispatch(sync({ shouldSuppressMessages: true }));\n\n// The 'visibilitychange' event might get triggered in some browsers many times for one 'real'\n// event of the browser becoming visible to the user. Debouncing through lodash ensures that\n// it is called at maximum once every second.\nvar debouncedDispatchSync = debounce(dispatchSync, 1000);\n\nexport default store => next => action => {\n  window.addEventListener('visibilitychange', () => {\n    if (store.getState().base.get('shouldSyncOnBecomingVisibile')) {\n      debouncedDispatchSync(store);\n    }\n  });\n\n  return next(action);\n};\n","export const addNewEmptyCaptureTemplate = () => ({\n  type: 'ADD_NEW_EMPTY_CAPTURE_TEMPLATE',\n});\n\nexport const updateTemplateFieldPathValue = (templateId, fieldPath, newValue) => ({\n  type: 'UPDATE_TEMPLATE_FIELD_PATH_VALUE',\n  templateId,\n  fieldPath,\n  newValue,\n});\n\nexport const addNewTemplateOrgFileAvailability = templateId => ({\n  type: 'ADD_NEW_TEMPLATE_ORG_FILE_AVAILABILITY',\n  templateId,\n});\n\nexport const removeTemplateOrgFileAvailability = (templateId, orgFileAvailabilityIndex) => ({\n  type: 'REMOVE_TEMPLATE_ORG_FILE_AVAILABILITY',\n  templateId,\n  orgFileAvailabilityIndex,\n});\n\nexport const addNewTemplateHeaderPath = templateId => ({\n  type: 'ADD_NEW_TEMPLATE_HEADER_PATH',\n  templateId,\n});\n\nexport const removeTemplateHeaderPath = (templateId, headerPathIndex) => ({\n  type: 'REMOVE_TEMPLATE_HEADER_PATH',\n  templateId,\n  headerPathIndex,\n});\n\nexport const deleteTemplate = templateId => ({\n  type: 'DELETE_TEMPLATE',\n  templateId,\n});\n\nexport const restoreCaptureSettings = newSettings => ({\n  type: 'RESTORE_CAPTURE_SETTINGS',\n  newSettings,\n});\n\nexport const reorderCaptureTemplate = (fromIndex, toIndex) => ({\n  type: 'REORDER_CAPTURE_TEMPLATE',\n  fromIndex,\n  toIndex,\n});\n","import { Map, List, fromJS } from 'immutable';\nimport _ from 'lodash';\n\nimport { getOpenHeaderPaths } from '../lib/org_utils';\n\nimport { restoreBaseSettings } from '../actions/base';\nimport { restoreCaptureSettings } from '../actions/capture';\n\nimport generateId from '../lib/id_generator';\n\nexport const isLocalStorageAvailable = () => {\n  try {\n    localStorage.setItem('test', 'test');\n    return localStorage.getItem('test') === 'test';\n  } catch (e) {\n    return false;\n  }\n};\n\nconst debouncedPushConfigToSyncBackend = _.debounce(\n  (syncBackendClient, contents) => {\n    switch (syncBackendClient.type) {\n      case 'Dropbox':\n        syncBackendClient\n          .createFile('/.org-web-config.json', contents)\n          .catch(error =>\n            alert(`There was an error trying to push settings to your sync backend: ${error}`)\n          );\n        break;\n      case 'Google Drive':\n        syncBackendClient\n          .createFile('.org-web-config.json', 'root', contents)\n          .catch(error =>\n            alert(`There was an error trying to push settings to your sync backend: ${error}`)\n          );\n        break;\n      default:\n    }\n  },\n  1000,\n  { maxWait: 3000 }\n);\n\nexport const persistableFields = [\n  {\n    category: 'base',\n    name: 'fontSize',\n    type: 'nullable',\n    shouldStoreInConfig: true,\n  },\n  {\n    category: 'base',\n    name: 'bulletStyle',\n    type: 'nullable',\n    shouldStoreInConfig: true,\n  },\n  {\n    category: 'base',\n    name: 'shouldTapTodoToAdvance',\n    type: 'boolean',\n    shouldStoreInConfig: true,\n  },\n\n  {\n    category: 'base',\n    name: 'agendaDefaultDeadlineDelayUnit',\n    type: 'nullable',\n    shouldStoreInConfig: true,\n  },\n  {\n    category: 'base',\n    name: 'agendaDefaultDeadlineDelayValue',\n    type: 'nullable',\n    shouldStoreInConfig: true,\n  },\n\n  {\n    category: 'base',\n    name: 'shouldStoreSettingsInSyncBackend',\n    type: 'boolean',\n    shouldStoreInConfig: true,\n  },\n  {\n    category: 'base',\n    name: 'lastSeenChangelogHeader',\n    type: 'nullable',\n    shouldStoreInConfig: true,\n  },\n  {\n    category: 'base',\n    name: 'customKeybindings',\n    type: 'json',\n    shouldStoreInConfig: true,\n  },\n  {\n    category: 'base',\n    name: 'shouldLiveSync',\n    type: 'boolean',\n    shouldStoreInConfig: false,\n  },\n  {\n    category: 'base',\n    name: 'shouldSyncOnBecomingVisibile',\n    type: 'boolean',\n    shouldStoreInConfig: true,\n  },\n  {\n    category: 'capture',\n    name: 'captureTemplates',\n    type: 'json',\n    shouldStoreInConfig: true,\n    default: new List(),\n  },\n];\n\nexport const readOpennessState = () => {\n  const opennessStateJSONString = localStorage.getItem('headerOpenness');\n  return !!opennessStateJSONString ? JSON.parse(opennessStateJSONString) : null;\n};\n\nconst getFieldsToPersist = (state, fields) =>\n  fields\n    .filter(field => !field.depreacted)\n    .filter(field => field.category === 'org')\n    .map(field => field.name)\n    .map(field => [field, state.org.present.get(field)])\n    .concat(\n      persistableFields\n        .filter(field => field.category !== 'org')\n        .map(field =>\n          field.type === 'json'\n            ? [\n                field.name,\n                JSON.stringify(state[field.category].get(field.name) || field.default || {}),\n              ]\n            : [field.name, state[field.category].get(field.name)]\n        )\n    );\n\nconst getConfigFileContents = fieldsToPersist =>\n  JSON.stringify(\n    _.fromPairs(\n      fieldsToPersist.filter(([name, _value]) => !['lastSeenChangelogHeader'].includes(name))\n    ),\n    null,\n    2\n  );\n\nexport const applyCategorySettingsFromConfig = (state, config, category) => {\n  persistableFields\n    .filter(field => field.category === category)\n    .filter(field => field.shouldStoreInConfig)\n    .filter(\n      field =>\n        // I accidentally included this field in some config files, so I need to forever\n        // filter it out here. Whoops...\n        field.name !== 'lastSeenChangelogHeader'\n    )\n    .forEach(field => {\n      field.type === 'json'\n        ? (state = state.set(field.name, fromJS(JSON.parse(config[field.name]))))\n        : (state = state.set(field.name, config[field.name]));\n    });\n\n  return state;\n};\n\nexport const applyCaptureSettingsFromConfig = (state, config) => {\n  const captureTemplates = fromJS(JSON.parse(config.captureTemplates)).map(template =>\n    template.set('id', generateId())\n  );\n\n  return state.set('captureTemplates', captureTemplates);\n};\n\nexport const readInitialState = () => {\n  if (!isLocalStorageAvailable()) {\n    return undefined;\n  }\n\n  let initialState = {\n    syncBackend: Map(),\n    org: {\n      past: [],\n      present: Map(),\n      future: [],\n    },\n    base: Map(),\n    capture: Map(),\n  };\n\n  persistableFields.forEach(field => {\n    let value = localStorage.getItem(field.name);\n\n    if (field.type === 'nullable') {\n      if (value === 'null') {\n        value = null;\n      }\n    } else if (field.type === 'boolean') {\n      value = value === 'true';\n    } else if (field.type === 'json') {\n      if (!value) {\n        value = field.default || new Map();\n      } else {\n        value = fromJS(JSON.parse(value));\n      }\n    }\n\n    if (field.category === 'org') {\n      initialState[field.category].present = initialState[field.category].present.set(\n        field.name,\n        value\n      );\n    } else {\n      initialState[field.category] = initialState[field.category].set(field.name, value);\n    }\n  });\n\n  // Assign new ids to the capture templates.\n  if (initialState.capture.get('captureTemplates')) {\n    initialState.capture = initialState.capture.update('captureTemplates', templates =>\n      templates.map(template => template.set('id', generateId()))\n    );\n  }\n\n  const opennessState = readOpennessState();\n  if (!!opennessState) {\n    initialState.org.present = initialState.org.present.set('opennessState', fromJS(opennessState));\n  }\n\n  // Cache the config file contents locally so we don't overwrite on initial page load.\n  window.previousSettingsFileContents = getConfigFileContents(\n    getFieldsToPersist(initialState, persistableFields)\n  );\n\n  return initialState;\n};\n\nexport const loadSettingsFromConfigFile = (dispatch, getState) => {\n  const syncBackendClient = getState().syncBackend.get('client');\n  if (!syncBackendClient) {\n    return;\n  }\n\n  let fileContentsPromise = null;\n  switch (syncBackendClient.type) {\n    case 'Dropbox':\n      fileContentsPromise = syncBackendClient.getFileContents('/.org-web-config.json');\n      break;\n    case 'Google Drive':\n      fileContentsPromise = syncBackendClient.getFileContentsByNameAndParent(\n        '.org-web-config.json',\n        'root'\n      );\n      break;\n    default:\n  }\n\n  fileContentsPromise\n    .then(configFileContents => {\n      try {\n        const config = JSON.parse(configFileContents);\n        dispatch(restoreBaseSettings(config));\n        dispatch(restoreCaptureSettings(config));\n      } catch (_error) {\n        // Something went wrong parsing the config file, but we don't care, we'll just\n        // overwrite it with a good local copy.\n      }\n    })\n    .catch(() => {});\n};\n\nexport const subscribeToChanges = store => {\n  if (!isLocalStorageAvailable()) {\n    return () => {};\n  } else {\n    return () => {\n      const state = store.getState();\n\n      const fieldsToPersist = getFieldsToPersist(state, persistableFields);\n\n      fieldsToPersist.forEach(([name, value]) => localStorage.setItem(name, value));\n\n      if (state.base.get('shouldStoreSettingsInSyncBackend')) {\n        const settingsFileContents = getConfigFileContents(fieldsToPersist);\n\n        if (window.previousSettingsFileContents !== settingsFileContents) {\n          debouncedPushConfigToSyncBackend(state.syncBackend.get('client'), settingsFileContents);\n        }\n\n        window.previousSettingsFileContents = settingsFileContents;\n      }\n\n      const currentFilePath = state.org.present.get('path');\n      if (!!currentFilePath && state.org.present.get('headers')) {\n        const openHeaderPaths = getOpenHeaderPaths(state.org.present.get('headers'));\n\n        let opennessState = {};\n        const opennessStateJSONString = localStorage.getItem('headerOpenness');\n        if (opennessStateJSONString) {\n          opennessState = JSON.parse(opennessStateJSONString);\n        }\n\n        opennessState[currentFilePath] = openHeaderPaths;\n        localStorage.setItem('headerOpenness', JSON.stringify(opennessState));\n      }\n    };\n  }\n};\n\nexport const persistField = (field, value) => {\n  if (!isLocalStorageAvailable()) {\n    return;\n  } else {\n    localStorage.setItem(field, value);\n  }\n};\n\nexport const getPersistedField = (field, nullable = false) => {\n  if (!isLocalStorageAvailable()) {\n    return null;\n  } else {\n    const value = localStorage.getItem(field);\n    if (nullable) {\n      return value === 'null' ? null : value;\n    } else {\n      return value;\n    }\n  }\n};\n","import { Map, List, fromJS } from 'immutable';\n\nimport { applyCategorySettingsFromConfig } from '../util/settings_persister';\n\nconst setLoadingMessage = (state, action) => state.set('loadingMessage', action.loadingMessage);\n\nconst hideLoadingMessage = (state, action) => state.set('loadingMessage', null);\n\nconst setFontSize = (state, action) => state.set('fontSize', action.newFontSize);\n\nconst setBulletStyle = (state, action) => state.set('bulletStyle', action.newBulletStyle);\n\nconst setShouldTapTodoToAdvance = (state, action) =>\n  state.set('shouldTapTodoToAdvance', action.newShouldTapTodoToAdvance);\n\nconst setAgendaDefaultDeadlineDelayUnit = (state, action) =>\n  state.set('agendaDefaultDeadlineDelayUnit', action.newAgendaDefaultDeadlineDelayUnit);\n\nconst setAgendaDefaultDeadlineDelayValue = (state, action) =>\n  state.set('agendaDefaultDeadlineDelayValue', action.newAgendaDefaultDeadlineDelayValue);\n\nconst setShouldStoreSettingsInSyncBackend = (state, action) =>\n  state.set('shouldStoreSettingsInSyncBackend', action.newShouldStoreSettingsInSyncBackend);\n\nconst setShouldLiveSync = (state, action) => state.set('shouldLiveSync', action.shouldLiveSync);\n\nconst setShouldSyncOnBecomingVisibile = (state, action) =>\n  state.set('shouldSyncOnBecomingVisibile', action.shouldSyncOnBecomingVisibile);\n\nconst setHasUnseenChangelog = (state, action) =>\n  state.set('hasUnseenChangelog', action.newHasUnseenChangelog);\n\nconst setLastSeenChangelogHeader = (state, action) =>\n  state.set('lastSeenChangelogHeader', action.newLastSeenChangelogHeader);\n\nconst setLastViewedFile = (state, action) =>\n  state\n    .set('lastViewedPath', action.lastViewedPath)\n    .set('lastViewedContents', action.lastViewedContents);\n\nconst setCustomKeybinding = (state, action) => {\n  if (!state.get('customKeybindings')) {\n    state = state.set('customKeybindings', new Map());\n  }\n\n  return state.setIn(['customKeybindings', action.keybindingName], action.keybinding);\n};\n\nconst restoreBaseSettings = (state, action) => {\n  if (!action.newSettings) {\n    return state;\n  }\n\n  return applyCategorySettingsFromConfig(state, action.newSettings, 'base');\n};\n\nconst pushModalPage = (state, action) =>\n  state.update('modalPageStack', stack =>\n    !!stack ? stack.push(action.modalPage) : List([action.modalPage])\n  );\n\nconst popModalPage = state =>\n  state.update('modalPageStack', stack => (!!stack ? stack.pop() : stack));\n\nconst clearModalStack = state => state.set('modalPageStack', List());\n\nconst activatePopup = (state, action) =>\n  state.set(\n    'activePopup',\n    fromJS({\n      type: action.popupType,\n      data: action.data,\n    })\n  );\n\nconst closePopup = state => state.set('activePopup', null);\n\nconst setIsLoading = (state, action) => state.set('isLoading', action.isLoading);\n\nexport default (state = new Map(), action) => {\n  switch (action.type) {\n    case 'SET_LOADING_MESSAGE':\n      return setLoadingMessage(state, action);\n    case 'HIDE_LOADING_MESSAGE':\n      return hideLoadingMessage(state, action);\n    case 'SET_FONT_SIZE':\n      return setFontSize(state, action);\n    case 'SET_BULLET_STYLE':\n      return setBulletStyle(state, action);\n    case 'SET_SHOULD_TAP_TODO_TO_ADVANCE':\n      return setShouldTapTodoToAdvance(state, action);\n    case 'SET_AGENDA_DEFAULT_DEADLINE_DELAY_UNIT':\n      return setAgendaDefaultDeadlineDelayUnit(state, action);\n    case 'SET_AGENDA_DEFAULT_DEADLINE_DELAY_VALUE':\n      return setAgendaDefaultDeadlineDelayValue(state, action);\n    case 'SET_SHOULD_STORE_SETTINGS_IN_SYNC_BACKEND':\n      return setShouldStoreSettingsInSyncBackend(state, action);\n    case 'SET_SHOULD_LIVE_SYNC':\n      return setShouldLiveSync(state, action);\n    case 'SET_SHOULD_SYNC_ON_BECOMING_VISIBLE':\n      return setShouldSyncOnBecomingVisibile(state, action);\n    case 'SET_HAS_UNSEEN_CHANGELOG':\n      return setHasUnseenChangelog(state, action);\n    case 'SET_LAST_SEEN_CHANGELOG_HEADER':\n      return setLastSeenChangelogHeader(state, action);\n    case 'SET_LAST_VIEWED_FILE':\n      return setLastViewedFile(state, action);\n    case 'SET_CUSTOM_KEYBINDING':\n      return setCustomKeybinding(state, action);\n    case 'RESTORE_BASE_SETTINGS':\n      return restoreBaseSettings(state, action);\n    case 'PUSH_MODAL_PAGE':\n      return pushModalPage(state, action);\n    case 'POP_MODAL_PAGE':\n      return popModalPage(state, action);\n    case 'CLEAR_MODAL_STACK':\n      return clearModalStack(state, action);\n    case 'ACTIVATE_POPUP':\n      return activatePopup(state, action);\n    case 'CLOSE_POPUP':\n      return closePopup(state, action);\n    case 'SET_IS_LOADING':\n      return setIsLoading(state, action);\n    default:\n      return state;\n  }\n};\n","import generateId from './id_generator';\n\nimport { fromJS, List } from 'immutable';\nimport _ from 'lodash';\n\n// Yeah, this thing is pretty wild. I use https://www.debuggex.com/ to edit it, then paste the results in here.\n// But fixing this mess is on my todo list...\nconst markupAndCookieRegex =\n  /(\\[\\[([^\\]]*)\\]\\]|\\[\\[([^\\]]*)\\]\\[([^\\]]*)\\]\\])|(\\[((\\d*%)|(\\d*\\/\\d*))\\])|(([\\s({'\"]?)([*/~=_+])([^\\s,'](.*)[^\\s,'])\\11([\\s\\-.,:!?'\")}]?))|(([<[])(\\d{4})-(\\d{2})-(\\d{2})(?: ([^0-9]{1,9}))?(?: ([012]?\\d:[0-5]\\d))?(?:-([012]?\\d:[0-5]\\d))?(?: ((?:\\+)|(?:\\+\\+)|(?:\\.\\+)|(?:-)|(?:--))(\\d+)(h|d|w|m|y))?(?: ((?:\\+)|(?:\\+\\+)|(?:\\.\\+)|(?:-)|(?:--))(\\d+)(h|d|w|m|y))?[>\\]](?:--([<[])(\\d{4})-(\\d{2})-(\\d{2})(?: ([^0-9]{1,9}))?(?: ([012]?\\d:[0-5]\\d))?(?:-([012]?\\d:[0-5]\\d))?(?: ((?:\\+)|(?:\\+\\+)|(?:\\.\\+)|(?:-)|(?:--))(\\d+)(h|d|w|m|y))?(?: ((?:\\+)|(?:\\+\\+)|(?:\\.\\+)|(?:-)|(?:--))(\\d+)(h|d|w|m|y))?[>\\]])?)/g;\nconst timestampRegex =\n  /([<[])(\\d{4})-(\\d{2})-(\\d{2})(?: ([^0-9]{1,9}))?(?: ([012]?\\d:[0-5]\\d))?(?:-([012]?\\d:[0-5]\\d))?(?: ((?:\\+)|(?:\\+\\+)|(?:\\.\\+)|(?:-)|(?:--))(\\d+)(h|d|w|m|y))?(?: ((?:\\+)|(?:\\+\\+)|(?:\\.\\+)|(?:-)|(?:--))(\\d+)(h|d|w|m|y))?[>\\]]/;\n\nconst timestampFromRegexMatch = (match, partIndices) => {\n  const [\n    typeBracket,\n    year,\n    month,\n    day,\n    dayName,\n    timeStart,\n    timeEnd,\n    firstDelayRepeatType,\n    firstDelayRepeatValue,\n    firstDelayRepeatUnit,\n    secondDelayRepeatType,\n    secondDelayRepeatValue,\n    secondDelayRepeatUnit,\n  ] = partIndices.map(partIndex => match[partIndex]);\n\n  if (!year) {\n    return null;\n  }\n\n  const [startHour, startMinute] = !!timeStart ? timeStart.split(':') : [];\n  const [endHour, endMinute] = !!timeEnd ? timeEnd.split(':') : [];\n\n  let repeaterType, repeaterValue, repeaterUnit;\n  let delayType, delayValue, delayUnit;\n\n  if (['+', '++', '.+'].includes(firstDelayRepeatType)) {\n    repeaterType = firstDelayRepeatType;\n    repeaterValue = firstDelayRepeatValue;\n    repeaterUnit = firstDelayRepeatUnit;\n  } else if (['-', '--'].includes(firstDelayRepeatType)) {\n    delayType = firstDelayRepeatType;\n    delayValue = firstDelayRepeatValue;\n    delayUnit = firstDelayRepeatUnit;\n  }\n  if (['+', '++', '.+'].includes(secondDelayRepeatType)) {\n    repeaterType = secondDelayRepeatType;\n    repeaterValue = secondDelayRepeatValue;\n    repeaterUnit = secondDelayRepeatUnit;\n  } else if (['-', '--'].includes(secondDelayRepeatType)) {\n    delayType = secondDelayRepeatType;\n    delayValue = secondDelayRepeatValue;\n    delayUnit = secondDelayRepeatUnit;\n  }\n\n  return {\n    isActive: typeBracket === '<',\n    year,\n    month,\n    day,\n    dayName,\n    startHour,\n    startMinute,\n    endHour,\n    endMinute,\n    repeaterType,\n    repeaterValue,\n    repeaterUnit,\n    delayType,\n    delayValue,\n    delayUnit,\n  };\n};\n\nexport const parseMarkupAndCookies = (\n  rawText,\n  { shouldAppendNewline = false, excludeCookies = true } = {}\n) => {\n  const matches = [];\n  let match = markupAndCookieRegex.exec(rawText);\n  while (match) {\n    if (!!match[2]) {\n      matches.push({\n        type: 'link',\n        rawText: match[0],\n        uri: match[2],\n        index: match.index,\n      });\n    } else if (!!match[3] && !!match[4]) {\n      matches.push({\n        type: 'link',\n        rawText: match[0],\n        uri: match[3],\n        title: match[4],\n        index: match.index,\n      });\n    } else if (!!match[7]) {\n      const percentCookieMatch = match[7].match(/(\\d*)%/);\n      matches.push({\n        type: 'percentage-cookie',\n        rawText: match[0],\n        percentage: percentCookieMatch[1],\n        index: match.index,\n      });\n    } else if (!!match[8]) {\n      const fractionCookieMatch = match[8].match(/(\\d*)\\/(\\d*)/);\n      matches.push({\n        type: 'fraction-cookie',\n        rawText: match[0],\n        fraction: [fractionCookieMatch[1], fractionCookieMatch[2]],\n        index: match.index,\n      });\n    } else if (!!match[11]) {\n      const markupType = {\n        '~': 'inline-code',\n        '*': 'bold',\n        '/': 'italic',\n        '+': 'strikethrough',\n        _: 'underline',\n        '=': 'verbatim',\n      }[match[11]];\n\n      const markupPrefixLength = match[10].length;\n\n      matches.push({\n        type: 'inline-markup',\n        rawText: match[0].substring(markupPrefixLength, match[12].length + 2 + markupPrefixLength),\n        index: match.index + markupPrefixLength,\n        content: match[12],\n        markupType,\n      });\n    } else if (!!match[15]) {\n      const firstTimestamp = timestampFromRegexMatch(match, _.range(16, 29));\n      const secondTimestamp = timestampFromRegexMatch(match, _.range(29, 42));\n\n      matches.push({\n        type: 'timestamp',\n        rawText: match[0],\n        index: match.index,\n        firstTimestamp,\n        secondTimestamp,\n      });\n    }\n    match = markupAndCookieRegex.exec(rawText);\n  }\n\n  const lineParts = [];\n  let startIndex = 0;\n  matches.forEach(match => {\n    let index = match.index;\n\n    if (index !== startIndex) {\n      const text = rawText.substring(startIndex, index);\n      lineParts.push({\n        type: 'text',\n        contents: text,\n      });\n    }\n\n    if (match.type === 'link') {\n      const linkPart = {\n        id: generateId(),\n        type: 'link',\n        contents: {\n          uri: match.uri,\n        },\n      };\n      if (match.title) {\n        linkPart.contents.title = match.title;\n      }\n      lineParts.push(linkPart);\n    } else if (match.type === 'percentage-cookie') {\n      lineParts.push({\n        id: generateId(),\n        type: 'percentage-cookie',\n        percentage: match.percentage,\n      });\n    } else if (match.type === 'fraction-cookie') {\n      lineParts.push({\n        id: generateId(),\n        type: 'fraction-cookie',\n        fraction: match.fraction,\n      });\n    } else if (match.type === 'inline-markup') {\n      lineParts.push({\n        id: generateId(),\n        type: 'inline-markup',\n        content: match.content,\n        markupType: match.markupType,\n      });\n    } else if (match.type === 'timestamp') {\n      lineParts.push({\n        id: generateId(),\n        type: 'timestamp',\n        firstTimestamp: match.firstTimestamp,\n        secondTimestamp: match.secondTimestamp,\n      });\n    }\n\n    startIndex = match.index + match.rawText.length;\n  });\n\n  if (startIndex !== rawText.length || shouldAppendNewline) {\n    const trailingText =\n      rawText.substring(startIndex, rawText.length) + (shouldAppendNewline ? '\\n' : '');\n    lineParts.push({\n      type: 'text',\n      contents: trailingText,\n    });\n  }\n\n  return lineParts;\n};\n\nconst parseTable = tableLines => {\n  const table = {\n    id: generateId(),\n    type: 'table',\n    contents: [[]],\n    columnProperties: [],\n  };\n\n  tableLines\n    .map(line => line.trim())\n    .forEach(line => {\n      if (line.startsWith('|-')) {\n        table.contents.push([]);\n      } else {\n        const lastRow = _.last(table.contents);\n        const lineCells = line.substr(1, line.length - 2).split('|');\n\n        if (lastRow.length === 0) {\n          lineCells.forEach(cell => lastRow.push(cell));\n        } else {\n          lineCells.forEach((cellContents, cellIndex) => {\n            lastRow[cellIndex] += `\\n${cellContents}`;\n          });\n        }\n      }\n    });\n\n  // Parse the contents of each cell.\n  table.contents = table.contents.map(row => ({\n    id: generateId(),\n    contents: row.map(rawContents => ({\n      id: generateId(),\n      contents: parseMarkupAndCookies(rawContents, { excludeCookies: true }),\n      rawContents,\n    })),\n  }));\n\n  // We sometimes end up with an extra, empty row - remove it if so.\n  if (_.last(table.contents).contents.length === 0) {\n    table.contents = table.contents.slice(0, table.contents.length - 1);\n  }\n\n  // Make sure each row has the same number of columns.\n  const maxNumColumns = Math.max(...table.contents.map(row => row.contents.length));\n  table.contents.forEach(row => {\n    if (row.contents.length < maxNumColumns) {\n      _.times(maxNumColumns - row.contents.length, () => {\n        row.contents.push({\n          id: generateId(),\n          contents: [],\n          rawContents: '',\n        });\n      });\n    }\n  });\n\n  return table;\n};\n\nexport const parseRawText = (rawText, { excludeContentElements = false } = {}) => {\n  const lines = rawText.split('\\n');\n\n  const LIST_HEADER_REGEX = /^\\s*([-+*]|(\\d+(\\.|\\)))) (.*)/;\n\n  let currentListHeaderNestingLevel = null;\n  const rawLineParts = _.flatten(\n    lines.map((line, lineIndex) => {\n      const numLeadingSpaces = line.match(/^( *)/)[0].length;\n\n      if (\n        currentListHeaderNestingLevel !== null &&\n        (numLeadingSpaces > currentListHeaderNestingLevel || !line.trim())\n      ) {\n        return [\n          {\n            type: 'raw-list-content',\n            line,\n          },\n        ];\n      } else {\n        currentListHeaderNestingLevel = null;\n\n        if (!!line.match(LIST_HEADER_REGEX) && !excludeContentElements) {\n          currentListHeaderNestingLevel = numLeadingSpaces;\n\n          return [\n            {\n              type: 'raw-list-header',\n              line,\n            },\n          ];\n        } else if (line.trim().startsWith('|') && !excludeContentElements) {\n          return [\n            {\n              type: 'raw-table',\n              line,\n            },\n          ];\n        } else {\n          return parseMarkupAndCookies(line, {\n            shouldAppendNewline: lineIndex !== lines.length - 1,\n            excludeCookies: true,\n          });\n        }\n      }\n    })\n  );\n\n  const processedLineParts = [];\n  for (let partIndex = 0; partIndex < rawLineParts.length; ++partIndex) {\n    const linePart = rawLineParts[partIndex];\n    if (linePart.type === 'raw-table') {\n      const tableLines = _.takeWhile(\n        rawLineParts.slice(partIndex),\n        part => part.type === 'raw-table'\n      ).map(part => part.line);\n\n      processedLineParts.push(parseTable(tableLines));\n\n      partIndex += tableLines.length - 1;\n    } else if (linePart.type === 'raw-list-header') {\n      const numLeadingSpaces = linePart.line.match(/^( *)/)[0].length;\n      const contentLines = _.takeWhile(\n        rawLineParts.slice(partIndex + 1),\n        part => part.type === 'raw-list-content'\n      )\n        .map(part => part.line)\n        .map(line =>\n          line.startsWith(' '.repeat(numLeadingSpaces + 2))\n            ? line.substr(numLeadingSpaces + 2)\n            : line.substr(numLeadingSpaces + 1)\n        );\n      if (contentLines[contentLines.length - 1] === '') {\n        contentLines[contentLines.length - 1] = ' ';\n      }\n      const contents = parseRawText(contentLines.join('\\n')).toJS();\n\n      partIndex += contentLines.length;\n\n      const isOrdered = !!linePart.line.match(/^\\s*\\d+[.)]/);\n\n      // Remove the leading -, +, *, or number characters.\n      let line = linePart.line.match(LIST_HEADER_REGEX)[4];\n\n      let forceNumber = null;\n      if (line.match(/^\\s*\\[@\\d+\\]/)) {\n        forceNumber = line.match(/^\\s*\\[@(\\d+)\\]/)[1];\n        line = line.replace(/^\\s*\\[@\\d+\\]\\s*/, '');\n      }\n\n      let checkboxState = null;\n      const isCheckbox = !!line.match(/^\\s*\\[[ X-]\\]/);\n      if (isCheckbox) {\n        const stateCharacter = line.match(/^\\s*\\[([ X-])\\]/)[1];\n        checkboxState = {\n          ' ': 'unchecked',\n          X: 'checked',\n          '-': 'partial',\n        }[stateCharacter];\n\n        line = line.replace(/^\\s*\\[[ X-]\\]\\s*/, '');\n      }\n\n      const newListItem = {\n        id: generateId(),\n        titleLine: parseMarkupAndCookies(line),\n        contents,\n        forceNumber,\n        isCheckbox,\n        checkboxState,\n      };\n\n      const lastIndex = processedLineParts.length - 1;\n      if (lastIndex >= 0 && processedLineParts[lastIndex].type === 'list') {\n        processedLineParts[lastIndex].items.push(newListItem);\n      } else {\n        processedLineParts.push({\n          type: 'list',\n          id: generateId(),\n          items: [newListItem],\n          bulletCharacter: linePart.line.trim()[0],\n          numberTerminatorCharacter: isOrdered ? linePart.line.match(/\\s*\\d+([.)])/)[1] : null,\n          isOrdered,\n        });\n      }\n    } else {\n      processedLineParts.push(linePart);\n    }\n  }\n\n  return fromJS(processedLineParts);\n};\n\nexport const _parsePlanningItems = rawText => {\n  const singlePlanningItemRegex = concatRegexes(/(DEADLINE|SCHEDULED|CLOSED):\\s*/, timestampRegex);\n  const optionalSinglePlanningItemRegex = RegExp(\n    '(' +\n      singlePlanningItemRegex\n        .toString()\n        .substring(1, singlePlanningItemRegex.toString().length - 1) +\n      ')?'\n  );\n\n  const planningRegex = concatRegexes(\n    /^\\s*/,\n    optionalSinglePlanningItemRegex,\n    /\\s*/,\n    optionalSinglePlanningItemRegex,\n    /\\s*/,\n    optionalSinglePlanningItemRegex,\n    /\\s*/\n  );\n  const planningMatch = rawText.match(planningRegex);\n\n  const planningItems = fromJS(\n    [2, 17, 32]\n      .map(planningTypeIndex => {\n        const type = planningMatch[planningTypeIndex];\n        if (!type) {\n          return null;\n        }\n\n        const timestamp = timestampFromRegexMatch(\n          planningMatch,\n          _.range(planningTypeIndex + 1, planningTypeIndex + 1 + 13)\n        );\n\n        return { type, timestamp, id: generateId() };\n      })\n      .filter(item => !!item)\n  );\n\n  if (planningItems.size > 0) {\n    // The `rawText` can look like:\n    // `SCHEDULED: <2019-07-30 Tue>\n    //   - indented list\n    //      - Foo`\n    // For the remaining description, filter the planning item out\n    const remainingDescriptionWithoutPlanningItem = rawText\n      .split('\\n')\n      .filter(line => {\n        return !line.includes(planningMatch[0].trim());\n      })\n      .join('\\n');\n    return { planningItems, strippedDescription: remainingDescriptionWithoutPlanningItem };\n  } else {\n    return { planningItems: fromJS([]), strippedDescription: rawText };\n  }\n};\n\nconst parsePropertyList = rawText => {\n  const lines = rawText.split('\\n');\n  const propertiesLineIndex = lines.findIndex(line => line.trim() === ':PROPERTIES:');\n  const endLineIndex = lines.findIndex(line => line.trim() === ':END:');\n\n  if (\n    propertiesLineIndex === -1 ||\n    endLineIndex === -1 ||\n    !rawText.trim().startsWith(':PROPERTIES:')\n  ) {\n    return {\n      propertyListItems: List(),\n      strippedDescription: rawText,\n    };\n  }\n\n  const propertyListItems = fromJS(\n    lines\n      .slice(propertiesLineIndex + 1, endLineIndex)\n      .map(line => {\n        const match = line.match(/:([^\\s]*):(?: (.*))?/);\n        if (!match) {\n          return null;\n        }\n\n        const value = !!match[2] ? parseMarkupAndCookies(match[2]) : null;\n\n        return {\n          property: match[1],\n          value,\n          id: generateId(),\n        };\n      })\n      .filter(result => !!result)\n  );\n\n  return {\n    propertyListItems,\n    strippedDescription: lines.slice(endLineIndex + 1).join('\\n'),\n  };\n};\n\nexport const parseDescriptionPrefixElements = rawText => {\n  const planningItemsParse = _parsePlanningItems(rawText);\n  const propertyListParse = parsePropertyList(planningItemsParse.strippedDescription);\n\n  return {\n    planningItems: planningItemsParse.planningItems,\n    propertyListItems: propertyListParse.propertyListItems,\n    strippedDescription: propertyListParse.strippedDescription,\n  };\n};\n\nconst defaultKeywordSets = fromJS([\n  {\n    keywords: ['TODO', 'DONE'],\n    completedKeywords: ['DONE'],\n    default: true,\n  },\n]);\n\nexport const parseTitleLine = (titleLine, todoKeywordSets) => {\n  const allKeywords = todoKeywordSets.flatMap(todoKeywordSet => {\n    return todoKeywordSet.get('keywords');\n  });\n  const todoKeyword = allKeywords.filter(keyword => titleLine.startsWith(keyword + ' ')).first();\n  let rawTitle = titleLine;\n  if (todoKeyword) {\n    rawTitle = rawTitle.substr(todoKeyword.length + 1);\n  }\n\n  // Check for tags.\n  let tags = [];\n  if (rawTitle.trimRight().endsWith(':')) {\n    const titleParts = rawTitle.trimRight().split(' ');\n    const possibleTags = titleParts[titleParts.length - 1];\n    if (/^:[^\\s]+:$/.test(possibleTags)) {\n      rawTitle = rawTitle.substr(0, rawTitle.length - possibleTags.length);\n      tags = possibleTags.split(':').filter(tag => tag !== '');\n    }\n  }\n\n  const title = parseMarkupAndCookies(rawTitle);\n\n  return fromJS({ title, rawTitle, todoKeyword, tags });\n};\n\nexport const newHeaderWithTitle = (line, nestingLevel, todoKeywordSets) => {\n  if (todoKeywordSets.size === 0) {\n    todoKeywordSets = defaultKeywordSets;\n  }\n\n  const titleLine = parseTitleLine(line, todoKeywordSets);\n  return fromJS({\n    titleLine,\n    rawDescription: '',\n    description: [],\n    opened: false,\n    id: generateId(),\n    nestingLevel,\n    planningItems: [],\n    propertyListItems: [],\n  });\n};\n\nconst concatRegexes = (...regexes) =>\n  regexes.reduce((prev, curr) =>\n    RegExp(\n      prev.toString().substring(1, prev.toString().length - 1) +\n        curr.toString().substring(1, curr.toString().length - 1)\n    )\n  );\n\nexport const newHeaderFromText = (rawText, todoKeywordSets) => {\n  const titleLine = rawText.split('\\n')[0].replace(/^\\**\\s*/, '');\n  const description = rawText.split('\\n').slice(1).join('\\n');\n\n  const { planningItems, propertyListItems, strippedDescription } =\n    parseDescriptionPrefixElements(description);\n\n  return newHeaderWithTitle(titleLine, 1, todoKeywordSets)\n    .set('rawDescription', strippedDescription)\n    .set('description', parseRawText(strippedDescription))\n    .set('planningItems', planningItems)\n    .set('propertyListItems', propertyListItems);\n};\n\nexport const parseOrg = fileContents => {\n  let headers = new List();\n  const lines = fileContents.split('\\n');\n\n  let todoKeywordSets = new List();\n  let fileConfigLines = new List();\n  let linesBeforeHeadings = new List();\n\n  lines.forEach(line => {\n    if (line.startsWith('*')) {\n      let nestingLevel = line.indexOf(' ');\n      if (nestingLevel === -1) {\n        nestingLevel = line.length;\n      }\n      const title = line.substr(nestingLevel + 1);\n      headers = headers.push(newHeaderWithTitle(title, nestingLevel, todoKeywordSets));\n    } else {\n      if (headers.size === 0) {\n        if (line.startsWith('#+TODO: ') || line.startsWith('#+TYP_TODO: ')) {\n          const keywordsString = line.substr(line.indexOf(':') + 2);\n          const keywordTokens = keywordsString.split(/\\s/);\n          const keywords = keywordTokens.filter(keyword => keyword !== '|');\n\n          const pipeIndex = keywordTokens.indexOf('|');\n          const completedKeywords = pipeIndex >= 0 ? keywords.slice(pipeIndex) : [];\n\n          todoKeywordSets = todoKeywordSets.push(\n            fromJS({\n              keywords,\n              completedKeywords,\n              configLine: line,\n              default: false,\n            })\n          );\n        } else if (line.startsWith('#+')) {\n          fileConfigLines = fileConfigLines.push(line);\n        } else {\n          linesBeforeHeadings = linesBeforeHeadings.push(line);\n        }\n      } else {\n        headers = headers.updateIn([headers.size - 1, 'rawDescription'], rawDescription =>\n          rawDescription.length === 0 ? line : rawDescription + '\\n' + line\n        );\n      }\n    }\n  });\n\n  if (todoKeywordSets.size === 0) {\n    todoKeywordSets = defaultKeywordSets;\n  }\n\n  headers = headers.map(header => {\n    const { planningItems, propertyListItems, strippedDescription } =\n      parseDescriptionPrefixElements(header.get('rawDescription'));\n\n    return header\n      .set('rawDescription', strippedDescription)\n      .set('description', parseRawText(strippedDescription))\n      .set('planningItems', planningItems)\n      .set('propertyListItems', propertyListItems);\n  });\n\n  return fromJS({\n    headers,\n    todoKeywordSets,\n    fileConfigLines,\n    linesBeforeHeadings,\n  });\n};\n","import { Map, List, fromJS } from 'immutable';\nimport _ from 'lodash';\n\nimport {\n  parseOrg,\n  parseTitleLine,\n  parseRawText,\n  parseDescriptionPrefixElements,\n  parseMarkupAndCookies,\n  newHeaderWithTitle,\n  newHeaderFromText,\n} from '../lib/parse_org';\nimport { attributedStringToRawText } from '../lib/export_org';\nimport {\n  indexOfHeaderWithId,\n  headerWithId,\n  parentIdOfHeaderWithId,\n  subheadersOfHeaderWithId,\n  numSubheadersOfHeaderWithId,\n  indexOfPreviousSibling,\n  openDirectParent,\n  openHeaderWithPath,\n  nextVisibleHeaderAfterIndex,\n  previousVisibleHeaderAfterIndex,\n  updateTableContainingCellId,\n  newEmptyTableRowLikeRows,\n  newEmptyTableCell,\n  headerThatContainsTableCellId,\n  headerWithPath,\n  pathAndPartOfListItemWithIdInHeaders,\n  pathAndPartOfTimestampItemWithIdInHeaders,\n  todoKeywordSetForKeyword,\n  newListItem,\n  parentListItemWithIdInHeaders,\n  updateListContainingListItemId,\n  headerThatContainsListItemId,\n  updateContentsWithListItemAddition,\n} from '../lib/org_utils';\nimport { getCurrentTimestamp, applyRepeater, renderAsText } from '../lib/timestamps';\nimport generateId from '../lib/id_generator';\n\nconst displayFile = (state, action) => {\n  const parsedFile = parseOrg(action.contents);\n\n  return state\n    .set('path', action.path)\n    .set('contents', action.contents)\n    .set('headers', parsedFile.get('headers'))\n    .set('todoKeywordSets', parsedFile.get('todoKeywordSets'))\n    .set('fileConfigLines', parsedFile.get('fileConfigLines'))\n    .set('linesBeforeHeadings', parsedFile.get('linesBeforeHeadings'));\n};\n\nconst stopDisplayingFile = state =>\n  state\n    .set('path', null)\n    .set('contents', null)\n    .set('headers', null)\n    .set('todoKeywordSets', null)\n    .set('fileConfigLines', null)\n    .set('linesBeforeHeadings', null);\n\nconst openHeader = (state, action) => {\n  const headers = state.get('headers');\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\n\n  return state.setIn(['headers', headerIndex, 'opened'], true);\n};\n\nconst toggleHeaderOpened = (state, action) => {\n  const headers = state.get('headers');\n\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\n  const isOpened = headerWithId(headers, action.headerId).get('opened');\n\n  if (isOpened && state.get('focusedHeaderId') === action.headerId) {\n    return state;\n  }\n\n  if (isOpened) {\n    const subheaders = subheadersOfHeaderWithId(headers, action.headerId);\n    subheaders.forEach((subheader, index) => {\n      state = state.setIn(['headers', headerIndex + index + 1, 'opened'], false);\n    });\n  }\n\n  return state.setIn(['headers', headerIndex, 'opened'], !isOpened);\n};\n\nconst selectHeader = (state, action) => {\n  return state.set('selectedHeaderId', action.headerId);\n};\n\nconst openParentsOfHeader = (state, action) => {\n  let headers = state.get('headers');\n  const { headerId } = action;\n\n  let parentHeaderId = parentIdOfHeaderWithId(headers, headerId);\n  while (!!parentHeaderId) {\n    const parentHeaderIndex = indexOfHeaderWithId(headers, parentHeaderId);\n    headers = headers.setIn([parentHeaderIndex, 'opened'], true);\n    parentHeaderId = parentIdOfHeaderWithId(headers, parentHeaderId);\n  }\n\n  return state.set('headers', headers);\n};\n\nconst updateCookiesInAttributedStringWithChildCompletionStates = (parts, completionStates) => {\n  const doneCount = completionStates.filter(isDone => isDone).length;\n  const totalCount = completionStates.length;\n\n  return parts.map(part => {\n    switch (part.get('type')) {\n      case 'fraction-cookie':\n        return part.set('fraction', List([doneCount, totalCount]));\n      case 'percentage-cookie':\n        return part.set('percentage', Math.floor((doneCount / totalCount) * 100));\n      default:\n        return part;\n    }\n  });\n};\n\nconst updateCookiesOfHeaderWithId = (state, headerId) => {\n  const headers = state.get('headers');\n  const headerIndex = indexOfHeaderWithId(headers, headerId);\n  const subheaders = subheadersOfHeaderWithId(headers, headerId);\n\n  const directChildren = [];\n  for (let i = 0; i < subheaders.size; ++i) {\n    const subheader = subheaders.get(i);\n    directChildren.push(subheader);\n\n    const subheaderSubheaders = subheadersOfHeaderWithId(headers, subheader.get('id'));\n    i += subheaderSubheaders.size;\n  }\n\n  let completionStates = directChildren\n    .map(header => header.getIn(['titleLine', 'todoKeyword']))\n    .filter(todoKeyword => !!todoKeyword)\n    .map(todoKeyword =>\n      todoKeywordSetForKeyword(state.get('todoKeywordSets'), todoKeyword)\n        .get('completedKeywords')\n        .contains(todoKeyword)\n    );\n\n  // If there are no headers with possible completion states, check for plain lists instead.\n  if (completionStates.length === 0) {\n    completionStates = headers\n      .get(headerIndex)\n      .get('description')\n      .filter(part => part.get('type') === 'list')\n      .flatMap(listPart => listPart.get('items'))\n      .filter(item => item.get('isCheckbox'))\n      .map(item => item.get('checkboxState') === 'checked')\n      .toJS();\n  }\n\n  return state\n    .updateIn(['headers', headerIndex, 'titleLine', 'title'], title =>\n      updateCookiesInAttributedStringWithChildCompletionStates(title, completionStates)\n    )\n    .updateIn(['headers', headerIndex, 'titleLine'], titleLine =>\n      titleLine.set('rawTitle', attributedStringToRawText(titleLine.get('title')))\n    );\n};\n\nconst updateCookiesOfParentOfHeaderWithId = (state, headerId) => {\n  const parentHeaderId = parentIdOfHeaderWithId(state.get('headers'), headerId);\n  if (!parentHeaderId) {\n    return state;\n  }\n\n  return updateCookiesOfHeaderWithId(state, parentHeaderId);\n};\n\nconst advanceTodoState = (state, action) => {\n  const headerId = action.headerId || state.get('selectedHeaderId');\n  if (!headerId) {\n    return state;\n  }\n\n  const headers = state.get('headers');\n  const header = headerWithId(headers, headerId);\n  const headerIndex = indexOfHeaderWithId(headers, headerId);\n\n  const currentTodoState = header.getIn(['titleLine', 'todoKeyword']);\n  const currentTodoSet = todoKeywordSetForKeyword(state.get('todoKeywordSets'), currentTodoState);\n\n  const currentStateIndex = currentTodoSet.get('keywords').indexOf(currentTodoState);\n  const newStateIndex = currentStateIndex + 1;\n  const newTodoState = currentTodoSet.get('keywords').get(newStateIndex) || '';\n\n  const indexedPlanningItemsWithRepeaters = header\n    .get('planningItems')\n    .map((planningItem, index) => [planningItem, index])\n    .filter(([planningItem, index]) => !!planningItem.getIn(['timestamp', 'repeaterType']));\n\n  if (\n    currentTodoSet.get('completedKeywords').includes(newTodoState) &&\n    indexedPlanningItemsWithRepeaters.size > 0\n  ) {\n    indexedPlanningItemsWithRepeaters.forEach(([planningItem, planningItemIndex]) => {\n      state = state.setIn(\n        ['headers', headerIndex, 'planningItems', planningItemIndex, 'timestamp'],\n        applyRepeater(planningItem.get('timestamp'), new Date())\n      );\n    });\n\n    state = state.setIn(\n      ['headers', headerIndex, 'titleLine', 'todoKeyword'],\n      currentTodoSet.get('keywords').first()\n    );\n\n    const lastRepeatTimestamp = getCurrentTimestamp({ isActive: false, withStartTime: true });\n    const newLastRepeatValue = [\n      {\n        type: 'timestamp',\n        id: generateId(),\n        firstTimestamp: lastRepeatTimestamp,\n        secondTimestamp: null,\n      },\n    ];\n    state = state.updateIn(['headers', headerIndex, 'propertyListItems'], propertyListItems =>\n      propertyListItems.some(item => item.get('property') === 'LAST_REPEAT')\n        ? propertyListItems.map(item =>\n            item.get('property') === 'LAST_REPEAT'\n              ? item.set('value', fromJS(newLastRepeatValue))\n              : item\n          )\n        : propertyListItems.push(\n            fromJS({\n              property: 'LAST_REPEAT',\n              value: newLastRepeatValue,\n              id: generateId(),\n            })\n          )\n    );\n\n    state = state.updateIn(['headers', headerIndex], header => {\n      let rawDescription = header.get('rawDescription');\n      if (rawDescription.startsWith('\\n')) {\n        rawDescription = rawDescription.slice(1);\n      }\n\n      rawDescription =\n        `\\n- State \"${newTodoState}\"       from \"${currentTodoState}\"       ${renderAsText(\n          fromJS(lastRepeatTimestamp)\n        )}\\n` + rawDescription;\n\n      return header\n        .set('rawDescription', rawDescription)\n        .set('description', parseRawText(rawDescription));\n    });\n  } else {\n    state = state.setIn(['headers', headerIndex, 'titleLine', 'todoKeyword'], newTodoState);\n  }\n\n  state = updateCookiesOfParentOfHeaderWithId(state, headerId);\n\n  return state;\n};\n\nconst enterEditMode = (state, action) => state.set('editMode', action.editModeType);\n\nconst exitEditMode = (state, action) => state.set('editMode', null);\n\nconst updateHeaderTitle = (state, action) => {\n  const headers = state.get('headers');\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\n\n  const newTitleLine = parseTitleLine(action.newRawTitle, state.get('todoKeywordSets'));\n\n  state = state.setIn(['headers', headerIndex, 'titleLine'], newTitleLine);\n\n  return updateCookiesOfParentOfHeaderWithId(state, action.headerId);\n};\n\nconst updateHeaderDescription = (state, action) => {\n  const headers = state.get('headers');\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\n\n  return state.updateIn(['headers', headerIndex], header => {\n    const { planningItems, propertyListItems, strippedDescription } =\n      parseDescriptionPrefixElements(action.newRawDescription);\n\n    return header\n      .set('rawDescription', strippedDescription)\n      .set('description', parseRawText(strippedDescription))\n      .set('planningItems', planningItems)\n      .set('propertyListItems', propertyListItems);\n  });\n};\n\nconst addHeader = (state, action) => {\n  const headers = state.get('headers');\n  const header = headerWithId(headers, action.headerId);\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\n\n  const subheaders = subheadersOfHeaderWithId(headers, action.headerId);\n\n  const newHeader = newHeaderWithTitle(\n    '',\n    header.get('nestingLevel'),\n    state.get('todoKeywordSets')\n  );\n\n  if (action.headerId === state.get('focusedHeaderId')) {\n    state = state.set('focusedHeaderId', null);\n  }\n\n  return state.update('headers', headers =>\n    headers.insert(headerIndex + subheaders.size + 1, newHeader)\n  );\n};\n\nconst selectNextSiblingHeader = (state, action) => {\n  const headers = state.get('headers');\n  const header = headerWithId(headers, action.headerId);\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\n  const subheaders = subheadersOfHeaderWithId(headers, action.headerId);\n\n  const nextSibling = headers.get(headerIndex + subheaders.size + 1);\n\n  if (!nextSibling || nextSibling.get('nestingLevel') !== header.get('nestingLevel')) {\n    return state;\n  }\n\n  return state.set('selectedHeaderId', nextSibling.get('id'));\n};\n\nconst selectNextVisibleHeader = (state, action) => {\n  const headers = state.get('headers');\n\n  if (state.get('selectedHeaderId') === undefined) {\n    return state.set('selectedHeaderId', headers.getIn([0, 'id']));\n  }\n\n  const headerIndex = indexOfHeaderWithId(headers, state.get('selectedHeaderId'));\n\n  const nextVisibleHeader = nextVisibleHeaderAfterIndex(headers, headerIndex);\n\n  if (!nextVisibleHeader) {\n    return state;\n  }\n\n  return state.set('selectedHeaderId', nextVisibleHeader.get('id'));\n};\n\nconst selectPreviousVisibleHeader = (state, action) => {\n  const headers = state.get('headers');\n  const headerIndex = indexOfHeaderWithId(headers, state.get('selectedHeaderId'));\n\n  const previousVisibleHeader = previousVisibleHeaderAfterIndex(headers, headerIndex);\n\n  if (!previousVisibleHeader) {\n    return state;\n  }\n\n  return state.set('selectedHeaderId', previousVisibleHeader.get('id'));\n};\n\nconst removeHeader = (state, action) => {\n  let headers = state.get('headers');\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\n\n  const subheaders = subheadersOfHeaderWithId(headers, action.headerId);\n  const numHeadersToRemove = 1 + subheaders.size;\n\n  const parentHeaderId = parentIdOfHeaderWithId(headers, action.headerId);\n\n  _.times(numHeadersToRemove).forEach(() => {\n    headers = headers.delete(headerIndex);\n  });\n\n  if (action.headerId === state.get('focusedHeaderId')) {\n    state = state.set('focusedHeaderId', null);\n  }\n\n  state = state.set('headers', headers);\n\n  if (parentHeaderId) {\n    state = updateCookiesOfHeaderWithId(state, parentHeaderId);\n  }\n\n  return state;\n};\n\nconst moveHeaderUp = (state, action) => {\n  let headers = state.get('headers');\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\n\n  const previousSiblingIndex = indexOfPreviousSibling(headers, headerIndex);\n  if (previousSiblingIndex === null) {\n    return state;\n  }\n\n  const subheaders = subheadersOfHeaderWithId(headers, action.headerId);\n  _.times(1 + subheaders.size).forEach(() => {\n    headers = headers.insert(previousSiblingIndex, headers.get(headerIndex + subheaders.size));\n    headers = headers.delete(headerIndex + subheaders.size + 1);\n  });\n\n  return state.set('headers', headers);\n};\n\nconst moveHeaderDown = (state, action) => {\n  let headers = state.get('headers');\n  const header = headerWithId(headers, action.headerId);\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\n\n  const subheaders = subheadersOfHeaderWithId(headers, action.headerId);\n  const nextSiblingIndex = headerIndex + subheaders.size + 1;\n  const nextSibling = headers.get(nextSiblingIndex);\n  if (nextSibling.get('nestingLevel') < header.get('nestingLevel')) {\n    return state;\n  }\n\n  const nextSiblingSubheaders = subheadersOfHeaderWithId(headers, nextSibling.get('id'));\n  _.times(1 + nextSiblingSubheaders.size).forEach(() => {\n    headers = headers.insert(\n      headerIndex,\n      headers.get(nextSiblingIndex + nextSiblingSubheaders.size)\n    );\n    headers = headers.delete(nextSiblingIndex + nextSiblingSubheaders.size + 1);\n  });\n\n  return state.set('headers', headers);\n};\n\nconst moveHeaderLeft = (state, action) => {\n  const headers = state.get('headers');\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\n\n  const previousParentHeaderId = parentIdOfHeaderWithId(headers, action.headerId);\n\n  state = state.updateIn(['headers', headerIndex, 'nestingLevel'], nestingLevel =>\n    Math.max(nestingLevel - 1, 1)\n  );\n\n  state = updateCookiesOfHeaderWithId(state, previousParentHeaderId);\n  state = updateCookiesOfParentOfHeaderWithId(state, action.headerId);\n\n  return state;\n};\n\nconst moveHeaderRight = (state, action) => {\n  const headers = state.get('headers');\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\n\n  const previousParentHeaderId = parentIdOfHeaderWithId(headers, action.headerId);\n\n  state = state.updateIn(\n    ['headers', headerIndex, 'nestingLevel'],\n    nestingLevel => nestingLevel + 1\n  );\n\n  state = openDirectParent(state, action.headerId);\n  state = updateCookiesOfHeaderWithId(state, previousParentHeaderId);\n  state = updateCookiesOfParentOfHeaderWithId(state, action.headerId);\n\n  return state;\n};\n\nconst moveSubtreeLeft = (state, action) => {\n  const headers = state.get('headers');\n  const header = headerWithId(headers, action.headerId);\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\n\n  const previousParentHeaderId = parentIdOfHeaderWithId(headers, action.headerId);\n\n  if (header.get('nestingLevel') === 1) {\n    return state;\n  }\n\n  const subheaders = subheadersOfHeaderWithId(headers, action.headerId);\n\n  state = state.updateIn(\n    ['headers', headerIndex, 'nestingLevel'],\n    nestingLevel => nestingLevel - 1\n  );\n\n  subheaders.forEach((_, index) => {\n    state = state.updateIn(\n      ['headers', headerIndex + index + 1, 'nestingLevel'],\n      nestingLevel => nestingLevel - 1\n    );\n  });\n\n  state = updateCookiesOfHeaderWithId(state, previousParentHeaderId);\n  state = updateCookiesOfParentOfHeaderWithId(state, action.headerId);\n\n  return state;\n};\n\nconst moveSubtreeRight = (state, action) => {\n  const headers = state.get('headers');\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\n\n  const previousParentHeaderId = parentIdOfHeaderWithId(headers, action.headerId);\n\n  const subheaders = subheadersOfHeaderWithId(headers, action.headerId);\n\n  state = state.updateIn(\n    ['headers', headerIndex, 'nestingLevel'],\n    nestingLevel => nestingLevel + 1\n  );\n  subheaders.forEach((_, index) => {\n    state = state.updateIn(\n      ['headers', headerIndex + index + 1, 'nestingLevel'],\n      nestingLevel => nestingLevel + 1\n    );\n  });\n\n  state = updateCookiesOfHeaderWithId(state, previousParentHeaderId);\n  state = updateCookiesOfParentOfHeaderWithId(state, action.headerId);\n\n  return openDirectParent(state, action.headerId);\n};\n\nconst focusHeader = (state, action) => {\n  return state.set('focusedHeaderId', action.headerId);\n};\n\nconst unfocusHeader = state => state.set('focusedHeaderId', null);\n\nconst noOp = state => state.update('noOpCounter', counter => (counter || 0) + 1);\n\nconst applyOpennessState = (state, action) => {\n  const opennessState = state.get('opennessState');\n  if (!opennessState) {\n    return state;\n  }\n\n  const fileOpennessState = opennessState.get(state.get('path'));\n  if (!fileOpennessState || fileOpennessState.size === 0) {\n    return state;\n  }\n\n  let headers = state.get('headers');\n  fileOpennessState.forEach(openHeaderPath => {\n    headers = openHeaderWithPath(headers, openHeaderPath);\n  });\n\n  return state.set('headers', headers);\n};\n\nconst setDirty = (state, action) => state.set('isDirty', action.isDirty);\n\nconst setSelectedTableCellId = (state, action) => state.set('selectedTableCellId', action.cellId);\n\nconst updateDescriptionOfHeaderContainingTableCell = (state, cellId, header = null) => {\n  const headers = state.get('headers');\n  if (!header) {\n    header = headerThatContainsTableCellId(headers, cellId);\n  }\n  const headerIndex = indexOfHeaderWithId(headers, header.get('id'));\n\n  return state.updateIn(['headers', headerIndex], header =>\n    header.set('rawDescription', attributedStringToRawText(header.get('description')))\n  );\n};\n\nconst addNewTableRow = (state, action) => {\n  const selectedTableCellId = state.get('selectedTableCellId');\n  if (!selectedTableCellId) {\n    return state;\n  }\n\n  state = state.update('headers', headers =>\n    updateTableContainingCellId(\n      headers,\n      selectedTableCellId,\n      rowIndex => rows => rows.insert(rowIndex + 1, newEmptyTableRowLikeRows(rows))\n    )\n  );\n\n  return updateDescriptionOfHeaderContainingTableCell(state, selectedTableCellId);\n};\n\nconst removeTableRow = (state, action) => {\n  const selectedTableCellId = state.get('selectedTableCellId');\n  if (!selectedTableCellId) {\n    return state;\n  }\n\n  const containingHeader = headerThatContainsTableCellId(state.get('headers'), selectedTableCellId);\n\n  state = state.update('headers', headers =>\n    updateTableContainingCellId(\n      headers,\n      selectedTableCellId,\n      rowIndex => rows => rows.delete(rowIndex)\n    )\n  );\n\n  state = state.set('selectedTableCellId', null);\n\n  return updateDescriptionOfHeaderContainingTableCell(state, selectedTableCellId, containingHeader);\n};\n\nconst addNewTableColumn = (state, action) => {\n  const selectedTableCellId = state.get('selectedTableCellId');\n  if (!selectedTableCellId) {\n    return state;\n  }\n\n  state = state.update('headers', headers =>\n    updateTableContainingCellId(\n      headers,\n      selectedTableCellId,\n      (_rowIndex, colIndex) => rows =>\n        rows.map(row =>\n          row.update('contents', contents => contents.insert(colIndex + 1, newEmptyTableCell()))\n        )\n    )\n  );\n\n  return updateDescriptionOfHeaderContainingTableCell(state, selectedTableCellId);\n};\n\nconst removeTableColumn = (state, action) => {\n  const selectedTableCellId = state.get('selectedTableCellId');\n  if (!selectedTableCellId) {\n    return state;\n  }\n\n  const containingHeader = headerThatContainsTableCellId(state.get('headers'), selectedTableCellId);\n\n  state = state.update('headers', headers =>\n    updateTableContainingCellId(\n      headers,\n      selectedTableCellId,\n      (_rowIndex, colIndex) => rows =>\n        rows.map(row => row.update('contents', contents => contents.delete(colIndex)))\n    )\n  );\n\n  state = state.set('selectedTableCellId', null);\n\n  return updateDescriptionOfHeaderContainingTableCell(state, selectedTableCellId, containingHeader);\n};\n\nconst moveTableRowDown = state => {\n  const selectedTableCellId = state.get('selectedTableCellId');\n  if (!selectedTableCellId) {\n    return state;\n  }\n\n  state = state.update('headers', headers =>\n    updateTableContainingCellId(\n      headers,\n      selectedTableCellId,\n      rowIndex => rows =>\n        rowIndex + 1 === rows.size\n          ? rows\n          : rows.insert(rowIndex, rows.get(rowIndex + 1)).delete(rowIndex + 2)\n    )\n  );\n\n  return updateDescriptionOfHeaderContainingTableCell(state, selectedTableCellId);\n};\n\nconst moveTableRowUp = (state, action) => {\n  const selectedTableCellId = state.get('selectedTableCellId');\n  if (!selectedTableCellId) {\n    return state;\n  }\n\n  state = state.update('headers', headers =>\n    updateTableContainingCellId(\n      headers,\n      selectedTableCellId,\n      rowIndex => rows =>\n        rowIndex === 0 ? rows : rows.insert(rowIndex - 1, rows.get(rowIndex)).delete(rowIndex + 1)\n    )\n  );\n\n  return updateDescriptionOfHeaderContainingTableCell(state, selectedTableCellId);\n};\n\nconst moveTableColumnLeft = (state, action) => {\n  const selectedTableCellId = state.get('selectedTableCellId');\n  if (!selectedTableCellId) {\n    return state;\n  }\n\n  state = state.update('headers', headers =>\n    updateTableContainingCellId(\n      headers,\n      selectedTableCellId,\n      (_rowIndex, columnIndex) => rows =>\n        columnIndex === 0\n          ? rows\n          : rows.map(row =>\n              row.update('contents', contents =>\n                contents.size === 0\n                  ? contents\n                  : contents\n                      .insert(columnIndex - 1, contents.get(columnIndex))\n                      .delete(columnIndex + 1)\n              )\n            )\n    )\n  );\n\n  return updateDescriptionOfHeaderContainingTableCell(state, selectedTableCellId);\n};\n\nconst moveTableColumnRight = (state, action) => {\n  const selectedTableCellId = state.get('selectedTableCellId');\n  if (!selectedTableCellId) {\n    return state;\n  }\n\n  state = state.update('headers', headers =>\n    updateTableContainingCellId(\n      headers,\n      selectedTableCellId,\n      (_rowIndex, columnIndex) => rows =>\n        columnIndex + 1 >= rows.getIn([0, 'contents']).size\n          ? rows\n          : rows.map(row =>\n              row.update('contents', contents =>\n                contents.size === 0\n                  ? contents\n                  : contents\n                      .insert(columnIndex, contents.get(columnIndex + 1))\n                      .delete(columnIndex + 2)\n              )\n            )\n    )\n  );\n\n  return updateDescriptionOfHeaderContainingTableCell(state, selectedTableCellId);\n};\n\nconst updateTableCellValue = (state, action) => {\n  state = state.update('headers', headers =>\n    updateTableContainingCellId(\n      headers,\n      action.cellId,\n      (rowIndex, colIndex) => rows =>\n        rows.updateIn([rowIndex, 'contents', colIndex], cell =>\n          cell\n            .set('rawContents', action.newValue)\n            .set(\n              'contents',\n              fromJS(parseMarkupAndCookies(action.newValue, { excludeCookies: true }))\n            )\n        )\n    )\n  );\n\n  return updateDescriptionOfHeaderContainingTableCell(state, action.cellId);\n};\n\nconst insertCapture = (state, action) => {\n  const headers = state.get('headers');\n  const { template, content, shouldPrepend } = action;\n\n  const isTopLevelTarget = template.get('headerPaths').filter(path => path.length !== 0).size === 0;\n\n  const parentHeader = isTopLevelTarget\n    ? null\n    : headerWithPath(headers, template.get('headerPaths'));\n  if (!parentHeader && !isTopLevelTarget) {\n    return state;\n  }\n\n  const newHeader = newHeaderFromText(content, state.get('todoKeywordSets')).set(\n    'nestingLevel',\n    isTopLevelTarget ? 1 : parentHeader.get('nestingLevel') + 1\n  );\n\n  if (isTopLevelTarget) {\n    return state.update('headers', headers => headers.push(newHeader));\n  } else {\n    const parentHeaderIndex = indexOfHeaderWithId(headers, parentHeader.get('id'));\n    const numSubheaders = numSubheadersOfHeaderWithId(headers, parentHeader.get('id'));\n    const newIndex = parentHeaderIndex + 1 + (shouldPrepend ? 0 : numSubheaders);\n\n    state = state.update('headers', headers => headers.insert(newIndex, newHeader));\n\n    state = updateCookiesOfHeaderWithId(state, parentHeader.get('id'));\n\n    return state;\n  }\n};\n\nconst clearPendingCapture = state => state.set('pendingCapture', null);\n\nconst updateParentListCheckboxes = (state, itemPath) => {\n  const parentListItemPath = itemPath.slice(0, itemPath.length - 4);\n  const parentListItem = state.getIn(parentListItemPath);\n  if (!parentListItem.has('checkboxState')) {\n    return state;\n  }\n\n  const childrenCheckedStates = parentListItem\n    .get('contents')\n    .filter(part => part.get('type') === 'list')\n    .flatMap(listPart =>\n      listPart\n        .get('items')\n        .filter(item => item.get('isCheckbox'))\n        .map(checkboxItem => checkboxItem.get('checkboxState'))\n    );\n\n  if (childrenCheckedStates.every(state => state === 'checked')) {\n    state = state.setIn(parentListItemPath.concat(['checkboxState']), 'checked');\n  } else if (childrenCheckedStates.every(state => state === 'unchecked')) {\n    state = state.setIn(parentListItemPath.concat(['checkboxState']), 'unchecked');\n  } else {\n    state = state.setIn(parentListItemPath.concat(['checkboxState']), 'partial');\n  }\n\n  const childCompletionStates = childrenCheckedStates\n    .map(state => {\n      switch (state) {\n        case 'checked':\n          return true;\n        case 'unchecked':\n          return false;\n        case 'partial':\n          return false;\n        default:\n          return false;\n      }\n    })\n    .toJS();\n\n  state = state.updateIn(parentListItemPath.concat('titleLine'), titleLine =>\n    updateCookiesInAttributedStringWithChildCompletionStates(titleLine, childCompletionStates)\n  );\n\n  if (parentListItem.get('isCheckbox')) {\n    return updateParentListCheckboxes(state, parentListItemPath);\n  } else {\n    return state;\n  }\n};\n\nconst advanceCheckboxState = (state, action) => {\n  const pathAndPart = pathAndPartOfListItemWithIdInHeaders(state.get('headers'), action.listItemId);\n  const { path, listItemPart } = pathAndPart;\n\n  const hasDirectCheckboxChildren = listItemPart\n    .get('contents')\n    .filter(part => part.get('type') === 'list')\n    .some(listPart => listPart.get('items').some(item => item.get('isCheckbox')));\n  if (hasDirectCheckboxChildren) {\n    return state;\n  }\n\n  const newCheckboxState = {\n    checked: 'unchecked',\n    unchecked: 'checked',\n    partial: 'unchecked',\n  }[listItemPart.get('checkboxState')];\n\n  state = state.setIn(['headers'].concat(path).concat(['checkboxState']), newCheckboxState);\n  state = updateParentListCheckboxes(state, ['headers'].concat(path));\n\n  const headerIndex = path[0];\n  state = updateCookiesOfHeaderWithId(state, state.getIn(['headers', headerIndex, 'id']));\n  state = state.updateIn(['headers', headerIndex], header =>\n    header.set('rawDescription', attributedStringToRawText(header.get('description')))\n  );\n\n  return state;\n};\n\nconst setSelectedListItemId = (state, action) => state.set('selectedListItemId', action.listItemId);\n\nconst updateDescriptionOfHeaderContainingListItem = (state, listItemId, header = null) => {\n  let headerIndex = -1;\n  const headers = state.get('headers');\n  if (!header) {\n    const pathAndPart = pathAndPartOfListItemWithIdInHeaders(headers, listItemId);\n    headerIndex = pathAndPart.path[0];\n  } else {\n    headerIndex = indexOfHeaderWithId(headers, header.get('id'));\n  }\n\n  if (headerIndex >= 0) {\n    return state.updateIn(['headers', headerIndex], header =>\n      header.set('rawDescription', attributedStringToRawText(header.get('description')))\n    );\n  } else {\n    return state;\n  }\n};\n\nconst updateListTitleValue = (state, action) => {\n  const selectedListItemId = action.listItemId;\n  if (!selectedListItemId) {\n    return state;\n  }\n\n  state = state.update('headers', headers =>\n    updateListContainingListItemId(\n      headers,\n      selectedListItemId,\n      itemIndex => items =>\n        items.updateIn([itemIndex], item =>\n          item.set('titleLine', fromJS(parseMarkupAndCookies(action.newValue)))\n        )\n    )\n  );\n\n  return updateDescriptionOfHeaderContainingListItem(state, selectedListItemId);\n};\n\nconst updateListContentsValue = (state, action) => {\n  const selectedListItemId = action.listItemId;\n  if (!selectedListItemId) {\n    return state;\n  }\n\n  state = state.update('headers', headers =>\n    updateListContainingListItemId(\n      headers,\n      selectedListItemId,\n      itemIndex => items =>\n        items.updateIn([itemIndex], item =>\n          item.set('contents', fromJS(parseRawText(action.newValue)))\n        )\n    )\n  );\n\n  return updateDescriptionOfHeaderContainingListItem(state, selectedListItemId);\n};\n\nconst addNewListItem = (state, action) => {\n  const selectedListItemId = state.get('selectedListItemId');\n  if (!selectedListItemId) {\n    return state;\n  }\n\n  const pathAndPart = pathAndPartOfListItemWithIdInHeaders(\n    state.get('headers'),\n    selectedListItemId\n  );\n\n  let newItem = newListItem();\n  if (pathAndPart.listItemPart.get('isCheckbox')) {\n    newItem = newItem.set('isCheckbox', true).set('checkboxState', 'unchecked');\n  }\n\n  state = state.update('headers', headers =>\n    updateListContainingListItemId(\n      headers,\n      selectedListItemId,\n      itemIndex => items => items.insert(itemIndex + 1, newItem)\n    )\n  );\n  return updateDescriptionOfHeaderContainingListItem(state, selectedListItemId);\n};\n\nconst selectNextSiblingListItem = (state, action) => {\n  const selectedListItemId = state.get('selectedListItemId');\n  if (!selectedListItemId) {\n    return state;\n  }\n\n  const pathAndPart = pathAndPartOfListItemWithIdInHeaders(\n    state.get('headers'),\n    selectedListItemId\n  );\n  let { path } = pathAndPart;\n  path[path.length - 1] = path[path.length - 1] + 1;\n\n  state = state.set('selectedListItemId', state.getIn(['headers'].concat(path).concat('id')));\n\n  return state;\n};\n\nconst removeListItem = (state, action) => {\n  const selectedListItemId = state.get('selectedListItemId');\n  if (!selectedListItemId) {\n    return state;\n  }\n\n  const containingHeader = headerThatContainsListItemId(state.get('headers'), selectedListItemId);\n\n  state = state.update('headers', headers =>\n    updateListContainingListItemId(\n      headers,\n      selectedListItemId,\n      itemIndex => items => items.delete(itemIndex)\n    )\n  );\n\n  state = state.set('selectedListItemId', null);\n\n  return updateDescriptionOfHeaderContainingListItem(state, selectedListItemId, containingHeader);\n};\n\nconst moveListItemUp = state => {\n  const selectedListItemId = state.get('selectedListItemId');\n  if (!selectedListItemId) {\n    return state;\n  }\n\n  state = state.update('headers', headers =>\n    updateListContainingListItemId(\n      headers,\n      selectedListItemId,\n      itemIndex => items =>\n        itemIndex === 0\n          ? items\n          : items.insert(itemIndex - 1, items.get(itemIndex)).delete(itemIndex + 1)\n    )\n  );\n\n  return updateDescriptionOfHeaderContainingListItem(state, selectedListItemId);\n};\n\nconst moveListItemDown = state => {\n  const selectedListItemId = state.get('selectedListItemId');\n  if (!selectedListItemId) {\n    return state;\n  }\n\n  state = state.update('headers', headers =>\n    updateListContainingListItemId(\n      headers,\n      selectedListItemId,\n      itemIndex => items =>\n        itemIndex + 1 === items.size\n          ? items\n          : items.insert(itemIndex, items.get(itemIndex + 1)).delete(itemIndex + 2)\n    )\n  );\n\n  return updateDescriptionOfHeaderContainingListItem(state, selectedListItemId);\n};\n\nconst moveListItemLeft = state => {\n  const selectedListItemId = state.get('selectedListItemId');\n  if (!selectedListItemId) {\n    return state;\n  }\n\n  const pathAndPart = pathAndPartOfListItemWithIdInHeaders(\n    state.get('headers'),\n    selectedListItemId\n  );\n\n  const hasChildrenItem = pathAndPart.listItemPart\n    .get('contents')\n    .filter(part => part.get('type') === 'list')\n    .some(listPart => listPart.get('items').size > 0);\n  if (hasChildrenItem) {\n    return state;\n  }\n  return moveListSubtreeLeft(state);\n};\n\nconst moveListItemRight = state => {\n  const selectedListItemId = state.get('selectedListItemId');\n  if (!selectedListItemId) {\n    return state;\n  }\n\n  const pathAndPart = pathAndPartOfListItemWithIdInHeaders(\n    state.get('headers'),\n    selectedListItemId\n  );\n  let { path, listItemPart: selectedListItem } = pathAndPart;\n  const listPart = state.getIn(['headers'].concat(path.slice(0, path.length - 2)));\n  const prevSiblingItemIndex = path[path.length - 1] - 1;\n\n  if (prevSiblingItemIndex < 0) {\n    return state;\n  }\n\n  state = state.update('headers', headers =>\n    updateListContainingListItemId(\n      headers,\n      selectedListItemId,\n      itemIndex => items => items.delete(itemIndex)\n    )\n  );\n\n  const prevSiblingItemContentsPath = ['headers']\n    .concat(path.slice(0, path.length - 1))\n    .concat(prevSiblingItemIndex)\n    .concat('contents');\n\n  const childrenListParts = selectedListItem\n    .get('contents')\n    .filter(part => part.get('type') === 'list');\n\n  selectedListItem = selectedListItem.update('contents', contents =>\n    contents.filter(part => part.get('type') !== 'list')\n  );\n\n  state = state.updateIn(prevSiblingItemContentsPath, contents =>\n    updateContentsWithListItemAddition(contents, selectedListItem, listPart)\n  );\n\n  childrenListParts.map(listPart =>\n    listPart.get('items').forEach((item, itemIndex) => {\n      state = state.updateIn(prevSiblingItemContentsPath, contents =>\n        updateContentsWithListItemAddition(contents, item, listPart)\n      );\n    })\n  );\n\n  return updateDescriptionOfHeaderContainingListItem(state, selectedListItemId);\n};\n\nconst moveListSubtreeLeft = state => {\n  const selectedListItemId = state.get('selectedListItemId');\n  if (!selectedListItemId) {\n    return state;\n  }\n\n  const pathAndPart = pathAndPartOfListItemWithIdInHeaders(\n    state.get('headers'),\n    selectedListItemId\n  );\n  let { path, listItemPart: selectedListItem } = pathAndPart;\n  const selectedListItemIndex = path[path.length - 1];\n  if (path.filter(partOfPath => partOfPath === 'items').length < 2) {\n    return state;\n  }\n\n  const parentListItem = parentListItemWithIdInHeaders(\n    state.getIn(['headers']),\n    selectedListItemId\n  );\n\n  parentListItem\n    .get('contents')\n    .filter(part => part.get('type') === 'list')\n    .map(listPart =>\n      listPart.get('items').forEach((item, itemIndex) => {\n        if (itemIndex > selectedListItemIndex) {\n          selectedListItem = selectedListItem.update('contents', contents =>\n            updateContentsWithListItemAddition(contents, item, listPart)\n          );\n        }\n      })\n    );\n\n  state = state.update('headers', headers =>\n    updateListContainingListItemId(\n      headers,\n      selectedListItemId,\n      itemIndex => items => items.filter((_item, index) => index < selectedListItemIndex)\n    )\n  );\n\n  state = state.update('headers', headers =>\n    updateListContainingListItemId(\n      headers,\n      parentListItem.get('id'),\n      itemIndex => items => items.insert(itemIndex + 1, selectedListItem)\n    )\n  );\n\n  return updateDescriptionOfHeaderContainingListItem(state, selectedListItemId);\n};\n\nconst moveListSubtreeRight = state => {\n  const selectedListItemId = state.get('selectedListItemId');\n  if (!selectedListItemId) {\n    return state;\n  }\n\n  const pathAndPart = pathAndPartOfListItemWithIdInHeaders(\n    state.get('headers'),\n    selectedListItemId\n  );\n  const { path, listItemPart: selectedListItem } = pathAndPart;\n  const listPart = state.getIn(['headers'].concat(path.slice(0, path.length - 2)));\n  const prevSiblingItemIndex = path[path.length - 1] - 1;\n  if (prevSiblingItemIndex < 0) {\n    return state;\n  }\n\n  state = state.update('headers', headers =>\n    updateListContainingListItemId(\n      headers,\n      selectedListItemId,\n      itemIndex => items => itemIndex === 0 ? items : items.delete(itemIndex)\n    )\n  );\n\n  state = state.updateIn(\n    ['headers']\n      .concat(path.slice(0, path.length - 1))\n      .concat(prevSiblingItemIndex)\n      .concat('contents'),\n    contents => updateContentsWithListItemAddition(contents, selectedListItem, listPart)\n  );\n\n  return updateDescriptionOfHeaderContainingListItem(state, selectedListItemId);\n};\n\nconst setLastSyncAt = (state, action) => state.set('lastSyncAt', action.lastSyncAt);\n\nconst setHeaderTags = (state, action) => {\n  const headers = state.get('headers');\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\n  if (headerIndex === -1) {\n    return state;\n  }\n\n  return state.setIn(['headers', headerIndex, 'titleLine', 'tags'], action.tags);\n};\n\nconst reorderTags = (state, action) => {\n  const selectedHeaderId = state.get('selectedHeaderId');\n  if (!selectedHeaderId) {\n    return state;\n  }\n  const headerIndex = indexOfHeaderWithId(state.get('headers'), selectedHeaderId);\n\n  return state.updateIn(['headers', headerIndex, 'titleLine', 'tags'], tags =>\n    tags.splice(action.fromIndex, 1).splice(action.toIndex, 0, tags.get(action.fromIndex))\n  );\n};\n\nconst reorderPropertyList = (state, action) => {\n  const headerId = action.headerId;\n  if (!headerId) {\n    return state;\n  }\n  const headerIndex = indexOfHeaderWithId(state.get('headers'), headerId);\n\n  return state.updateIn(['headers', headerIndex, 'propertyListItems'], propertyListItems =>\n    propertyListItems\n      .splice(action.fromIndex, 1)\n      .splice(action.toIndex, 0, propertyListItems.get(action.fromIndex))\n  );\n};\n\nconst updateTimestampWithId = (state, action) => {\n  const pathAndPart = pathAndPartOfTimestampItemWithIdInHeaders(\n    state.get('headers'),\n    action.timestampId\n  );\n  if (!pathAndPart) {\n    return state;\n  }\n\n  const { path } = pathAndPart;\n  const headerIndex = path[0];\n\n  return state\n    .setIn(['headers'].concat(path), action.newTimestamp)\n    .updateIn(['headers', headerIndex], header =>\n      header.set('rawDescription', attributedStringToRawText(header.get('description')))\n    )\n    .updateIn(['headers', headerIndex], header =>\n      header.setIn(\n        ['titleLine', 'rawTitle'],\n        attributedStringToRawText(header.getIn(['titleLine', 'title']))\n      )\n    );\n};\n\nconst updatePlanningItemTimestamp = (state, action) => {\n  const { headerId, planningItemIndex, newTimestamp } = action;\n  const headerIndex = indexOfHeaderWithId(state.get('headers'), headerId);\n\n  return state.setIn(\n    ['headers', headerIndex, 'planningItems', planningItemIndex, 'timestamp'],\n    newTimestamp\n  );\n};\n\nconst addNewPlanningItem = (state, action) => {\n  const headerIndex = indexOfHeaderWithId(state.get('headers'), action.headerId);\n\n  const newPlanningItem = fromJS({\n    id: generateId(),\n    type: action.planningType,\n    timestamp: getCurrentTimestamp(),\n  });\n\n  return state.updateIn(['headers', headerIndex, 'planningItems'], planningItems =>\n    !!planningItems ? planningItems.push(newPlanningItem) : List([newPlanningItem])\n  );\n};\n\nexport const updatePropertyListItems = (state, action) => {\n  const headerIndex = indexOfHeaderWithId(state.get('headers'), action.headerId);\n\n  return state.setIn(['headers', headerIndex, 'propertyListItems'], action.newPropertyListItems);\n};\n\nconst setOrgFileErrorMessage = (state, action) => state.set('orgFileErrorMessage', action.message);\n\nexport default (state = new Map(), action) => {\n  if (action.dirtying) {\n    state = state.set('isDirty', true);\n  }\n\n  switch (action.type) {\n    case 'DISPLAY_FILE':\n      return displayFile(state, action);\n    case 'STOP_DISPLAYING_FILE':\n      return stopDisplayingFile(state, action);\n    case 'TOGGLE_HEADER_OPENED':\n      return toggleHeaderOpened(state, action);\n    case 'OPEN_HEADER':\n      return openHeader(state, action);\n    case 'SELECT_HEADER':\n      return selectHeader(state, action);\n    case 'OPEN_PARENTS_OF_HEADER':\n      return openParentsOfHeader(state, action);\n    case 'ADVANCE_TODO_STATE':\n      return advanceTodoState(state, action);\n    case 'ENTER_EDIT_MODE':\n      return enterEditMode(state, action);\n    case 'EXIT_EDIT_MODE':\n      return exitEditMode(state, action);\n    case 'UPDATE_HEADER_TITLE':\n      return updateHeaderTitle(state, action);\n    case 'UPDATE_HEADER_DESCRIPTION':\n      return updateHeaderDescription(state, action);\n    case 'ADD_HEADER':\n      return addHeader(state, action);\n    case 'SELECT_NEXT_SIBLING_HEADER':\n      return selectNextSiblingHeader(state, action);\n    case 'SELECT_NEXT_VISIBLE_HEADER':\n      return selectNextVisibleHeader(state, action);\n    case 'SELECT_PREVIOUS_VISIBLE_HEADER':\n      return selectPreviousVisibleHeader(state, action);\n    case 'REMOVE_HEADER':\n      return removeHeader(state, action);\n    case 'MOVE_HEADER_UP':\n      return moveHeaderUp(state, action);\n    case 'MOVE_HEADER_DOWN':\n      return moveHeaderDown(state, action);\n    case 'MOVE_HEADER_LEFT':\n      return moveHeaderLeft(state, action);\n    case 'MOVE_HEADER_RIGHT':\n      return moveHeaderRight(state, action);\n    case 'MOVE_SUBTREE_LEFT':\n      return moveSubtreeLeft(state, action);\n    case 'MOVE_SUBTREE_RIGHT':\n      return moveSubtreeRight(state, action);\n    case 'NO_OP':\n      return noOp(state, action);\n    case 'APPLY_OPENNESS_STATE':\n      return applyOpennessState(state, action);\n    case 'SET_DIRTY':\n      return setDirty(state, action);\n    case 'FOCUS_HEADER':\n      return focusHeader(state, action);\n    case 'UNFOCUS_HEADER':\n      return unfocusHeader(state, action);\n    case 'SET_SELECTED_TABLE_CELL_ID':\n      return setSelectedTableCellId(state, action);\n    case 'ADD_NEW_TABLE_ROW':\n      return addNewTableRow(state, action);\n    case 'REMOVE_TABLE_ROW':\n      return removeTableRow(state, action);\n    case 'ADD_NEW_TABLE_COLUMN':\n      return addNewTableColumn(state, action);\n    case 'REMOVE_TABLE_COLUMN':\n      return removeTableColumn(state, action);\n    case 'MOVE_TABLE_ROW_DOWN':\n      return moveTableRowDown(state, action);\n    case 'MOVE_TABLE_ROW_UP':\n      return moveTableRowUp(state, action);\n    case 'MOVE_TABLE_COLUMN_LEFT':\n      return moveTableColumnLeft(state, action);\n    case 'MOVE_TABLE_COLUMN_RIGHT':\n      return moveTableColumnRight(state, action);\n    case 'UPDATE_TABLE_CELL_VALUE':\n      return updateTableCellValue(state, action);\n    case 'INSERT_CAPTURE':\n      return insertCapture(state, action);\n    case 'CLEAR_PENDING_CAPTURE':\n      return clearPendingCapture(state, action);\n    case 'ADVANCE_CHECKBOX_STATE':\n      return advanceCheckboxState(state, action);\n    case 'SET_SELECTED_LIST_ITEM_ID':\n      return setSelectedListItemId(state, action);\n    case 'UPDATE_LIST_TITLE_VALUE':\n      return updateListTitleValue(state, action);\n    case 'UPDATE_LIST_CONTENTS_VALUE':\n      return updateListContentsValue(state, action);\n    case 'ADD_NEW_LIST_ITEM':\n      return addNewListItem(state, action);\n    case 'SELECT_NEXT_SIBLING_LIST_ITEM':\n      return selectNextSiblingListItem(state, action);\n    case 'REMOVE_LIST_ITEM':\n      return removeListItem(state, action);\n    case 'MOVE_LIST_ITEM_UP':\n      return moveListItemUp(state, action);\n    case 'MOVE_LIST_ITEM_DOWN':\n      return moveListItemDown(state, action);\n    case 'MOVE_LIST_ITEM_LEFT':\n      return moveListItemLeft(state, action);\n    case 'MOVE_LIST_ITEM_RIGHT':\n      return moveListItemRight(state, action);\n    case 'MOVE_LIST_SUBTREE_LEFT':\n      return moveListSubtreeLeft(state, action);\n    case 'MOVE_LIST_SUBTREE_RIGHT':\n      return moveListSubtreeRight(state, action);\n    case 'SET_LAST_SYNC_AT':\n      return setLastSyncAt(state, action);\n    case 'SET_HEADER_TAGS':\n      return setHeaderTags(state, action);\n    case 'REORDER_TAGS':\n      return reorderTags(state, action);\n    case 'REORDER_PROPERTY_LIST':\n      return reorderPropertyList(state, action);\n    case 'UPDATE_TIMESTAMP_WITH_ID':\n      return updateTimestampWithId(state, action);\n    case 'UPDATE_PLANNING_ITEM_TIMESTAMP':\n      return updatePlanningItemTimestamp(state, action);\n    case 'ADD_NEW_PLANNING_ITEM':\n      return addNewPlanningItem(state, action);\n    case 'UPDATE_PROPERTY_LIST_ITEMS':\n      return updatePropertyListItems(state, action);\n    case 'SET_ORG_FILE_ERROR_MESSAGE':\n      return setOrgFileErrorMessage(state, action);\n    default:\n      return state;\n  }\n};\n","import { Map, List, fromJS } from 'immutable';\n\nimport generateId from '../lib/id_generator';\nimport { applyCaptureSettingsFromConfig } from '../util/settings_persister';\n\nconst indexOfTemplateWithId = (templates, templateId) =>\n  templates.findIndex(template => template.get('id') === templateId);\n\nconst addNewEmptyCaptureTemplate = state => {\n  if (!state.get('captureTemplates')) {\n    state = state.set('captureTemplates', new List());\n  }\n\n  return state.update('captureTemplates', templates =>\n    templates.push(\n      fromJS({\n        id: generateId(),\n        description: '',\n        letter: '',\n        iconName: '',\n        isAvailableInAllOrgFiles: true,\n        orgFilesWhereAvailable: [''],\n        headerPaths: [''],\n        shouldPrepend: false,\n        template: '',\n      })\n    )\n  );\n};\n\nconst updateTemplateFieldPathValue = (state, action) => {\n  const templateIndex = indexOfTemplateWithId(state.get('captureTemplates'), action.templateId);\n\n  return state.setIn(['captureTemplates', templateIndex].concat(action.fieldPath), action.newValue);\n};\n\nconst addNewTemplateOrgFileAvailability = (state, action) => {\n  const templateIndex = indexOfTemplateWithId(state.get('captureTemplates'), action.templateId);\n\n  return state.updateIn(['captureTemplates', templateIndex, 'orgFilesWhereAvailable'], orgFiles =>\n    orgFiles.push('')\n  );\n};\n\nconst removeTemplateOrgFileAvailability = (state, action) => {\n  const templateIndex = indexOfTemplateWithId(state.get('captureTemplates'), action.templateId);\n\n  return state.updateIn(['captureTemplates', templateIndex, 'orgFilesWhereAvailable'], orgFiles =>\n    orgFiles.delete(action.orgFileAvailabilityIndex)\n  );\n};\n\nconst addNewTemplateHeaderPath = (state, action) => {\n  const templateIndex = indexOfTemplateWithId(state.get('captureTemplates'), action.templateId);\n\n  return state.updateIn(['captureTemplates', templateIndex, 'headerPaths'], headerPaths =>\n    headerPaths.push('')\n  );\n};\n\nconst removeTemplateHeaderPath = (state, action) => {\n  const templateIndex = indexOfTemplateWithId(state.get('captureTemplates'), action.templateId);\n\n  return state.updateIn(['captureTemplates', templateIndex, 'headerPaths'], headerPaths =>\n    headerPaths.delete(action.headerPathIndex)\n  );\n};\n\nconst deleteTemplate = (state, action) => {\n  const templateIndex = indexOfTemplateWithId(state.get('captureTemplates'), action.templateId);\n\n  return state.update('captureTemplates', templates => templates.delete(templateIndex));\n};\n\nconst restoreCaptureSettings = (state, action) => {\n  if (!action.newSettings) {\n    return state;\n  }\n\n  return applyCaptureSettingsFromConfig(state, action.newSettings);\n};\n\nconst reorderCaptureTemplate = (state, action) =>\n  state.update('captureTemplates', templates =>\n    templates.splice(action.fromIndex, 1).splice(action.toIndex, 0, templates.get(action.fromIndex))\n  );\n\nexport default (state = new Map(), action) => {\n  switch (action.type) {\n    case 'ADD_NEW_EMPTY_CAPTURE_TEMPLATE':\n      return addNewEmptyCaptureTemplate(state, action);\n    case 'UPDATE_TEMPLATE_FIELD_PATH_VALUE':\n      return updateTemplateFieldPathValue(state, action);\n    case 'ADD_NEW_TEMPLATE_ORG_FILE_AVAILABILITY':\n      return addNewTemplateOrgFileAvailability(state, action);\n    case 'REMOVE_TEMPLATE_ORG_FILE_AVAILABILITY':\n      return removeTemplateOrgFileAvailability(state, action);\n    case 'ADD_NEW_TEMPLATE_HEADER_PATH':\n      return addNewTemplateHeaderPath(state, action);\n    case 'REMOVE_TEMPLATE_HEADER_PATH':\n      return removeTemplateHeaderPath(state, action);\n    case 'DELETE_TEMPLATE':\n      return deleteTemplate(state, action);\n    case 'RESTORE_CAPTURE_SETTINGS':\n      return restoreCaptureSettings(state, action);\n    case 'REORDER_CAPTURE_TEMPLATE':\n      return reorderCaptureTemplate(state, action);\n    default:\n      return state;\n  }\n};\n","import { combineReducers } from 'redux';\nimport undoable, { includeAction } from 'redux-linear-undo';\n\nimport baseReducer from './base';\nimport syncBackendReducer from './sync_backend';\nimport orgReducer from './org';\nimport captureReducer from './capture';\n\nconst UNDOABLE_ACTIONS = [\n  'ADD_HEADER',\n  'REMOVE_HEADER',\n  'MOVE_HEADER_UP',\n  'MOVE_HEADER_DOWN',\n  'MOVE_HEADER_LEFT',\n  'MOVE_HEADER_RIGHT',\n  'MOVE_SUBTREE_LEFT',\n  'MOVE_SUBTREE_RIGHT',\n  'ADVANCE_TODO_STATE',\n  'EDIT_HEADER_TITLE',\n  'EDIT_HEADER_DESCRIPTION',\n  'NO_OP',\n  'ADD_NEW_TABLE_ROW',\n  'ADD_NEW_TABLE_COLUMN',\n  'MOVE_TABLE_ROW_DOWN',\n  'MOVE_TABLE_ROW_UP',\n  'MOVE_TABLE_COLUMN_LEFT',\n  'MOVE_TABLE_COLUMN_RIGHT',\n  'ADD_NEW_LIST_ITEM',\n  'REMOVE_LIST_ITEM',\n  'MOVE_LIST_ITEM_UP',\n  'MOVE_LIST_ITEM_DOWN',\n  'MOVE_LIST_ITEM_LEFT',\n  'MOVE_LIST_ITEM_RIGHT',\n  'MOVE_LIST_SUBTREE_LEFT',\n  'MOVE_LIST_SUBTREE_RIGHT',\n  'INSERT_CAPTURE',\n];\n\nexport default combineReducers({\n  base: baseReducer,\n  syncBackend: syncBackendReducer,\n  org: undoable(orgReducer, {\n    filter: includeAction(UNDOABLE_ACTIONS),\n    linearizeHistory: true,\n  }),\n  capture: captureReducer,\n});\n","import { Map } from 'immutable';\n\nconst signOut = (state, action) => state.set('isAuthenticated', false).set('client', null);\n\nconst setCurrentFileBrowserDirectoryListing = (state, action) =>\n  state.set(\n    'currentFileBrowserDirectoryListing',\n    Map({\n      listing: action.directoryListing,\n      hasMore: action.hasMore,\n      additionalSyncBackendState: action.additionalSyncBackendState,\n    })\n  );\n\nconst setIsLoadingMoreDirectoryListing = (state, action) =>\n  state\n    .update('currentFileBrowserDirectoryListing', currentFileBrowserDirectoryListing =>\n      !!currentFileBrowserDirectoryListing ? currentFileBrowserDirectoryListing : Map()\n    )\n    .setIn(['currentFileBrowserDirectoryListing', 'isLoadingMore'], action.isLoadingMore);\n\nexport default (state = new Map(), action) => {\n  switch (action.type) {\n    case 'SIGN_OUT':\n      return signOut(state, action);\n    case 'SET_CURRENT_FILE_BROWSER_DIRECTORY_LISTING':\n      return setCurrentFileBrowserDirectoryListing(state, action);\n    case 'SET_IS_LOADING_MORE_DIRECTORY_LISTING':\n      return setIsLoadingMoreDirectoryListing(state, action);\n    default:\n      return state;\n  }\n};\n","import { createStore, applyMiddleware, compose } from 'redux';\nimport thunk from 'redux-thunk';\nimport googleAnalyticsLogger from './middleware/google_analytics_logging';\nimport liveSync from './middleware/live_sync';\nimport syncOnBecomingVisible from './middleware/sync_on_becoming_visible';\nimport rootReducer from './reducers';\n\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\n\nexport default initialState =>\n  createStore(\n    rootReducer,\n    initialState,\n    composeEnhancers(applyMiddleware(thunk, googleAnalyticsLogger, liveSync, syncOnBecomingVisible))\n  );\n","import migrateAccessTokenToDropboxAccessToken from './migrate_access_token_to_dropbox_access_token';\nimport migrateStoreInDropboxToStoreInSyncBackend from './migrate_store_in_dropbox_to_store_in_sync_backend';\n\nexport default () => {\n  migrateAccessTokenToDropboxAccessToken();\n  migrateStoreInDropboxToStoreInSyncBackend();\n};\n","import { isLocalStorageAvailable } from '../util/settings_persister';\n\nexport default () => {\n  if (!isLocalStorageAvailable) {\n    return;\n  }\n\n  const accessToken = localStorage.getItem('accessToken');\n  if (!accessToken) {\n    return;\n  }\n\n  localStorage.setItem('dropboxAccessToken', accessToken);\n  localStorage.removeItem('accessToken');\n};\n","import { isLocalStorageAvailable } from '../util/settings_persister';\n\nexport default () => {\n  if (!isLocalStorageAvailable) {\n    return;\n  }\n\n  const shouldStoreSettingsInDropbox = localStorage.getItem('shouldStoreSettingsInDropbox');\n  if (!shouldStoreSettingsInDropbox) {\n    return;\n  }\n\n  localStorage.setItem('shouldStoreSettingsInSyncBackend', shouldStoreSettingsInDropbox);\n  localStorage.removeItem('shouldStoreSettingsInDropbox');\n};\n","const parseQueryString = str => {\n  var ret = Object.create(null);\n\n  if (typeof str !== 'string') {\n    return ret;\n  }\n\n  str = str.trim().replace(/^(\\?|#|&)/, '');\n\n  if (!str) {\n    return ret;\n  }\n\n  str.split('&').forEach(function (param) {\n    var parts = param.replace(/\\+/g, ' ').split('=');\n    // Firefox (pre 40) decodes `%3D` to `=`\n    // https://github.com/sindresorhus/query-string/pull/37\n    var key = parts.shift();\n    var val = parts.length > 0 ? parts.join('=') : undefined;\n\n    key = decodeURIComponent(key);\n\n    // missing `=` should be `null`:\n    // http://w3.org/TR/2012/WD-url-20120524/#collect-url-parameters\n    val = val === undefined ? null : decodeURIComponent(val);\n\n    if (ret[key] === undefined) {\n      ret[key] = val;\n    } else if (Array.isArray(ret[key])) {\n      ret[key].push(val);\n    } else {\n      ret[key] = [ret[key], val];\n    }\n  });\n\n  return ret;\n};\n\nexport default parseQueryString;\n","/* global gapi, google */\n\nimport { setLoadingMessage, hideLoadingMessage, clearModalStack, setIsLoading } from './base';\nimport {\n  displayFile,\n  applyOpennessState,\n  setDirty,\n  setLastSyncAt,\n  setOrgFileErrorMessage,\n} from './org';\nimport { persistField } from '../util/settings_persister';\nimport { Dropbox } from 'dropbox';\n\nimport { addSeconds } from 'date-fns';\n\nexport const signOut = () => (dispatch, getState) => {\n  switch (getState().syncBackend.get('client', {}).type) {\n    case 'Dropbox':\n      persistField('dropboxAccessToken', null);\n      break;\n    case 'Google Drive':\n      const token = gapi.client.getToken();\n      if (token) {\n        persistField('googleDriveAccessToken', null);\n        google.accounts.oauth2.revoke(token);\n        gapi.client.setToken('');\n        window.location.reload();\n      }\n      break;\n    default:\n  }\n\n  persistField('authenticatedSyncService', null);\n\n  dispatch({ type: 'SIGN_OUT' });\n  dispatch(clearModalStack());\n  dispatch(hideLoadingMessage());\n};\n\nexport const setCurrentFileBrowserDirectoryListing = (\n  directoryListing,\n  hasMore,\n  additionalSyncBackendState\n) => ({\n  type: 'SET_CURRENT_FILE_BROWSER_DIRECTORY_LISTING',\n  directoryListing,\n  hasMore,\n  additionalSyncBackendState,\n});\n\nexport const setIsLoadingMoreDirectoryListing = isLoadingMore => ({\n  type: 'SET_IS_LOADING_MORE_DIRECTORY_LISTING',\n  isLoadingMore,\n});\n\nexport const getDirectoryListing = path => (dispatch, getState) => {\n  dispatch(setLoadingMessage('Getting listing...'));\n\n  window.console.log('reading directories');\n\n  const client = getState().syncBackend.get('client');\n  client\n    .getDirectoryListing(path)\n    .then(({ listing, hasMore, additionalSyncBackendState }) => {\n      dispatch(setCurrentFileBrowserDirectoryListing(listing, hasMore, additionalSyncBackendState));\n      dispatch(hideLoadingMessage());\n    })\n    .catch(error => {\n      alert(`There was an error retrieving files! (status: ${error.status})`);\n\n      if (error.status === 401 || error.status === 404) {\n        window.console.log(`uRL: ${process.env.PUBLIC_URL}`);\n        const dropbox = new Dropbox({ clientId: process.env.REACT_APP_DROPBOX_CLIENT_ID, fetch });\n        const authURL = dropbox.getAuthenticationUrl(\n          window.location.origin + process.env.PUBLIC_URL + '/'\n        );\n        window.location = authURL;\n      }\n\n      dispatch(hideLoadingMessage());\n    });\n};\n\nexport const loadMoreDirectoryListing = () => (dispatch, getState) => {\n  dispatch(setIsLoadingMoreDirectoryListing(true));\n\n  const client = getState().syncBackend.get('client');\n  const currentFileBrowserDirectoryListing = getState().syncBackend.get(\n    'currentFileBrowserDirectoryListing'\n  );\n  client\n    .getMoreDirectoryListing(currentFileBrowserDirectoryListing.get('additionalSyncBackendState'))\n    .then(({ listing, hasMore, additionalSyncBackendState }) => {\n      const extendedListing = currentFileBrowserDirectoryListing.get('listing').concat(listing);\n      dispatch(\n        setCurrentFileBrowserDirectoryListing(extendedListing, hasMore, additionalSyncBackendState)\n      );\n      dispatch(setIsLoadingMoreDirectoryListing(false));\n    });\n};\n\nexport const pushBackup = (pathOrFileId, contents) => {\n  return (dispatch, getState) => {\n    const client = getState().syncBackend.get('client');\n    switch (client.type) {\n      case 'Dropbox':\n        client.createFile(`${pathOrFileId}.org-web-bak`, contents);\n        break;\n      case 'Google Drive':\n        pathOrFileId = pathOrFileId.startsWith('/') ? pathOrFileId.substr(1) : pathOrFileId;\n        client.duplicateFile(pathOrFileId, fileName => `${fileName}.org-web-bak`);\n        break;\n      default:\n    }\n  };\n};\n\nexport const downloadFile = path => {\n  return (dispatch, getState) => {\n    dispatch(setLoadingMessage('Downloading file...'));\n\n    getState()\n      .syncBackend.get('client')\n      .getFileContents(path)\n      .then(fileContents => {\n        dispatch(setDirty(false));\n        dispatch(hideLoadingMessage());\n        dispatch(pushBackup(path, fileContents));\n        dispatch(setLastSyncAt(addSeconds(new Date(), 5)));\n        dispatch(displayFile(path, fileContents));\n        dispatch(applyOpennessState());\n      })\n      .catch(e => {\n        if (e.status === 401 || e.status === 404) {\n          const dropbox = new Dropbox({ clientId: process.env.REACT_APP_DROPBOX_CLIENT_ID, fetch });\n          const authURL = dropbox.getAuthenticationUrl(\n            window.location.origin + process.env.PUBLIC_URL + '/'\n          );\n          window.location = authURL;\n        }\n        dispatch(hideLoadingMessage());\n        dispatch(setIsLoading(false));\n        dispatch(setOrgFileErrorMessage('File not found'));\n      });\n  };\n};\n","import { Dropbox } from 'dropbox';\n\nimport { fromJS, Map } from 'immutable';\n\nexport default accessToken => {\n  const dropboxClient = new Dropbox({ accessToken, fetch });\n\n  const isSignedIn = () => new Promise(resolve => resolve(true));\n\n  const transformDirectoryListing = listing =>\n    fromJS(\n      listing.map(entry => ({\n        id: entry.id,\n        name: entry.name,\n        isDirectory: entry['.tag'] === 'folder',\n        path: entry.path_display,\n      }))\n    );\n\n  const getDirectoryListing = path =>\n    new Promise((resolve, reject) => {\n      dropboxClient\n        .filesListFolder({ path })\n        .then(response =>\n          resolve({\n            listing: transformDirectoryListing(response.entries),\n            hasMore: response.has_more,\n            additionalSyncBackendState: Map({\n              cursor: response.cursor,\n            }),\n          })\n        )\n        .catch(reject);\n    });\n\n  const getMoreDirectoryListing = additionalSyncBackendState => {\n    const cursor = additionalSyncBackendState.get('cursor');\n    return new Promise((resolve, reject) =>\n      dropboxClient.filesListFolderContinue({ cursor }).then(response =>\n        resolve({\n          listing: transformDirectoryListing(response.entries),\n          hasMore: response.has_more,\n          additionalSyncBackendState: Map({\n            cursor: response.cursor,\n          }),\n        })\n      )\n    );\n  };\n\n  const uploadFile = (path, contents) =>\n    new Promise((resolve, reject) =>\n      dropboxClient\n        .filesUpload({\n          path,\n          contents,\n          mode: {\n            '.tag': 'overwrite',\n          },\n          autorename: true,\n        })\n        .then(resolve)\n        .catch(reject)\n    );\n\n  const updateFile = uploadFile;\n  const createFile = uploadFile;\n\n  const getFileContentsAndMetadata = path =>\n    new Promise((resolve, reject) =>\n      dropboxClient\n        .filesDownload({ path })\n        .then(response => {\n          const reader = new FileReader();\n          reader.addEventListener('loadend', () =>\n            resolve({\n              contents: reader.result,\n              lastModifiedAt: response.server_modified,\n            })\n          );\n          reader.readAsText(response.fileBlob);\n        })\n        .catch(error => {\n          if (!!error.error && JSON.parse(error.error).error.path['.tag'] === 'not_found') {\n            reject();\n          }\n        })\n    );\n\n  const getFileContents = path =>\n    new Promise((resolve, reject) =>\n      getFileContentsAndMetadata(path)\n        .then(({ contents }) => resolve(contents))\n        .catch(reject)\n    );\n\n  const deleteFile = path =>\n    new Promise((resolve, reject) =>\n      dropboxClient\n        .filesDelete({ path })\n        .then(resolve)\n        .catch(error => reject(error.error.error['.tag'] === 'path_lookup', error))\n    );\n\n  return {\n    type: 'Dropbox',\n    isSignedIn,\n    getDirectoryListing,\n    getMoreDirectoryListing,\n    updateFile,\n    createFile,\n    getFileContentsAndMetadata,\n    getFileContents,\n    deleteFile,\n  };\n};\n","/* global process */\n\nimport { fromJS, Map } from 'immutable';\nimport { persistField, getPersistedField } from '../util/settings_persister';\n\nexport default () => {\n  const initGoogleDriveAPIClient = () =>\n    new Promise((resolve, reject) => {\n      window.gapi.load('client', () => {\n        window.gapi.client\n          .init({\n            apiKey: process.env.REACT_APP_GOOGLE_DRIVE_API_KEY,\n            discoveryDocs: ['https://www.googleapis.com/discovery/v1/apis/drive/v3/rest'],\n          })\n          .then(async () => {\n            const googleDriveAccessTokenString = getPersistedField('googleDriveAccessToken');\n            if (googleDriveAccessTokenString) {\n              const googleDriveAccessToken = JSON.parse(googleDriveAccessTokenString);\n              window.gapi.client.setToken(googleDriveAccessToken);\n              resolve();\n            } else {\n              const tokenClient = window.google.accounts.oauth2.initTokenClient({\n                client_id: process.env.REACT_APP_GOOGLE_DRIVE_CLIENT_ID,\n                scope: 'https://www.googleapis.com/auth/drive.file',\n                callback: accessToken => {\n                  persistField('authenticatedSyncService', 'Google Drive');\n                  persistField('googleDriveAccessToken', JSON.stringify(accessToken));\n                  resolve();\n                },\n              });\n              tokenClient.requestAccessToken({ prompt: 'consent' });\n            }\n          });\n      });\n    });\n\n  const getAPIClient = (() => {\n    let isInited = false;\n    let isIniting = false;\n    const afterInitCallbacks = [];\n\n    return () => {\n      return new Promise((resolve, reject) => {\n        if (isInited) {\n          resolve(window.gapi);\n        } else {\n          if (window.gapi && !isIniting) {\n            isIniting = true;\n            initGoogleDriveAPIClient().then(() => {\n              isInited = true;\n              afterInitCallbacks.forEach(callback => callback(window.gapi));\n              resolve(window.gapi);\n            });\n          } else {\n            afterInitCallbacks.push(resolve);\n          }\n        }\n      });\n    };\n  })();\n\n  // Trigger the API client init when the gapi script loads.\n  if (window.gapi) {\n    getAPIClient();\n  } else {\n    // This handler will be called when the <script> tag loads.\n    window.handleGoogleDriveClientLoad = getAPIClient;\n  }\n\n  const isSignedIn = () =>\n    new Promise((resolve, reject) => {\n      getAPIClient().then(gapi => {\n        resolve(gapi.client.getToken() !== null);\n      });\n    });\n\n  const transformDirectoryListing = listing =>\n    fromJS(\n      listing.map(entry => ({\n        id: entry.id,\n        name: entry.name,\n        isDirectory: entry.mimeType === 'application/vnd.google-apps.folder',\n        path: `/${entry.id}`,\n      }))\n    );\n\n  const getFiles = (directoryId, nextPageToken = null) => {\n    const fileListPromise = new Promise((resolve, reject) => {\n      getAPIClient().then(gapi => {\n        gapi.client.drive.files\n          .list({\n            pageSize: 30,\n            fields: 'nextPageToken, files(id, name, mimeType, parents)',\n            q: `'${directoryId === '' ? 'root' : directoryId}' in parents and trashed = false`,\n            pageToken: nextPageToken,\n          })\n          .then(response => {\n            resolve({\n              listing: transformDirectoryListing(response.result.files),\n              hasMore: !!response.result.nextPageToken,\n              additionalSyncBackendState: Map({\n                currentDirectoryId: directoryId,\n                nextPageToken: response.result.nextPageToken,\n              }),\n            });\n          })\n          .catch(reject);\n      });\n    });\n\n    const fileParentPromise = new Promise((resolve, reject) => {\n      if (directoryId === '') {\n        resolve(null);\n      } else {\n        getAPIClient()\n          .then(gapi =>\n            gapi.client.drive.files.get({\n              fileId: directoryId,\n              fields: 'parents',\n            })\n          )\n          .then(response => {\n            if (!response.result.parents) {\n              resolve(null);\n            } else {\n              resolve(response.result.parents[0]);\n            }\n          })\n          .catch(reject);\n      }\n    });\n\n    const rootFolderIdPromise = new Promise((resolve, reject) => {\n      if (!!window.rootFolderId) {\n        resolve(window.rootFolderId);\n      } else {\n        getAPIClient()\n          .then(gapi =>\n            gapi.client.drive.files.get({\n              fileId: 'root',\n              fields: 'id',\n            })\n          )\n          .then(response => {\n            window.rootFolderId = response.result.id;\n            resolve(response.result.id);\n          })\n          .catch(reject);\n      }\n    });\n\n    return new Promise((resolve, reject) => {\n      Promise.all([fileListPromise, fileParentPromise, rootFolderIdPromise]).then(\n        ([listing, parentId, rootFolderId]) => {\n          const directoryParentId = parentId === rootFolderId ? '' : parentId;\n          listing.additionalSyncBackendState = listing.additionalSyncBackendState.set(\n            'parentId',\n            directoryParentId\n          );\n          resolve(listing);\n        }\n      );\n    });\n  };\n\n  const getDirectoryListing = directoryId =>\n    getFiles(directoryId.startsWith('/') ? directoryId.substr(1) : directoryId);\n\n  const getMoreDirectoryListing = additionalSyncBackendState => {\n    const directoryId = additionalSyncBackendState.get('currentDirectoryId');\n    const nextPageToken = additionalSyncBackendState.get('nextPageToken');\n    return getFiles(directoryId, nextPageToken);\n  };\n\n  const fileIdByNameAndParent = (name, parentId) =>\n    new Promise((resolve, reject) => {\n      getAPIClient()\n        .then(gapi =>\n          gapi.client.drive.files.list({\n            pageSize: 1,\n            fields: 'files(id)',\n            q: `'${parentId}' in parents and trashed = false and name = '${name}'`,\n          })\n        )\n        .then(response =>\n          resolve(response.result.files.length > 0 ? response.result.files[0].id : null)\n        )\n        .catch(reject);\n    });\n\n  const updateFile = (fileId, contents) => {\n    fileId = fileId.startsWith('/') ? fileId.substr(1) : fileId;\n\n    return getAPIClient().then(gapi => {\n      fetch(`https://www.googleapis.com/upload/drive/v3/files/${fileId}?uploadType=media`, {\n        method: 'PATCH',\n        headers: {\n          Authorization: `Bearer ${gapi.auth.getToken().access_token}`,\n        },\n        body: contents,\n      });\n    });\n  };\n\n  const createFile = (name, parentId, contents) => {\n    return new Promise((resolve, reject) => {\n      fileIdByNameAndParent(name, parentId)\n        .then(fileId =>\n          !!fileId\n            ? updateFile(fileId, contents).then(resolve).catch(reject)\n            : getAPIClient().then(gapi => {\n                gapi.client.drive.files\n                  .create({\n                    name,\n                    parents: parentId,\n                  })\n                  .then(response => updateFile(response.result.id, contents))\n                  .then(resolve)\n                  .catch(reject);\n              })\n        )\n        .catch(reject);\n    });\n  };\n\n  const duplicateFile = (fileId, fileNameCallback) => {\n    return new Promise((resolve, reject) => {\n      getAPIClient().then(gapi => {\n        gapi.client.drive.files\n          .get({\n            fileId,\n            fields: 'name, parents',\n          })\n          .then(getResponse => {\n            if (!getResponse.result.name) {\n              reject();\n            } else {\n              const newFileName = fileNameCallback(getResponse.result.name);\n              const parents = getResponse.result.parents[0];\n              fileIdByNameAndParent(newFileName, parents).then(backupFileId => {\n                const makeCopy = () => {\n                  gapi.client.drive.files\n                    .copy({\n                      fileId,\n                      parents,\n                      name: newFileName,\n                    })\n                    .then(copyResponse => {\n                      resolve();\n                    })\n                    .catch(reject);\n                };\n\n                if (!!backupFileId) {\n                  gapi.client.drive.files\n                    .delete({ fileId: backupFileId })\n                    .then(makeCopy)\n                    .catch(reject);\n                } else {\n                  makeCopy();\n                }\n              });\n            }\n          });\n      });\n    });\n  };\n\n  const getFileContentsAndMetadata = fileId =>\n    new Promise((resolve, reject) => {\n      getAPIClient().then(gapi => {\n        fileId = fileId.startsWith('/') ? fileId.substr(1) : fileId;\n\n        const fileContentsPromise = new Promise(resolve => {\n          gapi.client.drive.files\n            .get({\n              fileId,\n              alt: 'media',\n            })\n            .then(response => resolve(decodeURIComponent(escape(response.body))))\n            .catch(error => {\n              if (error.body && JSON.parse(error.body).error.errors[0].reason === 'notFound') {\n                reject();\n              }\n            });\n        });\n\n        const fileModifiedTimePromise = new Promise(resolve => {\n          gapi.client.drive.files\n            .get({\n              fileId,\n              fields: 'modifiedTime',\n            })\n            .then(response => {\n              resolve(response.result.modifiedTime);\n            })\n            .catch(error => {\n              if (error.body && JSON.parse(error.body).error.errors[0].reason === 'notFound') {\n                reject();\n              }\n            });\n        });\n\n        Promise.all([fileContentsPromise, fileModifiedTimePromise]).then(\n          ([contents, lastModifiedAt]) => {\n            resolve({\n              contents,\n              lastModifiedAt,\n            });\n          }\n        );\n      });\n    });\n\n  const getFileContents = fileId =>\n    new Promise((resolve, reject) =>\n      getFileContentsAndMetadata(fileId)\n        .then(({ contents }) => resolve(contents))\n        .catch(reject)\n    );\n\n  const getFileContentsByNameAndParent = (name, parentId) =>\n    new Promise((resolve, reject) =>\n      fileIdByNameAndParent(name, parentId).then(fileId => getFileContents(fileId).then(resolve))\n    );\n\n  const deleteFileByNameAndParent = (name, parentId) =>\n    new Promise((resolve, reject) => {\n      getAPIClient().then(gapi =>\n        gapi.client.drive.files\n          .list({\n            pageSize: 1,\n            fields: 'files(id)',\n            q: `'${parentId}' in parents and trashed = false and name = '${name}'`,\n          })\n          .then(listResponse => {\n            if (listResponse.result.files.length > 0) {\n              gapi.client.drive.files\n                .delete({\n                  fileId: listResponse.result.files[0].id,\n                })\n                .then(resolve)\n                .catch(reject);\n            } else {\n              resolve();\n            }\n          })\n      );\n    });\n\n  return {\n    type: 'Google Drive',\n    isSignedIn,\n    getDirectoryListing,\n    getMoreDirectoryListing,\n    updateFile,\n    createFile,\n    duplicateFile,\n    getFileContentsAndMetadata,\n    getFileContents,\n    getFileContentsByNameAndParent,\n    deleteFileByNameAndParent,\n  };\n};\n","import React from 'react';\n\nimport './stylesheet.css';\n\nconst PrivacyPolicy = () => {\n  return (\n    <div className=\"privacy-policy-container\">\n      <h1>Privacy Policy</h1>\n      <p>Last updated: April 15th, 2019</p>\n      <p>\n        We (\"us\" or \"our\") operate https://org-web.org (the \"Site\"). This page informs you of our\n        policies regarding the collection, use and disclosure of Personal Information we receive\n        from users of the Site.\n      </p>\n      <p>\n        We use your Personal Information only for providing and improving the Site. By using the\n        Site, you agree to the collection and use of information in accordance with this policy.\n      </p>\n      <h2>Information Collection And Use</h2>\n      <p>\n        While using our Site, we may ask you to provide us with certain personally identifiable\n        information that can be used to contact or identify you. Personally identifiable information\n        may include, but is not limited to your name (\"Personal Information\").\n      </p>\n      <h2>Log Data</h2>\n      <p>\n        Like many site operators, we collect information that your browser sends whenever you visit\n        our Site (\"Log Data\").\n      </p>\n      <p>\n        This Log Data may include information such as your computer's Internet Protocol (\"IP\")\n        address, browser type, browser version, the pages of our Site that you visit, the time and\n        date of your visit, the time spent on those pages and other statistics.\n      </p>\n      <p>\n        In addition, we may use third party services such as Google Analytics that collect, monitor\n        and analyze this data.\n      </p>\n      <h2>Cookies</h2>\n      <p>\n        Cookies are files with small amount of data, which may include an anonymous unique\n        identifier. Cookies are sent to your browser from a web site and stored on your computer's\n        hard drive.\n      </p>\n      <p>\n        Like many sites, we use \"cookies\" to collect information. You can instruct your browser to\n        refuse all cookies or to indicate when a cookie is being sent. However, if you do not accept\n        cookies, you may not be able to use some portions of our Site.\n      </p>\n      <h2>Security</h2>\n      <p>\n        The security of your Personal Information is important to us, but remember that no method of\n        transmission over the Internet, or method of electronic storage, is 100% secure. While we\n        strive to use commercially acceptable means to protect your Personal Information, we cannot\n        guarantee its absolute security.\n      </p>\n      <h2>Changes To This Privacy Policy</h2>\n      <p>\n        This Privacy Policy is effective as of April 15th, 2019 and will remain in effect except\n        with respect to any changes in its provisions in the future, which will be in effect\n        immediately after being posted on this page.\n      </p>\n      <p>\n        We reserve the right to update or change our Privacy Policy at any time and you should check\n        this Privacy Policy periodically. Your continued use of the Service after we post any\n        modifications to the Privacy Policy on this page will constitute your acknowledgment of the\n        modifications and your consent to abide and be bound by the modified Privacy Policy.\n      </p>\n      <p>\n        If we make any material changes to this Privacy Policy, we will notify you either through\n        the email address you have provided us, or by placing a prominent notice on our website.\n      </p>\n      <h2>Contact</h2>\n      <p>Us If you have any questions about this Privacy Policy, please contact us.</p>\n    </div>\n  );\n};\nexport default PrivacyPolicy;\n","import React, { PureComponent, Fragment } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport { Link, withRouter } from 'react-router-dom';\n\nimport logo from './org-web.svg';\n\nimport './stylesheet.css';\n\nimport * as baseActions from '../../actions/base';\nimport { ActionCreators as undoActions } from 'redux-linear-undo';\n\nimport { List } from 'immutable';\nimport _ from 'lodash';\nimport classNames from 'classnames';\n\nclass HeaderBar extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, [\n      'handleChangelogClick',\n      'handleSettingsClick',\n      'handleModalPageDoneClick',\n      'handleSettingsSubPageBackClick',\n      'handleUndoClick',\n      'handleHelpClick',\n    ]);\n  }\n\n  getPathRoot() {\n    const {\n      location: { pathname },\n    } = this.props;\n    return pathname.split('/')[1];\n  }\n\n  renderFileBrowserBackButton() {\n    const {\n      location: { pathname },\n      syncBackendType,\n    } = this.props;\n    if (syncBackendType === 'Google Drive') {\n      return <div />;\n    }\n\n    let directoryPath = pathname.substr('/files'.length);\n    if (directoryPath.endsWith('/')) {\n      directoryPath = directoryPath.substring(0, directoryPath.length - 1);\n    }\n\n    if (directoryPath === '') {\n      return <div />;\n    } else {\n      const pathParts = directoryPath.split('/');\n      const parentDirectoryName = pathParts[pathParts.length - 2];\n      const parentPath = pathParts.slice(0, pathParts.length - 1).join('/');\n\n      return (\n        <Link to={`/files${parentPath}`} className=\"header-bar__back-button\">\n          <i className=\"fas fa-chevron-left\" />\n          <span className=\"header-bar__back-button__directory-path\">{parentDirectoryName}/</span>\n        </Link>\n      );\n    }\n  }\n\n  renderOrgFileBackButton() {\n    const {\n      location: { pathname },\n    } = this.props;\n\n    let filePath = pathname.substr('/file'.length);\n    if (filePath.endsWith('/')) {\n      filePath = filePath.substring(0, filePath.length - 1);\n    }\n\n    const pathParts = filePath.split('/');\n    const directoryPath = pathParts.slice(0, pathParts.length - 1).join('/');\n\n    return (\n      <Link to={`/files${directoryPath}`} className=\"header-bar__back-button\">\n        <i className=\"fas fa-chevron-left\" />\n        <span className=\"header-bar__back-button__directory-path\">File browser</span>\n      </Link>\n    );\n  }\n\n  renderLogo() {\n    return (\n      <div className=\"header-bar__logo-container\">\n        <img className=\"header-bar__logo\" src={logo} alt=\"Logo\" width=\"30\" height=\"30\" />\n        <h2 className=\"header-bar__app-name\">org-web</h2>\n      </div>\n    );\n  }\n\n  renderSampleFileBackButton() {\n    return (\n      <Link to={`/`} className=\"header-bar__back-button\">\n        <i className=\"fas fa-chevron-left\" />\n        <span className=\"header-bar__back-button__directory-path\">Home</span>\n      </Link>\n    );\n  }\n\n  renderSignInBackButton() {\n    return (\n      <Link to={`/`} className=\"header-bar__back-button\">\n        <i className=\"fas fa-chevron-left\" />\n        <span className=\"header-bar__back-button__directory-path\">Home</span>\n      </Link>\n    );\n  }\n\n  handleSettingsSubPageBackClick() {\n    this.props.base.popModalPage();\n  }\n\n  renderSettingsSubPageBackButton() {\n    return (\n      <div className=\"header-bar__back-button\" onClick={this.handleSettingsSubPageBackClick}>\n        <i className=\"fas fa-chevron-left\" />\n        <span className=\"header-bar__back-button__directory-path\">Settings</span>\n      </div>\n    );\n  }\n\n  renderBackButton() {\n    const { activeModalPage } = this.props;\n\n    switch (activeModalPage) {\n      case 'changelog':\n        return this.renderSettingsSubPageBackButton();\n      case 'keyboard_shortcuts_editor':\n        return this.renderSettingsSubPageBackButton();\n      case 'capture_templates_editor':\n        return this.renderSettingsSubPageBackButton();\n      case 'sample':\n        return this.renderSettingsSubPageBackButton();\n      case 'settings':\n        return <div />;\n      default:\n    }\n\n    switch (this.getPathRoot()) {\n      case '':\n        return this.renderLogo();\n      case 'files':\n        return this.renderFileBrowserBackButton();\n      case 'file':\n        return this.renderOrgFileBackButton();\n      case 'sample':\n        return this.renderSampleFileBackButton();\n      case 'sign_in':\n        return this.renderSignInBackButton();\n      default:\n        return <div />;\n    }\n  }\n\n  renderTitle() {\n    const titleContainerWithText = text => <div className=\"header-bar__title\">{text}</div>;\n\n    switch (this.props.activeModalPage) {\n      case 'changelog':\n        return titleContainerWithText('Changelog');\n      case 'settings':\n        return titleContainerWithText('Settings');\n      case 'keyboard_shortcuts_editor':\n        return titleContainerWithText('Shortcuts');\n      case 'capture_templates_editor':\n        return titleContainerWithText('Capture');\n      case 'sample':\n        return titleContainerWithText('Sample');\n      default:\n    }\n\n    switch (this.getPathRoot()) {\n      case 'sample':\n        return titleContainerWithText('Sample');\n      case 'sign_in':\n        return titleContainerWithText('Sign in');\n      default:\n    }\n\n    return titleContainerWithText('');\n  }\n\n  handleChangelogClick() {\n    this.props.base.pushModalPage('changelog');\n  }\n\n  handleSettingsClick() {\n    this.props.base.pushModalPage('settings');\n  }\n\n  handleModalPageDoneClick() {\n    this.props.base.clearModalStack();\n  }\n\n  handleUndoClick() {\n    if (this.props.isUndoEnabled) {\n      this.props.undo.undo();\n    }\n  }\n\n  handleHelpClick() {\n    this.props.base.pushModalPage('settings');\n    this.props.base.pushModalPage('sample');\n  }\n\n  renderActions() {\n    const { isAuthenticated, hasUnseenChangelog, activeModalPage, path, isUndoEnabled } =\n      this.props;\n\n    if (!!activeModalPage) {\n      return (\n        <div className=\"header-bar__actions\" onClick={this.handleModalPageDoneClick}>\n          Done\n        </div>\n      );\n    } else {\n      const undoIconClassName = classNames('fas fa-undo header-bar__actions__item', {\n        'header-bar__actions__item--disabled': !isUndoEnabled,\n      });\n\n      const settingsIconClassName = classNames('fas fa-cogs header-bar__actions__item', {\n        'settings-icon--has-unseen-changelog': hasUnseenChangelog,\n      });\n\n      return (\n        <div className=\"header-bar__actions\">\n          {!isAuthenticated && this.getPathRoot() !== 'sign_in' && (\n            <Link to=\"/sign_in\">\n              <div className=\"header-bar__actions__item\" title=\"Sign in\">\n                Sign in\n              </div>\n            </Link>\n          )}\n\n          {!isAuthenticated && (\n            <a href=\"https://github.com/DanielDe/org-web\" target=\"_blank\" rel=\"noopener noreferrer\">\n              <i className=\"fab fa-github header-bar__actions__item\" />\n            </a>\n          )}\n\n          {isAuthenticated && !activeModalPage && !!path && (\n            <Fragment>\n              <i className={undoIconClassName} onClick={this.handleUndoClick} title=\"Undo\" />\n              <i\n                className=\"fas fa-question-circle header-bar__actions__item\"\n                onClick={this.handleHelpClick}\n                title=\"Help\"\n              />\n            </Fragment>\n          )}\n\n          {isAuthenticated && (\n            <i\n              className={settingsIconClassName}\n              onClick={this.handleSettingsClick}\n              title=\"Settings\"\n            />\n          )}\n        </div>\n      );\n    }\n  }\n\n  render() {\n    const className = classNames('header-bar', {\n      'header-bar--with-logo': this.getPathRoot() === '',\n    });\n\n    return (\n      <div className={className}>\n        {this.renderBackButton()}\n        {this.renderTitle()}\n        {this.renderActions()}\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = (state, props) => {\n  return {\n    isAuthenticated: state.syncBackend.get('isAuthenticated'),\n    hasUnseenChangelog: state.base.get('hasUnseenChangelog'),\n    activeModalPage: state.base.get('modalPageStack', List()).last(),\n    path: state.org.present.get('path'),\n    isUndoEnabled: state.org.past.length > 0,\n    syncBackendType: state.syncBackend.get('client') && state.syncBackend.get('client').type,\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    base: bindActionCreators(baseActions, dispatch),\n    undo: bindActionCreators(undoActions, dispatch),\n  };\n};\n\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(HeaderBar));\n","import React from 'react';\nimport { Link } from 'react-router-dom';\nimport preval from 'preval.macro';\n\nimport './stylesheet.css';\n\nexport default () => {\n  const buildTimestamp = preval`module.exports = new Date().toLocaleString();`;\n\n  return (\n    <div className=\"landing-container\">\n      <h1 className=\"landing-app-name\">org-web</h1>\n      <div>{`(built at ${buildTimestamp})`}</div>\n      <h2 className=\"landing-tagline\">Edit your org files online.</h2>\n      <h2 className=\"landing-tagline\">Optimized for mobile.</h2>\n      <h2 className=\"landing-tagline\">\n        Syncs with Dropbox\n        <br />\n        and Google Drive.\n      </h2>\n\n      <Link to=\"/sample\">\n        <div className=\"btn landing-button view-sample-button\">View sample</div>\n      </Link>\n      <Link to=\"/sign_in\">\n        <div className=\"btn landing-button\">Sign in</div>\n      </Link>\n\n      <div className=\"mailing-list-signup-container\">\n        Interested in getting updates about org-web? Sign up for the{' '}\n        <a href=\"http://eepurl.com/dK5F9w\" target=\"_blank\" rel=\"noopener noreferrer\">\n          mailing list\n        </a>{' '}\n        (Or check out some{' '}\n        <a\n          href=\"https://us19.campaign-archive.com/home/?u=36b9d8082ddb55e6cc7e22339&id=f427625e31\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n        >\n          past emails\n        </a>{' '}\n        before you sign up)\n      </div>\n    </div>\n  );\n};\n","import React, { useEffect } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport { Link } from 'react-router-dom';\n\nimport './stylesheet.css';\n\nimport classNames from 'classnames';\n\nimport * as syncBackendActions from '../../actions/sync_backend';\n\nconst FileBrowser = ({\n  path,\n  listing,\n  hasMore,\n  isLoadingMore,\n  syncBackendType,\n  syncBackend,\n  additionalSyncBackendState,\n}) => {\n  useEffect(() => syncBackend.getDirectoryListing(path), [path]);\n\n  const handleLoadMoreClick = () => syncBackend.loadMoreDirectoryListing();\n\n  const getParentDirectoryPath = () => {\n    switch (syncBackendType) {\n      case 'Dropbox':\n        const pathParts = path.split('/');\n        return pathParts.slice(0, pathParts.length - 1).join('/');\n      case 'Google Drive':\n        return !!additionalSyncBackendState.get('parentId')\n          ? '/' + additionalSyncBackendState.get('parentId')\n          : null;\n      default:\n        return null;\n    }\n  };\n\n  const isTopLevelDirectory = path === '';\n\n  return (\n    <div className=\"file-browser-container\">\n      {syncBackendType === 'Dropbox' && (\n        <h3 className=\"file-browser__header\">Directory: {isTopLevelDirectory ? '/' : path}</h3>\n      )}\n\n      <ul className=\"file-browser__file-list\">\n        {!isTopLevelDirectory && (\n          <Link to={`/files${getParentDirectoryPath()}`}>\n            <li className=\"file-browser__file-list__element\">\n              <i className=\"fas fa-folder file-browser__file-list__icon--directory\" /> ..\n            </li>\n          </Link>\n        )}\n\n        {(listing || []).map(file => {\n          const isDirectory = file.get('isDirectory');\n          const isBackupFile = file.get('name').endsWith('.org-web-bak');\n          const isOrgFile = file.get('name').endsWith('.org');\n          const isSettingsFile = file.get('name') === '.org-web-config.json';\n\n          const iconClass = classNames('file-browser__file-list__icon fas', {\n            'fa-folder': isDirectory,\n            'file-browser__file-list__icon--directory': isDirectory,\n            'fa-file': !isDirectory && !isBackupFile && !isSettingsFile,\n            'file-browser__file-list__icon--not-org': !isOrgFile,\n            'fa-copy': isBackupFile,\n            'fa-cogs': isSettingsFile,\n          });\n\n          if (file.get('isDirectory')) {\n            return (\n              <Link to={`/files${file.get('path')}`} key={file.get('id')}>\n                <li className=\"file-browser__file-list__element\">\n                  <i className={iconClass} /> {file.get('name')}/\n                </li>\n              </Link>\n            );\n          } else {\n            return (\n              <Link to={`/file${file.get('path')}`} key={file.get('id')}>\n                <li className=\"file-browser__file-list__element\">\n                  <i className={iconClass} /> {file.get('name')}\n                </li>\n              </Link>\n            );\n          }\n        })}\n\n        {hasMore &&\n          (isLoadingMore ? (\n            <li className=\"file-browser__file-list__loading-more-container\">\n              <i className=\"fas fa-spinner fa-lg fa-spin\" />\n            </li>\n          ) : (\n            <li\n              className=\"file-browser__file-list__element file-browser__file-list__element--load-more-row\"\n              onClick={handleLoadMoreClick}\n            >\n              Load more...\n            </li>\n          ))}\n      </ul>\n    </div>\n  );\n};\n\nconst mapStateToProps = (state, props) => {\n  const currentFileBrowserDirectoryListing = state.syncBackend.get(\n    'currentFileBrowserDirectoryListing'\n  );\n  return {\n    syncBackendType: state.syncBackend.get('client').type,\n    listing: !!currentFileBrowserDirectoryListing\n      ? currentFileBrowserDirectoryListing.get('listing')\n      : null,\n    hasMore:\n      !!currentFileBrowserDirectoryListing && currentFileBrowserDirectoryListing.get('hasMore'),\n    isLoadingMore:\n      !!currentFileBrowserDirectoryListing &&\n      currentFileBrowserDirectoryListing.get('isLoadingMore'),\n    additionalSyncBackendState:\n      !!currentFileBrowserDirectoryListing &&\n      currentFileBrowserDirectoryListing.get('additionalSyncBackendState'),\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    syncBackend: bindActionCreators(syncBackendActions, dispatch),\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(FileBrowser);\n","import React, { useState, useEffect } from 'react';\nimport { Motion, spring } from 'react-motion';\n\nimport './stylesheet.css';\n\nexport default ({ message }) => {\n  const [shouldRenderIndicator, setShouldRenderIndicator] = useState(true);\n  const [lastMessage, setLastMessage] = useState(message);\n\n  useEffect(() => {\n    if (!!message) {\n      setLastMessage(message);\n      setShouldRenderIndicator(true);\n    }\n  }, [message]);\n\n  const handleAnimationRest = () => {\n    if (!!message) {\n      return;\n    }\n\n    setShouldRenderIndicator(false);\n    setLastMessage(null);\n  };\n\n  const handleClick = () => setShouldRenderIndicator(false);\n\n  if (!shouldRenderIndicator) {\n    return null;\n  }\n\n  const style = {\n    opacity: spring(!!message ? 0.9 : 0, { stiffness: 300 }),\n  };\n\n  return (\n    <Motion style={style} onRest={handleAnimationRest}>\n      {style => (\n        <div className=\"loading-indicator\" style={style} onClick={handleClick}>\n          {lastMessage}\n        </div>\n      )}\n    </Motion>\n  );\n};\n","import React from 'react';\n\nimport './stylesheet.css';\n\nexport default ({\n  subPartDataAndHandlers: {\n    onEnterTableEditMode,\n    onAddNewTableRow,\n    onRemoveTableRow,\n    onAddNewTableColumn,\n    onRemoveTableColumn,\n  },\n}) => {\n  return (\n    <div className=\"table-action-drawer-container\">\n      <div className=\" table-action-drawer__edit-icon-container\" onClick={onEnterTableEditMode}>\n        <i className=\"fas fa-pencil-alt fa-lg\" />\n      </div>\n\n      <div className=\"table-action-drawer__sub-icon-container\" onClick={onAddNewTableRow}>\n        <i className=\"fas fa-plus fa-lg table-action-drawer__main-icon\" />\n        <i className=\"fas fa-columns fa-sm table-action-drawer__sub-icon table-action-drawer__sub-icon--rotated\" />\n      </div>\n\n      <div className=\"table-action-drawer__sub-icon-container\" onClick={onRemoveTableRow}>\n        <i className=\"fas fa-times fa-lg table-action-drawer__main-icon\" />\n        <i className=\"fas fa-columns fa-sm table-action-drawer__sub-icon table-action-drawer__sub-icon--rotated\" />\n      </div>\n\n      <div className=\"table-action-drawer__sub-icon-container\" onClick={onAddNewTableColumn}>\n        <i className=\"fas fa-plus fa-lg table-action-drawer__main-icon\" />\n        <i className=\"fas fa-columns fa-sm table-action-drawer__sub-icon\" />\n      </div>\n\n      <div className=\"table-action-drawer__sub-icon-container\" onClick={onRemoveTableColumn}>\n        <i className=\"fas fa-times fa-lg table-action-drawer__main-icon\" />\n        <i className=\"fas fa-columns fa-sm table-action-drawer__sub-icon\" />\n      </div>\n    </div>\n  );\n};\n","import React, { PureComponent, Fragment } from 'react';\nimport { UnmountClosed as Collapse } from 'react-collapse';\n\nimport './stylesheet.css';\n\nimport AttributedString from '../../../AttributedString';\nimport TableActionDrawer from './TableActionDrawer';\n\nimport { getCurrentTimestampAsText } from '../../../../../../lib/timestamps';\n\nimport _ from 'lodash';\nimport classNames from 'classnames';\nimport { Map } from 'immutable';\n\nexport default class TablePart extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, [\n      'handleCellSelect',\n      'handleTextareaBlur',\n      'handleCellChange',\n      'handleInsertTimestamp',\n      'handleTextareaRef',\n    ]);\n\n    this.state = {\n      rawCellValues: this.generateCellValueMap(props.table),\n      shouldIgnoreBlur: false,\n    };\n  }\n\n  componentDidUpdate(prevProps) {\n    const {\n      subPartDataAndHandlers: { onTableCellValueUpdate, selectedTableCellId, inTableEditMode },\n    } = this.props;\n    const { rawCellValues } = this.state;\n\n    if (prevProps.subPartDataAndHandlers.inTableEditMode && !inTableEditMode) {\n      if (rawCellValues.has(selectedTableCellId)) {\n        onTableCellValueUpdate(selectedTableCellId, rawCellValues.get(selectedTableCellId));\n      }\n    }\n\n    if (this.props.table !== prevProps.table) {\n      this.setState({ rawCellValues: this.generateCellValueMap(this.props.table) });\n    }\n  }\n\n  generateCellValueMap(table) {\n    return Map(\n      table\n        .get('contents')\n        .map(row => row.get('contents').map(cell => [cell.get('id'), cell.get('rawContents')]))\n        .flatten()\n    );\n  }\n\n  handleCellSelect(cellId) {\n    return () => this.props.subPartDataAndHandlers.onTableCellSelect(cellId);\n  }\n\n  handleTextareaBlur() {\n    setTimeout(() => {\n      if (!this.state.shouldIgnoreBlur) {\n        this.props.subPartDataAndHandlers.onExitTableEditMode();\n      } else {\n        this.setState({ shouldIgnoreBlur: false });\n      }\n    }, 0);\n  }\n\n  handleCellChange(event) {\n    const { rawCellValues } = this.state;\n    const {\n      subPartDataAndHandlers: { selectedTableCellId },\n    } = this.props;\n\n    this.setState({\n      rawCellValues: rawCellValues.set(selectedTableCellId, event.target.value),\n    });\n  }\n\n  handleInsertTimestamp() {\n    // Clicking this button will unfocus the textarea, but we don't want to exit edit mode,\n    // so instruct the blur handler to ignore the event.\n    this.setState({ shouldIgnoreBlur: true });\n\n    const { rawCellValues } = this.state;\n    const {\n      subPartDataAndHandlers: { selectedTableCellId },\n    } = this.props;\n    const cellValue = rawCellValues.get(selectedTableCellId);\n\n    const insertionIndex = this.textarea.selectionStart;\n    this.setState({\n      rawCellValues: rawCellValues.set(\n        selectedTableCellId,\n        cellValue.substring(0, insertionIndex) +\n          getCurrentTimestampAsText() +\n          cellValue.substring(this.textarea.selectionEnd || insertionIndex)\n      ),\n    });\n\n    this.textarea.focus();\n  }\n\n  handleTextareaRef(textarea) {\n    this.textarea = textarea;\n  }\n\n  render() {\n    const {\n      table,\n      subPartDataAndHandlers: { selectedTableCellId, inTableEditMode, shouldDisableActions },\n    } = this.props;\n    const { rawCellValues } = this.state;\n\n    const isTableSelected = table\n      .get('contents')\n      .some(row => row.get('contents').some(cell => cell.get('id') === selectedTableCellId));\n\n    return (\n      <Fragment>\n        <table className=\"table-part\">\n          <tbody>\n            {table.get('contents').map(row => (\n              <tr key={row.get('id')}>\n                {row.get('contents').map(cell => {\n                  const isCellSelected = cell.get('id') === selectedTableCellId;\n\n                  const className = classNames('table-part__cell', {\n                    'table-part__cell--selected': isCellSelected,\n                  });\n\n                  return (\n                    <td\n                      className={className}\n                      key={cell.get('id')}\n                      onClick={this.handleCellSelect(cell.get('id'))}\n                    >\n                      {isCellSelected && inTableEditMode ? (\n                        <div className=\"table-cell__edit-container\">\n                          <textarea\n                            autoFocus\n                            className=\"textarea\"\n                            rows=\"3\"\n                            value={rawCellValues.get(cell.get('id'))}\n                            onBlur={this.handleTextareaBlur}\n                            onChange={this.handleCellChange}\n                            ref={this.handleTextareaRef}\n                          />\n                          <div\n                            className=\"table-cell__insert-timestamp-button\"\n                            onClick={this.handleInsertTimestamp}\n                          >\n                            <i className=\"fas fa-plus insert-timestamp-icon\" />\n                            Insert timestamp\n                          </div>\n                        </div>\n                      ) : cell.get('contents').size > 0 ? (\n                        <AttributedString\n                          parts={cell.get('contents')}\n                          subPartDataAndHandlers={this.props.subPartDataAndHandlers}\n                        />\n                      ) : (\n                        '   '\n                      )}\n                    </td>\n                  );\n                })}\n              </tr>\n            ))}\n          </tbody>\n        </table>\n\n        <Collapse isOpened={isTableSelected && !shouldDisableActions}>\n          <TableActionDrawer subPartDataAndHandlers={this.props.subPartDataAndHandlers} />\n        </Collapse>\n      </Fragment>\n    );\n  }\n}\n","// Interpolates between two colors.\n// colorA and colorB should be objects with keys {r, g, b, a}.\n// interpolationFactor should be a number between 0 and 1 representing how far from colorA to\n// colorB it should interpolate.\n// An object with keys {r, g, b, a} will be returned.\nexport const interpolateColors = (colorA, colorB, interpolationFactor) => {\n  return {\n    r: parseInt((colorB.r - colorA.r) * interpolationFactor + colorA.r, 10),\n    g: parseInt((colorB.g - colorA.g) * interpolationFactor + colorA.g, 10),\n    b: parseInt((colorB.b - colorA.b) * interpolationFactor + colorA.b, 10),\n    a: (colorB.a - colorA.a) * interpolationFactor + colorA.a,\n  };\n};\n\nexport const rgbaObject = (r, g, b, a) => {\n  return { r, g, b, a };\n};\n\nexport const rgbaString = rgba => {\n  return `rgba(${rgba.r}, ${rgba.g}, ${rgba.b}, ${rgba.a})`;\n};\n","import React from 'react';\nimport { Motion, spring } from 'react-motion';\n\nimport { interpolateColors, rgbaObject, rgbaString } from '../../../lib/color';\n\nimport './stylesheet.css';\n\nexport default ({ state, onClick }) => {\n  const uncheckedColor = rgbaObject(255, 255, 255, 1);\n  const checkedColor = rgbaObject(94, 52, 140, 1);\n\n  const checkboxStyle = {\n    colorFactor: spring(\n      {\n        checked: 1,\n        partial: 1,\n        unchecked: 0,\n      }[state],\n      { stiffness: 300 }\n    ),\n  };\n\n  return (\n    <Motion style={checkboxStyle}>\n      {style => {\n        const backgroundColor = rgbaString(\n          interpolateColors(uncheckedColor, checkedColor, style.colorFactor)\n        );\n\n        return (\n          <div className=\"checkbox\" onClick={onClick} style={{ backgroundColor }}>\n            <div className=\"checkbox__inner-container\">\n              {state === 'checked' && <i className=\"fas fa-check\" />}\n              {state === 'partial' && <i className=\"fas fa-minus\" />}\n              {state === 'unchecked' && <i className=\"fas fa-square\" />}\n            </div>\n          </div>\n        );\n      }}\n    </Motion>\n  );\n};\n","import React from 'react';\n\nimport './stylesheet.css';\n\nexport default ({\n  subPartDataAndHandlers: {\n    onEnterListTitleEditMode,\n    onEnterListContentsEditMode,\n    onAddNewListItem,\n    onRemoveListItem,\n  },\n}) => {\n  return (\n    <div className=\"list-action-drawer-container\">\n      <div className=\"list-action-drawer__row\">\n        <div className=\"list-action-drawer__edit-icon-container\" onClick={onEnterListTitleEditMode}>\n          <i className=\"fas fa-pencil-alt fa-lg\" />\n        </div>\n\n        <span className=\"list-action-drawer__separator\" />\n\n        <div\n          className=\"list-action-drawer__edit-icon-container\"\n          onClick={onEnterListContentsEditMode}\n        >\n          <i className=\"fas fa-edit fa-lg\" />\n        </div>\n\n        <span className=\"list-action-drawer__separator\" />\n\n        <div className=\"list-action-drawer__edit-icon-container\" onClick={onAddNewListItem}>\n          <i className=\"fas fa-plus fa-lg\" />\n        </div>\n\n        <span className=\"list-action-drawer__separator\" />\n\n        <div className=\"list-action-drawer__edit-icon-container\" onClick={onRemoveListItem}>\n          <i className=\"fas fa-times fa-lg\" />\n        </div>\n      </div>\n    </div>\n  );\n};\n","import React, { PureComponent, Fragment } from 'react';\nimport { UnmountClosed as Collapse } from 'react-collapse';\n\nimport './stylesheet.css';\n\nimport AttributedString from '../../../AttributedString/';\nimport Checkbox from '../../../../../UI/Checkbox/';\nimport ListActionDrawer from './ListActionDrawer';\nimport { attributedStringToRawText } from '../../../../../../lib/export_org';\n\nimport { getCurrentTimestampAsText } from '../../../../../../lib/timestamps';\n\nimport _ from 'lodash';\nimport classNames from 'classnames';\nimport { Map } from 'immutable';\n\nexport default class ListPart extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, [\n      'handleListItemSelect',\n      'handleCheckboxClick',\n      'handleTextareaBlur',\n      'handleListTitleChange',\n      'handleListContentsChange',\n      'handleInsertTimestampListTitle',\n      'handleInsertTimestampListContents',\n      'handleTextareaRef',\n    ]);\n\n    this.state = {\n      listTitleValues: this.generateListTitleValueMap(props.part),\n      listContentsValues: this.generateListContentsValueMap(props.part),\n      shouldIgnoreBlur: false,\n    };\n  }\n\n  componentDidUpdate(prevProps) {\n    const {\n      subPartDataAndHandlers: {\n        onListTitleValueUpdate,\n        onListContentsValueUpdate,\n        inListTitleEditMode,\n        inListContentsEditMode,\n        selectedListItemId,\n      },\n    } = this.props;\n    const { listTitleValues, listContentsValues } = this.state;\n\n    if (prevProps.subPartDataAndHandlers.inListTitleEditMode && !inListTitleEditMode) {\n      if (listTitleValues.has(selectedListItemId)) {\n        onListTitleValueUpdate(selectedListItemId, listTitleValues.get(selectedListItemId));\n      }\n    }\n\n    const prevSelectedListItemId = prevProps.subPartDataAndHandlers.selectedListItemId;\n    if (\n      prevSelectedListItemId !== selectedListItemId &&\n      inListTitleEditMode &&\n      prevProps.subPartDataAndHandlers.inListTitleEditMode\n    ) {\n      if (listTitleValues.has(prevSelectedListItemId)) {\n        onListTitleValueUpdate(prevSelectedListItemId, listTitleValues.get(prevSelectedListItemId));\n      }\n    }\n\n    if (prevProps.subPartDataAndHandlers.inListContentsEditMode && !inListContentsEditMode) {\n      if (listContentsValues.has(selectedListItemId)) {\n        onListContentsValueUpdate(selectedListItemId, listContentsValues.get(selectedListItemId));\n      }\n    }\n\n    if (\n      prevSelectedListItemId !== selectedListItemId &&\n      inListContentsEditMode &&\n      prevProps.subPartDataAndHandlers.inListContentsEditMode\n    ) {\n      if (listContentsValues.has(prevSelectedListItemId)) {\n        onListContentsValueUpdate(\n          prevSelectedListItemId,\n          listContentsValues.get(prevSelectedListItemId)\n        );\n      }\n    }\n\n    if (this.props.part !== prevProps.part) {\n      this.setState({ listTitleValues: this.generateListTitleValueMap(this.props.part) });\n      this.setState({ listContentsValues: this.generateListContentsValueMap(this.props.part) });\n    }\n  }\n\n  generateListTitleValueMap(part) {\n    return Map(\n      part\n        .get('items')\n        .map(item => [item.get('id'), attributedStringToRawText(item.get('titleLine'))])\n    );\n  }\n\n  generateListContentsValueMap(part) {\n    return Map(\n      part\n        .get('items')\n        .map(item => [item.get('id'), attributedStringToRawText(item.get('contents'))])\n    );\n  }\n\n  handleListItemSelect(itemId) {\n    return () => this.props.subPartDataAndHandlers.onListItemSelect(itemId);\n  }\n\n  handleCheckboxClick(itemId) {\n    return () => this.props.subPartDataAndHandlers.onCheckboxClick(itemId);\n  }\n\n  handleTextareaBlur() {\n    setTimeout(() => {\n      if (!this.state.shouldIgnoreBlur) {\n        this.props.subPartDataAndHandlers.onExitListTitleEditMode();\n      } else {\n        this.setState({ shouldIgnoreBlur: false });\n      }\n    }, 0);\n  }\n\n  handleListTitleChange(event) {\n    const { listTitleValues } = this.state;\n    const {\n      subPartDataAndHandlers: { selectedListItemId },\n    } = this.props;\n\n    this.setState({\n      listTitleValues: listTitleValues.set(selectedListItemId, event.target.value),\n    });\n  }\n\n  handleListContentsChange(event) {\n    const { listContentsValues } = this.state;\n    const {\n      subPartDataAndHandlers: { selectedListItemId },\n    } = this.props;\n\n    this.setState({\n      listContentsValues: listContentsValues.set(selectedListItemId, event.target.value),\n    });\n  }\n\n  handleInsertTimestampListTitle() {\n    // Clicking this button will unfocus the textarea, but we don't want to exit edit mode,\n    // so instruct the blur handler to ignore the event.\n    this.setState({ shouldIgnoreBlur: true });\n\n    const { listTitleValues } = this.state;\n    const {\n      subPartDataAndHandlers: { selectedListItemId },\n    } = this.props;\n    const listTitleValue = listTitleValues.get(selectedListItemId);\n\n    const insertionIndex = this.textarea.selectionStart;\n    this.setState({\n      listTitleValues: listTitleValues.set(\n        selectedListItemId,\n        listTitleValue.substring(0, insertionIndex) +\n          getCurrentTimestampAsText() +\n          listTitleValue.substring(this.textarea.selectionEnd || insertionIndex)\n      ),\n    });\n\n    this.textarea.focus();\n  }\n\n  handleInsertTimestampListContents() {\n    this.setState({ shouldIgnoreBlur: true });\n\n    const { listContentsValues } = this.state;\n    const {\n      subPartDataAndHandlers: { selectedListItemId },\n    } = this.props;\n    const listContentsValue = listContentsValues.get(selectedListItemId);\n\n    const insertionIndex = this.textarea.selectionStart;\n    this.setState({\n      listContentsValues: listContentsValues.set(\n        selectedListItemId,\n        listContentsValue.substring(0, insertionIndex) +\n          getCurrentTimestampAsText() +\n          listContentsValue.substring(this.textarea.selectionEnd || insertionIndex)\n      ),\n    });\n\n    this.textarea.focus();\n  }\n  handleTextareaRef(textarea) {\n    this.textarea = textarea;\n  }\n\n  renderContent() {\n    const {\n      part,\n      subPartDataAndHandlers: {\n        selectedListItemId,\n        inListTitleEditMode,\n        inListContentsEditMode,\n        shouldDisableActions,\n      },\n    } = this.props;\n    const { listTitleValues, listContentsValues } = this.state;\n\n    return part.get('items').map(item => {\n      const isItemSelected = item.get('id') === selectedListItemId;\n      const lineContainerClass = classNames({\n        'list-part__not_checkbox-container': !item.get('isCheckbox'),\n        'list-part__checkbox-container': item.get('isCheckbox'),\n        'list-part__item--selected': isItemSelected,\n      });\n\n      return (\n        <li key={item.get('id')} value={item.get('forceNumber')}>\n          <div className={lineContainerClass} onClick={this.handleListItemSelect(item.get('id'))}>\n            {item.get('isCheckbox') && (\n              <Checkbox\n                onClick={this.handleCheckboxClick(item.get('id'))}\n                state={item.get('checkboxState')}\n              />\n            )}\n            {isItemSelected && inListTitleEditMode ? (\n              <div className=\"list-title-line__edit-container\">\n                <textarea\n                  autoFocus\n                  className=\"textarea\"\n                  rows=\"3\"\n                  ref={this.handleTextareaRef}\n                  value={listTitleValues.get(item.get('id'))}\n                  onBlur={this.handleTextareaBlur}\n                  onChange={this.handleListTitleChange}\n                />\n                <div\n                  className=\"list-title-line__insert-timestamp-button\"\n                  onClick={this.handleInsertTimestampListTitle}\n                >\n                  <i className=\"fas fa-plus insert-timestamp-icon\" />\n                  Insert timestamp\n                </div>\n              </div>\n            ) : listTitleValues.get(item.get('id')) ? (\n              <AttributedString\n                parts={item.get('titleLine')}\n                subPartDataAndHandlers={this.props.subPartDataAndHandlers}\n              />\n            ) : (\n              <span>&nbsp;</span>\n            )}\n          </div>\n          <Collapse isOpened={isItemSelected && !shouldDisableActions}>\n            <ListActionDrawer subPartDataAndHandlers={this.props.subPartDataAndHandlers} />\n          </Collapse>\n          {isItemSelected && inListContentsEditMode ? (\n            <div className=\"list-contents__edit-container\">\n              <textarea\n                autoFocus\n                className=\"textarea\"\n                rows=\"8\"\n                ref={this.handleTextareaRef}\n                value={listContentsValues.get(item.get('id'))}\n                onBlur={this.handleTextareaBlur}\n                onChange={this.handleListContentsChange}\n              />\n              <div\n                className=\"list-contents__insert-timestamp-button\"\n                onClick={this.handleInsertTimestampListContents}\n              >\n                <i className=\"fas fa-plus insert-timestamp-icon\" />\n                Insert timestamp\n              </div>\n            </div>\n          ) : (\n            <AttributedString\n              parts={item.get('contents')}\n              subPartDataAndHandlers={this.props.subPartDataAndHandlers}\n            />\n          )}\n        </li>\n      );\n    });\n  }\n\n  render() {\n    return (\n      <Fragment>\n        {this.props.part.get('isOrdered') ? (\n          <ol className=\"attributed-string__list-part attributed-string__list-part--ordered\">\n            {this.renderContent()}\n          </ol>\n        ) : (\n          <ul className=\"attributed-string__list-part\">{this.renderContent()}</ul>\n        )}\n      </Fragment>\n    );\n  }\n}\n","import React, { Fragment } from 'react';\n\nimport './stylesheet.css';\n\nimport { renderAsText } from '../../../../../../lib/timestamps';\n\nexport default ({ part, subPartDataAndHandlers: { onTimestampClick, shouldDisableActions } }) => {\n  const handleClick = () => (shouldDisableActions ? void 0 : onTimestampClick(part.get('id')));\n\n  const firstTimestamp = part.get('firstTimestamp');\n  const secondTimestamp = part.get('secondTimestamp');\n\n  return (\n    <span className=\"attributed-string__timestamp-part\" onClick={handleClick}>\n      {!!firstTimestamp && renderAsText(firstTimestamp)}\n      {!!secondTimestamp && (\n        <Fragment>\n          {'--'}\n          {renderAsText(secondTimestamp)}\n        </Fragment>\n      )}\n    </span>\n  );\n};\n","import React from 'react';\n\nimport './stylesheet.css';\n\nimport TablePart from './components/TablePart';\nimport ListPart from './components/ListPart';\nimport TimestampPart from './components/TimestampPart';\n\nimport classNames from 'classnames';\n\nexport default ({ parts, subPartDataAndHandlers }) => {\n  let className;\n\n  return (\n    <span>\n      {parts.map(part => {\n        switch (part.get('type')) {\n          case 'text':\n            return part.get('contents');\n          case 'link':\n            const uri = part.getIn(['contents', 'uri']);\n            const title = part.getIn(['contents', 'title']) || uri;\n\n            return (\n              <a key={part.get('id')} href={uri} target=\"_blank\" rel=\"noopener noreferrer\">\n                {title}\n              </a>\n            );\n          case 'percentage-cookie':\n            className = classNames('attributed-string__cookie-part', {\n              'attributed-string__cookie-part--complete':\n                parseInt(part.get('percentage'), 10) === 100,\n            });\n\n            return (\n              <span key={part.get('id')} className={className}>\n                [{part.get('percentage')}\n                %]\n              </span>\n            );\n          case 'fraction-cookie':\n            className = classNames('attributed-string__cookie-part', {\n              'attributed-string__cookie-part--complete':\n                part.getIn(['fraction', 0]) !== '' &&\n                part.getIn(['fraction', 0]) === part.getIn(['fraction', 1]),\n            });\n\n            return (\n              <span key={part.get('id')} className={className}>\n                [{part.getIn(['fraction', 0])}/{part.getIn(['fraction', 1])}]\n              </span>\n            );\n          case 'table':\n            return (\n              <TablePart\n                key={part.get('id')}\n                table={part}\n                subPartDataAndHandlers={subPartDataAndHandlers}\n              />\n            );\n          case 'list':\n            return (\n              <ListPart\n                key={part.get('id')}\n                part={part}\n                subPartDataAndHandlers={subPartDataAndHandlers}\n              />\n            );\n          case 'inline-markup':\n            className = classNames(\n              'attributed-string__inline-markup',\n              `attributed-string__inline-markup--${part.get('markupType')}`\n            );\n\n            return (\n              <span key={part.get('id')} className={className}>\n                {part.get('content')}\n              </span>\n            );\n          case 'timestamp':\n            return (\n              <TimestampPart\n                key={part.get('id')}\n                part={part}\n                subPartDataAndHandlers={subPartDataAndHandlers}\n              />\n            );\n          default:\n            console.error(`Unrecognized attributed string part type! ${part.get('type')}`);\n            return '';\n        }\n      })}\n    </span>\n  );\n};\n","import React, { PureComponent } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport './stylesheet.css';\n\nimport _ from 'lodash';\nimport classNames from 'classnames';\n\nimport * as orgActions from '../../../../actions/org';\nimport * as baseActions from '../../../../actions/base';\n\nimport { getCurrentTimestampAsText } from '../../../../lib/timestamps';\n\nimport AttributedString from '../AttributedString';\n\nclass TitleLine extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, [\n      'handleRef',\n      'handleTitleSpanRef',\n      'handleTextareaRef',\n      'handleTitleClick',\n      'handleTextareaBlur',\n      'handleTitleChange',\n      'handleTitleFieldClick',\n      'handleTodoClick',\n      'handleTimestampClick',\n      'handleInsertTimestamp',\n    ]);\n\n    this.state = {\n      titleValue: this.calculateRawTitle(props.header),\n      containerWidth: null,\n      shouldIgnoreBlur: false,\n    };\n  }\n\n  storeContainerWidth() {\n    if (this.containerDiv) {\n      this.setState({ containerWidth: this.containerDiv.offsetWidth });\n    }\n  }\n\n  componentDidMount() {\n    this.storeContainerWidth();\n  }\n\n  componentDidUpdate(prevProps) {\n    const { header } = this.props;\n\n    if (prevProps.inEditMode && !this.props.inEditMode) {\n      this.props.org.updateHeaderTitle(header.get('id'), this.state.titleValue);\n    }\n\n    if (prevProps.header !== this.props.header) {\n      this.setState(\n        {\n          titleValue: this.calculateRawTitle(this.props.header),\n        },\n        () => this.storeContainerWidth()\n      );\n    }\n  }\n\n  handleRef(div) {\n    this.containerDiv = div;\n  }\n\n  handleTitleSpanRef(span) {\n    this.titleSpan = span;\n  }\n\n  handleTextareaRef(textarea) {\n    this.textarea = textarea;\n  }\n\n  calculateRawTitle(header) {\n    const todoKeyword = header.getIn(['titleLine', 'todoKeyword']);\n    const tags = header.getIn(['titleLine', 'tags']);\n\n    let titleValue = header.getIn(['titleLine', 'rawTitle']);\n\n    if (!!todoKeyword) {\n      titleValue = `${todoKeyword} ${titleValue}`;\n    }\n\n    if (!!tags && tags.size > 0) {\n      titleValue = `${titleValue} :${tags.join(':')}:`;\n    }\n\n    return titleValue;\n  }\n\n  handleTitleClick(event) {\n    const { header, hasContent, isSelected, onClick } = this.props;\n\n    if (!!onClick) {\n      onClick();\n    } else {\n      if (hasContent && (!header.get('opened') || isSelected)) {\n        this.props.org.toggleHeaderOpened(header.get('id'));\n      }\n\n      this.props.org.selectHeader(header.get('id'));\n    }\n  }\n\n  handleTodoClick(event) {\n    const { header, shouldTapTodoToAdvance, onClick } = this.props;\n\n    if (!!onClick) {\n      onClick();\n      event.stopPropagation();\n    } else {\n      this.props.org.selectHeader(header.get('id'));\n\n      if (shouldTapTodoToAdvance) {\n        this.props.org.advanceTodoState();\n      }\n    }\n  }\n\n  handleTextareaBlur(event) {\n    // Give the \"Insert timestamp\" button click a chance to tell us to ignore the blur event.\n    setTimeout(() => {\n      if (!this.state.shouldIgnoreBlur) {\n        this.props.org.exitEditMode();\n      } else {\n        this.setState({ shouldIgnoreBlur: false });\n      }\n    }, 100);\n  }\n\n  handleTitleChange(event) {\n    // If the last character typed was a newline at the end, exit edit mode.\n    const newTitle = event.target.value;\n    const lastCharacter = newTitle[newTitle.length - 1];\n    if (\n      this.state.titleValue === newTitle.substring(0, newTitle.length - 1) &&\n      lastCharacter === '\\n'\n    ) {\n      this.props.org.exitEditMode();\n      return;\n    }\n\n    this.setState({ titleValue: newTitle });\n  }\n\n  handleTitleFieldClick(event) {\n    event.stopPropagation();\n  }\n\n  handleTimestampClick(timestampId) {\n    this.props.base.activatePopup('timestamp-editor', { timestampId });\n  }\n\n  handleInsertTimestamp(event) {\n    // Clicking this button will unfocus the textarea, but we don't want to exit edit mode,\n    // so instruct the blur handler to ignore the event.\n    this.setState({ shouldIgnoreBlur: true });\n\n    const { titleValue } = this.state;\n    const insertionIndex = this.textarea.selectionStart;\n    this.setState({\n      titleValue:\n        titleValue.substring(0, insertionIndex) +\n        getCurrentTimestampAsText() +\n        titleValue.substring(this.textarea.selectionEnd || insertionIndex),\n    });\n\n    this.textarea.focus();\n\n    event.stopPropagation();\n  }\n\n  render() {\n    const {\n      header,\n      color,\n      hasContent,\n      inEditMode,\n      shouldDisableActions,\n      shouldDisableExplicitWidth,\n    } = this.props;\n    const { containerWidth } = this.state;\n    const todoKeyword = header.getIn(['titleLine', 'todoKeyword']);\n\n    const titleStyle = {\n      color,\n      wordBreak: 'break-word',\n    };\n\n    return (\n      <div\n        className=\"title-line\"\n        onClick={this.handleTitleClick}\n        ref={this.handleRef}\n        style={{ width: shouldDisableExplicitWidth ? '' : containerWidth }}\n      >\n        {!inEditMode && !!todoKeyword ? (\n          <span\n            className={classNames('todo-keyword', `todo-keyword--${todoKeyword.toLowerCase()}`)}\n            onClick={this.handleTodoClick}\n          >\n            {todoKeyword}\n          </span>\n        ) : (\n          ''\n        )}\n\n        {inEditMode ? (\n          <div className=\"title-line__edit-container\">\n            <textarea\n              autoFocus\n              className=\"textarea\"\n              rows=\"3\"\n              ref={this.handleTextareaRef}\n              value={this.state.titleValue}\n              onBlur={this.handleTextareaBlur}\n              onChange={this.handleTitleChange}\n              onClick={this.handleTitleFieldClick}\n            />\n            <div\n              className=\"title-line__insert-timestamp-button\"\n              onClick={this.handleInsertTimestamp}\n            >\n              <i className=\"fas fa-plus insert-timestamp-icon\" />\n              Insert timestamp\n            </div>\n          </div>\n        ) : (\n          <div>\n            <span style={titleStyle} ref={this.handleTitleSpanRef}>\n              <AttributedString\n                parts={header.getIn(['titleLine', 'title'])}\n                subPartDataAndHandlers={{\n                  onTimestampClick: this.handleTimestampClick,\n                  shouldDisableActions,\n                }}\n              />\n              {!header.get('opened') && hasContent ? '...' : ''}\n            </span>\n\n            {header.getIn(['titleLine', 'tags']).size > 0 && (\n              <div>\n                {header\n                  .getIn(['titleLine', 'tags'])\n                  .toSet()\n                  .toList()\n                  .filter(tag => !!tag)\n                  .map(tag => (\n                    <div className=\"header-tag\" key={tag}>\n                      {tag}\n                    </div>\n                  ))}\n              </div>\n            )}\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = (state, props) => {\n  return {\n    inEditMode:\n      state.org.present.get('editMode') === 'title' &&\n      state.org.present.get('selectedHeaderId') === props.header.get('id'),\n    shouldTapTodoToAdvance: state.base.get('shouldTapTodoToAdvance'),\n    isSelected: state.org.present.get('selectedHeaderId') === props.header.get('id'),\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    org: bindActionCreators(orgActions, dispatch),\n    base: bindActionCreators(baseActions, dispatch),\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(TitleLine);\n","import React, { PureComponent } from 'react';\n\nimport './stylesheet.css';\n\nimport { renderAsText } from '../../../../../../lib/timestamps';\n\nimport _ from 'lodash';\n\nexport default class PlanningItems extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, ['handleTimestampClick']);\n  }\n\n  handleTimestampClick(planningItemIndex) {\n    return () => this.props.onClick(planningItemIndex);\n  }\n\n  render() {\n    const { planningItems } = this.props;\n\n    if (planningItems.size === 0) {\n      return null;\n    }\n\n    return (\n      <div>\n        {planningItems.map((planningItem, index) => (\n          <div key={planningItem.get('id')} className=\"planning-items__item-container\">\n            <div className=\"planning-item__type\">{planningItem.get('type')}: </div>\n            <div className=\"planning-item__timestamp\" onClick={this.handleTimestampClick(index)}>\n              {renderAsText(planningItem.get('timestamp'))}\n            </div>\n          </div>\n        ))}\n      </div>\n    );\n  }\n}\n","import React, { Fragment, useState } from 'react';\n\nimport './stylesheet.css';\n\nimport AttributedString from '../../../AttributedString';\n\nexport default ({ propertyListItems, shouldDisableActions, onTimestampClick, onEdit }) => {\n  const [isDrawerCollapsed, setIsDrawerCollapsed] = useState(true);\n\n  const handleCollapseToggle = () => setIsDrawerCollapsed(!isDrawerCollapsed);\n\n  return propertyListItems.size === 0 ? null : (\n    <div className=\"property-list-container\">\n      <div className=\"property-list__property\" onClick={handleCollapseToggle}>\n        :PROPERTIES:\n        {isDrawerCollapsed ? '...' : ''}\n      </div>\n\n      {!isDrawerCollapsed && (\n        <Fragment>\n          {propertyListItems.map(propertyListItem => (\n            <div className=\"property-list__item-container\" key={propertyListItem.get('id')}>\n              <div\n                className=\"property-list__property\"\n                onClick={shouldDisableActions ? null : onEdit}\n              >\n                :{propertyListItem.get('property')}:\n              </div>\n              <div className=\"property-list__value\">\n                <AttributedString\n                  parts={propertyListItem.get('value') || []}\n                  subPartDataAndHandlers={{\n                    onTimestampClick,\n                    shouldDisableActions,\n                  }}\n                />\n              </div>\n            </div>\n          ))}\n\n          <div className=\"property-list__property\" onClick={onEdit}>\n            :END:\n          </div>\n        </Fragment>\n      )}\n    </div>\n  );\n};\n","import React, { PureComponent, Fragment } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport './stylesheet.css';\n\nimport PlanningItems from './components/PlanningItems';\nimport PropertyListItems from './components/PropertyListItems';\n\nimport _ from 'lodash';\n\nimport * as orgActions from '../../../../actions/org';\nimport * as baseActions from '../../../../actions/base';\n\nimport { renderAsText, getCurrentTimestampAsText } from '../../../../lib/timestamps';\nimport { attributedStringToRawText } from '../../../../lib/export_org';\n\nimport AttributedString from '../AttributedString';\n\nclass HeaderContent extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, [\n      'handleRef',\n      'handleTextareaRef',\n      'handleDescriptionChange',\n      'handleTextareaBlur',\n      'handleTableCellSelect',\n      'handleExitTableEditMode',\n      'handleTableCellValueUpdate',\n      'handleEnterTableEditMode',\n      'handleAddNewTableRow',\n      'handleRemoveTableRow',\n      'handleAddNewTableColumn',\n      'handleRemoveTableColumn',\n      'handleCheckboxClick',\n      'handleListItemSelect',\n      'handleEnterListTitleEditMode',\n      'handleExitListTitleEditMode',\n      'handleListTitleValueUpdate',\n      'handleEnterListContentsEditMode',\n      'handleExitListContentsEditMode',\n      'handleListContentsValueUpdate',\n      'handleAddNewListItem',\n      'handleRemoveListItem',\n      'handleTimestampClick',\n      'handleInsertTimestamp',\n      'handlePlanningItemTimestampClick',\n      'handlePropertyListEdit',\n    ]);\n\n    this.state = {\n      descriptionValue: this.calculateRawDescription(props.header),\n      containerWidth: null,\n      shouldIgnoreBlur: false,\n    };\n  }\n\n  storeContainerWidth() {\n    if (this.containerDiv) {\n      this.setState({ containerWidth: this.containerDiv.offsetWidth });\n    }\n  }\n\n  componentDidMount() {\n    this.storeContainerWidth();\n  }\n\n  componentDidUpdate(prevProps) {\n    const { header } = this.props;\n\n    if (prevProps.inEditMode && !this.props.inEditMode) {\n      this.props.org.updateHeaderDescription(header.get('id'), this.state.descriptionValue);\n    }\n\n    if (prevProps.header !== this.props.header) {\n      this.setState(\n        {\n          descriptionValue: this.calculateRawDescription(this.props.header),\n        },\n        () => this.storeContainerWidth()\n      );\n    }\n  }\n\n  calculateRawDescription(header) {\n    const planningItems = header.get('planningItems');\n    const propertyListItems = header.get('propertyListItems');\n\n    const planningItemsText = planningItems\n      .map(\n        planningItem =>\n          `${planningItem.get('type')}: ${renderAsText(planningItem.get('timestamp'))}`\n      )\n      .join(' ');\n\n    let propertyListItemsText = '';\n    if (propertyListItems.size > 0) {\n      propertyListItemsText += ':PROPERTIES:\\n';\n      propertyListItemsText += propertyListItems\n        .map(\n          propertyListItem =>\n            `:${propertyListItem.get('property')}: ${attributedStringToRawText(\n              propertyListItem.get('value')\n            )}`\n        )\n        .join('\\n');\n      propertyListItemsText += '\\n:END:';\n    }\n\n    let descriptionText = '';\n    if (!!planningItemsText) {\n      descriptionText += planningItemsText + '\\n';\n    }\n    if (!!propertyListItemsText) {\n      descriptionText += propertyListItemsText + '\\n';\n    }\n    descriptionText += header.get('rawDescription');\n    return descriptionText;\n  }\n\n  handleTextareaRef(textarea) {\n    this.textarea = textarea;\n  }\n\n  handleRef(div) {\n    this.containerDiv = div;\n  }\n\n  handleDescriptionChange(event) {\n    this.setState({ descriptionValue: event.target.value });\n  }\n\n  handleTextareaBlur() {\n    // Give the \"Insert timestamp\" button click a chance to tell us to ignore the blur event.\n    setTimeout(() => {\n      if (!this.state.shouldIgnoreBlur) {\n        this.props.org.exitEditMode();\n      } else {\n        this.setState({ shouldIgnoreBlur: false });\n      }\n    }, 100);\n  }\n\n  handleTableCellSelect(cellId) {\n    this.props.org.setSelectedTableCellId(cellId);\n  }\n\n  handleExitTableEditMode() {\n    this.props.org.exitEditMode();\n  }\n\n  handleTableCellValueUpdate(cellId, newValue) {\n    this.props.org.updateTableCellValue(cellId, newValue);\n  }\n\n  handleEnterTableEditMode() {\n    this.props.org.enterEditMode('table');\n  }\n\n  handleAddNewTableRow() {\n    this.props.org.addNewTableRow();\n  }\n\n  handleRemoveTableRow() {\n    this.props.org.removeTableRow();\n  }\n\n  handleAddNewTableColumn() {\n    this.props.org.addNewTableColumn();\n  }\n\n  handleRemoveTableColumn() {\n    this.props.org.removeTableColumn();\n  }\n\n  handleCheckboxClick(listItemId) {\n    this.props.org.advanceCheckboxState(listItemId);\n  }\n\n  handleListItemSelect(listItemId) {\n    this.props.org.setSelectedListItemId(listItemId);\n  }\n\n  handleEnterListTitleEditMode() {\n    this.props.org.enterEditMode('list-title');\n  }\n\n  handleExitListTitleEditMode() {\n    this.props.org.exitEditMode();\n  }\n\n  handleListTitleValueUpdate(listItemId, newValue) {\n    this.props.org.updateListTitleValue(listItemId, newValue);\n  }\n\n  handleEnterListContentsEditMode() {\n    this.props.org.enterEditMode('list-contents');\n  }\n\n  handleExitListContentsEditMode() {\n    this.props.org.exitEditMode();\n  }\n\n  handleListContentsValueUpdate(listItemId, newValue) {\n    this.props.org.updateListContentsValue(listItemId, newValue);\n  }\n\n  handleAddNewListItem() {\n    this.props.org.addNewListItemAndEdit();\n  }\n\n  handleRemoveListItem() {\n    this.props.org.removeListItem();\n  }\n\n  handleTimestampClick(timestampId) {\n    this.props.base.activatePopup('timestamp-editor', { timestampId });\n  }\n\n  handleInsertTimestamp() {\n    // Clicking this button will unfocus the textarea, but we don't want to exit edit mode,\n    // so instruct the blur handler to ignore the event.\n    this.setState({ shouldIgnoreBlur: true });\n\n    const { descriptionValue } = this.state;\n    const insertionIndex = this.textarea.selectionStart;\n    this.setState({\n      descriptionValue:\n        descriptionValue.substring(0, insertionIndex) +\n        getCurrentTimestampAsText() +\n        descriptionValue.substring(this.textarea.selectionEnd || insertionIndex),\n    });\n    this.textarea.focus();\n  }\n\n  handlePlanningItemTimestampClick(headerId) {\n    return planningItemIndex =>\n      this.props.base.activatePopup('timestamp-editor', { headerId, planningItemIndex });\n  }\n\n  handlePropertyListEdit() {\n    const { header } = this.props;\n    this.props.base.activatePopup('property-list-editor', { headerId: header.get('id') });\n  }\n\n  render() {\n    const {\n      header,\n      inEditMode,\n      selectedTableCellId,\n      inTableEditMode,\n      shouldDisableActions,\n      selectedListItemId,\n      inListTitleEditMode,\n      inListContentsEditMode,\n    } = this.props;\n    const { containerWidth } = this.state;\n\n    if (!header.get('opened')) {\n      return <div />;\n    }\n\n    const startWhitespaces = this.state.descriptionValue.match(/^\\s*/);\n    const indentStr = startWhitespaces ? startWhitespaces[0] : '';\n\n    return (\n      <div\n        className=\"header-content-container nice-scroll\"\n        ref={this.handleRef}\n        style={{ width: containerWidth }}\n      >\n        {inEditMode ? (\n          <div className=\"header-content__edit-container\">\n            <textarea\n              autoFocus\n              className=\"textarea\"\n              rows={Math.min(10, this.state.descriptionValue.split('\\n').length)}\n              ref={this.handleTextareaRef}\n              value={this.state.descriptionValue}\n              onBlur={this.handleTextareaBlur}\n              onChange={this.handleDescriptionChange}\n              onFocus={e => {\n                const target = e.target;\n                setTimeout(() => {\n                  target.scrollTop = target.scrollHeight;\n                }, 0);\n              }}\n              onKeyDown={e => {\n                const target = e.target;\n                if (target && e.key === 'Enter') {\n                  e.preventDefault();\n                  const currentContent = target.value;\n                  const caretPosition = target.selectionStart;\n                  const beforeText = currentContent.substring(0, caretPosition);\n                  const afterText = currentContent.substring(caretPosition);\n                  const newlineText = '\\n' + indentStr;\n                  target.value = beforeText + newlineText + afterText;\n                  target.setSelectionRange(\n                    caretPosition + newlineText.length,\n                    caretPosition + newlineText.length\n                  );\n                  if (afterText.length === 0) {\n                    target.scrollTop = target.scrollHeight;\n                  }\n                }\n              }}\n            />\n            <div\n              className=\"header-content__insert-timestamp-button\"\n              onClick={this.handleInsertTimestamp}\n            >\n              <i className=\"fas fa-plus insert-timestamp-icon\" />\n              Insert timestamp\n            </div>\n          </div>\n        ) : (\n          <Fragment>\n            <PlanningItems\n              planningItems={header.get('planningItems')}\n              onClick={this.handlePlanningItemTimestampClick(header.get('id'))}\n            />\n            <PropertyListItems\n              propertyListItems={header.get('propertyListItems')}\n              onTimestampClick={this.handleTimestampClick}\n              shouldDisableActions={shouldDisableActions}\n              onEdit={this.handlePropertyListEdit}\n            />\n            <AttributedString\n              parts={header.get('description')}\n              subPartDataAndHandlers={{\n                onTableCellSelect: this.handleTableCellSelect,\n                selectedTableCellId: selectedTableCellId,\n                inTableEditMode: inTableEditMode,\n                onExitTableEditMode: this.handleExitTableEditMode,\n                onTableCellValueUpdate: this.handleTableCellValueUpdate,\n                onEnterTableEditMode: this.handleEnterTableEditMode,\n                onAddNewTableRow: this.handleAddNewTableRow,\n                onRemoveTableRow: this.handleRemoveTableRow,\n                onAddNewTableColumn: this.handleAddNewTableColumn,\n                onRemoveTableColumn: this.handleRemoveTableColumn,\n                onCheckboxClick: this.handleCheckboxClick,\n                onListItemSelect: this.handleListItemSelect,\n                onEnterListTitleEditMode: this.handleEnterListTitleEditMode,\n                onExitListTitleEditMode: this.handleExitListTitleEditMode,\n                onListTitleValueUpdate: this.handleListTitleValueUpdate,\n                onEnterListContentsEditMode: this.handleEnterListContentsEditMode,\n                onExitListContentsEditMode: this.handleExitListContentsEditMode,\n                onListContentsValueUpdate: this.handleListContentsValueUpdate,\n                onAddNewListItem: this.handleAddNewListItem,\n                onRemoveListItem: this.handleRemoveListItem,\n                selectedListItemId: selectedListItemId,\n                inListTitleEditMode: inListTitleEditMode,\n                inListContentsEditMode: inListContentsEditMode,\n                onTimestampClick: this.handleTimestampClick,\n                shouldDisableActions,\n              }}\n            />\n          </Fragment>\n        )}\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = (state, props) => {\n  return {\n    inEditMode:\n      state.org.present.get('editMode') === 'description' &&\n      state.org.present.get('selectedHeaderId') === props.header.get('id'),\n    isSelected: state.org.present.get('selectedHeaderId') === props.header.get('id'),\n    selectedTableCellId: state.org.present.get('selectedTableCellId'),\n    inTableEditMode: state.org.present.get('editMode') === 'table',\n    selectedListItemId: state.org.present.get('selectedListItemId'),\n    inListTitleEditMode: state.org.present.get('editMode') === 'list-title',\n    inListContentsEditMode: state.org.present.get('editMode') === 'list-contents',\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    org: bindActionCreators(orgActions, dispatch),\n    base: bindActionCreators(baseActions, dispatch),\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(HeaderContent);\n","import React, { PureComponent } from 'react';\n\nimport './stylesheet.css';\n\nexport default class HeaderActionDrawer extends PureComponent {\n  // A nasty hack required to get click handling to work properly in Firefox. No idea why its\n  // broken in the first place or why this fixes it.\n  iconWithFFClickCatcher(className, onClick) {\n    return (\n      <div onClick={onClick} className=\"header-action-drawer__ff-click-catcher-container\">\n        <div className=\"header-action-drawer__ff-click-catcher\" />\n        <i className={className} />\n      </div>\n    );\n  }\n\n  render() {\n    const {\n      onEnterTitleEditMode,\n      onEnterDescriptionEditMode,\n      onTagsClick,\n      isFocused,\n      onFocus,\n      onUnfocus,\n      onAddNewHeader,\n      onDeadlineClick,\n      onScheduledClick,\n    } = this.props;\n\n    return (\n      <div className=\"header-action-drawer-container\">\n        <div className=\"header-action-drawer__row\">\n          {this.iconWithFFClickCatcher('fas fa-pencil-alt fa-lg', onEnterTitleEditMode)}\n\n          <span className=\"header-action-drawer__separator\" />\n\n          {this.iconWithFFClickCatcher('fas fa-edit fa-lg', onEnterDescriptionEditMode)}\n\n          <span className=\"header-action-drawer__separator\" />\n\n          {this.iconWithFFClickCatcher('fas fa-tags fa-lg', onTagsClick)}\n\n          <span className=\"header-action-drawer__separator\" />\n\n          {isFocused\n            ? this.iconWithFFClickCatcher('fas fa-expand fa-lg', onUnfocus)\n            : this.iconWithFFClickCatcher('fas fa-compress fa-lg', onFocus)}\n\n          <span className=\"header-action-drawer__separator\" />\n\n          {this.iconWithFFClickCatcher('fas fa-plus fa-lg', onAddNewHeader)}\n          <div\n            className=\"header-action-drawer__deadline-scheduled-button\"\n            onClick={onDeadlineClick}\n          >\n            Deadline\n          </div>\n          <span className=\"header-action-drawer__separator\" />\n\n          <div\n            className=\"header-action-drawer__deadline-scheduled-button\"\n            onClick={onScheduledClick}\n          >\n            Scheduled\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n","import React, { PureComponent } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport { Motion, spring } from 'react-motion';\nimport { UnmountClosed as Collapse } from 'react-collapse';\n\nimport * as orgActions from '../../../../actions/org';\nimport * as baseActions from '../../../../actions/base';\n\nimport './stylesheet.css';\n\nimport classNames from 'classnames';\nimport _ from 'lodash';\n\nimport TitleLine from '../TitleLine';\nimport HeaderContent from '../HeaderContent';\nimport HeaderActionDrawer from './components/HeaderActionDrawer';\n\nimport { headerWithId } from '../../../../lib/org_utils';\nimport { interpolateColors, rgbaObject, rgbaString } from '../../../../lib/color';\n\nclass Header extends PureComponent {\n  SWIPE_ACTION_ACTIVATION_DISTANCE = 80;\n  FREE_DRAG_ACTIVATION_DISTANCE = 10;\n\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, [\n      'handleRef',\n      'handleMouseDown',\n      'handleMouseMove',\n      'handleMouseUp',\n      'handleMouseOut',\n      'handleTouchMove',\n      'handleTouchStart',\n      'handleTouchEnd',\n      'handleTouchCancel',\n      'handleHeaderClick',\n      'handleEnterTitleEditMode',\n      'handleEnterDescriptionEditMode',\n      'handleShowTagsModal',\n      'handleFocus',\n      'handleUnfocus',\n      'handleAddNewHeader',\n      'handleRest',\n      'handleDeadlineClick',\n      'handleScheduledClick',\n    ]);\n\n    this.state = {\n      isDraggingFreely: false,\n      dragStartX: null,\n      dragStartY: null,\n      currentDragX: null,\n      containerWidth: null,\n      isPlayingRemoveAnimation: false,\n      heightBeforeRemove: null,\n    };\n  }\n\n  componentDidMount() {\n    if (this.containerDiv) {\n      this.setState({ containerWidth: this.containerDiv.offsetWidth });\n    }\n  }\n\n  handleRef(containerDiv) {\n    this.containerDiv = containerDiv;\n    this.props.onRef(containerDiv);\n  }\n\n  handleDragStart(event, dragX, dragY) {\n    if (this.props.shouldDisableActions) {\n      return;\n    }\n    if (this.props.inEditMode) {\n      return;\n    }\n\n    if (!!event.target.closest('.table-part')) {\n      return;\n    }\n\n    this.setState({\n      dragStartX: dragX,\n      dragStartY: dragY,\n    });\n  }\n\n  handleDragMove(dragX, dragY) {\n    const { dragStartX, dragStartY } = this.state;\n    if (dragStartX === null) {\n      return;\n    }\n\n    if (!this.state.isDraggingFreely) {\n      if (Math.abs(dragX - dragStartX) >= this.FREE_DRAG_ACTIVATION_DISTANCE) {\n        this.setState({ isDraggingFreely: true });\n      }\n    }\n\n    if (Math.abs(dragY - dragStartY) >= this.SWIPE_ACTION_ACTIVATION_DISTANCE / 2) {\n      this.setState({ dragStartX: null });\n    } else {\n      this.setState({ currentDragX: dragX });\n    }\n  }\n\n  handleDragEnd() {\n    const { dragStartX, currentDragX } = this.state;\n\n    if (!!dragStartX && !!currentDragX) {\n      const swipeDistance = currentDragX - dragStartX;\n\n      if (swipeDistance >= this.SWIPE_ACTION_ACTIVATION_DISTANCE) {\n        this.props.org.advanceTodoState(this.props.header.get('id'));\n      }\n\n      if (-1 * swipeDistance >= this.SWIPE_ACTION_ACTIVATION_DISTANCE) {\n        this.setState({\n          isPlayingRemoveAnimation: true,\n          heightBeforeRemove: this.containerDiv.offsetHeight,\n        });\n      }\n    }\n\n    this.setState({\n      dragStartX: null,\n      currentDragX: null,\n      isDraggingFreely: false,\n    });\n  }\n\n  handleDragCancel() {\n    this.setState({\n      dragStartX: null,\n      currentDragX: null,\n      isDraggingFreely: false,\n    });\n  }\n\n  handleMouseDown(event) {\n    this.handleDragStart(event, event.clientX, event.clientY);\n  }\n\n  handleMouseMove(event) {\n    this.handleDragMove(event.clientX, event.clientY);\n  }\n\n  handleMouseUp() {\n    this.handleDragEnd();\n  }\n\n  handleMouseOut() {\n    this.handleDragCancel();\n  }\n\n  handleTouchStart(event) {\n    this.handleDragStart(event, event.changedTouches[0].clientX, event.changedTouches[0].clientY);\n  }\n\n  handleTouchMove(event) {\n    this.handleDragMove(event.changedTouches[0].clientX, event.changedTouches[0].clientY);\n  }\n\n  handleTouchEnd() {\n    this.handleDragEnd();\n  }\n\n  handleTouchCancel() {\n    this.handleDragCancel();\n  }\n\n  handleHeaderClick(event) {\n    const classList = event.target.classList;\n    if (classList.contains('header') || classList.contains('header__bullet')) {\n      const { header, hasContent, isSelected } = this.props;\n\n      if (hasContent && (!header.get('opened') || isSelected)) {\n        this.props.org.toggleHeaderOpened(header.get('id'));\n      }\n\n      this.props.org.selectHeader(header.get('id'));\n    }\n  }\n\n  handleEnterTitleEditMode() {\n    this.props.org.enterEditMode('title');\n  }\n\n  handleEnterDescriptionEditMode() {\n    this.props.org.openHeader(this.props.header.get('id'));\n    this.props.org.enterEditMode('description');\n  }\n\n  handleShowTagsModal() {\n    this.props.base.activatePopup('tags-editor');\n  }\n\n  handleFocus() {\n    this.props.org.focusHeader(this.props.header.get('id'));\n  }\n\n  handleUnfocus() {\n    this.props.org.unfocusHeader();\n  }\n\n  handleAddNewHeader() {\n    this.props.org.addHeaderAndEdit(this.props.header.get('id'));\n  }\n\n  handleRest() {\n    if (this.state.isPlayingRemoveAnimation) {\n      this.props.org.removeHeader(this.props.header.get('id'));\n    }\n  }\n\n  handleDeadlineAndScheduledClick(planningType) {\n    const { header } = this.props;\n\n    const existingDeadlinePlanningItemIndex = header\n      .get('planningItems', [])\n      .findIndex(planningItem => planningItem.get('type') === planningType);\n\n    if (existingDeadlinePlanningItemIndex === -1) {\n      this.props.org.addNewPlanningItem(header.get('id'), planningType);\n      this.props.base.activatePopup('timestamp-editor', {\n        headerId: header.get('id'),\n        planningItemIndex: header.get('planningItems').size,\n      });\n    } else {\n      this.props.base.activatePopup('timestamp-editor', {\n        headerId: header.get('id'),\n        planningItemIndex: existingDeadlinePlanningItemIndex,\n      });\n    }\n\n    this.props.org.openHeader(header.get('id'));\n  }\n\n  handleDeadlineClick() {\n    this.handleDeadlineAndScheduledClick('DEADLINE');\n  }\n\n  handleScheduledClick() {\n    this.handleDeadlineAndScheduledClick('SCHEDULED');\n  }\n\n  render() {\n    const {\n      header,\n      color,\n      hasContent,\n      isSelected,\n      bulletStyle,\n      focusedHeader,\n      isFocused,\n      shouldDisableActions,\n    } = this.props;\n\n    const indentLevel = !!focusedHeader\n      ? header.get('nestingLevel') - focusedHeader.get('nestingLevel') + 1\n      : header.get('nestingLevel');\n\n    const { dragStartX, currentDragX, isDraggingFreely, isPlayingRemoveAnimation, containerWidth } =\n      this.state;\n    const marginLeft =\n      !!dragStartX && !!currentDragX && isDraggingFreely\n        ? currentDragX - dragStartX\n        : isPlayingRemoveAnimation\n        ? spring(-1 * containerWidth, { stiffness: 300 })\n        : spring(0, { stiffness: 300 });\n\n    const style = {\n      paddingLeft: 20 * indentLevel,\n      marginLeft,\n      heightFactor: isPlayingRemoveAnimation ? spring(0, { stiffness: 300 }) : 1,\n    };\n\n    const className = classNames('header', {\n      'header--selected': isSelected,\n      'header--removing': isPlayingRemoveAnimation,\n    });\n\n    return (\n      <Motion style={style} onRest={this.handleRest}>\n        {interpolatedStyle => {\n          const swipedDistance = interpolatedStyle.marginLeft;\n          const isLeftActionActivated = swipedDistance >= this.SWIPE_ACTION_ACTIVATION_DISTANCE;\n          const isRightActionActivated =\n            -1 * swipedDistance >= this.SWIPE_ACTION_ACTIVATION_DISTANCE;\n\n          const disabledColor = rgbaObject(211, 211, 211, 1);\n          const leftActivatedColor = rgbaObject(0, 128, 0, 1);\n          const rightActivatedColor = rgbaObject(255, 0, 0, 1);\n\n          const leftSwipeActionContainerStyle = {\n            width: interpolatedStyle.marginLeft,\n            backgroundColorFactor: spring(isLeftActionActivated ? 1 : 0, { stiffness: 300 }),\n          };\n          const rightSwipeActionContainerStyle = {\n            width: -1 * interpolatedStyle.marginLeft,\n            backgroundColorFactor: spring(isRightActionActivated ? 1 : 0, { stiffness: 300 }),\n          };\n\n          const leftIconStyle = {\n            display: swipedDistance > 30 ? '' : 'none',\n          };\n          const rightIconStyle = {\n            display: -1 * swipedDistance > 30 ? '' : 'none',\n          };\n\n          const { heightFactor, ...headerStyle } = interpolatedStyle;\n\n          if (isPlayingRemoveAnimation) {\n            headerStyle.height = this.state.heightBeforeRemove * heightFactor;\n          }\n\n          return (\n            <div\n              className={className}\n              style={headerStyle}\n              ref={this.handleRef}\n              onClick={this.handleHeaderClick}\n              onMouseDown={this.handleMouseDown}\n              onMouseMove={this.handleMouseMove}\n              onMouseUp={this.handleMouseUp}\n              onMouseOut={this.handleMouseOut}\n              onTouchStart={this.handleTouchStart}\n              onTouchMove={this.handleTouchMove}\n              onTouchEnd={this.handleTouchEnd}\n              onTouchCancel={this.handleTouchCancel}\n            >\n              <Motion style={leftSwipeActionContainerStyle}>\n                {leftInterpolatedStyle => {\n                  const leftStyle = {\n                    width: leftInterpolatedStyle.width,\n                    backgroundColor: rgbaString(\n                      interpolateColors(\n                        disabledColor,\n                        leftActivatedColor,\n                        leftInterpolatedStyle.backgroundColorFactor\n                      )\n                    ),\n                  };\n\n                  return (\n                    <div className=\"left-swipe-action-container\" style={leftStyle}>\n                      <i\n                        className=\"fas fa-check swipe-action-container__icon swipe-action-container__icon--left\"\n                        style={leftIconStyle}\n                      />\n                    </div>\n                  );\n                }}\n              </Motion>\n              <Motion style={rightSwipeActionContainerStyle}>\n                {rightInterpolatedStyle => {\n                  const rightStyle = {\n                    width: rightInterpolatedStyle.width,\n                    backgroundColor: rgbaString(\n                      interpolateColors(\n                        disabledColor,\n                        rightActivatedColor,\n                        rightInterpolatedStyle.backgroundColorFactor\n                      )\n                    ),\n                  };\n\n                  return (\n                    <div className=\"right-swipe-action-container\" style={rightStyle}>\n                      <i\n                        className=\"fas fa-times swipe-action-container__icon swipe-action-container__icon--right\"\n                        style={rightIconStyle}\n                      />\n                    </div>\n                  );\n                }}\n              </Motion>\n\n              <div style={{ marginLeft: -16, color }} className=\"header__bullet\">\n                {bulletStyle === 'Fancy' ? '' : '*'}\n              </div>\n              <TitleLine\n                header={header}\n                color={color}\n                hasContent={hasContent}\n                isSelected={isSelected}\n                shouldDisableActions={shouldDisableActions}\n              />\n\n              <Collapse\n                isOpened={isSelected && !shouldDisableActions}\n                springConfig={{ stiffness: 300 }}\n                style={{ marginRight: rightSwipeActionContainerStyle.width }}\n              >\n                <HeaderActionDrawer\n                  onEnterTitleEditMode={this.handleEnterTitleEditMode}\n                  onEnterDescriptionEditMode={this.handleEnterDescriptionEditMode}\n                  isFocused={isFocused}\n                  onTagsClick={this.handleShowTagsModal}\n                  onFocus={this.handleFocus}\n                  onUnfocus={this.handleUnfocus}\n                  onAddNewHeader={this.handleAddNewHeader}\n                  onDeadlineClick={this.handleDeadlineClick}\n                  onScheduledClick={this.handleScheduledClick}\n                />\n              </Collapse>\n\n              <HeaderContent header={header} shouldDisableActions={shouldDisableActions} />\n            </div>\n          );\n        }}\n      </Motion>\n    );\n  }\n}\n\nconst mapStateToProps = (state, props) => {\n  const focusedHeader = !!state.org.present.get('focusedHeaderId')\n    ? headerWithId(state.org.present.get('headers'), state.org.present.get('focusedHeaderId'))\n    : null;\n\n  return {\n    bulletStyle: state.base.get('bulletStyle'),\n    focusedHeader,\n    isFocused: !!focusedHeader && focusedHeader.get('id') === props.header.get('id'),\n    inEditMode: !!state.org.present.get('editMode'),\n  };\n};\n\nconst mapDispatchToProps = dispatch => ({\n  org: bindActionCreators(orgActions, dispatch),\n  base: bindActionCreators(baseActions, dispatch),\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Header);\n","import React, { PureComponent } from 'react';\nimport { connect } from 'react-redux';\n\nimport './stylesheet.css';\n\nimport Header from '../Header';\n\nimport { numSubheadersOfHeaderWithId } from '../../../../lib/org_utils';\n\nimport _ from 'lodash';\nimport classNames from 'classnames';\n\nclass HeaderList extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    this.headerRefs = {};\n\n    _.bindAll(this, ['handleHeaderRef']);\n  }\n\n  componentDidUpdate(prevProps) {\n    if (prevProps.selectedHeaderId !== this.props.selectedHeaderId) {\n      const selectedHeaderDiv = this.headerRefs[this.props.selectedHeaderId];\n      if (!!selectedHeaderDiv) {\n        const boundingRectangle = selectedHeaderDiv.getBoundingClientRect();\n        const viewportHeight = document.documentElement.clientHeight;\n\n        if (boundingRectangle.top > viewportHeight * 0.9 || boundingRectangle.bottom < 0) {\n          selectedHeaderDiv.scrollIntoView();\n        }\n      }\n    }\n  }\n\n  handleHeaderRef(headerId) {\n    return div => (this.headerRefs[headerId] = div);\n  }\n\n  render() {\n    const { headers, selectedHeaderId, focusedHeaderId, shouldDisableActions } = this.props;\n\n    const headerRenderData = headers\n      .map(header => {\n        return {\n          header,\n          displayed: false,\n          hasContent:\n            !!header.get('rawDescription') ||\n            header.get('planningItems').size !== 0 ||\n            header.get('propertyListItems').size !== 0,\n        };\n      })\n      .toArray();\n\n    headerRenderData.forEach((headerRenderDatum, index) => {\n      const nestingLevel = headerRenderDatum.header.get('nestingLevel');\n\n      const hasNoParents = headerRenderData\n        .slice(0, index)\n        .every(\n          previousRenderDatum => previousRenderDatum.header.get('nestingLevel') >= nestingLevel\n        );\n      if (hasNoParents) {\n        headerRenderDatum.displayed = true;\n      }\n\n      const followingHeaders = headerRenderData.slice(index + 1);\n      for (\n        let followingHeaderIndex = 0;\n        followingHeaderIndex < followingHeaders.length;\n        ++followingHeaderIndex\n      ) {\n        const followingHeader = followingHeaders[followingHeaderIndex];\n        if (followingHeader.header.get('nestingLevel') <= nestingLevel) {\n          break;\n        }\n\n        headerRenderDatum.hasContent = true;\n\n        followingHeader.displayed =\n          headerRenderDatum.header.get('opened') && headerRenderDatum.displayed;\n      }\n    });\n\n    if (!!focusedHeaderId) {\n      const focusedHeaderIndex = headerRenderData.findIndex(\n        headerRenderDatum => headerRenderDatum.header.get('id') === focusedHeaderId\n      );\n\n      const previousHeaders = headerRenderData.slice(0, focusedHeaderIndex);\n      previousHeaders.forEach(headerRenderDatum => (headerRenderDatum.displayed = false));\n\n      const numSubheaders = numSubheadersOfHeaderWithId(headers, focusedHeaderId);\n      const followingHeaders = headerRenderData.slice(focusedHeaderIndex + numSubheaders + 1);\n      followingHeaders.forEach(headerRenderDatum => (headerRenderDatum.displayed = false));\n    }\n\n    const headerColors = [\n      'rgba(38, 143, 214, 1)',\n      'rgba(42, 164, 168, 1)',\n      'rgba(181, 142, 78, 1)',\n      'rgba(220, 64, 95, 1)',\n      'rgba(101, 128, 152, 1)',\n      'rgba(146, 164, 175, 1)',\n      'rgba(203, 85, 83, 1)',\n      'rgba(108, 119, 202, 1)',\n    ];\n\n    const displayedHeaderRenderData = headerRenderData.filter(\n      headerRenderDatum => headerRenderDatum.displayed\n    );\n\n    const className = classNames('header-list-container', {\n      'header-list-container--focused': !!focusedHeaderId,\n    });\n    return (\n      <div className={className}>\n        {displayedHeaderRenderData.map((headerRenderDatum, index) => {\n          const header = headerRenderDatum.header;\n          const color = headerColors[(header.get('nestingLevel') - 1) % headerColors.length];\n\n          return (\n            <Header\n              key={header.get('id')}\n              header={header}\n              color={color}\n              hasContent={headerRenderDatum.hasContent}\n              isSelected={header.get('id') === selectedHeaderId}\n              onRef={this.handleHeaderRef(header.get('id'))}\n              shouldDisableActions={shouldDisableActions}\n            />\n          );\n        })}\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = (state, props) => {\n  return {\n    headers: state.org.present.get('headers'),\n    selectedHeaderId: state.org.present.get('selectedHeaderId'),\n    focusedHeaderId: state.org.present.get('focusedHeaderId'),\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {};\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(HeaderList);\n","import React, { PureComponent } from 'react';\n\nimport './stylesheet.css';\n\nimport classNames from 'classnames';\nimport _ from 'lodash';\n\nexport default class ActionButton extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, ['handleClick']);\n  }\n\n  handleClick() {\n    const { onClick, isDisabled } = this.props;\n\n    if (isDisabled) {\n      return;\n    }\n\n    onClick();\n  }\n\n  render() {\n    const {\n      iconName,\n      subIconName,\n      isDisabled,\n      shouldRotateSubIcon,\n      letter,\n      additionalClassName,\n      style,\n      tooltip,\n      shouldSpinSubIcon,\n      onRef,\n    } = this.props;\n\n    const className = classNames(\n      'btn',\n      'btn--circle',\n      'action-drawer__btn',\n      additionalClassName || '',\n      {\n        fas: !letter,\n        'fa-lg': !letter,\n        [`fa-${iconName}`]: !letter,\n        'action-drawer__btn--with-sub-icon': !!subIconName,\n        'btn--disabled': isDisabled,\n        'action-drawer__btn--letter': !!letter,\n      }\n    );\n\n    const subIconClassName = classNames(\n      'fas',\n      'fa-xs',\n      `fa-${subIconName}`,\n      'action-drawer__btn__sub-icon',\n      {\n        'action-drawer__btn__sub-icon--rotated': shouldRotateSubIcon,\n        'fa-spin': shouldSpinSubIcon,\n      }\n    );\n\n    return (\n      <button\n        className={className}\n        onClick={this.handleClick}\n        style={style}\n        title={tooltip}\n        ref={onRef}\n      >\n        {!!letter && letter}\n        {!!subIconName && <i className={subIconClassName} />}\n      </button>\n    );\n  }\n}\n","import React, { Fragment, useState, useEffect, useMemo, useRef } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport { Motion, spring } from 'react-motion';\n\nimport './stylesheet.css';\n\nimport { List } from 'immutable';\n\nimport * as orgActions from '../../../../actions/org';\nimport * as captureActions from '../../../../actions/capture';\nimport * as baseActions from '../../../../actions/base';\n\nimport sampleCaptureTemplates from '../../../../lib/sample_capture_templates';\n\nimport ActionButton from './components/ActionButton/';\n\nconst ActionDrawer = ({\n  org,\n  selectedHeaderId,\n  base,\n  staticFile,\n  captureTemplates,\n  path,\n  selectedTableCellId,\n  selectedListItemId,\n  inEditMode,\n  isLoading,\n  shouldDisableSyncButtons,\n}) => {\n  const [isDisplayingArrowButtons, setIsDisplayingArrowButtons] = useState(false);\n  const [isDisplayingCaptureButtons, setIsDisplayingCaptureButtons] = useState(false);\n\n  // Send a no-op action to take care of the bug where redux-undo won't allow the first\n  // action to be undone.\n  useEffect(() => {\n    org.noOp();\n  }, []);\n\n  useEffect(() => {\n    document.querySelector('html').style.paddingBottom = '90px';\n\n    return () => (document.querySelector('html').style.paddingBottom = '0px');\n  });\n\n  const mainArrowButton = useRef(null);\n\n  const mainArrowButtonBoundingRect = useMemo(\n    () => (!!mainArrowButton.current ? mainArrowButton.current.getBoundingClientRect() : null),\n    [mainArrowButton.current]\n  );\n\n  const handleUpClick = () =>\n    !!selectedHeaderId\n      ? org.moveHeaderUp(selectedHeaderId)\n      : !!selectedTableCellId\n      ? org.moveTableRowUp()\n      : org.moveListItemUp();\n\n  const handleDownClick = () =>\n    !!selectedHeaderId\n      ? org.moveHeaderDown(selectedHeaderId)\n      : !!selectedTableCellId\n      ? org.moveTableRowDown()\n      : org.moveListItemDown();\n\n  const handleLeftClick = () =>\n    !!selectedHeaderId\n      ? org.moveHeaderLeft(selectedHeaderId)\n      : !!selectedTableCellId\n      ? org.moveTableColumnLeft()\n      : org.moveListItemLeft();\n\n  const handleRightClick = () =>\n    !!selectedHeaderId\n      ? org.moveHeaderRight(selectedHeaderId)\n      : !!selectedTableCellId\n      ? org.moveTableColumnRight()\n      : org.moveListItemRight();\n\n  const handleMoveSubtreeLeftClick = () =>\n    !!selectedHeaderId ? org.moveSubtreeLeft(selectedHeaderId) : org.moveListSubtreeLeft();\n\n  const handleMoveSubtreeRightClick = () =>\n    !!selectedHeaderId ? org.moveSubtreeRight(selectedHeaderId) : org.moveListSubtreeRight();\n\n  const handleDoneClick = () => org.exitEditMode();\n\n  const handleCaptureButtonClick = templateId => () => {\n    setIsDisplayingCaptureButtons(false);\n    base.activatePopup('capture', { templateId });\n  };\n\n  const getSampleCaptureTemplates = () => sampleCaptureTemplates;\n\n  const getAvailableCaptureTemplates = () =>\n    staticFile === 'sample'\n      ? getSampleCaptureTemplates()\n      : captureTemplates.filter(\n          template =>\n            template.get('isAvailableInAllOrgFiles') ||\n            template\n              .get('orgFilesWhereAvailable')\n              .map(availablePath =>\n                availablePath.trim().startsWith('/')\n                  ? availablePath.trim()\n                  : '/' + availablePath.trim()\n              )\n              .includes((path || '').trim())\n        );\n\n  const handleSync = () => org.sync();\n\n  const handleMainArrowButtonClick = () => setIsDisplayingArrowButtons(!isDisplayingArrowButtons);\n\n  const handleMainCaptureButtonClick = () => {\n    if (!isDisplayingCaptureButtons && getAvailableCaptureTemplates().size === 0) {\n      alert(\n        `You don't have any capture templates set up for this file! Add some in Settings > Capture Templates`\n      );\n      return;\n    }\n\n    setIsDisplayingCaptureButtons(!isDisplayingCaptureButtons);\n  };\n\n  const renderCaptureButtons = () => {\n    const availableCaptureTemplates = getAvailableCaptureTemplates();\n\n    const baseCaptureButtonStyle = {\n      position: 'absolute',\n      zIndex: 0,\n      left: 0,\n      opacity: isDisplayingArrowButtons ? 0 : 1,\n    };\n    if (!isDisplayingCaptureButtons) {\n      baseCaptureButtonStyle.boxShadow = 'none';\n    }\n\n    const mainButtonStyle = {\n      opacity: isDisplayingArrowButtons ? 0 : 1,\n      position: 'relative',\n      zIndex: 1,\n    };\n\n    const animatedStyle = {\n      bottom: spring(isDisplayingCaptureButtons ? 70 : 0, { stiffness: 300 }),\n    };\n\n    return (\n      <Motion style={animatedStyle}>\n        {style => (\n          <div className=\"action-drawer__capture-buttons-container\">\n            <ActionButton\n              iconName={isDisplayingCaptureButtons ? 'times' : 'list-ul'}\n              isDisabled={false}\n              onClick={handleMainCaptureButtonClick}\n              style={mainButtonStyle}\n              tooltip={\n                isDisplayingCaptureButtons ? 'Hide capture templates' : 'Show capture templates'\n              }\n            />\n\n            {availableCaptureTemplates.map((template, index) => (\n              <ActionButton\n                key={template.get('id')}\n                letter={template.get('letter')}\n                iconName={template.get('iconName')}\n                isDisabled={false}\n                onClick={handleCaptureButtonClick(template.get('id'))}\n                style={{ ...baseCaptureButtonStyle, bottom: style.bottom * (index + 1) }}\n                tooltip={`Activate \"${template.get('description')}\" capture template`}\n              />\n            ))}\n          </div>\n        )}\n      </Motion>\n    );\n  };\n\n  const renderMovementButtons = () => {\n    const baseArrowButtonStyle = {\n      opacity: isDisplayingCaptureButtons ? 0 : 1,\n    };\n    if (!isDisplayingArrowButtons) {\n      baseArrowButtonStyle.boxShadow = 'none';\n    }\n\n    let centerXOffset = 0;\n    if (!!mainArrowButtonBoundingRect) {\n      centerXOffset =\n        window.screen.width / 2 -\n        (mainArrowButtonBoundingRect.x + mainArrowButtonBoundingRect.width / 2);\n    }\n\n    const animatedStyles = {\n      centerXOffset: spring(isDisplayingArrowButtons ? centerXOffset : 0, { stiffness: 300 }),\n      topRowYOffset: spring(isDisplayingArrowButtons ? 150 : 0, { stiffness: 300 }),\n      bottomRowYOffset: spring(isDisplayingArrowButtons ? 80 : 0, { stiffness: 300 }),\n      firstColumnXOffset: spring(isDisplayingArrowButtons ? 70 : 0, {\n        stiffness: 300,\n      }),\n      secondColumnXOffset: spring(isDisplayingArrowButtons ? 140 : 0, {\n        stiffness: 300,\n      }),\n    };\n\n    let subIconNameStr = null;\n    let tooltipUpStr = 'Move header up';\n    let tooltipDownStr = 'Move header down';\n    let tooltipLeftStr = 'Move header left';\n    let tooltipRightStr = 'Move header right';\n    if (!!selectedTableCellId) {\n      subIconNameStr = 'table';\n      tooltipUpStr = 'Move row up';\n      tooltipDownStr = 'Move row down';\n      tooltipLeftStr = 'Move column left';\n      tooltipRightStr = 'Move column right';\n    } else if (!!selectedListItemId) {\n      subIconNameStr = 'list';\n      tooltipUpStr = 'Move list up';\n      tooltipDownStr = 'Move list down';\n      tooltipLeftStr = 'Move list left';\n      tooltipRightStr = 'Move list right';\n    }\n\n    return (\n      <Motion style={animatedStyles}>\n        {style => (\n          <div\n            className=\"action-drawer__arrow-buttons-container\"\n            style={{ left: style.centerXOffset }}\n          >\n            <ActionButton\n              additionalClassName=\"action-drawer__arrow-button\"\n              iconName=\"arrow-up\"\n              subIconName={subIconNameStr}\n              isDisabled={false}\n              onClick={handleUpClick}\n              style={{ ...baseArrowButtonStyle, bottom: style.topRowYOffset }}\n              tooltip={tooltipUpStr}\n            />\n            <ActionButton\n              additionalClassName=\"action-drawer__arrow-button\"\n              iconName=\"arrow-down\"\n              subIconName={subIconNameStr}\n              isDisabled={false}\n              onClick={handleDownClick}\n              style={{ ...baseArrowButtonStyle, bottom: style.bottomRowYOffset }}\n              tooltip={tooltipDownStr}\n            />\n            <ActionButton\n              additionalClassName=\"action-drawer__arrow-button\"\n              iconName=\"arrow-left\"\n              subIconName={subIconNameStr}\n              isDisabled={false}\n              onClick={handleLeftClick}\n              style={{\n                ...baseArrowButtonStyle,\n                bottom: style.bottomRowYOffset,\n                right: style.firstColumnXOffset,\n              }}\n              tooltip={tooltipLeftStr}\n            />\n            <ActionButton\n              additionalClassName=\"action-drawer__arrow-button\"\n              iconName=\"arrow-right\"\n              subIconName={subIconNameStr}\n              isDisabled={false}\n              onClick={handleRightClick}\n              style={{\n                ...baseArrowButtonStyle,\n                bottom: style.bottomRowYOffset,\n                left: style.firstColumnXOffset,\n              }}\n              tooltip={tooltipRightStr}\n            />\n            {!selectedTableCellId && (\n              <Fragment>\n                <ActionButton\n                  additionalClassName=\"action-drawer__arrow-button\"\n                  iconName=\"chevron-left\"\n                  subIconName={subIconNameStr}\n                  isDisabled={false}\n                  onClick={handleMoveSubtreeLeftClick}\n                  style={{\n                    ...baseArrowButtonStyle,\n                    bottom: style.bottomRowYOffset,\n                    right: style.secondColumnXOffset,\n                  }}\n                  tooltip=\"Move entire subtree left\"\n                />\n                <ActionButton\n                  additionalClassName=\"action-drawer__arrow-button\"\n                  iconName=\"chevron-right\"\n                  subIconName={subIconNameStr}\n                  isDisabled={false}\n                  onClick={handleMoveSubtreeRightClick}\n                  style={{\n                    ...baseArrowButtonStyle,\n                    bottom: style.bottomRowYOffset,\n                    left: style.secondColumnXOffset,\n                  }}\n                  tooltip=\"Move entire subtree right\"\n                />\n              </Fragment>\n            )}\n\n            <ActionButton\n              iconName={isDisplayingArrowButtons ? 'times' : 'arrows-alt'}\n              subIconName={subIconNameStr}\n              additionalClassName=\"action-drawer__main-arrow-button\"\n              isDisabled={false}\n              onClick={handleMainArrowButtonClick}\n              style={{ opacity: isDisplayingCaptureButtons ? 0 : 1 }}\n              tooltip={isDisplayingArrowButtons ? 'Hide movement buttons' : 'Show movement buttons'}\n              onRef={mainArrowButton}\n            />\n          </div>\n        )}\n      </Motion>\n    );\n  };\n\n  const handleAgendaClick = () => base.activatePopup('agenda');\n\n  return (\n    <div className=\"action-drawer-container nice-scroll\">\n      {inEditMode ? (\n        <button className=\"btn action-drawer__done-btn\" onClick={handleDoneClick}>\n          Done\n        </button>\n      ) : (\n        <Fragment>\n          <ActionButton\n            iconName=\"cloud\"\n            subIconName=\"sync-alt\"\n            shouldSpinSubIcon={isLoading}\n            isDisabled={shouldDisableSyncButtons}\n            onClick={handleSync}\n            style={{ opacity: isDisplayingArrowButtons || isDisplayingCaptureButtons ? 0 : 1 }}\n            tooltip=\"Sync changes\"\n          />\n\n          {renderMovementButtons()}\n\n          <ActionButton\n            iconName=\"calendar-alt\"\n            shouldSpinSubIcon={isLoading}\n            isDisabled={false}\n            onClick={handleAgendaClick}\n            style={{ opacity: isDisplayingArrowButtons || isDisplayingCaptureButtons ? 0 : 1 }}\n            tooltip=\"Show agenda\"\n          />\n\n          {renderCaptureButtons()}\n        </Fragment>\n      )}\n    </div>\n  );\n};\n\nconst mapStateToProps = (state, props) => {\n  return {\n    inEditMode: !!state.org.present.get('editMode'),\n    selectedHeaderId: state.org.present.get('selectedHeaderId'),\n    isDirty: state.org.present.get('isDirty'),\n    isFocusedHeaderActive: !!state.org.present.get('focusedHeaderId'),\n    selectedTableCellId: state.org.present.get('selectedTableCellId'),\n    selectedListItemId: state.org.present.get('selectedListItemId'),\n    captureTemplates: state.capture.get('captureTemplates', new List()),\n    path: state.org.present.get('path'),\n    isLoading: state.base.get('isLoading'),\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    org: bindActionCreators(orgActions, dispatch),\n    capture: bindActionCreators(captureActions, dispatch),\n    base: bindActionCreators(baseActions, dispatch),\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ActionDrawer);\n","import React from 'react';\nimport { Motion, spring } from 'react-motion';\n\nimport { interpolateColors, rgbaObject, rgbaString } from '../../../lib/color';\n\nimport './stylesheet.css';\n\nexport default ({ isEnabled, onToggle }) => {\n  const disabledColor = rgbaObject(255, 255, 255, 1);\n  const enabledColor = rgbaObject(94, 52, 140, 1);\n\n  const switchStyle = {\n    colorFactor: spring(isEnabled ? 1 : 0, { stiffness: 300 }),\n  };\n\n  const grabberStyle = {\n    marginLeft: spring(isEnabled ? 42 : 0, { stiffness: 300 }),\n  };\n\n  return (\n    <Motion style={switchStyle}>\n      {style => {\n        const backgroundColor = rgbaString(\n          interpolateColors(disabledColor, enabledColor, style.colorFactor)\n        );\n\n        return (\n          <div className=\"switch\" style={{ backgroundColor }} onClick={onToggle}>\n            <Motion style={grabberStyle}>\n              {style => <div className=\"switch__grabber\" style={style} />}\n            </Motion>\n          </div>\n        );\n      }}\n    </Motion>\n  );\n};\n","import React, { useState, useEffect, useLayoutEffect, useRef } from 'react';\n\nimport './stylesheet.css';\n\nimport { Motion, spring } from 'react-motion';\nimport classNames from 'classnames';\n\nexport default ({ children, shouldIncludeCloseButton, onClose }) => {\n  const [isVisible, setIsVisible] = useState(false);\n  const [dragOffsetY, setDragOffsetY] = useState(null);\n\n  useLayoutEffect(() => {\n    setIsVisible(true);\n  }, []);\n\n  const initialClientY = useRef();\n  const innerContainer = useRef();\n\n  const innerContainerHeight = useRef();\n  useLayoutEffect(() => {\n    innerContainerHeight.current = innerContainer.current.offsetHeight;\n  });\n  const endInnerContainerDrag = () => {\n    setIsVisible(dragOffsetY <= innerContainerHeight.current * 0.3);\n    setDragOffsetY(null);\n  };\n\n  const handleInnerContainerClick = event => event.stopPropagation();\n\n  const handleClose = () => setIsVisible(false);\n\n  const handleAnimationRest = () => (!isVisible && !!onClose ? onClose() : void 0);\n\n  const handleTouchStart = event => (initialClientY.current = event.targetTouches[0].clientY);\n\n  const handleTouchMove = event => {\n    if (event.target.classList.contains('drag-handle')) {\n      return;\n    }\n\n    const isScrollingDown = initialClientY.current > event.targetTouches[0].clientY;\n\n    if (\n      isScrollingDown &&\n      innerContainer.current.scrollHeight - innerContainer.current.scrollTop <=\n        innerContainer.current.clientHeight\n    ) {\n      event.preventDefault();\n    } else if (!isScrollingDown && innerContainer.current.scrollTop === 0) {\n      event.preventDefault();\n\n      setDragOffsetY(event.targetTouches[0].clientY - initialClientY.current);\n    }\n  };\n\n  const handleTouchEndOrCancel = event => endInnerContainerDrag();\n\n  useEffect(() => {\n    if (!!innerContainer.current) {\n      // Super annoying logic for disabling scrolling of the body when a slide up is active.\n      // Briefly: if we're already at the top of our Drawer and trying to scroll up, disable\n      // scrolling. Likewise, if we're already at the bottom of our Drawer and trying to scroll\n      // down, disable scrolling.\n      innerContainer.current.addEventListener('touchstart', handleTouchStart);\n      innerContainer.current.addEventListener('touchmove', handleTouchMove);\n      innerContainer.current.addEventListener('touchend', handleTouchEndOrCancel);\n      innerContainer.current.addEventListener('touchcancel', handleTouchEndOrCancel);\n\n      return () => {\n        innerContainer.current.removeEventListener('touchstart', handleTouchStart);\n        innerContainer.current.removeEventListener('touchmove', handleTouchMove);\n        innerContainer.current.removeEventListener('touchend', handleTouchEndOrCancel);\n        innerContainer.current.removeEventListener('touchcancel', handleTouchEndOrCancel);\n      };\n    } else {\n      return null;\n    }\n  }, [innerContainer.current, dragOffsetY]);\n\n  useEffect(() => {\n    // A ridiculous hack to get around what is presumably a Mobile Safari bug in iOS 12.\n    // Without this, I can't scroll the inner container in the agenda view.\n    setTimeout(() => {\n      innerContainer.current.style.left = '0';\n      setTimeout(() => {\n        innerContainer.current.style.left = '-1px';\n      }, 0);\n    }, 0);\n  }, [children]);\n\n  const outerClassName = classNames('drawer-outer-container', {\n    'drawer-outer-container--visible': isVisible,\n  });\n\n  const innerStyle = {\n    offsetY:\n      dragOffsetY ||\n      spring(isVisible ? 0 : innerContainerHeight.current || window.innerHeight, {\n        stiffness: 300,\n      }),\n  };\n\n  return (\n    <Motion style={innerStyle} onRest={handleAnimationRest}>\n      {style => {\n        const interpolatedStyle = {\n          transform: `translateY(${style.offsetY}px)`,\n        };\n\n        return (\n          <div className={outerClassName} onClick={!!onClose ? handleClose : null}>\n            <div\n              onClick={handleInnerContainerClick}\n              className=\"drawer-inner-container nice-scroll\"\n              ref={innerContainer}\n              style={interpolatedStyle}\n            >\n              <div className=\"drawer__grabber\" />\n\n              {shouldIncludeCloseButton && (\n                <button className=\"fas fa-times fa-lg drawer__close-button\" onClick={handleClose} />\n              )}\n\n              {children}\n            </div>\n          </div>\n        );\n      }}\n    </Motion>\n  );\n};\n","import React, { Fragment, useState, useEffect, useRef, useMemo } from 'react';\n\nimport './stylesheet.css';\n\nimport ActionButton from '../ActionDrawer/components/ActionButton/';\nimport Switch from '../../../UI/Switch/';\nimport Drawer from '../../../UI/Drawer/';\n\nimport { headerWithPath } from '../../../../lib/org_utils';\nimport substituteTemplateVariables from '../../../../lib/capture_template_substitution';\n\nimport classNames from 'classnames';\n\nexport default ({ template, onCapture, headers, onClose }) => {\n  const [substitutedTemplate, initialCursorIndex] = useMemo(\n    () => substituteTemplateVariables(template.get('template')),\n    [template.get('template')]\n  );\n\n  const isTopLevelTarget = template.get('headerPaths').filter(path => path.length !== 0).size === 0;\n  const targetHeader = useMemo(\n    () => headerWithPath(headers, template.get('headerPaths')),\n    [headers, template.get('headerPaths')]\n  );\n\n  const [textareaValue, setTextareaValue] = useState(substitutedTemplate);\n  const [shouldPrepend, setShouldPrepend] = useState(template.get('shouldPrepend'));\n\n  const textarea = useRef(null);\n\n  useEffect(() => {\n    if (textarea.current) {\n      textarea.current.focus();\n      if (initialCursorIndex !== null) {\n        textarea.current.selectionStart = initialCursorIndex;\n        textarea.current.selectionEnd = initialCursorIndex;\n      }\n    }\n  }, [textarea]);\n\n  const handleCaptureClick = () => onCapture(template.get('id'), textareaValue, shouldPrepend);\n\n  const handleTextareaChange = event => setTextareaValue(event.target.value);\n\n  const handlePrependSwitchToggle = () => setShouldPrepend(!shouldPrepend);\n\n  return (\n    <Drawer onClose={onClose}>\n      <div className=\"capture-modal-header\">\n        <ActionButton\n          letter={template.get('letter')}\n          iconName={template.get('iconName')}\n          isDisabled={false}\n          onClick={() => {}}\n          style={{ marginRight: 20 }}\n        />\n\n        <span>{template.get('description')}</span>\n      </div>\n\n      <div\n        className={classNames('capture-modal-header-path', {\n          'capture-modal-header-path--top-level': isTopLevelTarget,\n        })}\n      >\n        {isTopLevelTarget ? 'Top level header' : template.get('headerPaths').join(' > ')}\n      </div>\n\n      {!!targetHeader || isTopLevelTarget ? (\n        <Fragment>\n          <textarea\n            className=\"textarea capture-modal-textarea\"\n            rows=\"4\"\n            value={textareaValue}\n            onChange={handleTextareaChange}\n            ref={textarea}\n          />\n\n          <div className=\"capture-modal-button-container\">\n            <div className=\"capture-modal-prepend-container\">\n              <span className=\"capture-modal-prepend-label\">Prepend:</span>\n              <Switch isEnabled={shouldPrepend} onToggle={handlePrependSwitchToggle} />\n            </div>\n\n            <button className=\"btn capture-modal-button\" onClick={handleCaptureClick}>\n              Capture\n            </button>\n          </div>\n        </Fragment>\n      ) : (\n        <div className=\"capture-modal-error-message\">\n          The specified header path doesn't exist in this org file!\n        </div>\n      )}\n\n      <br />\n    </Drawer>\n  );\n};\n","import React from 'react';\n\nimport './stylesheet.css';\n\nimport Drawer from '../../../UI/Drawer/';\n\nimport formatDate from 'date-fns/format';\nimport { distanceInWordsToNow } from 'date-fns';\n\nexport default ({ lastServerModifiedAt, onPull, onPush, onCancel }) => {\n  return (\n    <Drawer>\n      <h2 className=\"sync-confirmation-modal__header\">Sync conflict</h2>\n      Since you last pulled, a newer version of the file has been pushed to the server. The newer\n      version is from:\n      <br />\n      <br />\n      <div className=\"sync-confirmation-modal__last-sync-time\">\n        {formatDate(lastServerModifiedAt, 'MMMM Do, YYYY [at] h:mm:ss a')}\n        <br />({distanceInWordsToNow(lastServerModifiedAt)} ago)\n      </div>\n      <div className=\"sync-confirmation-modal__buttons-container\">\n        <button className=\"btn sync-confirmation-modal__button\" onClick={onPull}>\n          Pull latest version from server\n        </button>\n        <button className=\"btn sync-confirmation-modal__button\" onClick={onPush}>\n          Overwrite server version\n        </button>\n        <button className=\"btn sync-confirmation-modal__button\" onClick={onCancel}>\n          Cancel sync\n        </button>\n      </div>\n      <br />\n    </Drawer>\n  );\n};\n","import React, { PureComponent, Fragment } from 'react';\n\nimport { Droppable, Draggable } from 'react-beautiful-dnd';\n\nimport './stylesheet.css';\n\nimport Drawer from '../../../UI/Drawer/';\n\nimport _ from 'lodash';\nimport classNames from 'classnames';\n\nexport default class TagsEditorModal extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, ['handleRemoveTag', 'handleAddNewTag', 'handleTagChange']);\n\n    this.state = {\n      allTags: props.allTags,\n    };\n  }\n\n  componentDidUpdate(prevProps) {\n    const prevTags = prevProps.header.getIn(['titleLine', 'tags']);\n    const currentTags = this.props.header.getIn(['titleLine', 'tags']);\n    if (prevTags.size === currentTags.size - 1 && currentTags.last() === '') {\n      if (this.lastTextfield) {\n        this.lastTextfield.focus();\n      }\n    }\n  }\n\n  handleTagChange(tagIndex) {\n    return event => {\n      const tags = this.props.header.getIn(['titleLine', 'tags']);\n      this.props.onChange(tags.set(tagIndex, event.target.value.replace(/(\\s+|:)/g, '')));\n    };\n  }\n\n  handleRemoveTag(tagIndex) {\n    return () => {\n      const tags = this.props.header.getIn(['titleLine', 'tags']);\n      this.props.onChange(tags.delete(tagIndex));\n    };\n  }\n\n  handleAddNewTag() {\n    const tags = this.props.header.getIn(['titleLine', 'tags']);\n    this.props.onChange(tags.push(''));\n  }\n\n  handleExistingTagClick(newTag) {\n    return () => {\n      const tags = this.props.header.getIn(['titleLine', 'tags']);\n      if (tags.includes(newTag)) {\n        this.props.onChange(tags.filter(tag => tag !== newTag));\n      } else {\n        this.props.onChange(tags.push(newTag));\n      }\n    };\n  }\n\n  render() {\n    const { header, onClose } = this.props;\n    const { allTags } = this.state;\n\n    const headerTags = header.getIn(['titleLine', 'tags']);\n\n    return (\n      <Drawer onClose={onClose}>\n        <h2 className=\"drawer-modal__title\">Edit tags</h2>\n\n        {headerTags.size === 0 ? (\n          <div className=\"no-tags-message\">\n            This header doesn't have any tags.\n            <br />\n            <br />\n            Click the <i className=\"fas fa-plus\" /> button to add a new one, or choose from the list\n            of all of your tags below.\n          </div>\n        ) : (\n          <Droppable droppableId=\"tags-editor-droppable\" type=\"TAG\">\n            {(provided, snapshot) => (\n              <div className=\"tags-container\" ref={provided.innerRef} {...provided.droppableProps}>\n                <Fragment>\n                  {headerTags.map((tag, index) => (\n                    <Draggable draggableId={`tag--${index}`} index={index} key={index}>\n                      {(provided, snapshot) => (\n                        <div\n                          className={classNames('tag-container', {\n                            'tag-container--dragging': snapshot.isDragging,\n                          })}\n                          ref={provided.innerRef}\n                          {...provided.draggableProps}\n                        >\n                          <input\n                            type=\"text\"\n                            className=\"textfield tag-container__textfield\"\n                            value={tag}\n                            onChange={this.handleTagChange(index)}\n                            ref={textfield => (this.lastTextfield = textfield)}\n                          />\n                          <div className=\"tag-container__actions-container\">\n                            <i\n                              className=\"fas fa-times fa-lg\"\n                              onClick={this.handleRemoveTag(index)}\n                            />\n                            <i\n                              className=\"fas fa-bars fa-lg tag-container__drag-handle drag-handle\"\n                              {...provided.dragHandleProps}\n                            />\n                          </div>\n                        </div>\n                      )}\n                    </Draggable>\n                  ))}\n\n                  {provided.placeholder}\n                </Fragment>\n              </div>\n            )}\n          </Droppable>\n        )}\n\n        <div className=\"tags-editor__add-new-container\">\n          <button className=\"fas fa-plus fa-lg btn btn--circle\" onClick={this.handleAddNewTag} />\n        </div>\n\n        <hr className=\"tags-editor__separator\" />\n\n        <h2 className=\"tags-editor__title\">All tags</h2>\n\n        <div className=\"all-tags-container\">\n          {allTags\n            .filter(tag => !!tag)\n            .map(tag => {\n              const className = classNames('all-tags__tag', {\n                'all-tags__tag--in-use': headerTags.includes(tag),\n              });\n\n              return (\n                <div className={className} key={tag} onClick={this.handleExistingTagClick(tag)}>\n                  {tag}\n                </div>\n              );\n            })}\n        </div>\n      </Drawer>\n    );\n  }\n}\n","import React from 'react';\n\nimport './stylesheet.css';\n\nimport classNames from 'classnames';\n\nexport default ({ buttons, selectedButton, useEqualWidthTabs, onSelect }) => {\n  const handleButtonClick = buttonName => () => onSelect(buttonName);\n\n  const containerClassName = classNames('tab-buttons', {\n    'tab-buttons--equal-width-tabs': useEqualWidthTabs,\n  });\n\n  const style = {\n    gridTemplateColumns: useEqualWidthTabs ? `repeat(${buttons.length}, 1fr)` : null,\n  };\n\n  return (\n    <div className={containerClassName} style={style}>\n      {buttons.map(buttonName => {\n        const className = classNames('tab-buttons__btn', {\n          'tab-buttons__btn--selected': buttonName === selectedButton,\n        });\n\n        return (\n          <div key={buttonName} className={className} onClick={handleButtonClick(buttonName)}>\n            {buttonName}\n          </div>\n        );\n      })}\n    </div>\n  );\n};\n","import React, { PureComponent, Fragment } from 'react';\n\nimport './stylesheet.css';\n\nimport Switch from '../../../../../UI/Switch/';\nimport TabButtons from '../../../../../UI/TabButtons/';\n\nimport { renderAsText } from '../../../../../../lib/timestamps';\n\nimport _ from 'lodash';\nimport parseDate from 'date-fns/parse';\nimport formatDate from 'date-fns/format';\n\nexport default class TimestampEditor extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, [\n      'handleActiveToggle',\n      'handleDateChange',\n      'handleAddRepeater',\n      'handleRemoveRepeater',\n      'handleRepeaterTypeChange',\n      'handleRepeaterValueChange',\n      'handleRepeaterUnitChange',\n      'handleAddDelay',\n      'handleRemoveDelay',\n      'handleDelayTypeChange',\n      'handleDelayValueChange',\n      'handleDelayUnitChange',\n    ]);\n  }\n\n  handleActiveToggle() {\n    this.props.onChange(this.props.timestamp.update('isActive', isActive => !isActive));\n  }\n\n  handleDateChange(event) {\n    const { onChange, timestamp } = this.props;\n\n    const [newYear, newMonth, newDay, newDayName] = formatDate(\n      parseDate(event.target.value),\n      'YYYY MM DD ddd'\n    ).split(' ');\n    onChange(\n      timestamp\n        .set('year', newYear)\n        .set('month', newMonth)\n        .set('day', newDay)\n        .set('dayName', newDayName)\n    );\n  }\n\n  handleAddTime(startOrEnd) {\n    return () => {\n      const { onChange, timestamp } = this.props;\n\n      const [hourKey, minuteKey] =\n        startOrEnd === 'start' ? ['startHour', 'startMinute'] : ['endHour', 'endMinute'];\n      const [hour, minute] = formatDate(new Date(), 'HH:mm').split(':');\n      onChange(timestamp.set(hourKey, hour).set(minuteKey, minute));\n    };\n  }\n\n  handleRemoveTime(startOrEnd) {\n    return () => {\n      const { onChange, timestamp } = this.props;\n\n      const [hourKey, minuteKey] =\n        startOrEnd === 'start' ? ['startHour', 'startMinute'] : ['endHour', 'endMinute'];\n      onChange(timestamp.set(hourKey, null).set(minuteKey, null));\n    };\n  }\n\n  handleTimeChange(startOrEnd) {\n    return event => {\n      const { onChange, timestamp } = this.props;\n\n      const [hourKey, minuteKey] =\n        startOrEnd === 'start' ? ['startHour', 'startMinute'] : ['endHour', 'endMinute'];\n      let [hour, minute] = event.target.value.split(':');\n      hour = hour.startsWith('0') ? hour.substring(1) : hour;\n      onChange(timestamp.set(hourKey, hour).set(minuteKey, minute));\n    };\n  }\n\n  handleAddRepeater() {\n    const { onChange, timestamp } = this.props;\n    onChange(timestamp.set('repeaterType', '+').set('repeaterValue', 1).set('repeaterUnit', 'h'));\n  }\n\n  handleRemoveRepeater() {\n    const { onChange, timestamp } = this.props;\n    onChange(\n      timestamp.set('repeaterType', null).set('repeaterValue', null).set('repeaterUnit', null)\n    );\n  }\n\n  handleRepeaterTypeChange(newRepeaterType) {\n    const { onChange, timestamp } = this.props;\n    onChange(timestamp.set('repeaterType', newRepeaterType));\n  }\n\n  handleRepeaterValueChange(event) {\n    const { onChange, timestamp } = this.props;\n    onChange(timestamp.set('repeaterValue', event.target.value));\n  }\n\n  handleRepeaterUnitChange(newRepeaterUnit) {\n    const { onChange, timestamp } = this.props;\n    onChange(timestamp.set('repeaterUnit', newRepeaterUnit));\n  }\n\n  handleAddDelay() {\n    const { onChange, timestamp } = this.props;\n    onChange(timestamp.set('delayType', '-').set('delayValue', 1).set('delayUnit', 'h'));\n  }\n\n  handleRemoveDelay() {\n    const { onChange, timestamp } = this.props;\n    onChange(timestamp.set('delayType', null).set('delayValue', null).set('delayUnit', null));\n  }\n\n  handleDelayTypeChange(newDelayType) {\n    const { onChange, timestamp } = this.props;\n    onChange(timestamp.set('delayType', newDelayType));\n  }\n\n  handleDelayValueChange(event) {\n    const { onChange, timestamp } = this.props;\n    onChange(timestamp.set('delayValue', event.target.value));\n  }\n\n  handleDelayUnitChange(newDelayUnit) {\n    const { onChange, timestamp } = this.props;\n    onChange(timestamp.set('delayUnit', newDelayUnit));\n  }\n\n  renderTimeField(label, timeKey, hour, minute, showRemoveButton = true) {\n    return (\n      <div className=\"timestamp-editor__field-container timestamp-editor__field-container--inline\">\n        <div className=\"timestamp-editor__field-title\">{label}</div>\n        <div className=\"timestamp-editor__field\">\n          {!!hour ? (\n            <Fragment>\n              <input\n                type=\"time\"\n                className=\"timestamp-editor__time-input\"\n                value={`${hour.padStart(2, '0')}:${minute.padStart(2, '0')}`}\n                onChange={this.handleTimeChange(timeKey)}\n              />\n              {showRemoveButton && (\n                <i\n                  className=\"fas fa-times fa-lg timestamp-editor__icon timestamp-editor__icon--remove\"\n                  onClick={this.handleRemoveTime(timeKey)}\n                />\n              )}\n            </Fragment>\n          ) : (\n            <i\n              className=\"fas fa-plus timestamp-editor__icon timestamp-editor__icon--add\"\n              onClick={this.handleAddTime(timeKey)}\n            />\n          )}\n        </div>\n      </div>\n    );\n  }\n\n  renderRepeater() {\n    const { repeaterType, repeaterValue, repeaterUnit } = this.props.timestamp.toJS();\n\n    return (\n      <div className=\"timestamp-editor__field-container\">\n        <div className=\"timestamp-editor__field-title\">Repeater</div>\n        <div className=\"timestamp-editor__field timestamp-editor__field--delay-repeater\">\n          {!!repeaterType ? (\n            <Fragment>\n              <div className=\"timestamp-editor__delay-repeater-type\">\n                <TabButtons\n                  buttons={['+', '++', '.+']}\n                  selectedButton={repeaterType || '+'}\n                  onSelect={this.handleRepeaterTypeChange}\n                />\n              </div>\n              <input\n                type=\"number\"\n                min=\"1\"\n                className=\"textfield delay-repeater-value-input\"\n                value={repeaterValue || 1}\n                onChange={this.handleRepeaterValueChange}\n              />\n              <div>\n                <TabButtons\n                  buttons={'hdwmy'.split('')}\n                  selectedButton={repeaterUnit || 'h'}\n                  onSelect={this.handleRepeaterUnitChange}\n                />\n              </div>\n              <i\n                className=\"fas fa-times fa-lg timestamp-editor__icon timestamp-editor__icon--remove\"\n                onClick={this.handleRemoveRepeater}\n              />\n            </Fragment>\n          ) : (\n            <i\n              className=\"fas fa-plus timestamp-editor__icon timestamp-editor__icon--add\"\n              onClick={this.handleAddRepeater}\n            />\n          )}\n        </div>\n      </div>\n    );\n  }\n\n  renderDelay() {\n    const { delayType, delayValue, delayUnit } = this.props.timestamp.toJS();\n\n    return (\n      <div className=\"timestamp-editor__field-container\">\n        <div className=\"timestamp-editor__field-title\">Delay</div>\n        <div className=\"timestamp-editor__field\">\n          {!!delayType ? (\n            <Fragment>\n              <div className=\"timestamp-editor__delay-repeater-type\">\n                <TabButtons\n                  buttons={['-', '--']}\n                  selectedButton={delayType || '-'}\n                  onSelect={this.handleDelayTypeChange}\n                />\n              </div>\n              <input\n                type=\"number\"\n                min=\"1\"\n                className=\"textfield delay-repeater-value-input\"\n                value={delayValue || 1}\n                onChange={this.handleDelayValueChange}\n              />\n              <div>\n                <TabButtons\n                  buttons={'hdwmy'.split('')}\n                  selectedButton={delayUnit || 'h'}\n                  onSelect={this.handleDelayUnitChange}\n                />\n              </div>\n              <i\n                className=\"fas fa-times fa-lg timestamp-editor__icon timestamp-editor__icon--remove\"\n                onClick={this.handleRemoveDelay}\n              />\n            </Fragment>\n          ) : (\n            <i\n              className=\"fas fa-plus timestamp-editor__icon timestamp-editor__icon--add\"\n              onClick={this.handleAddDelay}\n            />\n          )}\n        </div>\n      </div>\n    );\n  }\n\n  render() {\n    const { timestamp } = this.props;\n    const { isActive, year, month, day, startHour, startMinute, endHour, endMinute } =\n      timestamp.toJS();\n\n    return (\n      <div>\n        <div className=\"timestamp-editor__render\">{renderAsText(timestamp)}</div>\n\n        <div className=\"timestamp-editor__date-time-fields-container\">\n          <div className=\"timestamp-editor__field-container timestamp-editor__field-container--inline\">\n            <div className=\"timestamp-editor__field-title\">Active</div>\n            <div className=\"timestamp-editor__field\">\n              <Switch isEnabled={isActive} onToggle={this.handleActiveToggle} />\n            </div>\n          </div>\n\n          <div className=\"timestamp-editor__field-container timestamp-editor__field-container--inline\">\n            <div className=\"timestamp-editor__field-title\">Date</div>\n            <div className=\"timestamp-editor__field\">\n              <input\n                type=\"date\"\n                className=\"timestamp-editor__date-input\"\n                onChange={this.handleDateChange}\n                value={`${year}-${month}-${day}`}\n              />\n            </div>\n          </div>\n\n          {this.renderTimeField('Start time', 'start', startHour, startMinute, !endHour)}\n          {!!startHour && this.renderTimeField('End time', 'end', endHour, endMinute)}\n        </div>\n\n        {this.renderRepeater()}\n        {this.renderDelay()}\n      </div>\n    );\n  }\n}\n","import React, { PureComponent, Fragment } from 'react';\n\nimport './stylesheet.css';\n\nimport TimestampEditor from './components/TimestampEditor';\nimport Drawer from '../../../UI/Drawer/';\n\nimport _ from 'lodash';\nimport formatDate from 'date-fns/format';\nimport { Map } from 'immutable';\n\nexport default class TimestampEditorModal extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, ['handleAddEndTimestamp', 'handleRemoveEndTimestamp']);\n  }\n\n  handleChange(key) {\n    return newTimestamp => this.props.onChange(this.props.timestamp.set(key, newTimestamp));\n  }\n\n  handleAddEndTimestamp() {\n    const { timestamp } = this.props;\n    const [year, month, day, dayName] = formatDate(new Date(), 'YYYY MM DD ddd').split(' ');\n    this.props.onChange(\n      timestamp.set(\n        'secondTimestamp',\n        Map({\n          year,\n          month,\n          day,\n          dayName,\n          isActive: timestamp.getIn(['firstTimestamp', 'isActive']),\n        })\n      )\n    );\n  }\n\n  handleRemoveEndTimestamp() {\n    this.props.onChange(this.props.timestamp.set('secondTimestamp', null));\n  }\n\n  render() {\n    const { timestamp, onClose, singleTimestampOnly } = this.props;\n\n    return (\n      <Drawer onClose={onClose}>\n        <h2 className=\"timestamp-editor__title\">Edit timestamp</h2>\n\n        <TimestampEditor\n          timestamp={timestamp.get('firstTimestamp')}\n          onChange={this.handleChange('firstTimestamp')}\n        />\n\n        {!singleTimestampOnly &&\n          (!!timestamp.get('secondTimestamp') ? (\n            <Fragment>\n              <div className=\"timestamp-editor__separator\">\n                <div className=\"timestamp-editor__separator__margin-line\" />\n                to\n                <div className=\"timestamp-editor__separator__margin-line\" />\n              </div>\n\n              <TimestampEditor\n                timestamp={timestamp.get('secondTimestamp')}\n                onChange={this.handleChange('secondTimestamp')}\n              />\n\n              <div className=\"timestamp-editor__button-container\">\n                <button\n                  className=\"btn timestamp-editor__add-new-button\"\n                  onClick={this.handleRemoveEndTimestamp}\n                >\n                  Remove end timestamp\n                </button>\n              </div>\n            </Fragment>\n          ) : (\n            <div className=\"timestamp-editor__button-container\">\n              <button\n                className=\"btn timestamp-editor__add-new-button\"\n                onClick={this.handleAddEndTimestamp}\n              >\n                Add end timestamp\n              </button>\n            </div>\n          ))}\n\n        <br />\n      </Drawer>\n    );\n  }\n}\n","import React, { PureComponent, Fragment } from 'react';\n\nimport './stylesheet.css';\n\nimport Drawer from '../../../UI/Drawer';\n\nimport { attributedStringToRawText } from '../../../../lib/export_org';\nimport generateId from '../../../../lib/id_generator';\nimport { parseMarkupAndCookies } from '../../../../lib/parse_org';\n\nimport { Droppable, Draggable } from 'react-beautiful-dnd';\nimport classNames from 'classnames';\nimport { fromJS } from 'immutable';\nimport _ from 'lodash';\n\nexport default class PropertyListEditorModal extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, ['handleAddNewItem']);\n  }\n\n  componentDidUpdate(prevProps) {\n    const prevItems = prevProps.propertyListItems;\n    const currentItems = this.props.propertyListItems;\n    if (prevItems.size === currentItems.size - 1 && currentItems.last().get('property') === '') {\n      if (this.lastTextfield) {\n        this.lastTextfield.focus();\n      }\n    }\n  }\n\n  handlePropertyChange(propertyListItemId) {\n    return event => {\n      const propertyListItemIndex = this.props.propertyListItems.findIndex(\n        propertyListItem => propertyListItem.get('id') === propertyListItemId\n      );\n      this.props.onChange(\n        this.props.propertyListItems.setIn([propertyListItemIndex, 'property'], event.target.value)\n      );\n    };\n  }\n\n  handleValueChange(propertyListItemId) {\n    return event => {\n      const { propertyListItems, onChange } = this.props;\n\n      const propertyListItemIndex = propertyListItems.findIndex(\n        propertyListItem => propertyListItem.get('id') === propertyListItemId\n      );\n      onChange(\n        propertyListItems.setIn(\n          [propertyListItemIndex, 'value'],\n          fromJS(parseMarkupAndCookies(event.target.value))\n        )\n      );\n    };\n  }\n\n  handleRemoveItem(propertyListItemId) {\n    return () =>\n      this.props.onChange(\n        this.props.propertyListItems.filter(\n          propertyListItem => propertyListItem.get('id') !== propertyListItemId\n        )\n      );\n  }\n\n  handleAddNewItem() {\n    this.props.onChange(\n      this.props.propertyListItems.push(\n        fromJS({\n          property: '',\n          value: '',\n          id: generateId(),\n        })\n      )\n    );\n  }\n\n  render() {\n    const { onClose, propertyListItems } = this.props;\n\n    return (\n      <Drawer onClose={onClose}>\n        <h2 className=\"drawer-modal__title\">Edit property list</h2>\n\n        {propertyListItems.size === 0 ? (\n          <div className=\"no-items-message\">\n            There are no items in this property list.\n            <br />\n            <br />\n            Click the <i className=\"fas fa-plus\" /> button to add a new one.\n          </div>\n        ) : (\n          <Droppable droppableId=\"property-list-editor-droppable\" type=\"PROPERTY-LIST\">\n            {(provided, snapshot) => (\n              <div\n                className=\"property-list-editor__items-container\"\n                ref={provided.innerRef}\n                {...provided.droppableProps}\n              >\n                <Fragment>\n                  {propertyListItems.map((propertyListItem, index) => (\n                    <Draggable\n                      draggableId={`property-list-item--${index}`}\n                      index={index}\n                      key={propertyListItem.get('id')}\n                    >\n                      {(provided, snapshot) => (\n                        <div\n                          className={classNames('property-list-editor__item-container', {\n                            'property-list-editor__item-container--dragging': snapshot.isDragging,\n                          })}\n                          ref={provided.innerRef}\n                          {...provided.draggableProps}\n                        >\n                          <div className=\"item__textfields-container\">\n                            <input\n                              type=\"text\"\n                              className=\"textfield item-container__textfield\"\n                              value={propertyListItem.get('property')}\n                              onChange={this.handlePropertyChange(propertyListItem.get('id'))}\n                              ref={textfield => (this.lastTextfield = textfield)}\n                            />\n                            <input\n                              type=\"text\"\n                              className=\"textfield item-container__textfield\"\n                              value={attributedStringToRawText(propertyListItem.get('value'))}\n                              onChange={this.handleValueChange(propertyListItem.get('id'))}\n                            />\n                          </div>\n                          <div className=\"item-container__actions-container\">\n                            <i\n                              className=\"fas fa-times fa-lg\"\n                              onClick={this.handleRemoveItem(propertyListItem.get('id'))}\n                            />\n                            <i\n                              className=\"fas fa-bars fa-lg item-container__drag-handle drag-handle\"\n                              {...provided.dragHandleProps}\n                            />\n                          </div>\n                        </div>\n                      )}\n                    </Draggable>\n                  ))}\n\n                  {provided.placeholder}\n                </Fragment>\n              </div>\n            )}\n          </Droppable>\n        )}\n\n        <div className=\"property-list-editor__add-new-container\">\n          <button className=\"fas fa-plus fa-lg btn btn--circle\" onClick={this.handleAddNewItem} />\n        </div>\n      </Drawer>\n    );\n  }\n}\n","import React, { PureComponent, Fragment } from 'react';\n\nimport './stylesheet.css';\n\nimport TitleLine from '../../../TitleLine';\n\nimport { isTodoKeywordCompleted } from '../../../../../../lib/org_utils';\nimport {\n  dateForTimestamp,\n  subtractTimestampUnitFromDate,\n  addTimestampUnitToDate,\n} from '../../../../../../lib/timestamps';\n\nimport {\n  isToday,\n  startOfDay,\n  endOfDay,\n  isBefore,\n  isAfter,\n  isEqual,\n  isWithinRange,\n  isPast,\n  distanceInWordsToNow,\n} from 'date-fns';\nimport formatDate from 'date-fns/format';\nimport classNames from 'classnames';\n\nexport default class AgendaDay extends PureComponent {\n  handleHeaderClick(headerId) {\n    return () => this.props.onHeaderClick(headerId);\n  }\n\n  render() {\n    const {\n      date,\n      headers,\n      todoKeywordSets,\n      dateDisplayType,\n      onToggleDateDisplayType,\n      agendaDefaultDeadlineDelayValue,\n      agendaDefaultDeadlineDelayUnit,\n    } = this.props;\n\n    const dateStart = startOfDay(date);\n    const dateEnd = endOfDay(date);\n\n    const planningItemsAndHeaders = headers\n      .flatMap(header => {\n        const planningItemsforDate = header.get('planningItems').filter(planningItem => {\n          const timestamp = planningItem.get('timestamp');\n          if (!timestamp.get('isActive')) {\n            return false;\n          }\n\n          const planningItemDate = dateForTimestamp(timestamp);\n          const isCompletedTodo =\n            !!header.getIn(['titleLine', 'todoKeyword']) &&\n            isTodoKeywordCompleted(todoKeywordSets, header.getIn(['titleLine', 'todoKeyword']));\n          if (isCompletedTodo) {\n            return false;\n          }\n\n          if (planningItem.get('type') === 'DEADLINE') {\n            if (isToday(date)) {\n              if (isBefore(planningItemDate, new Date())) {\n                return true;\n              }\n\n              const [delayValue, delayUnit] = !!timestamp.get('delayType')\n                ? [timestamp.get('delayValue'), timestamp.get('delayUnit')]\n                : [agendaDefaultDeadlineDelayValue, agendaDefaultDeadlineDelayUnit];\n\n              const appearDate = subtractTimestampUnitFromDate(\n                planningItemDate,\n                delayValue,\n                delayUnit\n              );\n              return isAfter(date, appearDate) || isEqual(date, appearDate);\n            } else {\n              return isWithinRange(planningItemDate, dateStart, dateEnd);\n            }\n          } else if (planningItem.get('type') === 'SCHEDULED') {\n            let appearDate = planningItemDate;\n            if (!!timestamp.get('delayType')) {\n              const hasBeenRepeated = header\n                .get('propertyListItems')\n                .some(propertyListItem => propertyListItem.get('property') === 'LAST_REPEAT');\n              if (timestamp.get('delayType') === '--' && !hasBeenRepeated) {\n                appearDate = addTimestampUnitToDate(\n                  planningItemDate,\n                  timestamp.get('delayValue'),\n                  timestamp.get('delayUnit')\n                );\n              }\n            }\n\n            if (isToday(date) && isAfter(date, appearDate)) {\n              return true;\n            }\n\n            return isWithinRange(appearDate, dateStart, dateEnd);\n          } else {\n            return false;\n          }\n        });\n\n        return planningItemsforDate.map(planningItem => [planningItem, header]);\n      })\n      .sortBy(([planningItem, header]) => {\n        const { startHour, startMinute, endHour, endMinute, month, day } = planningItem\n          .get('timestamp')\n          .toJS();\n\n        return [!!startHour ? 0 : 1, startHour, startMinute, endHour, endMinute, month, day];\n      });\n\n    return (\n      <div className=\"agenda-day__container\">\n        <div className=\"agenda-day__title\">\n          {isToday(date) && <div className=\"agenda-day__today-indicator\" />}\n          <div className=\"agenda-day__title__day-name\">{formatDate(date, 'dddd')}</div>\n          <div className=\"agenda-day__title__date\">{formatDate(date, 'MMMM Do, YYYY')}</div>\n        </div>\n\n        <div className=\"agenda-day__headers-container\">\n          {planningItemsAndHeaders.map(([planningItem, header]) => {\n            const planningItemDate = dateForTimestamp(planningItem.get('timestamp'));\n            const hasTodoKeyword = !!header.getIn(['titleLine', 'todoKeyword']);\n\n            const dateClassName = classNames('agenda-day__header-planning-date', {\n              'agenda-day__header-planning-date--overdue':\n                hasTodoKeyword && isPast(planningItemDate),\n            });\n\n            return (\n              <div key={planningItem.get('id')} className=\"agenda-day__header-container\">\n                <div className=\"agenda-day__header__planning-item-container\">\n                  <div className=\"agenda-day__header-planning-type\">{planningItem.get('type')}</div>\n                  <div className={dateClassName} onClick={onToggleDateDisplayType}>\n                    {dateDisplayType === 'absolute'\n                      ? formatDate(planningItemDate, 'MM/DD')\n                      : `${distanceInWordsToNow(planningItemDate)} ago`}\n\n                    {!!planningItem.getIn(['timestamp', 'startHour']) && (\n                      <Fragment>\n                        <br />\n                        {formatDate(planningItemDate, 'h:mma')}\n                      </Fragment>\n                    )}\n                  </div>\n                </div>\n                <div className=\"agenda-day__header__header-container\">\n                  <TitleLine\n                    header={header}\n                    color=\"black\"\n                    hasContent={false}\n                    isSelected={false}\n                    shouldDisableActions\n                    shouldDisableExplicitWidth\n                    onClick={this.handleHeaderClick(header.get('id'))}\n                  />\n                </div>\n              </div>\n            );\n          })}\n        </div>\n      </div>\n    );\n  }\n}\n","import React, { PureComponent } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport './stylesheet.css';\n\nimport AgendaDay from './components/AgendaDay';\nimport Drawer from '../../../UI/Drawer';\nimport TabButtons from '../../../UI/TabButtons';\n\nimport * as orgActions from '../../../../actions/org';\n\nimport _ from 'lodash';\nimport {\n  addDays,\n  addWeeks,\n  addMonths,\n  subDays,\n  subWeeks,\n  subMonths,\n  startOfWeek,\n  startOfMonth,\n  getDaysInMonth,\n} from 'date-fns';\nimport formatDate from 'date-fns/format';\n\nclass AgendaModal extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, [\n      'handleTimeframeTypeChange',\n      'handleNextDateClick',\n      'handlePreviousDateClick',\n      'handleHeaderClick',\n      'handleToggleDateDisplayType',\n    ]);\n\n    this.state = {\n      selectedDate: new Date(),\n      timeframeType: 'Week',\n      dateDisplayType: 'absolute',\n    };\n  }\n\n  handleTimeframeTypeChange(timeframeType) {\n    this.setState({ timeframeType });\n  }\n\n  handleNextDateClick() {\n    const { selectedDate, timeframeType } = this.state;\n\n    switch (timeframeType) {\n      case 'Day':\n        this.setState({ selectedDate: addDays(selectedDate, 1) });\n        break;\n      case 'Week':\n        this.setState({ selectedDate: addWeeks(selectedDate, 1) });\n        break;\n      case 'Month':\n        this.setState({ selectedDate: addMonths(selectedDate, 1) });\n        break;\n      default:\n        return '';\n    }\n  }\n\n  handleHeaderClick(headerId) {\n    this.props.onClose();\n    this.props.org.selectHeaderAndOpenParents(headerId);\n  }\n\n  handlePreviousDateClick() {\n    const { selectedDate, timeframeType } = this.state;\n\n    switch (timeframeType) {\n      case 'Day':\n        this.setState({ selectedDate: subDays(selectedDate, 1) });\n        break;\n      case 'Week':\n        this.setState({ selectedDate: subWeeks(selectedDate, 1) });\n        break;\n      case 'Month':\n        this.setState({ selectedDate: subMonths(selectedDate, 1) });\n        break;\n      default:\n        return '';\n    }\n  }\n\n  handleToggleDateDisplayType() {\n    const { dateDisplayType } = this.state;\n\n    this.setState({\n      dateDisplayType: dateDisplayType === 'absolute' ? 'relative' : 'absolute',\n    });\n  }\n\n  calculateTimeframeHeader() {\n    const { selectedDate, timeframeType } = this.state;\n\n    switch (timeframeType) {\n      case 'Day':\n        return formatDate(selectedDate, 'MMMM Do');\n      case 'Week':\n        const weekStart = startOfWeek(selectedDate);\n        const weekEnd = addWeeks(weekStart, 1);\n        return `${formatDate(weekStart, 'MMM Do')} - ${formatDate(\n          weekEnd,\n          'MMM Do'\n        )} (W${formatDate(weekStart, 'W')})`;\n      case 'Month':\n        return formatDate(selectedDate, 'MMMM');\n      default:\n        return '';\n    }\n  }\n\n  render() {\n    const {\n      onClose,\n      headers,\n      todoKeywordSets,\n      agendaDefaultDeadlineDelayValue,\n      agendaDefaultDeadlineDelayUnit,\n    } = this.props;\n    const { timeframeType, selectedDate, dateDisplayType } = this.state;\n\n    let dates = [];\n    switch (timeframeType) {\n      case 'Day':\n        dates = [selectedDate];\n        break;\n      case 'Week':\n        const weekStart = startOfWeek(selectedDate);\n        dates = _.range(7).map(daysAfter => addDays(weekStart, daysAfter));\n        break;\n      case 'Month':\n        const monthStart = startOfMonth(selectedDate);\n        dates = _.range(getDaysInMonth(selectedDate)).map(daysAfter =>\n          addDays(monthStart, daysAfter)\n        );\n        break;\n      default:\n    }\n\n    return (\n      <Drawer onClose={onClose}>\n        <h2 className=\"agenda__title\">Agenda</h2>\n\n        <div className=\"agenda__tab-container\">\n          <TabButtons\n            buttons={['Day', 'Week', 'Month']}\n            selectedButton={timeframeType}\n            onSelect={this.handleTimeframeTypeChange}\n            useEqualWidthTabs\n          />\n        </div>\n\n        <div className=\"agenda__timeframe-header-container\">\n          <i className=\"fas fa-chevron-left fa-lg\" onClick={this.handlePreviousDateClick} />\n          <div className=\"agenda__timeframe-header\">{this.calculateTimeframeHeader()}</div>\n          <i className=\"fas fa-chevron-right fa-lg\" onClick={this.handleNextDateClick} />\n        </div>\n\n        <div className=\"agenda__days-container\">\n          {dates.map(date => (\n            <AgendaDay\n              key={formatDate(date)}\n              date={date}\n              headers={headers}\n              onHeaderClick={this.handleHeaderClick}\n              todoKeywordSets={todoKeywordSets}\n              dateDisplayType={dateDisplayType}\n              onToggleDateDisplayType={this.handleToggleDateDisplayType}\n              agendaDefaultDeadlineDelayValue={agendaDefaultDeadlineDelayValue}\n              agendaDefaultDeadlineDelayUnit={agendaDefaultDeadlineDelayUnit}\n            />\n          ))}\n        </div>\n\n        <br />\n      </Drawer>\n    );\n  }\n}\n\nconst mapStateToProps = state => ({\n  todoKeywordSets: state.org.present.get('todoKeywordSets'),\n  agendaDefaultDeadlineDelayValue: state.base.get('agendaDefaultDeadlineDelayValue') || 5,\n  agendaDefaultDeadlineDelayUnit: state.base.get('agendaDefaultDeadlineDelayUnit') || 'd',\n});\n\nconst mapDispatchToProps = dispatch => ({\n  org: bindActionCreators(orgActions, dispatch),\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(AgendaModal);\n","const DEFAULT_BINDINGS = [\n  ['Select next header', 'selectNextVisibleHeader', 'ctrl+n'],\n  ['Select previous header', 'selectPreviousVisibleHeader', 'ctrl+p'],\n  ['Toggle header opened', 'toggleHeaderOpened', 'tab'],\n  ['Advance todo state', 'advanceTodo', 'ctrl+t'],\n  ['Edit title', 'editTitle', 'ctrl+h'],\n  ['Edit description', 'editDescription', 'ctrl+d'],\n  ['Exit edit mode', 'exitEditMode', 'command+enter'],\n  ['Add header', 'addHeader', 'ctrl+enter'],\n  ['Remove header', 'removeHeader', 'backspace'],\n  ['Move header up', 'moveHeaderUp', 'ctrl+command+p'],\n  ['Move header down', 'moveHeaderDown', 'ctrl+command+n'],\n  ['Move header left', 'moveHeaderLeft', 'ctrl+command+b'],\n  ['Move header right', 'moveHeaderRight', 'ctrl+command+f'],\n  ['Undo', 'undo', 'ctrl+shift+-'],\n];\n\nexport const calculateNamedKeybindings = customKeybindings =>\n  DEFAULT_BINDINGS.map(([bindingName, _bindingAction, binding]) => [\n    bindingName,\n    customKeybindings.get(bindingName, binding),\n  ]);\n\nexport const calculateActionedKeybindings = customKeybindings =>\n  DEFAULT_BINDINGS.map(([bindingName, bindingAction, binding]) => [\n    bindingAction,\n    customKeybindings.get(bindingName, binding),\n  ]);\n","/* global ga */\n\nimport React, { PureComponent, Fragment } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport { Redirect } from 'react-router-dom';\n\nimport { HotKeys } from 'react-hotkeys';\n\nimport './stylesheet.css';\n\nimport HeaderList from './components/HeaderList';\nimport ActionDrawer from './components/ActionDrawer';\nimport CaptureModal from './components/CaptureModal';\nimport SyncConfirmationModal from './components/SyncConfirmationModal';\nimport TagsEditorModal from './components/TagsEditorModal';\nimport TimestampEditorModal from './components/TimestampEditorModal';\nimport PropertyListEditorModal from './components/PropertyListEditorModal';\nimport AgendaModal from './components/AgendaModal';\n\nimport * as baseActions from '../../actions/base';\nimport * as syncBackendActions from '../../actions/sync_backend';\nimport * as orgActions from '../../actions/org';\nimport * as captureActions from '../../actions/capture';\nimport { ActionCreators as undoActions } from 'redux-linear-undo';\n\nimport sampleCaptureTemplates from '../../lib/sample_capture_templates';\nimport { calculateActionedKeybindings } from '../../lib/keybindings';\nimport { timestampWithId, headerWithId } from '../../lib/org_utils';\n\nimport _ from 'lodash';\nimport { fromJS, OrderedSet } from 'immutable';\n\nclass OrgFile extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, [\n      'handleSelectNextVisibleHeaderHotKey',\n      'handleSelectPreviousVisibleHeaderHotKey',\n      'handleToggleHeaderOpenedHotKey',\n      'handleAdvanceTodoHotKey',\n      'handleEditTitleHotKey',\n      'handleEditDescriptionHotKey',\n      'handleExitEditModeHotKey',\n      'handleAddHeaderHotKey',\n      'handleRemoveHeaderHotKey',\n      'handleMoveHeaderUpHotKey',\n      'handleMoveHeaderDownHotKey',\n      'handleMoveHeaderLeftHotKey',\n      'handleMoveHeaderRightHotKey',\n      'handleUndoHotKey',\n      'handleContainerRef',\n      'handleCapture',\n      'handlePopupClose',\n      'handleSyncConfirmationPull',\n      'handleSyncConfirmationPush',\n      'handleSyncConfirmationCancel',\n      'handleTagsChange',\n      'handlePropertyListItemsChange',\n    ]);\n\n    this.state = {\n      hasUncaughtError: false,\n    };\n  }\n\n  componentDidMount() {\n    const { staticFile, path, loadedPath } = this.props;\n\n    if (!!staticFile) {\n      this.props.base.loadStaticFile(staticFile);\n\n      if (staticFile === 'changelog') {\n        this.props.base.setHasUnseenChangelog(false);\n      }\n\n      setTimeout(() => (document.querySelector('html').scrollTop = 0), 0);\n    } else if (!!path && path !== loadedPath) {\n      this.props.syncBackend.downloadFile(path);\n    }\n  }\n\n  componentWillUnmount() {\n    const { staticFile } = this.props;\n\n    if (!!staticFile) {\n      this.props.base.unloadStaticFile();\n    } else {\n      this.props.org.stopDisplayingFile();\n    }\n  }\n\n  componentDidUpdate() {\n    const { headers, pendingCapture } = this.props;\n    if (!!pendingCapture && !!headers && headers.size > 0) {\n      this.props.org.insertPendingCapture();\n    }\n  }\n\n  componentDidCatch(error) {\n    ga('send', 'event', 'error', 'OrgFile componentDidCatch', error);\n\n    this.setState({ hasUncaughtError: true });\n  }\n\n  handleSelectNextVisibleHeaderHotKey() {\n    this.props.org.selectNextVisibleHeader();\n  }\n\n  handleSelectPreviousVisibleHeaderHotKey() {\n    this.props.org.selectPreviousVisibleHeader();\n  }\n\n  handleToggleHeaderOpenedHotKey() {\n    const { selectedHeaderId } = this.props;\n\n    if (selectedHeaderId) {\n      this.props.org.toggleHeaderOpened(selectedHeaderId);\n    }\n  }\n\n  handleAdvanceTodoHotKey() {\n    this.props.org.advanceTodoState();\n  }\n\n  handleEditTitleHotKey() {\n    this.props.org.enterEditMode('title');\n  }\n\n  handleEditDescriptionHotKey() {\n    this.props.org.openHeader(this.props.selectedHeaderId);\n    this.props.org.enterEditMode('description');\n  }\n\n  handleExitEditModeHotKey() {\n    this.props.org.exitEditMode();\n    this.container.focus();\n  }\n\n  handleAddHeaderHotKey() {\n    this.props.org.addHeaderAndEdit(this.props.selectedHeaderId);\n  }\n\n  handleRemoveHeaderHotKey() {\n    const { selectedHeaderId } = this.props;\n\n    this.props.org.selectNextSiblingHeader(selectedHeaderId);\n    this.props.org.removeHeader(selectedHeaderId);\n  }\n\n  handleMoveHeaderUpHotKey() {\n    this.props.org.moveHeaderUp(this.props.selectedHeaderId);\n  }\n\n  handleMoveHeaderDownHotKey() {\n    this.props.org.moveHeaderDown(this.props.selectedHeaderId);\n  }\n\n  handleMoveHeaderLeftHotKey() {\n    this.props.org.moveHeaderLeft(this.props.selectedHeaderId);\n  }\n\n  handleMoveHeaderRightHotKey() {\n    this.props.org.moveHeaderRight(this.props.selectedHeaderId);\n  }\n\n  handleUndoHotKey() {\n    this.props.undo.undo();\n  }\n\n  handleContainerRef(container) {\n    this.container = container;\n    if (this.container) {\n      this.container.focus();\n    }\n  }\n\n  handleCapture(templateId, content, shouldPrepend) {\n    this.props.org.insertCapture(templateId, content, shouldPrepend);\n  }\n\n  handlePopupClose() {\n    this.props.base.closePopup();\n  }\n\n  handleSyncConfirmationPull() {\n    this.props.org.sync({ forceAction: 'pull' });\n    this.props.base.closePopup();\n  }\n\n  handleSyncConfirmationPush() {\n    this.props.org.sync({ forceAction: 'push' });\n    this.props.base.closePopup();\n  }\n\n  handleSyncConfirmationCancel() {\n    this.props.base.closePopup();\n  }\n\n  handleTagsChange(newTags) {\n    this.props.org.setHeaderTags(this.props.selectedHeaderId, newTags);\n  }\n\n  handlePropertyListItemsChange(newPropertyListItems) {\n    this.props.org.updatePropertyListItems(\n      this.props.activePopupData.get('headerId'),\n      newPropertyListItems\n    );\n  }\n\n  handleTimestampChange(popupData) {\n    if (!!popupData.get('timestampId')) {\n      return newTimestamp =>\n        this.props.org.updateTimestampWithId(popupData.get('timestampId'), newTimestamp);\n    } else {\n      return newTimestamp =>\n        this.props.org.updatePlanningItemTimestamp(\n          popupData.get('headerId'),\n          popupData.get('planningItemIndex'),\n          newTimestamp.get('firstTimestamp')\n        );\n    }\n  }\n\n  renderActivePopup() {\n    const { activePopupType, activePopupData, captureTemplates, headers, selectedHeader } =\n      this.props;\n\n    switch (activePopupType) {\n      case 'sync-confirmation':\n        return (\n          <SyncConfirmationModal\n            lastServerModifiedAt={activePopupData.get('lastServerModifiedAt')}\n            onPull={this.handleSyncConfirmationPull}\n            onPush={this.handleSyncConfirmationPush}\n            onCancel={this.handleSyncConfirmationCancel}\n          />\n        );\n      case 'capture':\n        return (\n          <CaptureModal\n            template={captureTemplates.find(\n              template => template.get('id') === activePopupData.get('templateId')\n            )}\n            headers={headers}\n            onCapture={this.handleCapture}\n            onClose={this.handlePopupClose}\n          />\n        );\n      case 'tags-editor':\n        return !!selectedHeader ? (\n          <TagsEditorModal\n            header={selectedHeader}\n            allTags={OrderedSet(\n              headers.flatMap(header => header.getIn(['titleLine', 'tags']))\n            ).sort()}\n            onClose={this.handlePopupClose}\n            onChange={this.handleTagsChange}\n          />\n        ) : null;\n      case 'timestamp-editor':\n        let editingTimestamp = null;\n        if (activePopupData.get('timestampId')) {\n          editingTimestamp = timestampWithId(headers, activePopupData.get('timestampId'));\n        } else {\n          editingTimestamp = fromJS({\n            firstTimestamp: headerWithId(headers, activePopupData.get('headerId')).getIn([\n              'planningItems',\n              activePopupData.get('planningItemIndex'),\n              'timestamp',\n            ]),\n          });\n        }\n\n        return (\n          <TimestampEditorModal\n            timestamp={editingTimestamp}\n            singleTimestampOnly={!activePopupData.get('timestampId')}\n            onClose={this.handlePopupClose}\n            onChange={this.handleTimestampChange(activePopupData)}\n          />\n        );\n\n      case 'property-list-editor':\n        return (\n          <PropertyListEditorModal\n            onClose={this.handlePopupClose}\n            onChange={this.handlePropertyListItemsChange}\n            propertyListItems={headerWithId(headers, activePopupData.get('headerId')).get(\n              'propertyListItems'\n            )}\n          />\n        );\n      case 'agenda':\n        return <AgendaModal onClose={this.handlePopupClose} headers={headers} />;\n      default:\n        return null;\n    }\n  }\n\n  render() {\n    const {\n      headers,\n      shouldDisableDirtyIndicator,\n      shouldDisableSyncButtons,\n      shouldDisableActions,\n      isDirty,\n      parsingErrorMessage,\n      path,\n      staticFile,\n      customKeybindings,\n      inEditMode,\n      orgFileErrorMessage,\n    } = this.props;\n\n    if (!path && !staticFile) {\n      return <Redirect to=\"/files\" />;\n    }\n\n    if (this.state.hasUncaughtError) {\n      return (\n        <div className=\"error-message-container\">\n          Uh oh, you ran into a bug!\n          <br />\n          <br />\n          This was probably the result of an error in attempting to parse your org file. It'd be\n          super helpful if you could{' '}\n          <a\n            href=\"https://github.com/DanielDe/org-web/issues/new\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n          >\n            create an issue\n          </a>{' '}\n          (and include the org file if possible!)\n        </div>\n      );\n    }\n\n    if (!!orgFileErrorMessage) {\n      return <div className=\"error-message-container\">{orgFileErrorMessage}</div>;\n    }\n\n    if (!headers) {\n      return <div />;\n    }\n\n    const keyMap = _.fromPairs(calculateActionedKeybindings(customKeybindings));\n\n    // Automatically call preventDefault on all the keyboard events that come through for\n    // these hotkeys.\n    const preventDefaultAndHandleEditMode =\n      (callback, ignoreInEditMode = false) =>\n      event => {\n        if (ignoreInEditMode && inEditMode) {\n          return;\n        }\n\n        if (ignoreInEditMode && ['TEXTAREA', 'INPUT'].includes(document.activeElement.nodeName)) {\n          return;\n        }\n\n        event.preventDefault();\n        callback(event);\n      };\n\n    const handlers = {\n      selectNextVisibleHeader: preventDefaultAndHandleEditMode(\n        this.handleSelectNextVisibleHeaderHotKey\n      ),\n      selectPreviousVisibleHeader: preventDefaultAndHandleEditMode(\n        this.handleSelectPreviousVisibleHeaderHotKey\n      ),\n      toggleHeaderOpened: preventDefaultAndHandleEditMode(\n        this.handleToggleHeaderOpenedHotKey,\n        true\n      ),\n      advanceTodo: preventDefaultAndHandleEditMode(this.handleAdvanceTodoHotKey),\n      editTitle: preventDefaultAndHandleEditMode(this.handleEditTitleHotKey),\n      editDescription: preventDefaultAndHandleEditMode(this.handleEditDescriptionHotKey),\n      exitEditMode: preventDefaultAndHandleEditMode(this.handleExitEditModeHotKey),\n      addHeader: preventDefaultAndHandleEditMode(this.handleAddHeaderHotKey),\n      removeHeader: preventDefaultAndHandleEditMode(this.handleRemoveHeaderHotKey, true),\n      moveHeaderUp: preventDefaultAndHandleEditMode(this.handleMoveHeaderUpHotKey),\n      moveHeaderDown: preventDefaultAndHandleEditMode(this.handleMoveHeaderDownHotKey),\n      moveHeaderLeft: preventDefaultAndHandleEditMode(this.handleMoveHeaderLeftHotKey),\n      moveHeaderRight: preventDefaultAndHandleEditMode(this.handleMoveHeaderRightHotKey),\n      undo: preventDefaultAndHandleEditMode(this.handleUndoHotKey),\n    };\n\n    return (\n      <HotKeys keyMap={keyMap} handlers={handlers}>\n        <div className=\"org-file-container\" tabIndex=\"-1\" ref={this.handleContainerRef}>\n          {headers.size === 0 ? (\n            <div className=\"org-file__parsing-error-message\">\n              <h3>Couldn't parse file</h3>\n\n              {!!parsingErrorMessage ? (\n                <Fragment>{parsingErrorMessage}</Fragment>\n              ) : (\n                <Fragment>\n                  If you think this is a bug, please{' '}\n                  <a\n                    href=\"https://github.com/DanielDe/org-web/issues/new\"\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                  >\n                    create an issue\n                  </a>{' '}\n                  and include the org file if possible!\n                </Fragment>\n              )}\n            </div>\n          ) : (\n            <HeaderList shouldDisableActions={shouldDisableActions} />\n          )}\n\n          {isDirty && !shouldDisableDirtyIndicator && (\n            <div className=\"dirty-indicator\">Unpushed changes</div>\n          )}\n\n          {!shouldDisableActions && (\n            <ActionDrawer\n              shouldDisableSyncButtons={shouldDisableSyncButtons}\n              staticFile={staticFile}\n            />\n          )}\n\n          {this.renderActivePopup()}\n        </div>\n      </HotKeys>\n    );\n  }\n}\n\nconst mapStateToProps = (state, props) => {\n  const headers = state.org.present.get('headers');\n  const selectedHeaderId = state.org.present.get('selectedHeaderId');\n  const activePopup = state.base.get('activePopup');\n\n  return {\n    headers,\n    selectedHeaderId,\n    isDirty: state.org.present.get('isDirty'),\n    loadedPath: state.org.present.get('path'),\n    selectedHeader: headers && headers.find(header => header.get('id') === selectedHeaderId),\n    customKeybindings: state.base.get('customKeybindings'),\n    inEditMode: !!state.org.present.get('editMode'),\n    activePopupType: !!activePopup ? activePopup.get('type') : null,\n    activePopupData: !!activePopup ? activePopup.get('data') : null,\n    captureTemplates: state.capture.get('captureTemplates').concat(sampleCaptureTemplates),\n    pendingCapture: state.org.present.get('pendingCapture'),\n    orgFileErrorMessage: state.org.present.get('orgFileErrorMessage'),\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    base: bindActionCreators(baseActions, dispatch),\n    syncBackend: bindActionCreators(syncBackendActions, dispatch),\n    org: bindActionCreators(orgActions, dispatch),\n    undo: bindActionCreators(undoActions, dispatch),\n    capture: bindActionCreators(captureActions, dispatch),\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(OrgFile);\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\nimport preval from 'preval.macro';\n\nimport { withRouter } from 'react-router-dom';\n\nimport * as syncBackendActions from '../../actions/sync_backend';\nimport * as baseActions from '../../actions/base';\n\nimport './stylesheet.css';\n\nimport TabButtons from '../UI/TabButtons';\nimport Switch from '../UI/Switch';\n\nconst Settings = ({\n  fontSize,\n  bulletStyle,\n  shouldTapTodoToAdvance,\n  shouldStoreSettingsInSyncBackend,\n  shouldLiveSync,\n  shouldSyncOnBecomingVisibile,\n  agendaDefaultDeadlineDelayValue,\n  agendaDefaultDeadlineDelayUnit,\n  hasUnseenChangelog,\n  syncBackend,\n  base,\n}) => {\n  const handleSignOutClick = () =>\n    window.confirm('Are you sure you want to sign out?') ? syncBackend.signOut() : void 0;\n\n  const handleKeyboardShortcutsClick = () => base.pushModalPage('keyboard_shortcuts_editor');\n\n  const handleCaptureTemplatesClick = () => base.pushModalPage('capture_templates_editor');\n\n  const handleFontSizeChange = newFontSize => base.setFontSize(newFontSize);\n\n  const handleBulletStyleChange = newBulletStyle => base.setBulletStyle(newBulletStyle);\n\n  const handleShouldTapTodoToAdvanceChange = () =>\n    base.setShouldTapTodoToAdvance(!shouldTapTodoToAdvance);\n\n  const handleAgendaDefaultDeadlineDelayValueChange = event =>\n    base.setAgendaDefaultDeadlineDelayValue(event.target.value);\n\n  const handleAgendaDefaultDeadlineDelayUnitChange = newDelayUnit =>\n    base.setAgendaDefaultDeadlineDelayUnit(newDelayUnit);\n\n  const handleShouldLiveSyncChange = () => base.setShouldLiveSync(!shouldLiveSync);\n\n  const handleShouldSyncOnBecomingVisibleChange = () =>\n    base.setShouldSyncOnBecomingVisibile(!shouldSyncOnBecomingVisibile);\n\n  const handleShouldStoreSettingsInSyncBackendChange = () =>\n    base.setShouldStoreSettingsInSyncBackend(!shouldStoreSettingsInSyncBackend);\n\n  const handleChangelogClick = () => base.pushModalPage('changelog');\n\n  const handleHelpClick = () => base.pushModalPage('sample');\n\n  const buildTimestamp = preval`module.exports = new Date().toLocaleString();`;\n\n  return (\n    <div className=\"settings-container\">\n      <div className=\"setting-container\">\n        <div className=\"setting-label\">Font size</div>\n        <TabButtons\n          buttons={['Regular', 'Large']}\n          selectedButton={fontSize}\n          onSelect={handleFontSizeChange}\n        />\n      </div>\n\n      <div className=\"setting-container\">\n        <div className=\"setting-label\">Bullet style</div>\n        <TabButtons\n          buttons={['Classic', 'Fancy']}\n          selectedButton={bulletStyle}\n          onSelect={handleBulletStyleChange}\n        />\n      </div>\n\n      <div className=\"setting-container\">\n        <div className=\"setting-label\">Tap TODO to advance state</div>\n        <Switch isEnabled={shouldTapTodoToAdvance} onToggle={handleShouldTapTodoToAdvanceChange} />\n      </div>\n\n      <div className=\"setting-container\">\n        <div className=\"setting-label\">\n          Live sync\n          <div className=\"setting-label__description\">\n            If enabled, changes are automatically pushed to the sync backend as you make them.\n          </div>\n        </div>\n        <Switch isEnabled={shouldLiveSync} onToggle={handleShouldLiveSyncChange} />\n      </div>\n\n      <div className=\"setting-container\">\n        <div className=\"setting-label\">\n          Sync on application becoming visible\n          <div className=\"setting-label__description\">\n            If enabled, the current org file is pulled from the sync backend when the browser tab\n            becomes visible. This prevents you from having a stale file before starting to make\n            changes to it.\n          </div>\n        </div>\n        <Switch\n          isEnabled={shouldSyncOnBecomingVisibile}\n          onToggle={handleShouldSyncOnBecomingVisibleChange}\n        />\n      </div>\n\n      <div className=\"setting-container\">\n        <div className=\"setting-label\">\n          Store settings in sync backend\n          <div className=\"setting-label__description\">\n            Store settings and keyboard shortcuts in a .org-web-config.json file in your sync\n            backend to sync betweeen multiple devices.\n          </div>\n        </div>\n        <Switch\n          isEnabled={shouldStoreSettingsInSyncBackend}\n          onToggle={handleShouldStoreSettingsInSyncBackendChange}\n        />\n      </div>\n\n      <div className=\"setting-container setting-container--vertical\">\n        <div className=\"setting-label\">Default DEADLINE warning period</div>\n\n        <div className=\"default-deadline-warning-container\">\n          <input\n            type=\"number\"\n            min=\"0\"\n            className=\"textfield default-deadline-value-textfield\"\n            value={agendaDefaultDeadlineDelayValue}\n            onChange={handleAgendaDefaultDeadlineDelayValueChange}\n          />\n\n          <TabButtons\n            buttons={'hdwmy'.split('')}\n            selectedButton={agendaDefaultDeadlineDelayUnit}\n            onSelect={handleAgendaDefaultDeadlineDelayUnitChange}\n          />\n        </div>\n      </div>\n      <div className=\"setting-container setting-container--vertical\">{buildTimestamp}</div>\n\n      <div className=\"settings-buttons-container\">\n        <button className=\"btn settings-btn\" onClick={handleCaptureTemplatesClick}>\n          Capture templates\n        </button>\n        <button className=\"btn settings-btn\" onClick={handleKeyboardShortcutsClick}>\n          Keyboard shortcuts\n        </button>\n\n        <hr className=\"settings-button-separator\" />\n\n        <button className=\"btn settings-btn\" onClick={handleChangelogClick}>\n          Changelog\n          {hasUnseenChangelog && (\n            <div className=\"changelog-badge-container\">\n              <i className=\"fas fa-gift\" />\n            </div>\n          )}\n        </button>\n        <button className=\"btn settings-btn\" onClick={handleHelpClick}>\n          Help\n        </button>\n        <button className=\"btn settings-btn\">\n          <a\n            href=\"https://github.com/DanielDe/org-web\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n            style={{ color: 'white' }}\n          >\n            Github repo <i className=\"fas fa-external-link-alt fa-sm\" />\n          </a>\n        </button>\n\n        <hr className=\"settings-button-separator\" />\n\n        <button className=\"btn settings-btn\">\n          <a\n            href=\"http://eepurl.com/dK5F9w\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n            style={{ color: 'white' }}\n          >\n            Mailing list <i className=\"fas fa-external-link-alt fa-sm\" />\n          </a>\n        </button>\n\n        <div className=\"settings-button-help-text\">\n          Sign up for the mailing list if you're interested in getting occasional ({'<'}1 per week)\n          updates on org-web. Or take a look at some{' '}\n          <a\n            href=\"https://us19.campaign-archive.com/home/?u=36b9d8082ddb55e6cc7e22339&id=f427625e31\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n          >\n            past emails\n          </a>{' '}\n          before you sign up. You can unsubscribe at any time!\n        </div>\n\n        <button className=\"btn settings-btn\">\n          <a\n            href=\"https://twitter.com/org_web_org\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n            style={{ color: 'white' }}\n          >\n            Twitter <i className=\"fas fa-external-link-alt fa-sm\" />\n          </a>\n        </button>\n\n        <hr className=\"settings-button-separator\" />\n\n        <button className=\"btn settings-btn\" onClick={handleSignOutClick}>\n          Sign out\n        </button>\n      </div>\n    </div>\n  );\n};\n\nconst mapStateToProps = (state, props) => {\n  return {\n    fontSize: state.base.get('fontSize') || 'Regular',\n    bulletStyle: state.base.get('bulletStyle') || 'Classic',\n    shouldTapTodoToAdvance: state.base.get('shouldTapTodoToAdvance'),\n    agendaDefaultDeadlineDelayValue: state.base.get('agendaDefaultDeadlineDelayValue') || 5,\n    agendaDefaultDeadlineDelayUnit: state.base.get('agendaDefaultDeadlineDelayUnit') || 'd',\n    shouldStoreSettingsInSyncBackend: state.base.get('shouldStoreSettingsInSyncBackend'),\n    shouldLiveSync: state.base.get('shouldLiveSync'),\n    shouldSyncOnBecomingVisibile: state.base.get('shouldSyncOnBecomingVisibile'),\n    hasUnseenChangelog: state.base.get('hasUnseenChangelog'),\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    syncBackend: bindActionCreators(syncBackendActions, dispatch),\n    base: bindActionCreators(baseActions, dispatch),\n  };\n};\n\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(Settings));\n","import React, { PureComponent } from 'react';\n\nimport './stylesheet.css';\n\nimport _ from 'lodash';\nimport classNames from 'classnames';\n\nexport default class ShortcutRow extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, ['handleRebindClick', 'handleKeyPress']);\n\n    this.state = {\n      isEditMode: false,\n    };\n  }\n\n  componentDidMount() {\n    this.rebindArea.addEventListener('blur', () => this.setState({ isEditMode: false }));\n  }\n\n  handleRebindClick() {\n    this.setState({ isEditMode: true });\n    document.addEventListener('keypress', this.handleKeyPress);\n  }\n\n  handleKeyPress(event) {\n    this.setState({ isEditMode: false });\n    document.removeEventListener('keypress', this.handleKeyPress);\n\n    let key = null;\n    if (event.code.startsWith('Key')) {\n      key = event.code.substr(3).toLowerCase();\n    } else if (event.code.startsWith('Digit')) {\n      key = event.code.substr(5);\n    } else {\n      key = {\n        Minus: '-',\n        Equal: '=',\n        Backspace: 'backspace',\n        Enter: 'enter',\n        Return: 'return',\n        Tab: 'tab',\n        BracketLeft: '[',\n        BracketRight: ']',\n        Semicolon: ';',\n        Quote: '\"',\n        Backslash: '\\\\',\n        Comma: ',',\n        Period: '.',\n        Slash: '/',\n      }[event.code];\n    }\n\n    if (!key) {\n      return;\n    }\n\n    const modifiers = [\n      ['ctrlKey', 'ctrl'],\n      ['altKey', 'alt'],\n      ['metaKey', 'meta'],\n      ['shiftKey', 'shift'],\n    ];\n\n    const newModifiers = modifiers\n      .filter(([modifier, _]) => event[modifier])\n      .map(([_, symbol]) => symbol)\n      .join('+');\n    const newBinding = `${newModifiers}${!!newModifiers ? '+' : ''}${key}`;\n\n    this.props.onBindingChange(this.props.name, newBinding);\n  }\n\n  symbolizeKeybinding(binding) {\n    if (!binding) {\n      return '';\n    }\n\n    const replacements = [\n      ['ctrl', '^'],\n      ['alt', ''],\n      ['option', ''],\n      ['command', ''],\n      ['meta', ''],\n      ['shift', ''],\n      ['backspace', ''],\n      ['return', ''],\n      ['enter', ''],\n      ['left', ''],\n      ['right', ''],\n      ['up', ''],\n      ['down', ''],\n    ];\n\n    return replacements.reduce(\n      (currentBinding, [name, symbol]) => currentBinding.replace(RegExp(`${name}\\\\+?`), symbol),\n      binding\n    );\n  }\n\n  render() {\n    const { name, binding } = this.props;\n    const { isEditMode } = this.state;\n\n    const rebindAreaClassName = classNames('keyboard-shortcut-container__shortcut-key', {\n      'keyboard-shortcut-container__shortcut-key--edit-mode': isEditMode,\n    });\n\n    return (\n      <div className=\"keyboard-shortcut-container\">\n        <div className=\"keyboard-shortcut-container__shortcut-name\">{name}</div>\n        <div\n          className={rebindAreaClassName}\n          onClick={this.handleRebindClick}\n          tabIndex=\"-1\"\n          ref={div => (this.rebindArea = div)}\n        >\n          {isEditMode ? '...' : this.symbolizeKeybinding(binding)}\n        </div>\n      </div>\n    );\n  }\n}\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport { withRouter } from 'react-router-dom';\n\nimport { Map } from 'immutable';\n\nimport ShortcutRow from './components/ShortcutRow';\n\nimport * as baseActions from '../../actions/base';\n\nimport { calculateNamedKeybindings } from '../../lib/keybindings';\n\nimport './stylesheet.css';\n\nconst KeyboardShortcutsEditor = ({ customKeybindings, base }) => {\n  const handleBindingChange = (bindingName, newBinding) => {\n    const alreadyInUseBinding = calculateNamedKeybindings(customKeybindings).filter(\n      ([_, binding]) => binding === newBinding\n    )[0];\n\n    if (!!alreadyInUseBinding) {\n      alert(`That binding is already in use for \"${alreadyInUseBinding[0]}\"`);\n      return;\n    }\n\n    base.setCustomKeybinding(bindingName, newBinding);\n  };\n\n  return (\n    <div className=\"keyboard-shortcuts-editor-container\">\n      {calculateNamedKeybindings(customKeybindings).map(([name, binding]) => (\n        <ShortcutRow\n          key={name}\n          name={name}\n          binding={binding}\n          onBindingChange={handleBindingChange}\n        />\n      ))}\n    </div>\n  );\n};\n\nconst mapStateToProps = (state, props) => {\n  return {\n    customKeybindings: state.base.get('customKeybindings') || Map(),\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    base: bindActionCreators(baseActions, dispatch),\n  };\n};\n\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(KeyboardShortcutsEditor));\n","import React, { Fragment, useState } from 'react';\nimport { UnmountClosed as Collapse } from 'react-collapse';\n\nimport { Draggable } from 'react-beautiful-dnd';\n\nimport './stylesheet.css';\n\nimport ActionButton from '../../../OrgFile/components/ActionDrawer/components/ActionButton';\nimport Switch from '../../../UI/Switch/';\n\nimport classNames from 'classnames';\n\nexport default ({\n  template,\n  index,\n  onFieldPathUpdate,\n  onAddNewTemplateOrgFileAvailability,\n  onRemoveTemplateOrgFileAvailability,\n  onAddNewTemplateHeaderPath,\n  onRemoveTemplateHeaderPath,\n  onDeleteTemplate,\n  syncBackendType,\n}) => {\n  const [isCollapsed, setIsCollapsed] = useState(!!template.get('description'));\n  const handleHeaderBarClick = () => setIsCollapsed(!isCollapsed);\n\n  const updateField = fieldName => event =>\n    onFieldPathUpdate(template.get('id'), [fieldName], event.target.value);\n\n  const toggleAvailabilityInAllOrgFiles = () =>\n    onFieldPathUpdate(\n      template.get('id'),\n      ['isAvailableInAllOrgFiles'],\n      !template.get('isAvailableInAllOrgFiles')\n    );\n\n  const togglePrepend = () =>\n    onFieldPathUpdate(template.get('id'), ['shouldPrepend'], !template.get('shouldPrepend'));\n\n  const handleAddNewOrgFileAvailability = () => {\n    onAddNewTemplateOrgFileAvailability(template.get('id'));\n  };\n\n  const handleRemoveOrgFileAvailability = index => () =>\n    onRemoveTemplateOrgFileAvailability(template.get('id'), index);\n\n  const handleOrgFileAvailabilityChange = orgFileAvailabilityIndex => event =>\n    onFieldPathUpdate(\n      template.get('id'),\n      ['orgFilesWhereAvailable', orgFileAvailabilityIndex],\n      event.target.value\n    );\n\n  const handleAddNewHeaderPath = () => onAddNewTemplateHeaderPath(template.get('id'));\n\n  const handleRemoveHeaderPath = headerPathIndex => () =>\n    onRemoveTemplateHeaderPath(template.get('id'), headerPathIndex);\n\n  const handleHeaderPathChange = headerPathIndex => event =>\n    onFieldPathUpdate(template.get('id'), ['headerPaths', headerPathIndex], event.target.value);\n\n  const handleDeleteClick = () => {\n    if (\n      window.confirm(\n        `Are you sure you want to delete the \"${template.get('description')}\" template?`\n      )\n    ) {\n      onDeleteTemplate(template.get('id'));\n    }\n  };\n\n  const renderDescriptionField = template => (\n    <div className=\"capture-template__field-container\">\n      <div className=\"capture-template__field\">\n        <div>Description:</div>\n        <input\n          type=\"text\"\n          className=\"textfield\"\n          value={template.get('description', '')}\n          onChange={updateField('description')}\n        />\n      </div>\n    </div>\n  );\n\n  const renderIconField = template => (\n    <div className=\"capture-template__field-container\">\n      <div className=\"capture-template__field\">\n        <div>Letter:</div>\n        <input\n          type=\"text\"\n          className=\"textfield capture-template__letter-textfield\"\n          maxLength=\"1\"\n          value={template.get('letter', '')}\n          onChange={updateField('letter')}\n          autoCapitalize=\"none\"\n        />\n      </div>\n\n      <div className=\"capture-template__field__or-container\">\n        <div className=\"capture-template__field__or-line\" />\n        <div className=\"capture-template__field__or\">or</div>\n        <div className=\"capture-template__field__or-line\" />\n      </div>\n\n      <div className=\"capture-template__field\">\n        <div>Icon name:</div>\n        <input\n          type=\"text\"\n          className=\"textfield\"\n          value={template.get('iconName')}\n          onChange={updateField('iconName')}\n          autoCapitalize=\"none\"\n          autoCorrect=\"none\"\n        />\n      </div>\n\n      <div className=\"capture-template__help-text\">\n        Instead of a letter, you can specify the name of any free Font Awesome icon (like lemon or\n        calendar-plus) to use as the capture icon. You can search the available icons{' '}\n        <a\n          href=\"https://fontawesome.com/icons?d=gallery&s=solid&m=free\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n        >\n          here\n        </a>\n        .\n      </div>\n    </div>\n  );\n\n  const renderOrgFileAvailability = template => (\n    <div className=\"capture-template__field-container\">\n      <div className=\"capture-template__field\">\n        <div>Available in all org files?</div>\n        <Switch\n          isEnabled={template.get('isAvailableInAllOrgFiles')}\n          onToggle={toggleAvailabilityInAllOrgFiles}\n        />\n      </div>\n\n      <div className=\"capture-template__help-text\">\n        You can make this capture template available in all org files, or just the ones you specify.\n        {syncBackendType === 'Dropbox' && (\n          <Fragment>\n            {' '}\n            Specify full paths starting from the root of your Dropbox, like{' '}\n            <code>/org/todo.org</code>\n          </Fragment>\n        )}\n        {syncBackendType === 'Google Drive' && (\n          <Fragment>\n            {' '}\n            Specify the file id of each file. You can find the file id in the URL of the file in\n            org-web (e.g.,{' '}\n            <code>\n              /file/\n              {'<file id>'}\n            </code>\n            ).\n          </Fragment>\n        )}\n      </div>\n\n      <Collapse\n        isOpened={!template.get('isAvailableInAllOrgFiles')}\n        springConfig={{ stiffness: 300 }}\n      >\n        <div className=\"multi-textfields-container\">\n          {template.get('orgFilesWhereAvailable').map((orgFilePath, index) => (\n            <div key={`org-file-availability-${index}`} className=\"multi-textfield-container\">\n              <input\n                type=\"text\"\n                placeholder=\"e.g., /org/todo.org\"\n                className=\"textfield multi-textfield-field\"\n                value={orgFilePath}\n                onChange={handleOrgFileAvailabilityChange(index)}\n              />\n              <button\n                className=\"fas fa-times fa-lg remove-multi-textfield-button\"\n                onClick={handleRemoveOrgFileAvailability(index)}\n              />\n            </div>\n          ))}\n        </div>\n\n        <div className=\"add-new-multi-textfield-button-container\">\n          <button\n            className=\"fas fa-plus add-new-multi-textfield-button\"\n            onClick={handleAddNewOrgFileAvailability}\n          />\n        </div>\n      </Collapse>\n    </div>\n  );\n\n  const renderHeaderPaths = template => (\n    <div className=\"capture-template__field-container\">\n      <div className=\"capture-template__field\" style={{ marginTop: 7 }}>\n        <div>Header path</div>\n      </div>\n\n      <div className=\"capture-template__help-text\">\n        Specify the path to the header under which the new header should be filed. One header per\n        textfield.\n      </div>\n\n      <div className=\"multi-textfields-container\">\n        {template.get('headerPaths').map((headerPath, index) => (\n          <div key={`header-path-${index}`} className=\"multi-textfield-container\">\n            <input\n              type=\"text\"\n              placeholder=\"e.g., Todos\"\n              className=\"textfield multi-textfield-field\"\n              value={headerPath}\n              onChange={handleHeaderPathChange(index)}\n            />\n            <button\n              className=\"fas fa-times fa-lg remove-multi-textfield-button\"\n              onClick={handleRemoveHeaderPath(index)}\n            />\n          </div>\n        ))}\n      </div>\n\n      <div className=\"add-new-multi-textfield-button-container\">\n        <button\n          className=\"fas fa-plus add-new-multi-textfield-button\"\n          onClick={handleAddNewHeaderPath}\n        />\n      </div>\n    </div>\n  );\n\n  const renderPrependField = template => (\n    <div className=\"capture-template__field-container\">\n      <div className=\"capture-template__field\">\n        <div>Prepend?</div>\n        <Switch isEnabled={template.get('shouldPrepend')} onToggle={togglePrepend} />\n      </div>\n\n      <div className=\"capture-template__help-text\">\n        By default, new captured headers are appended to the specified header path. Enable this\n        setting to prepend them instead.\n      </div>\n    </div>\n  );\n\n  const renderTemplateField = template => (\n    <div className=\"capture-template__field-container\">\n      <div className=\"capture-template__field\" style={{ marginTop: 7 }}>\n        <div>Template</div>\n      </div>\n\n      <textarea\n        className=\"textarea template-textarea\"\n        rows=\"3\"\n        value={template.get('template')}\n        onChange={updateField('template')}\n      />\n\n      <div className=\"capture-template__help-text\">\n        The template for creating the capture item. You can use the following template variables\n        that will be expanded upon capture:\n        <ul>\n          <li>\n            <code>%?</code> - Place the cursor here.\n          </li>\n          <li>\n            <code>%t</code> - Timestamp, date only.\n          </li>\n          <li>\n            <code>%T</code> - Timestamp, with date and time.\n          </li>\n          <li>\n            <code>%u</code> - Inactive timestamp, date only.\n          </li>\n          <li>\n            <code>%U</code> - Inactive timestamp, with date and time.\n          </li>\n          <li>\n            <code>%{'<custom variable>'}</code> - A custom variable from a URL param capture. See{' '}\n            <a href=\"https://github.com/DanielDe/org-web/#capture-params-and-siri-support\">\n              the README file\n            </a>{' '}\n            for more details.\n          </li>\n        </ul>\n      </div>\n    </div>\n  );\n\n  const renderDeleteButton = template => (\n    <div className=\"capture-template__field-container capture-template__delete-button-container\">\n      <button\n        className=\"btn settings-btn capture-template__delete-button\"\n        onClick={handleDeleteClick}\n      >\n        Delete template\n      </button>\n    </div>\n  );\n\n  const caretClassName = classNames(\n    'fas fa-2x fa-caret-right capture-template-container__header__caret',\n    {\n      'capture-template-container__header__caret--rotated': !isCollapsed,\n    }\n  );\n\n  return (\n    <Draggable draggableId={`capture-template--${template.get('id')}`} index={index}>\n      {(provided, snapshot) => (\n        <div\n          className={classNames('capture-template-container', {\n            'capture-template-container--dragging': snapshot.isDragging,\n          })}\n          ref={provided.innerRef}\n          {...provided.draggableProps}\n        >\n          <div className=\"capture-template-container__header\" onClick={handleHeaderBarClick}>\n            <i className={caretClassName} />\n            <ActionButton\n              iconName={template.get('iconName')}\n              letter={template.get('letter')}\n              onClick={() => {}}\n              style={{ marginRight: 20 }}\n            />\n            <span className=\"capture-template-container__header__title\">\n              {template.get('description')}\n            </span>\n            <i\n              className=\"fas fa-bars fa-lg capture-template-container__header__drag-handle\"\n              {...provided.dragHandleProps}\n            />\n          </div>\n\n          <Collapse isOpened={!isCollapsed} springConfig={{ stiffness: 300 }}>\n            <div className=\"capture-template-container__content\">\n              {renderDescriptionField(template)}\n              {renderIconField(template)}\n              {renderOrgFileAvailability(template)}\n              {renderHeaderPaths(template)}\n              {renderPrependField(template)}\n              {renderTemplateField(template)}\n              {renderDeleteButton(template)}\n            </div>\n          </Collapse>\n        </div>\n      )}\n    </Draggable>\n  );\n};\n","import React, { Fragment } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport { Droppable } from 'react-beautiful-dnd';\n\nimport './stylesheet.css';\n\nimport * as captureActions from '../../actions/capture';\n\nimport CaptureTemplate from './components/CaptureTemplate';\n\nimport { List } from 'immutable';\n\nconst CaptureTemplatesEditor = ({ captureTemplates, syncBackendType, capture }) => {\n  const handleAddNewTemplateClick = () => capture.addNewEmptyCaptureTemplate();\n\n  const handleFieldPathUpdate = (templateId, fieldPath, newValue) =>\n    capture.updateTemplateFieldPathValue(templateId, fieldPath, newValue);\n\n  const handleAddNewTemplateOrgFileAvailability = templateId =>\n    capture.addNewTemplateOrgFileAvailability(templateId);\n\n  const handleRemoveTemplateOrgFileAvailability = (templateId, orgFileAvailabilityIndex) =>\n    capture.removeTemplateOrgFileAvailability(templateId, orgFileAvailabilityIndex);\n\n  const handleAddNewTemplateHeaderPath = templateId => capture.addNewTemplateHeaderPath(templateId);\n\n  const handleRemoveTemplateHeaderPath = (templateId, headerPathIndex) =>\n    capture.removeTemplateHeaderPath(templateId, headerPathIndex);\n\n  const handleDeleteTemplate = templateId => capture.deleteTemplate(templateId);\n\n  const handleReorderTemplate = (fromIndex, toIndex) =>\n    capture.reorderCaptureTemplate(fromIndex, toIndex);\n\n  return (\n    <div>\n      <Droppable droppableId=\"capture-templates-editor-droppable\" type=\"CAPTURE-TEMPLATE\">\n        {(provided, snapshot) => (\n          <div\n            className=\"capture-templates-container\"\n            ref={provided.innerRef}\n            {...provided.droppableProps}\n          >\n            {captureTemplates.size === 0 ? (\n              <div className=\"no-capture-templates-message\">\n                You don't currently have any capture templates - add one by pressing the{' '}\n                <i className=\"fas fa-plus\" /> button.\n                <br />\n                <br />\n                Capture templates show up in the action drawer and give you quick access to creating\n                new headers (like org-capture).\n              </div>\n            ) : (\n              <Fragment>\n                {captureTemplates.map((template, index) => (\n                  <CaptureTemplate\n                    key={template.get('id')}\n                    index={index}\n                    template={template}\n                    syncBackendType={syncBackendType}\n                    onFieldPathUpdate={handleFieldPathUpdate}\n                    onAddNewTemplateOrgFileAvailability={handleAddNewTemplateOrgFileAvailability}\n                    onRemoveTemplateOrgFileAvailability={handleRemoveTemplateOrgFileAvailability}\n                    onAddNewTemplateHeaderPath={handleAddNewTemplateHeaderPath}\n                    onRemoveTemplateHeaderPath={handleRemoveTemplateHeaderPath}\n                    onDeleteTemplate={handleDeleteTemplate}\n                    onReorder={handleReorderTemplate}\n                  />\n                ))}\n\n                {provided.placeholder}\n              </Fragment>\n            )}\n          </div>\n        )}\n      </Droppable>\n\n      <div className=\"new-capture-template-button-container\">\n        <button className=\"fas fa-plus fa-lg btn btn--circle\" onClick={handleAddNewTemplateClick} />\n      </div>\n    </div>\n  );\n};\n\nconst mapStateToProps = (state, props) => {\n  return {\n    captureTemplates: state.capture.get('captureTemplates', new List()),\n    syncBackendType: state.syncBackend.get('client').type,\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    capture: bindActionCreators(captureActions, dispatch),\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(CaptureTemplatesEditor);\n","/* global process, gapi, google */\n\nimport React, { PureComponent } from 'react';\n\nimport './stylesheet.css';\n\nimport DropboxLogo from './dropbox.svg';\nimport GoogleDriveLogo from './google_drive.png';\n\nimport { persistField } from '../../util/settings_persister';\n\nimport { Dropbox } from 'dropbox';\n\nimport _ from 'lodash';\n\nexport default class SyncServiceSignIn extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, ['handleDropboxClick', 'handleGoogleDriveClick']);\n  }\n\n  handleDropboxClick() {\n    persistField('authenticatedSyncService', 'Dropbox');\n\n    const dropbox = new Dropbox({ clientId: process.env.REACT_APP_DROPBOX_CLIENT_ID, fetch });\n    const authURL = dropbox.getAuthenticationUrl(\n      window.location.origin + process.env.PUBLIC_URL + '/'\n    );\n    window.location = authURL;\n  }\n\n  handleGoogleDriveClick() {\n    try {\n      gapi.load('client', () => {\n        window.gapi.client\n          .init({\n            apiKey: process.env.REACT_APP_GOOGLE_DRIVE_API_KEY,\n            discoveryDocs: ['https://www.googleapis.com/discovery/v1/apis/drive/v3/rest'],\n          })\n          .then(async () => {\n            const tokenClient = google.accounts.oauth2.initTokenClient({\n              client_id: process.env.REACT_APP_GOOGLE_DRIVE_CLIENT_ID,\n              scope: 'https://www.googleapis.com/auth/drive.file',\n              callback: accessToken => {\n                persistField('authenticatedSyncService', 'Google Drive');\n                persistField('googleDriveAccessToken', JSON.stringify(accessToken));\n                window.location.reload();\n              },\n            });\n            tokenClient.requestAccessToken({ prompt: 'consent' });\n          });\n      });\n    } catch (error) {\n      alert(\n        `The Google Drive API client isn't available - you might be blocking it with an ad blocker`\n      );\n      return;\n    }\n  }\n\n  render() {\n    return (\n      <div className=\"sync-service-sign-in-container\">\n        <p className=\"sync-service-sign-in__help-text\">\n          org-web syncs your files with Dropbox or Google Drive. Choose your preferred sync backend\n          below to sign in.\n        </p>\n\n        <div className=\"sync-service-container\" onClick={this.handleDropboxClick}>\n          <img src={DropboxLogo} alt=\"Dropbox logo\" className=\"dropbox-logo\" />\n        </div>\n\n        <div className=\"sync-service-container\" onClick={this.handleGoogleDriveClick}>\n          <img src={GoogleDriveLogo} alt=\"Google Drive logo\" className=\"google-drive-logo\" />\n        </div>\n      </div>\n    );\n  }\n}\n","import React, { PureComponent, Fragment } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport { Route, Switch, Redirect, Prompt, withRouter } from 'react-router-dom';\n\nimport './stylesheet.css';\n\nimport { List } from 'immutable';\nimport _ from 'lodash';\nimport classNames from 'classnames';\n\nimport { parseOrg } from '../../lib/parse_org';\n\nimport raw from 'raw.macro';\n\nimport PrivacyPolicy from '../PrivacyPolicy';\nimport HeaderBar from '../HeaderBar';\nimport Landing from '../Landing';\nimport FileBrowser from '../FileBrowser';\nimport LoadingIndicator from '../LoadingIndicator';\nimport OrgFile from '../OrgFile';\nimport Settings from '../Settings';\nimport KeyboardShortcutsEditor from '../KeyboardShortcutsEditor';\nimport CaptureTemplatesEditor from '../CaptureTemplatesEditor';\nimport SyncServiceSignIn from '../SyncServiceSignIn';\n\nimport * as syncBackendActions from '../../actions/sync_backend';\nimport * as orgActions from '../../actions/org';\nimport * as baseActions from '../../actions/base';\n\nclass Entry extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, ['renderChangelogFile', 'renderSampleFile', 'renderFileBrowser', 'renderFile']);\n  }\n\n  componentDidMount() {\n    const { lastSeenChangelogHeader, isAuthenticated } = this.props;\n\n    const changelogFile = parseOrg(raw('../../../changelog.org'));\n    const firstHeaderTitle = changelogFile.getIn(['headers', 0, 'titleLine', 'rawTitle']);\n    if (\n      isAuthenticated &&\n      !!lastSeenChangelogHeader &&\n      firstHeaderTitle !== lastSeenChangelogHeader\n    ) {\n      this.props.base.setHasUnseenChangelog(true);\n    }\n    this.props.base.setLastSeenChangelogHeader(firstHeaderTitle);\n  }\n\n  componentDidUpdate() {\n    this.shouldPromptWhenLeaving()\n      ? (window.onbeforeunload = () => true)\n      : (window.onbeforeunload = undefined);\n  }\n\n  componentWillUnmount() {\n    window.onbeforeunload = undefined;\n  }\n\n  renderChangelogFile() {\n    return (\n      <OrgFile\n        staticFile=\"changelog\"\n        shouldDisableDirtyIndicator={true}\n        shouldDisableActions={true}\n        shouldDisableSyncButtons={false}\n        parsingErrorMessage={\n          \"The contents of changelog.org couldn't be loaded. You probably forgot to set the environment variable - see the Development section of README.org for details!\"\n        }\n      />\n    );\n  }\n\n  renderSampleFile() {\n    return (\n      <OrgFile\n        staticFile=\"sample\"\n        shouldDisableDirtyIndicator={true}\n        shouldDisableActionDrawer={false}\n        shouldDisableSyncButtons={true}\n        parsingErrorMessage={\n          \"The contents of sample.org couldn't be loaded. You probably forgot to set the environment variable - see the Development section of README.org for details!\"\n        }\n      />\n    );\n  }\n\n  renderFileBrowser({\n    match: {\n      params: { path = '' },\n    },\n  }) {\n    if (!!path) {\n      path = '/' + path;\n    }\n\n    return <FileBrowser path={path} />;\n  }\n\n  renderFile({\n    match: {\n      params: { path },\n    },\n  }) {\n    if (!!path) {\n      path = '/' + path;\n    }\n\n    return (\n      <OrgFile\n        path={path}\n        shouldDisableDirtyIndicator={false}\n        shouldDisableActionDrawer={false}\n        shouldDisableSyncButtons={false}\n      />\n    );\n  }\n\n  shouldPromptWhenLeaving() {\n    return this.props.location.pathname.startsWith('/file/') && this.props.isDirty;\n  }\n\n  render() {\n    const {\n      isAuthenticated,\n      loadingMessage,\n      fontSize,\n      activeModalPage,\n      pendingCapture,\n      location: { pathname },\n    } = this.props;\n\n    const pendingCapturePath = !!pendingCapture && `/file${pendingCapture.get('capturePath')}`;\n    const shouldRedirectToCapturePath = pendingCapturePath && pendingCapturePath !== pathname;\n\n    const className = classNames('entry-container', {\n      'entry-container--large-font': fontSize === 'Large',\n    });\n\n    return (\n      <div className={className}>\n        <HeaderBar />\n\n        <LoadingIndicator message={loadingMessage} />\n\n        <Prompt\n          when={this.shouldPromptWhenLeaving()}\n          message={() => 'You have unpushed changes - are you sure you want to leave this page?'}\n        />\n\n        {activeModalPage === 'changelog' ? (\n          this.renderChangelogFile()\n        ) : isAuthenticated ? (\n          ['keyboard_shortcuts_editor', 'settings', 'capture_templates_editor', 'sample'].includes(\n            activeModalPage\n          ) ? (\n            <Fragment>\n              {activeModalPage === 'settings' && <Settings />}\n              {activeModalPage === 'keyboard_shortcuts_editor' && <KeyboardShortcutsEditor />}\n              {activeModalPage === 'capture_templates_editor' && <CaptureTemplatesEditor />}\n              {activeModalPage === 'sample' && this.renderSampleFile()}\n            </Fragment>\n          ) : (\n            <Switch>\n              {shouldRedirectToCapturePath && <Redirect to={pendingCapturePath} />}\n              <Route path=\"/privacy-policy\" exact component={PrivacyPolicy} />\n              <Route path=\"/file/:path+\" render={this.renderFile} />\n              <Route path=\"/files/:path*\" render={this.renderFileBrowser} />\n              <Redirect to=\"/files\" />\n            </Switch>\n          )\n        ) : (\n          <Switch>\n            <Route path=\"/privacy-policy\" exact component={PrivacyPolicy} />\n            <Route path=\"/sample\" exact={true} render={this.renderSampleFile} />\n            <Route path=\"/sign_in\" exact={true} component={SyncServiceSignIn} />\n            <Route path=\"/\" exact={true} component={Landing} />\n            <Redirect to=\"/\" />\n          </Switch>\n        )}\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = (state, props) => {\n  return {\n    loadingMessage: state.base.get('loadingMessage'),\n    isAuthenticated: state.syncBackend.get('isAuthenticated'),\n    fontSize: state.base.get('fontSize'),\n    lastSeenChangelogHeader: state.base.get('lastSeenChangelogHeader'),\n    activeModalPage: state.base.get('modalPageStack', List()).last(),\n    pendingCapture: state.org.present.get('pendingCapture'),\n    isDirty: state.org.present.get('isDirty'),\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    syncBackend: bindActionCreators(syncBackendActions, dispatch),\n    org: bindActionCreators(orgActions, dispatch),\n    base: bindActionCreators(baseActions, dispatch),\n  };\n};\n\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(Entry));\n","import React, { PureComponent } from 'react';\nimport { Provider } from 'react-redux';\nimport Store from './store';\nimport {\n  readInitialState,\n  loadSettingsFromConfigFile,\n  subscribeToChanges,\n  persistField,\n  getPersistedField,\n} from './util/settings_persister';\nimport runAllMigrations from './migrations';\nimport parseQueryString from './util/parse_query_string';\nimport { HashRouter as Router } from 'react-router-dom';\n\nimport { DragDropContext } from 'react-beautiful-dnd';\n\nimport { reorderCaptureTemplate } from './actions/capture';\nimport { reorderTags, reorderPropertyList } from './actions/org';\nimport { signOut } from './actions/sync_backend';\nimport { setDisappearingLoadingMessage } from './actions/base';\n\nimport createDropboxSyncBackendClient from './sync_backend_clients/dropbox_sync_backend_client';\nimport createGoogleDriveSyncBackendClient from './sync_backend_clients/google_drive_sync_backend_client';\n\nimport './base.css';\n\nimport Entry from './components/Entry';\n\nimport _ from 'lodash';\nimport { Map } from 'immutable';\n\nexport default class App extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    runAllMigrations();\n\n    const initialState = readInitialState();\n\n    window.initialHash = window.location.hash.substring(0);\n    const hashContents = parseQueryString(window.location.hash);\n    const authenticatedSyncService = getPersistedField('authenticatedSyncService', true);\n    let client = null;\n\n    if (!!authenticatedSyncService) {\n      switch (authenticatedSyncService) {\n        case 'Dropbox':\n          const dropboxAccessToken = hashContents.access_token;\n          if (dropboxAccessToken) {\n            client = createDropboxSyncBackendClient(dropboxAccessToken);\n            initialState.syncBackend = Map({\n              isAuthenticated: true,\n              client,\n            });\n            persistField('dropboxAccessToken', dropboxAccessToken);\n            window.location.hash = '';\n          } else {\n            const persistedDropboxAccessToken = getPersistedField('dropboxAccessToken', true);\n            if (!!persistedDropboxAccessToken) {\n              client = createDropboxSyncBackendClient(persistedDropboxAccessToken);\n              initialState.syncBackend = Map({\n                isAuthenticated: true,\n                client,\n              });\n            }\n          }\n          break;\n        case 'Google Drive':\n          client = createGoogleDriveSyncBackendClient();\n          initialState.syncBackend = Map({\n            isAuthenticated: true,\n            client,\n          });\n          break;\n        default:\n      }\n    }\n\n    const queryStringContents = parseQueryString(window.location.search);\n    const { captureFile, captureTemplateName, captureContent } = queryStringContents;\n    if (!!captureFile && !!captureTemplateName) {\n      const capturePath = captureFile.startsWith('/') ? captureFile : `/${captureFile}`;\n      const customCaptureVariables = Map(\n        Object.entries(queryStringContents)\n          .map(([key, value]) => {\n            const CUSTOM_VARIABLE_PREFIX = 'captureVariable_';\n            if (key.startsWith(CUSTOM_VARIABLE_PREFIX)) {\n              return [key.substring(CUSTOM_VARIABLE_PREFIX.length), value];\n            }\n\n            return null;\n          })\n          .filter(item => !!item)\n      );\n      initialState.org.present = initialState.org.present.set(\n        'pendingCapture',\n        Map({\n          capturePath,\n          captureTemplateName,\n          captureContent,\n          customCaptureVariables,\n        })\n      );\n    }\n\n    this.store = Store(initialState);\n    this.store.subscribe(subscribeToChanges(this.store));\n\n    if (!!client) {\n      client.isSignedIn().then(isSignedIn => {\n        if (isSignedIn) {\n          loadSettingsFromConfigFile(this.store.dispatch, this.store.getState);\n        } else {\n          this.store.dispatch(signOut());\n        }\n      });\n    } else {\n      if (!!this.store.getState().org.present.get('pendingCapture')) {\n        this.store.dispatch(\n          setDisappearingLoadingMessage(\n            `You need to sign in before you can use capture templates`,\n            5000\n          )\n        );\n      }\n    }\n\n    _.bindAll(this, ['handleDragEnd']);\n  }\n\n  handleDragEnd(result) {\n    if (!result.destination) {\n      return;\n    }\n\n    if (result.type === 'CAPTURE-TEMPLATE') {\n      this.store.dispatch(reorderCaptureTemplate(result.source.index, result.destination.index));\n    } else if (result.type === 'TAG') {\n      this.store.dispatch(reorderTags(result.source.index, result.destination.index));\n    } else if (result.type === 'PROPERTY-LIST') {\n      this.store.dispatch(reorderPropertyList(result.source.index, result.destination.index));\n    }\n  }\n\n  render() {\n    return (\n      <DragDropContext onDragEnd={this.handleDragEnd}>\n        <Router basename={process.env.PUBLIC_URL}>\n          <Provider store={this.store}>\n            <div className=\"App\">\n              <Entry />\n            </div>\n          </Provider>\n        </Router>\n      </DragDropContext>\n    );\n  }\n}\n","// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)\n);\n\nexport default function register() {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Lets check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://goo.gl/SC7cgQ'\n          );\n        });\n      } else {\n        // Is not local host. Just register service worker\n        registerValidSW(swUrl);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the old content will have been purged and\n              // the fresh content will have been added to the cache.\n              // It's the perfect time to display a \"New content is\n              // available; please refresh.\" message in your web app.\n              console.log('New content is available; please refresh.');\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      if (\n        response.status === 404 ||\n        response.headers.get('content-type').indexOf('javascript') === -1\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl);\n      }\n    })\n    .catch(() => {\n      console.log('No internet connection found. App is running in offline mode.');\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport registerServiceWorker from './registerServiceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\nregisterServiceWorker();\n"],"sourceRoot":""}